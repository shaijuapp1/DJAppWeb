```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\AdminPage\AdminPageCtrl.js```FileName```DocApp.controller('AdminPageCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{		
	function AddItem(list, Title, Link, Group, Order, Permission){
		
		var item = {};
		item.Title = Title;
		item.Link= Link;
		item.Group= Group;
		item.Order = Order;
		item.Permission= Permission;
		
		list.push(item);
	}
	
	
	$scope.listCtrlOnLoad= function(){
	
		setIconList();
	
		$scope.access = true;

		/*
		$scope.access = false; 
		if(!IsCurrentUserInGroup("OMS-ApplicationAdmin")){
			return;
		}
		else{
			$scope.access = true;
		}
		*/


		SetSideBar("Admin Dashboard", "Admin Dashboard");
		
		
		
		
		//var list = GetListData("AdminLinks", "&$orderby=Order asc" );
		
		var list = [];
		AddItem(list ,'Booking System List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 1);
		AddItem(list ,'Currency List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 2);
		AddItem(list ,'Document Types','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 3);
		AddItem(list ,'Entity List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 4);
		AddItem(list ,'Type List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 5);
		AddItem(list ,'Folder Name List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 6);
		AddItem(list ,'Template','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 7);
		AddItem(list ,'Index List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 9);
		AddItem(list ,'Instrument Type List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 10);
		AddItem(list ,'Nature of Risk d List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 11);
		AddItem(list ,'Pay Frequency List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 12);
		AddItem(list ,'Testing Methodology List','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Config List', 13);
		AddItem(list ,'Requests','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Data List', 14);
		AddItem(list ,'StatusList','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Data List', 15);
		AddItem(list ,'AdminLinks','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Data List', 16);
		AddItem(list ,'SiteFieldsList','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Data List', 17);
		AddItem(list ,'AuditLog','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Data List', 18);
		AddItem(list ,'Admin','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 19);
		AddItem(list ,'Users','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 20);
		AddItem(list ,'Front Office','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 21);
		AddItem(list ,'Back Office','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 22);
		AddItem(list ,'Product Control','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 23);
		AddItem(list ,'Product Control Head','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 24);
		AddItem(list ,'TRY FIN Head','https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/NewUIHome.aspx#!/admin','Group', 25);

		
		var fileted = [];
		var groups = [];
		$.each(list , function(id, obj){
			
			//var v = CheckUserAndGroup(obj.PermissionId.results);
			
			if(true){ //CheckUserAndGroup(obj.PermissionId.results)){
										
				if(!obj.Link.contains("?")){
					obj.Link += "?";
				}
				else{
					obj.Link += "&";
				}
				obj.Link += "source=EITRY/FX/SitePages/NewUIHome.aspx#!/admin";
	
				
				///gops/WBCDD/WBTRYOMS/SiteAssets/OMS/html/PageClose.aspx
				var add = true;
				if(obj.Group){
					for(i=0;i<groups.length;i++){
						if(groups[i] == obj.Group){
							add = false;
							break;
						}
					}
					
					if(add){
						groups.push(obj.Group);
					}
				}
				fileted.push(obj);
			}
		});

		
		$scope.groups = groups;
		$scope.dataList = fileted;
		
		

	}
	
	
	
	
	
});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Contact\Bridge.html```FileName```<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" x-undefined="" />
<title>Untitled 1</title>
</head>

<body>

</body>

</html>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Contact\Contact.html```FileName```<script type="text/javascript" src="/EITRY/FX/SiteAssets/JS/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="/EITRY/FX/SiteAssets/JS/NewJSFiles/angular1.7.5.min.js"></script>

<!--Bootstrap JS-->
<script src="/EITRY/FX/SiteAssets/TryUtilUAT/Libraries/Bootstrap/bootstrap.min.js"></script>
<!--Bootstrap CSS-->
<link rel="stylesheet" href="/EITRY/FX/SiteAssets/TryUtilUAT/Libraries/Bootstrap/bootstrap.min.css">



<div  class="main"  ng-app="DocApp"  ng-controller="ListingCtrl"  data-ng-init="listCtrlOnLoad()">

	<table class="table table-striped table-hover table-bordered" >       
    	<thead> 
	        <tr  class="SubHeader1" style="background-color:#461e57;color:white" >
	            <th style="width:250px">Name</th>
	            <th style="width:70px">Desk</th>
	            <th style="width:150px">Mobile Number</th>
	            <th style="width:150px">Internal Number</th>
	            <th style="width:150px">Internal Hunting Line</th>			                    
	        </tr>
        </thead>
        <tbody>
	        <tr ng-repeat="th in DataList" ng-style="{ 'background-color': th.ItemColor }">
	            <td>{{th.Title}}</td>
	            <td>{{th.Desk}}</td>
	            <td>{{th.Mobile_x0020_Number}}</td>
	            <td>{{th.Internal_x0020_Number}}</td>
	            <td>{{th.Internal_x0020_Hunting_x0020_Lin}}</td>
	        </tr>
        </tbody>
    </table>	
</div>


<script type="text/javascript">
	var DocApp = angular.module('DocApp', []);
	
	DocApp.controller('ListingCtrl', function($scope) 
	{
		$scope.listCtrlOnLoad= function(){
		
		debugger;
			$scope.Test = "123";	
			$scope.DataList = GetSiteFieldsList("TRYContacts");
				
	}
	
	function GetSiteFieldsList(List)
	{
		var SiteURL = _spPageContextInfo.webAbsoluteUrl;
		var DataList = [];
		
		var URL = SiteURL + "/_vti_bin/client.svc/web/lists/getByTitle('" + List +"')/Items?$select=*";
			
		  $.ajax({
	        url: URL,
	        type: "GET",
			async: false,
	        headers: {
	            "accept": "application/json;odata=verbose",
	        },
	        success: function (data) 
	        {				
				if(data.d.results)
				{						
	            	var results = data.d.results;
		            $.each(results , function(index, dataRec) 
		            {    				
						DataList.push(dataRec);	                
		            });
				}
				else
				{
					DataList.push(data.d);
				}		
															
	        },
	        error: function (error) {
	            alert(JSON.stringify(error));					
	        }
	    });
		
		return DataList;
	}

});

</script>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CostApproval\Attachment.html```FileName```<div class="row" style="margin:0px"  >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" style="margin:0px" >
			<div class="col-md-12 divSubHeadingLog" >Attachment</div>
			<div class="col-md-12" style="padding:0px">
				<div class="row" ng-show="!item.ID" style="margin: 10px;color: blue;font-weight: 500;">
					Please save to attach files
				</div>
				
				<div class="row" ng-show="item.ID"> 
					
					<div class="form-group input-group col-md-9 HedgeDivCol" ng-hide="read"  
						style="margin-left: 10px !important;" ng-hide="read" >							
						<label class="form-group has-float-label">
							<input class="form-control" style="height:28px" id="filesDocument" name="filesDocument" 
								type="file" style="width: 95%;" multiple ng-model="filesDocument" />      										
							<span>Attachment</span>            
						</label>
					</div>
				
					<div class="col-md-2" style="margin-top: 12px;" ng-hide="read" >
						<button style="margin:0px !important;padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onUploadFile()" >			
							Upload
						</button>
					</div>
					 
				</div>
				
				<span style="color: blue;margin-left: 10px;"> * As part of CPR/GDPR compliance, do not add any customer sensitive information on SharePoint</span>										 
				
				
				<div class="row" style="margin-left: 3px;margin-right: 3px;" ng-show="item.Attachments.length > 0">
					<table id="dtFdRequestDocs" class="table table-condensed table-bordered table-hover dataTable no-footer" cellspacing="0" style="background-color: white;width: 100%;">
						<thead>
							<tr style="background-color: #d9d9d9;">
								<th class="hide">ID</th>
								<th>Document Name</th>							
								<th>Uploaded By</th>
								<th>Date</th>
								<th class="text-center">File</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							<tr  ng-repeat="at in item.Attachments track by $index" >
								<td>{{at.Name}}</td>							
								<td>{{at.uploadedBy}}</td>
								<td>{{at.documentDate}}</td>
								<td class="text-center">
									<a  target="_blank" href="{{at.fileUrl}}" ><i class="ChkFile fa fa-file-pdf-o" aria-hidden="true" style="font-size: 18px;"></i></a> 
								</td>
								<td class="text-center">
									<a href="" ng-click="DeleteAttachment(at)"  ng-hide="read"  >
										<i ng-hide="at.deleted" class="fa fa-trash-o DelFdReqDocIco" aria-hidden="true" style="font-size: 18px;"></i>
									</a>
								</td>
							</tr>		
						</tbody>
					</table>
				</div>
			</div>
			
		</div>
	</fieldset>
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CostApproval\Buttons.html```FileName```<div id="ButtonDiv" style="margin:10px;  ">

	
	<div class="text-danger" style="font-weight:bold;width:100%;padding:8px 20px;">{{ErrorMessage}}</div>
	
	<div ng-hide="read">
	
		<div style="float:left;padding:5px" ng-show="item.StatusCode == 1 ">				
			<button type="button" class="btn EI-ButtonPurple" ng-click="Save()" >						 
				Save
			</button>			 		
		</div>

	
		<div style="float:left;padding:5px"  >	
			<button type="button" class="btn EI-ButtonPurple" ng-click="StartWF()" >						 
				{{item.StatusCode== 1 ? 'Submit' : 'Resubmit' }}
			</button>			 		
		</div>
				
	</div>

	
	
	<div style="float:left;padding:5px" ng-repeat="sf in nintexFlow">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="TakeNintexWFAction(sf)" >	
			{{sf.Title}}
		</button>							
	</div>
	
	<div style="float:left;padding:5px">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onBackClick()" >						 
			Back to Queue
		</button>				 		
	</div>

	
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CostApproval\Comments.html```FileName```<div class="row" style="margin:0px" ng-show="item.AuditLog.length > 0" >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" style="margin:0px" >
			<div class="col-md-12 divSubHeadingLog" >Audit Log</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:120px;">Action</th>
							<th style="text-align:center;width:120px;">Action Type</th>
							<th style="text-align:center;width:200px;">By</th>
							<th style="text-align:center;width:100px;">Date &Time</th>
							<th style="text-align:center;width:300px;">Comments</th>			
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="it in item.AuditLog" >	
							<td style="text-align:center;">{{it.Title}}</td>
							<td style="text-align:center;">{{it.Action}}</td>
							<!--td style="text-align:left;"><span ng-show="it.Action">{{it.Author.Title}}{{it.WFComment.split(":")[}}</span></td-->
							<td style="text-align:center;"><span ng-show="it.Action">{{commentApprover(it.ActionBy.Title, it.WFComment ) }}</span></td>
							
							<td style="text-align:center;">{{FormatDate(it.ActionTime)}}</td>									
							<td style="text-align:left;">{{it.Comment}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>



```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CostApproval\CostApprovalCtrl.js```FileName```
DocApp.controller('CostApprovalCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	var selTab = "";
	var CostApprovalList = "CostApprovalList";
	var CostApprovalStatus = "CostApprovalStatus";
	var AttachmentDocLib = "CostApprovalkAttachments";
	var ApprovalAuditLog = "CostApprovalAuditLog";
	
	var HoTMGroup = "EITRY_HOTM_UAT";
	var BMSGroup = "EITRY_BMS_TEAM_UAT";
	var APP_Groups;

	
	//Lissting Page
	$scope.listCtrlOnLoad= function(){
	
		SetSideBar("Cost Approval", "Cost Approval");			
	
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);    	    				
	}
			
	$scope.listCtrlOnLoadInit = function()
	{
		LoadConfig();
		
		$scope.ListingQueue(selTab);
		$scope.$apply();
	}
	
	$scope.ListingQueue = function(queue){
		
		selTab = queue;
		
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		$scope.HoTMCount = "(" + GetListItemsCount(CostApprovalList , "StatusCode", "(StatusCode eq 2 or StatusCode eq 5 )") + ")";
		$scope.BMSCount = "(" + GetListItemsCount(CostApprovalList , "StatusCode", "(StatusCode eq 3 )") + ")";
		$scope.AllCount = "(" + GetListItemsCount(CostApprovalList , "StatusCode", "(StatusCode eq 2 or StatusCode eq 5 or StatusCode eq 3 )") + ")";


		DestroyTable();

		if(!selTab){
			if($scope.isBMS){
				queue = "BMS";
			}
			else if($scope.isHoTRY){
				queue = "HoTM";
			} 
		}
		
		var filter = "";
		if(queue == "HoTM"){
			filter = "&$filter=StatusCode eq 2 ";
		}
		else if(queue == "BMS"){
			filter = "&$filter=StatusCode eq 3 or StatusCode eq 1 ";
		}
		else{				
			queue = "All Requests";								
		}
		
		filter = ",Author/Title&$expand=Author/ID" + filter;			
		var dataList = GetListData(CostApprovalList , filter );
		
		$scope.dataList = dataList;
		
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
						
			updateTable();
			$('#divOverlay').hide();
			$('#divDataTable').show();

			$scope.QuqueTitle = queue;
		
		}, 0);

	}
	
	
	$scope.ClearFilter = function(){
	
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}

		updateTable();
	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				
				"pageLength": 20,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 1, "desc" ]],
				"autoWidth": false,
	
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						if( ColCount == 10 || ColCount == 11 ){

							var column = this;
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.main-ListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
							column.data().unique().sort().each( function ( d, j ) {
								
								select.append( '<option value="'+d+'">'+d+'</option>' )
	
							} );
							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
								
								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();
								
								    });							
							/*
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.auctionListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val )
										.draw();
								} );							
							$.each(ResponsibilityList , function(id, val){
								select.append( '<option value="'+ val.Title +'">'+ val.Title +'</option>' )	
	
							});
							*/
						}
						
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				//var id =  $($(auctionReqstItemElem ).children()[0]).text();
				var id = auctionReqstItemElem[0].children[0].textContent;

				//debugger;
				$scope.item = $scope.dataList[id]; 
				window.location = "/" + TryUtilPath + "CostApprovalDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
						
			if( $scope.QuqueTitle == "Report"  ){ //&& ( $scope.Config.isBMSUser || $scope.Config.isHoBMSUser)
				UpdateMeetingDateSearch();
			}
			
			/*
			var ht = "<button class='btn btn-success buttons-html5 iconButton pull-right' type='button' ng-click='ExportToExcel()' title='Export To Excel'  style='padding-right:10px'>";     
			ht += "<i class='fa fa-download actionButtonSign' aria-hidden='true'></i>";
			ht += "</button>";			
			$('#main-ListTable_filter').before(ht);
			*/
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}
	
			
	$scope.AddNew= function(){
		window.location = "/" + TryUtilPath + "NewCostApproval/";
	}

	//End of Lissting Page
	
	//Details Page
	
	$scope.detailsCtrlOnLoad = function(IsCopy){
	    	    	    	   			
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		SetSideBar("Cost Approval", "Cost Approval");
		
		LoadConfig();
		
		//turn;
		$scope.read = true;
		
		setTimeout(function(){ 		
    		$scope.detailsOnLoadInit(IsCopy);
    	}, 1);
    	
    	
    	

    	

	}
	
	$scope.detailsOnLoadInit= function(IsCopy){		
		
		$scope.itenId = $routeParams.itenId;
		//$scope.ShowSaveButton = true;
		var isRequestor = false;
		$scope.ShowComment = false;
		
		if(!IsCopy){
			$scope.ReqDetails = [];
		}
		
		
		if(!IsCopy && $routeParams.itenId){
		
			$scope.ShowComment = true;

			var listFilter = ",Author/Title&$expand=Author/ID&$filter=ID eq " + $routeParams.itenId;
			var listItems = GetListData(CostApprovalList, listFilter );
					
			if(listItems.length > 0 ){				
				$scope.item = listItems[0];	
				$scope.item.CurrentComment = "";
				//$scope.item.AuditLog =  angular.fromJson($scope.item.AuditLog);
				
				var Filter = ",Author/Title,ActionBy/Title&$filter=SpRef eq '" + $scope.item.Title  + "'&$expand=ActionBy/Id&$expand=Author/Id" ;	    	
				$scope.item.AuditLog =  GetListData(ApprovalAuditLog, Filter );
	
				if(!$scope.item.AuditLog ){
					$scope.item.AuditLog= [];
				}			
								
				$scope.AmountOnChange();
			}
			
			$scope.nintexFlow = [];
			var flow = GetRunningWorkflowTasksForCurrentUserForListItem( $scope.item.Id, CostApprovalList);
			flow.sort((a, b) => a.Title.localeCompare(b.Title));
			
			$scope.nintexFlow = flow;			
			RefreshDocuments($scope, AttachmentDocLib, $scope.item.Id, false );
		}
		else{
			
			$scope.nintexFlow = [];
			var ProductType = "";
			
			
			$scope.item = {};		
			$scope.item.StatusCode = "1";
			isRequestor  = true;	
			$scope.item.AuditLog = [];
			
		}
		
	
		
		if( $scope.isBMS && ( $scope.item.StatusCode == "1" || $scope.item.StatusCode == "3"   ) ){
			$scope.read = false;
		}
		
		setTimeout(function(){ 		
    		$('#CostDescription').on('change keyup keydown paste cut', 'textarea', function () {
				$(this).height(0).height(this.scrollHeight);
			}).find('textarea').trigger("change");
    	}, 1000);
				
						
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();
						
	}

	$scope.openFlow = function(date){			
		if($scope.item.WFLink){
			window.open($scope.item.WFLink.Url, "_blank");
		}
	}
	
	$scope.onBackClick = function()    
	{			
		 $location.path("CostApproval");
	}
	
	$scope.Save = function(){			
		ValidateAndSave(true);			
	}
	
	function ValidateAndSave(ignoreValidate){
	
		if( ignoreValidate || ValidateItem()){
		
			//$scope.item.InvoiceDate = new moment($scope.item.InvoiceDate, "DD-MMM-YYYY" )
		
			//$scope.item.ReqDetails = angular.toJson($scope.ReqDetails);
			
			if($scope.item.Title){
				//$scope.item.EmailBody = GetEmailBody();
			}
			
			//$scope.item.EmailBody = htmlEscape($scope.item.EmailBody )

			$scope.item.EmailBody = ""; //GetEmailBody();
			var IsNewReq = $scope.item.ID ? false : true;
			var id = UpdateList($scope.item, CostApprovalList, IsNewReq, IsNewReq);
			
			if(!$scope.item.Title){						
				
				var valuepairs = [];

				if(IsNewReq){
					$scope.item.ID = id;					
					$scope.item.Title = new moment($scope.item.Created).format('YYYYMM') + "-" + $scope.item.ID;					
					valuepairs.push( ["Title", $scope.item.Title ], ["EmailBody", $scope.item.EmailBody ]);	
					UpdateField(CostApprovalList, $scope.item.ID, valuepairs );	
				}

															
			}



			if(IsNewReq && id ){
				$location.path("CostApprovalDetails/" + id );
			}
			
			return true;
		}		
		else{
			return false;
		}
		
	}

	$scope.afterFileUpload = function(){		
		$('#filesDocument').val('');
		RefreshDocuments($scope, AttachmentDocLib, $scope.item.Id, true );
	}

	$scope.onUploadFile = function(){
		UploadFileIntoFolder($scope, AttachmentDocLib, $scope.item.ID, $('#filesDocument') );
	}

	$scope.DeleteAttachment = function(fileObj){		
		$scope.FileDeleteErrorMsg = "";
		$scope.deleteDocument = fileObj;
		fileObj.deleted = true;		
		DeleteDocument($scope, AttachmentDocLib, $scope.item.ID );
	}
	
	function ValidateItem(){
				
		var errMessage = "";
		$scope.invalidDealer = false;
				
		if ( $scope.af.$valid) {
				
			if(!$scope.item.Attachments || $scope.item.Attachments.length == 0){
				$scope.ErrorMessage = "Attachment required ";   
           	 	return false;
			}
			else{
				$scope.errMessage = "";              			        			 
           	 	return true;            	 	
			} 
                
        } 
        else {        				
        	$scope.se = true;
        	if( $scope.af.$error.required  != null || $scope.af.$error.required  != undefined ){	
        		$.each($scope.af.$error.required, function(id, err){
        			
        			if(  err.$$attr.errmsg == null || err.$$attr.errmsg == undefined ){	
        				//errMessage += err.$name + " required. ";        				
        			}
        			else{        			 
        				//errMessage += err.$$attr.errmsg + " required. ";
        			}
        		});
        	}                				
        	$scope.ErrorMessage = errMessage;
        	return false;
		}
	}
	
	$scope.StartWF = function(){
	
		$('#divOverlay').show();
		$('#ListDetails').hide();
			
		setTimeout(function(){ 					
			if(ValidateAndSave(false)){
											
				var valuepairs = [  [ "StartWF", true]];
				UpdateField(CostApprovalList, $scope.item.ID, valuepairs );

				GoBackOnChange();
								
				// $('#divOverlay').hide();
				// $('#ListDetails').show();						
			}
			else{				
				$scope.$apply();				
				$('#divOverlay').hide();
				$('#ListDetails').show();
			}

    	}, 50);
	}
	
	$scope.TakeNintexWFAction = function(task){
	
		$('#divOverlay').show();
		$('#ListDetails').hide();
		$scope.ErrorMessage = "";
		
		if((task.Title == "Reject" || task.Title == "Cancel" ) && !$scope.item.CurrentComment ){
			$scope.ErrorMessage = "Comment Required";
			$('#divOverlay').hide();
			$('#ListDetails').show();
			return;
		}
		
		if($scope.item.CurrentComment){
			var valuepairs = [ [ "CurrentComment", $scope.item.CurrentComment ] ];
			UpdateField(CostApprovalList, $scope.item.ID, valuepairs );
		}
		
		var res = ProcessFlexiTaskResponse2( task.Title, task.TaskId, $scope.item.CurrentComment);
		
		GoBackOnChange();					
		
	}
	
	var counter1 = 0;
	function GoBackOnChange(){
	
		console.log( counter1++ + ". GoBackOnChange" + moment().format('DD-MM-YYYY-HH-mm-ss') );
		$timeout(function(){ 
		
			if(CheckStatusChanged( $scope.item.StatusCode, $scope.item.ID )){ 
				//$('#dialog-overlay, #dialog-box').hide();
				$('#divOverlay').hide();
				$('#ListDetails').show();
				window.location = TryUtilURL + "CostApproval"; 

			}
			else{
				GoBackOnChange();
			} 				
		},1000);	
	}
	
	function CheckStatusChanged( LastStatusCode, ID)
	{
		var result = false;
		var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + CostApprovalList + "')/Items?$select=StatusCode&$filter=ID eq " + ID;
			
		  $.ajax({
	        url: URL,
	        type: "GET",
			async: false,
	        headers: {
	            "accept": "application/json;odata=verbose",
	        },
	        success: function(data) 
	        {		
				if(data.d.results)
				{		
					var res = data.d.results[0];
					if( LastStatusCode == 2 ){
						if( res.StatusCode != LastStatusCode ){
							result = true;
						}
						else{
							result = false;
						}
					}
					else{
						result = data.d.results[0].StatusCode == LastStatusCode ? false : true;	
					}
				}				
															
	        },
	        error: function (error) {
	            alert("Error : " + JSON.stringify(error));
				ErrorLog(ListName, "GetLiveStatus", JSON.stringify(error), "", "OMS");
	        }
	    });
		
		return result;
	
	}

	$scope.AmountOnChange = function(){ 
        $scope.item.Amount = AntTxtBoxOnChange($scope.item.Amount);  
    }





	//End of Details Page
	
	
	
	//Common
	$scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}
	
	$scope.FormatDate = function(date){		
		if(date){
			return new moment(date).format('DD-MMM-YYYY hh:mm A')
		}
	}


	$scope.GetStatusText = function(StatusId){				
		res = "";
		var StatusList = $scope.StatusList;
		if(StatusId){
			//Conf.Status
			for(i=0;i<StatusList.length;i++){
				if( StatusList[i].Id == parseInt(StatusId) ){
					res = StatusList[i].Title;
					break;
				}
			}			
		}		
		return res;					
	}
	
	$scope.GetButtonClass = function(title){
	
		if( title == $scope.QuqueTitle ){
			return "EI-ButtonPurple-Selected";
		}
		else{
			return '';
		}
	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function GetEmailBody(){
	
		var L1 = $scope.item.ProductType == 'FX' ? 'CUB' : 'CXB'
		var L2 = $scope.item.ProductType == 'FX' ? 'CUS' : 'CXS';

		var link = "<a href='" + TryUtilURL + "CostApprovalDetails/" + $scope.item.ID + "' >Request</a>"
				
		var emailText = '';
		emailText += "<div style='font-weight:normal;font-family:Arial, Helvetica, sans-serif;font-size:12px'>";
		emailText += "Dear User,<br/><br />";
		emailText += link + " has been submitted for approval<br /><br />";

		/*
		emailText += "<table style='width:800px;font-weight:normal;font-family:Arial, Helvetica, sans-serif;font-size:12px'>";
		emailText += "<tbody>";
		emailText += "<tr>";
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Product Type</td>";
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Currency</td>";
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:200px;border-bottom:1px white solid;color:black'>Current " + L1 + " margin</td>";
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:200px;border-bottom:1px white solid;color:black'>Proposed " + L1 + " margin</td>";
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:200px;border-bottom:1px white solid;color:black'>Current " + L2 + " margin</td>";
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:200px;border-bottom:1px white solid;color:black'>Proposed " + L2 + " margin</td>";
		emailText += "</tr> ";
		emailText += "<!--Table Rows-->";
		emailText += "</tbody>";
		emailText += "</table>";
		emailText += "</div>";
		
		//emailText = emailText.replace("Product type", "Product type");
		
		var tableRow = "";
		tableRow += "<tr>";
		tableRow += "<td style='text-align: center;background-color: #F9F9F9;'>##ProductType##</td>";
		tableRow += "<td style='text-align: center;background-color: #F9F9F9;'>##Currency##</td>";
		tableRow += "<td style='text-align: center;background-color: #F9F9F9;'>##CurrentCMargin##</td>";
		tableRow += "<td style='text-align: center;background-color: #F9F9F9;'>##ProposedCBMargin##</td>";
		tableRow += "<td style='text-align: center;background-color: #F9F9F9;'>##CurrentCSMargin##</td>";
		tableRow += "<td style='text-align: center;background-color: #F9F9F9;'>##ProposedCSMargin##</td>";
		tableRow += "</tr>";
		
		var rows = "";
		
		
		$.each($scope.ReqDetails, function(id, val){
		
			var row = tableRow;
			row = row.replace("##ProductType##", $scope.item.ProductType);	
			row = row.replace("##Currency##", val.Currency);
			row = row.replace("##CurrentCMargin##", val.CurrentCMargin);
			row = row.replace("##ProposedCBMargin##", val.ProposedCBMargin);
			row = row.replace("##CurrentCSMargin##", val.CurrentCSMargin);
			row = row.replace("##ProposedCSMargin##", val.ProposedCSMargin);
			rows += row; 
		});
		
		emailText = emailText.replace("<!--Table Rows-->", rows );
		*/

		emailText += "<table style='font-weight:normal;font-family:Arial, Helvetica, sans-serif;font-size:12px'>";
		emailText += "<tbody>";                
		emailText += "<tr>"                     
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:150px;border-bottom:1px white solid;color:black'>Product Type</td>";
		$.each($scope.ReqDetails, function(id, val){
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + $scope.item.ProductType + "</td>";
		});
		emailText += "</tr> ";

		emailText += "<tr>"
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Currency</td>";
		$.each($scope.ReqDetails, function(id, val){
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.Currency + "</td>";
		});
		emailText += "</tr> ";

		emailText += "<tr>"
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Current " + L1 + " margin</td>";
		$.each($scope.ReqDetails, function(id, val){
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.CurrentCMargin + "</td>";
		});
		emailText += "</tr> ";

		emailText += "<tr>"
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Proposed " + L1 + " margin</td>";
		$.each($scope.ReqDetails, function(id, val){
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.ProposedCBMargin + "</td>";
		});
		emailText += "</tr> ";

		emailText += "<tr>"
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Current " + L2 + " margin</td>";
		$.each($scope.ReqDetails, function(id, val){
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.CurrentCSMargin + "</td>";
		});
		emailText += "</tr> ";

		emailText += "<tr>"
		emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Proposed " + L2 + " margin</td>";
		$.each($scope.ReqDetails, function(id, val){
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.ProposedCSMargin + "</td>";
		});            
		emailText += "</tr> ";
		emailText += "</tbody>";
		emailText += "</table>";

		return htmlEscape(emailText);
		
	}
	
	$scope.ExportToExcel = function(){
	
		var filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID";		
		
		
		var res = [];        
        var row = [
        	'SP Ref.',
			'Invoice Date',
        	'Service Provider',
			'Currency', 
			'Amount',
			'Cost Description',   
			'Status',     	        				
        ];
        res.push(row);   
        
        
        $.each($scope.dataList, function(id, val){     			
			var row = [];
			row.push(val.Title);
			row.push(val.InvoiceDate);
			row.push(val.ServiceProvider); 
			row.push(val.Currency); 
			row.push(val.Amount); 
			row.push(val.CostDescription); 	
			row.push( $scope.GetStatusText(val.StatusCode) );        			    	        		        	
			res.push(row);	
        	        	        	        	        	
		}); 
		
		ExcelReportDownload(res, 'CostApproval-' + moment().format('DD-MM-YYYY-HH-mm-ss') +'.xlsx')
	}
	
	function LoadConfig(){
		$scope.StatusList = GetConfigList(CostApprovalStatus );
		$scope.CurrencyList = GetConfigList("CurrencyList");
		$scope.ServiceProviderList = GetConfigList("CostApprovalServiceProvider");
		
		$scope.ChargesQuarterList = GetConfigList("ChargesQuarterList");
    	$scope.ChargesYearList = GetConfigList("ChargesYearList");


		
		if(!APP_Groups){
			APP_Groups= {};
			APP_Groups= RefreshUserInGroupByName( BMSGroup, APP_Groups);
			APP_Groups= RefreshUserInGroupByName(HoTMGroup, APP_Groups);
			
			for(j=0;j< APP_Groups.UserGroupsForUser.length;j++){
	
				switch( APP_Groups.UserGroupsForUser[j] ){
					case HoTMGroup:
						$scope.isHoTRY = true;
						break;
					case BMSGroup:
						$scope.isBMS= true;
						break;
				}
			}
		}
	}

	$scope.commentApprover = function(Approver, comment){			
		if(comment){
			try{
				var str = comment.split(":")[2]
				return str.substring(str.indexOf('(')+1, str.length-1)
			}catch(ex){
				return comment;
			}
			window.open($scope.item.WFLink.Url, "_blank");
		}
		else{
			return Approver;
		}
	}

});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CostApproval\CostApprovalDetails.html```FileName```<style>

	.CloseButton{
		position:absolute;
		top:0px;
		right:0px;
		cursor:pointer;				
	}

	.boldCpation{
		font-weight: bold;margin-left: 2px;
		/* margin-left: 60px; */
		text-align: center;
	}

	.WTDCap {
		background:#deeaf6;	
		height:20px;
		padding-top:3px;
		padding-left:10px;
		width:225px;
		border-bottom:1px white solid;
		font-weight:bold;
		color:black
	} 
	WTDVal{
		width:400px;
		height:17px;
		background:white;
		padding-top:3px;
		padding-left:5px;
		color:black;
		font-weight:bold;
		background:#F9F9F9;
		border-bottom:1px white solid;
		
	}
	
	
</style>

<form name="myForm"></form>

<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="detailsCtrlOnLoad()" >
  <div class="panel panel-default" style="width: 100%">
   
    
    <div class="panel-heading item-panel-heading" >  
    	
    	<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;">						
			<span >Status : {{ GetStatusText(item.StatusCode) }}</span>
		</p>
		
		<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;" ng-show="item.Title">						
			<span ng-click="openFlow()">SP Ref. : {{ item.Title }}</span>
		</p>
		
			
    	<div class="pannel-header">
			<div class="main-header-title">Cost Approval Request Form<span style="color:red;font-weight:bold"> UAT</span></div>						
		</div>		   		
    </div>

    <div class="meeting-panel-body">        	
        <form name="af" novalidate>	    	    
	    	<div class="tab-content pageTabContentStyles" >    	    		    			    		    			    		
	    		<div id="tabDetails" class="tab-pane fade in active"  >	
	    			
	    			<div class="row content divPnlSrchRsltCharts" >
	    				<div class="col-md-12 divSubHeading" >Request Details</div>
	    				
						<!-- <div class="col-md-12">
							<table style="width:500px">
								<tr >
									<td class="WTDCap" ng-click="Test()" >Invoice Date</td>
									<td class="WTDVal">
										<input name="InvoiceDate"  class="form-control" type="text" ng-model="item.InvoiceDate"  gtdatepicker   
											required    ng-disabled="read">					
									</td>
								</tr>

							</table>
						</div> -->

	    				<div class="col-md-12" style="margin:10px !important" >
	    				
	    					<div class="row" style="margin-top:10px;border:1px gray solid;background-color:#F0F8FF !important;padding:20px" >
								
								
	    						<div class="form-group input-group col-md-1 HedgeDivCol" 	  >	
									<label class="form-group has-float-label">
										<input name="InvoiceDate"  class="form-control" type="text" ng-model="item.InvoiceDate"  gtdatepicker   
												required    ng-disabled="read">										
										<span>Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['InvoiceDate'].$touched) && af['InvoiceDate'].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
	    						<div class="form-group input-group col-md-3 HedgeDivCol" >	
									<label class="form-group has-float-label">
										
										<select name="ServiceProvider" class="form-control" ng-model="item.ServiceProvider" ng-disabled="read" required  errmsg="Service Provider" >
		    									<option value=""></option>									    
										    	<option ng-repeat="sp in ServiceProviderList">{{sp.Title}}</option>											 						
										</select>	
																		
										<span>Service Provider<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['ServiceProvider'].$touched) && af['ServiceProvider'].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>

								<div class="form-group input-group col-md-2 HedgeDivCol" >	
									<label class="form-group has-float-label">
										<input name="InvoiceRef" class="form-control" type="text" ng-model="item.InvoiceRef" required  
											ng-disabled="read" errmsg="Invoice Ref" />										
										<span>Invoice Ref<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['InvoiceRef'].$touched) && af['InvoiceRef'].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>

							
								
								
								<div class="form-group input-group HedgeDivCol col-md-3" >
									<div style="width:50%;float:left">
										<label class="form-group has-float-label">
											<select name="Period" class="form-control" ng-model="item.Period" ng-disabled="read" required  errmsg="Period Month" 
												>
			    									<option value=""></option>									    
											    	<option ng-repeat="sp in ChargesQuarterList">{{sp.Title}}</option>											 						
											</select>										
											<span>Invoice for month<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
											<p ng-show="(se || af['Period'].$touched) && af['Period'].$invalid " class="text-danger">required.</p>										     
										</label>
									</div>	
									<div style="width:50%;float:left">
										<label class="form-group has-float-label">
											<select name="PeriodYear" class="form-control" ng-model="item.PeriodYear" ng-disabled="read" required  errmsg="Service Provider"
													>
			    									<option value=""></option>									    
											    	<option ng-repeat="sp in ChargesYearList">{{sp.Title}}</option>											 						
											</select>										
											<span>Year<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
											<p ng-show="(se || af['PeriodYear'].$touched) && af['PeriodYear'].$invalid " class="text-danger">required.</p>										     
										</label>	
									
									</div>																													 
								</div>

																								
								<div class="form-group input-group HedgeDivCol col-md-3" >
									<div style="width:30%;float:left">
										<label class="form-group has-float-label">
											<select name="Currency" class="form-control" ng-model="item.Currency" ng-disabled="read" required  errmsg="Currency" >
		    									<option value=""></option>									    
										    	<option ng-repeat="cr in CurrencyList">{{cr.CurrencyCode}}</option>											 						
											</select>										
											<span>Currency<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
											<p ng-show="(se || af['Currency'].$touched) && af['Currency'].$invalid " class="text-danger">required.</p>										     
										</label>
									</div>	
									<div style="width:70%;float:left">
										<label class="form-group has-float-label">
											<input name="Amount" class="form-control" type="text" ng-model="item.Amount" required  
												ng-disabled="read" errmsg="Amount" ng-change="AmountOnChange()" />										
											<span>Amount<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
											<p ng-show="(se || af['Amount'].$touched) && af['Amount'].$invalid " class="text-danger">required.</p>										     
										</label>	
									
									</div>																													 
								</div>
																
								<div class="form-group input-group col-md-12 HedgeDivCol" id="CostDescription"	  >	
									<label class="form-group has-float-label">
										<!-- <input name="CostDescription" class="form-control" type="text" ng-model="item.CostDescription" required  
											ng-disabled="read" errmsg="Cost Description" />	
																			 -->
										<textarea  name="CostDescription" class="multiLineInput" ng-model="item.CostDescription" required 
										 ng-disabled="read"  errmsg="Cost Description"  style="height:40px" ></textarea>		    			
													
										<span>Cost Description<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['CostDescription'].$touched) && af['CostDescription'].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								
	    					</div>
	    						    						    					
	    				</div>
	    				
						<div class="col-md-12" style="padding:10px;" >
							<div style="width:100%" ng-include="'../SiteAssets/TryUtilUAT/Proj/CostApproval/Attachment.html'" ></div>	
						</div>

						<div class="form-group input-group col-md-12 HedgeDivCol" style="margin-top:15px !important">
							<label class="form-group has-float-label FormLabel">													
								<textarea  name="CurrentComment" id="CurrentComment" ng-model="item.CurrentComment"  
									class="multiLineInput" style="height:40px" ></textarea>		    			
								<span>Comment</span>
							</label>																 
						</div>
						
	   				    <div style="width:100%;" ng-include="'../SiteAssets/TryUtilUAT/Proj/CostApproval/Buttons.html'"></div> 
	   				    
							
						<div class="col-md-12" style="padding:10px;" >
							<div style="width:100%" ng-include="'../SiteAssets/TryUtilUAT/Proj/CostApproval/Comments.html'" ></div>	
						</div>
						
					</div>
														    				    				    					    		
	    		</div>	    			    										
																											
	    	</div>
    	</form>	
				
    </div>
    
  </div>  
</div>


	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CostApproval\CostApprovalList.html```FileName```<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-4 main-header-title">Cost Approval Management<span style="color:red;font-weight:bold"> UAT</span></div>	
		<div class=" col-md-8">										
		</div>		
	</div>
	
	<div  class="row content  divPnlButton" >
	
		<div class="col-md-10">
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()"  > <!--ng-show="Config.isBMSUser"-->
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  New Request
			</button>
						
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('HoTM')" ng-class="GetButtonClass('HoTM')" >
				 HoTM {{HoTMCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('BMS')"  ng-class="GetButtonClass('BMS')" >
				BMS {{BMSCount}}
			</button>				
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('All Requests')"  ng-class="GetButtonClass('All Requests')"  >
				 All Requests{{AllCount}}
			</button>
					
		</div>
		
		<div class="col-md-2">								
			
	        
	        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
            	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
				<!-- <i class="fa icon-filter icon-stack-base"></i>
				<i class="fa icon-remove"></i> -->
            </button>
	        
			 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ListingQueue(QuqueTitle)" title="Refresh">
	            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
	         </button>	
	        
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
	        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
			</button>  
	          				
		</div>						            	
							
	</div>
	
	
	
	<div class="row main-data">			
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class='hide' style='width:100px'>ID</th>
						<th style='width:150px'>SP Ref.</th>
						<th style='width:150px'>Request Date</th>
						<th style='width:200px'>Service Provider</th>
						<th style='width:150px'>Invoice Ref</th>
						<th style='width:150px'>Invoice  Date</th>
						<th style='width:150px'>CCY & Amt</th>	
						<th style='width:150px'>Invoice for</th>																													
						<th style='width:150px'>Status</th>										
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class='hide' style='width:100px'>ID</th>
						<th style='width:150px'>SP Ref.</th>
						<th style='width:150px'>Request Date</th>
						<th style='width:200px'>Service Provider</th>
						<th style='width:150px'>Invoice Ref</th>
						<th style='width:150px'>Invoice  Date</th>
						<th style='width:150px'>CCY & Amt</th>	
						<th style='width:150px'>Invoice for</th>																													
						<th style='width:150px'>Status</th>																
		            </tr>
		        </tfoot>		        		        
				<tbody>									
					<tr ng-repeat="it in dataList  " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
						<td class='hide'>{{it.ID}}</td>
						<td style="text-align:center" data-order="{{it.ID}}" >{{it.Title}}</td>
						<td style="text-align:center" data-order="{{DateSer(it.Created)}}" >{{it.Created}}</td>
						<td style="text-align:center">{{ it.ServiceProvider}}</td>	
						<td style="text-align:center">{{ it.InvoiceRef}}</td>
						<td style="text-align:center" data-order="{{DateSer(it.InvoiceDate )}}" >{{it.InvoiceDate }}</td>	
						<td style="text-align:left">{{ it.Currency}} {{ it.Amount | number}}</td>	
						<td style="text-align:center">{{ it.Period}} {{ it.PeriodYear}}</td>													
						<td style="text-align:center">{{GetStatusText(it.StatusCode)}}</td>																	
					</tr>				 	  
				</tbody>									
			</table>
		</div>		
	</div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\ASList.html```FileName```<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-4 main-header-title">Counterparty A&S</div>	
		<div class=" col-md-8">			
			
			<div class=" appCountButton topright"  >
				<button type="button" class="btn active" ng-if="DDCPTYCount"
					onclick="window.open('https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/CounterpartyManagement.aspx','_blank')" >
					{{DDCPTYCount}}
				</button>
			</div>
				
		</div>		
	</div>
	
	<div  class="row content  divPnlButton" ng-if="isBMSUser" >
	
		<div class="col-md-9">
		
			<!--button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('Active')"  ng-class="GetButtonClass('Active')" >
				Active Counterparties
			</button-->
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('New')"  ng-class="GetButtonClass('New')" >
				New({{NewItemCount}})
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('All')"  ng-class="GetButtonClass('All')" >
				All Counterparties
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('Monthy Review')"  ng-class="GetButtonClass('Monthy Review')" >
				Monthly Review
			</button>
			
			<!--button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('Warning Email Report')"  ng-class="GetButtonClass('Warning Email Report')" >
				Warning Email Report
			</button-->

			
			<a href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandSExpLog">
				<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" >Expiry Email Log</button>
			</a>
			
			<a href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandSCheckLog">
				<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" >Pending Emails({{WFErrCount}})</button>
			</a>


		
		</div>
		
		<div class="col-md-3">								
			<!--a href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandSExpLog">	
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button"  title="Expiry Email Log">	            	
	        	<i class="fa fa-list-alt actionButtonSign" aria-hidden="true"></i>
	        </button>  
	        </a-->
	                
	        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
            	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
            </button>
	        
			 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ListingQueue(QuqueTitle)" title="Refresh">
	            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
	         </button>	
	         
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
	        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
	        </button>      
	        
			      				
		</div>						            	
							
	</div>
	
	
	
	<div class="row main-data">			
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class='hide' style='width:100px' data-order="{{DateSer(it.ComplectionDate)}}" >ID</th>
						<th style='width:100px'>CIF</th>
						<th style='width:400px'>Client Name</th>
						<th style='width:100px'>Client Type</th>
						<th style='width:100px'>Client Categorization</th>
						<th style='width:60px'>Assessment Date</th>
						<th style='width:80px'>Status</th>																																						
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class='hide' style='width:100px'>ID</th>
						<th style='width:100px'>CIF</th>
						<th style='width:400px'>Client Name</th>
						<th style='width:100px'>Client Type</th>
						<th style='width:100px'>Client Categorization</th>
						<th style='width:60px'>Assessment Date</th>
						<th style='width:80px'>Status</th>		
	
												
		            </tr>
		        </tfoot>		        		        
				<tbody>									
					<tr ng-repeat="it in dataList | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" 
						ng-class-even="'alloTableEven'"
						ng-click="OnItemClick(it, $index)" >	
						<td class='hide'>{{it.ID}}</td>
						<td style="text-align:center">
							<i class="fa fa-asterisk mandatory " ng-if="IsNew(it.ModifiedDt)" aria-hidden="true" style="color:green"></i>
						{{it.Title}}</td>
						<td style="text-align:left">{{it.ClientName}}</td>
						<td style="text-align:center">{{it.ClientType}}</td>
						<td style="text-align:center">{{it.ClientRating}}</td>
						<td style="text-align:center">{{it.AssessmentDate}}</td>
						<td style="text-align:center">{{it.Status}}</td>						
					</tr>				 	  
				</tbody>									
			</table>
		</div>
	</div>
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtil/Proj/CprtyAS/ReqModel.html'" ></div>

</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\ASListCtrl.js```FileName```
var selTab = "";

DocApp.controller('ASListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.MeetingStatus = function(itm){
		if(itm.ExpairyEmailErr == "yes" ){
			return '#FF9966';
		}
		else{
			return '';
		}						
	}


	$scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}
	
	
	$scope.IsNew = function(date){
		if(date){			
			var v = new moment().subtract(1, 'hours');
			if(v >  moment(date)){
				return false;
			} else{
				return true;
			}
		}
		else{
			return false;
		}
	}


	
	$scope.GetExpiryDate = function(){
	
		if($scope.item && $scope.item.AssessmentDate){
		
			var dt2022 = new moment("12-31-2021", "MM-DD-YYYY");
			
			var assDt = new  moment($scope.item.AssessmentDate, "DD-MMM-YYYY" );
			
			if( assDt > dt2022 ){
				return assDt.add(1, 'years').format("DD-MMM-YYYY");
			}
			else{
				return assDt.add(2, 'years').format("DD-MMM-YYYY");
			}
			
			//return moment($scope.item.AssessmentDate, "DD-MMM-YYYY" ).add(1, 'years').format("DD-MMM-YYYY");
		}
		else{
			return "";
		}
	}
	
			
	$scope.OnItemClick = function(DocObj,index)
	{			
		if(!$scope.isBMSUser){
			return;
		}
		
		var products = [];
		if( DocObj.custID){
			$scope.item = Object.assign({}, DocObj);
			var filter = "&$select=ID,CIF,Title,ClientType,AuthorizerProduct1/Title,AuthorizerProduct2/Title,AuthorizerProduct3/Title,AuthorizerProduct4/Title,AuthorizerProduct5/Title" 
				+ "&$expand=AuthorizerProduct1/Id&$expand=AuthorizerProduct2/Id&$expand=AuthorizerProduct3/Id&$expand=AuthorizerProduct4/Id&$expand=AuthorizerProduct5/Id";		
						
			filter += "&$filter=ID eq " + DocObj.custID;
			var listItems = GetListByFilter("Customer", filter );
			
			
			if(listItems.length > 0 ){				
				var cust = listItems[0];
				$.each(cust.AuthorizerProduct1.results, function(id, prod){
					if(!products.includes(prod.Title)){
						products.push(prod.Title);
					}
				});				
				$.each(cust.AuthorizerProduct2.results, function(id, prod){
					if(!products.includes(prod.Title)){
						products.push(prod.Title);
					}
				});
				$.each(cust.AuthorizerProduct3.results, function(id, prod){
					if(!products.includes(prod.Title)){
						products.push(prod.Title);
					}
				});				
				$.each(cust.AuthorizerProduct4.results, function(id, prod){
					if(!products.includes(prod.Title)){
						products.push(prod.Title);
					}
				});
				$.each(cust.AuthorizerProduct5.results, function(id, prod){
					if(!products.includes(prod.Title)){
						products.push(prod.Title);
					}
				});		
			}
		}
		else if(DocObj.CprtyProduct){
			products.push(DocObj.CprtyProduct);
		}
		
		$scope.item.NewReviewDate = new moment().format('DD-MMM-YYYY');	
		$scope.item.products = products;
		$scope.item.Status = GetStatus();
		
		
		/*
		data.AuthorizerProduct2 = cust.AuthorizerProduct2;
		data.AuthorizerProduct3 = cust.AuthorizerProduct3;
		data.AuthorizerProduct4 = cust.AuthorizerProduct4;
		data.AuthorizerProduct5 = cust.AuthorizerProduct5;
		*/
		
		
					    
	    
	    $scope.CommentList =  angular.fromJson($scope.item.AuditLog);
	    if(!$scope.CommentList ){
			$scope.CommentList= [];
		}	
		$scope.item.CurrentComment = "";	    
	    $scope.selIndex = index;
	   
		$('#DetailsModal').modal('toggle');		
	}
	
	$scope.SaveItem = function()
	{			
		addComment();			    
		$scope.item.AuditLog = angular.toJson($scope.CommentList);
		$scope.item.ReviewDate = $scope.item.NewReviewDate;	
			
	    var IsNewReq = $scope.item.ID ? false : true;
		var id = UpdateList($scope.item, "CounterpartyAandS", IsNewReq, IsNewReq); 
		
		
		$scope.ListingQueue($scope.QuqueTitle);		
		
		//$scope.selIndex
		//$scope.dataList[$scope.selIndex] = $scope.item;

		$('#DetailsModal').modal('toggle');
	}
	
	function addComment(){
	
		var log = {};
		log.Date = moment($scope.item.NewReviewDate , "DD-MMM-YYYY").format('YYYY-MM-DD hh:mm A'); // moment().format('YYYY-MM-DD hh:mm A');
		log.ActionBy = GetSiteConfig("CurrentUser").Title;				
		log.ClientRating = $scope.item.ClientRating;		
		log.AssessmentDate = $scope.item.AssessmentDate;		
		log.Status = $scope.item.Status;				
		log.Comment = $scope.item.CurrentComment;
		
		$scope.CommentList.push(log);
	}

	$scope.FormatCommentDate= function(date)    
	{		
		var dt = "";	
		if(date){
			 //var dt =  new moment(date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY hh:mm A')
			 var dt =  new moment(date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY')
		 }
		 return dt;
	}
	
	$scope.LogCtrlOnLoad= function(){
		SetSideBar("Counterparty A&S", "Counterparty A&S");
		
		$scope.ListingQueue("CheckLog");
		
		
	}
	
	$scope.listCtrlOnLoad= function(){
	
		SetSideBar("Counterparty A&S", "Counterparty A&S");			
	
		//$('#divOverlay').show();
		//$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
    	
    	setTimeout(function(){ 		
    		$('.AssessmentDate').datetimepicker({
				format: 'DD-MMM-YYYY',				
				useCurrent: false,
		    });
		    $(".AssessmentDate").on("dp.change", function() {
		        $scope.item.AssessmentDate = $(".AssessmentDate").val();		
				$scope.item.Status = GetStatus();								 					        						
				$scope.$apply();
		    });
		    
		    
		    $('.NewReviewDate').datetimepicker({
				format: 'DD-MMM-YYYY',
				useCurrent: false,
		    });
		    $(".NewReviewDate").on("dp.change", function() {
		        $scope.item.NewReviewDate = $(".NewReviewDate").val();										 					        						
				$scope.$apply();
		    });
		    		    		    	    
    	}, 500);
    				
	}
	
	function GetStatus(){
				
		var status = "New"
				
		if(!$scope.item.AssessmentDate){
			
			if(( $scope.item.ClientType == "TSA" || $scope.item.ClientType == "TSA/SD") && ( $scope.item.products.length == 1 && $scope.item.products[0] == "FX SPOT" )){
				status = "Not Applicable";
			}
			else{
				status = "Not Existing";
			}
		}
		else{
								
			var isOneYearBefore = moment().isBefore( moment($scope.item.AssessmentDate, "DD-MMM-YYYY" ).add(1, 'years') );
			if(isOneYearBefore){
				status = "Active";
			}
			else{
				status = "Expired";	
			}
		}
		
		return status;
	}

	$scope.listCtrlOnLoadInit = function()
	{
		
		$scope.read = true;
		var TRYPermisionsFilter = "Title eq 'Counterparty AandS BMS Users' and " + "Names/Id eq " + "'" + _spPageContextInfo.userId + "'";
		$scope.isBMSUser = IsCurrentInUsersList("UserPermissionsList" , "Title,Names/Id&$expand=Names/Id", TRYPermisionsFilter);
		if($scope.isBMSUser){
			$scope.read = false;
		}
		
		if($scope.isBMSUser){
			$scope.ListingQueue("New");		
		}
		else{
			$scope.ListingQueue("All");	
		}
				    
		$scope.$apply();	
							
					
	}
		
	
	$scope.GetButtonClass = function(title){
		if( title == $scope.QuqueTitle ){
			return "EI-ButtonPurple-Selected";
		}
		else{
			return '';
		}
	}
	
	$scope.ClearFilter = function(){
	
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
		updateTable();
	}
				
		
	$scope.ListingQueue = function(queue){
		
		
		selTab = queue;
		
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		$scope.WFErrCount = 0;
		
		DestroyTable();


		var filter = "&$select=ID,CIF,Title,ClientType,CanDirectDeal,CanBranchDeal"; 			
		var custList = GetListByFilter("Customer", filter );
		
		filter = "&$select=ID,Title,ClientRating,AssessmentDate,Status,AuditLog,ReviewDate,Modified,ClientName,ClientType,Product,ExpiryDate,ExpairyEmail,WarningEmail";
		/*
		if(queue == "New"){
			filter += "&$filter=Status eq 'New' " ;
		}
		else if(queue == "Monthy Review"){
			filter += "&$filter=Status eq 'Not Existing' and  ReviewDate le '" + moment().startOf('month').subtract(1, "days").format( "DD-MMM-YYYY HH:mm") + "'";
		}
		else if(queue == "All"){
			//filter += "";
		}		
		else{
			queue = "Active";
			filter += "&$filter=Status eq 'Active' " ;
		}	
		*/
		if(!queue ){
			queue = "New";
		}
		
		if(queue == "Monthy Review"){
			//filter += "&$filter=Status eq 'Not Existing' and  ReviewDate le '" + moment().startOf('month').subtract(1, "days").format( "DD-MMM-YYYY HH:mm") + "'";
			filter += "&$filter=(Status eq 'Not Existing' or (Status eq 'Expired' and  TSAExpired  eq 1 ) ) and  ReviewDate le '" + moment().startOf('month').subtract(1, "days").format( "DD-MMM-YYYY HH:mm") + "'";
		}

		if(queue == "CheckLog"){
			//filter = "&$select=ID,Title,ClientRating,AssessmentDate,Status,AuditLog,ReviewDate,Modified,ClientName,ClientType,Product,ExpiryDate,ExpairyEmail,WarningEmail";

			/*
			filter += "&$filter=ExpiryDate ge '" + moment().format( "DD-MMM-YYYY HH:mm") + "' and "
					+ "ExpiryDate lt '" + moment().startOf('month').subtract(2, "months").format( "DD-MMM-YYYY HH:mm") + "'";
			*/		
			//filter += "&$filter=ExpiryDate lt '" + moment().startOf('month').add(2, "months").format( "DD-MMM-YYYY HH:mm") + "'";						
		}

		var cpyList = GetListByFilter("CounterpartyAandS", filter);
		var len = cpyList.length;
		var dataList = []; 
		
		//Add missing customer
		$.each(cpyList, function(id, cprty){
			var custLen = custList.length;
			var addCust = true;
			for(c=0;c<custLen;c++){
				if(cprty.Title == custList[c].CIF ){
					addCust = false;
					break;
				}
			}
			if(addCust){
				var cust = {};
				cust.CIF = cprty.Title;	
				//console.log(cprty.Title);		
				
				
				cust.Title = cprty.ClientName;
				if(!cust.Title){
					cust.Title = "***";
				}
				cust.ClientType = cprty.ClientType;
				cust.CprtyProduct = cprty.Product;
				cust.custID = "";
				custList.push(cust);
			}
		});

		//End of Add missing customer
		
		
		$.each(custList, function(id, cust){
			/*
			if(!(cust.ClientType == "TSA" && cust.CanDirectDeal == false && cust.CanBranchDeal == false)){
				if(!(cust.ClientType == "TSA" && cust.CanDirectDeal == false )){
				}
				else{
					console.log(cust.CIF + " - " + cust.Title);
				}
				
			}
			*/
			
			if(!(cust.ClientType == "TSA" && cust.CanDirectDeal == false && cust.CanBranchDeal == false)){			
				data = {};
				data.ExpairyEmailErr = "no"
				data.Title = cust.CIF;
				data.ClientName = cust.Title;
				data.ClientType = cust.ClientType;
				data.custID = cust.ID;
				data.Modified = 0;
				data.ModifiedDt = '';
	
				/*
				if( cust.CIF == "73040282"){
					debugger;
				}
				*/
			
				var newCust = true;			
				for(c=0;c<len;c++){
					if(cpyList[c].Title == cust.CIF ){
						
						if(queue == "New" && cpyList[c].Status != "New"){						
							newCust = false;
							break;
						}
						data.ClientRating = cpyList[c].ClientRating;
						if(cpyList[c].AssessmentDate){
							data.AssessmentDate = new moment(cpyList[c].AssessmentDate).format('DD-MMM-YYYY')
						}
						else{
							data.AssessmentDate = "";
						}
						
						data.Status = cpyList[c].Status;
						data.ID = cpyList[c].ID;
						data.AuditLog = cpyList[c].AuditLog;
						if(cpyList[c].ReviewDate){
							data.ReviewDate = new moment( cpyList[c].ReviewDate).format('DD-MMM-YYYY');
						}
						else{
							cpyList[c].ReviewDate = "";
						}
						
						//ExpiryDate
						if(cpyList[c].ExpiryDate){
							data.ExpiryDate = new moment( cpyList[c].ExpiryDate).format('DD-MMM-YYYY');
							
							if( queue == "CheckLog" && data.ExpiryDate ){
																							
								var expDt = new moment(cpyList[c].ExpiryDate);
								var v =  moment().diff(expDt, 'days');
								if( moment().diff(expDt, 'days') > 0 ){
								
									if(data.Status != 'Expired' ){
										data.ExpairyEmailErr = "yes";
										var expEmailDt =  new moment(cpyList[c].ExpairyEmail);
										var v1 =  moment().diff(expEmailDt, 'days');
										$scope.WFErrCount++;	
									}
									else{
										data.ExpairyEmailErr = "";
									}
								}
																								
								/*
								if( moment().diff(expDt, 'days')  >  ){
								}
								
								var expEmailDt =  new moment(data.ExpairyEmail);
								
								if(!data.ExpairyEmail && expDt <= expEmailDt ){
									data.ExpairyEmailErr = "yes";
								}
								*/
							}
						}
						else{
							cpyList[c].ExpiryDate = "";
						}

						
	
						newCust = false;
						data.Modified = new moment(cpyList[c].Modified ).unix();
						data.ModifiedDt = cpyList[c].Modified;
						
						data.ExpairyEmail = cpyList[c].ExpairyEmail;
						data.WarningEmail= cpyList[c].WarningEmail;
						
						
						if(queue == "CheckLog" ){
							if( data.ExpairyEmailErr == "yes"){							
								dataList.push(data);
							}
						}
						else{
							dataList.push(data);
						}						
	
						//dataList.push(data);
						break;
					}
				}
				
				if(newCust && ( queue == "All" ||  queue == "New" ) ){
					data.ClientRating = "C0";
					data.AssessmentDate = "";
					data.Status = "New";
					data.ID = "";
					
					dataList.push(data);
				}
			
			}//if(!(cust.ClientType == "TSA" && cust.CanDirectDeal == false)){		
		}); //each
		
		if(queue == "New" ){
			$scope.NewItemCount = dataList.length;
		}
		
		$scope.dataList = dataList;
		
						
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
			
			updateTable();
			$scope.QuqueTitle = queue;
		
		}, 0);

		
	}
	
	$scope.ExportToExcel = function(){
	
		var filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID";		
		//$scope.dataList = GetListData("DealReleaseRequest", filter );
		
		var res = [];        
        var row = [
        	'CIF', 
			'Client Name', 
			'Client Type', 
			'Client Rating', 
			'AssessmentDate', 
			'Status', 	
			'ExpiryDate',
        ];
        res.push(row);   
        
        
        $.each($scope.dataList, function(id, val){
        	var row = [];
        	row.push(val.Title);
			row.push(val.ClientName);
			row.push(val.ClientType);
			row.push(val.ClientRating);
			row.push(val.AssessmentDate);
			row.push(val.Status);
			row.push(val.ExpiryDate);
			
        	res.push(row);
		}); 
		
		ExcelReportDownload(res, 'CounterpartyAandS-' + moment().format('DD-MM-YYYY-HH-mm-ss') +'.xlsx')

	}

			
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	/*
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	*/
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				
				"pageLength": 20,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 0, "desc" ]],
				"autoWidth": false,
	
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						if( ColCount == 3 || ColCount == 4 ||  ColCount == 6  ){

							var column = this;
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.main-ListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
							column.data().unique().sort().each( function ( d, j ) {								
								select.append( '<option value="'+d+'">'+d+'</option>' )	
							} );
							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
								
								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();
								
								    });							
						}
						
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);				
			});
						
			if( $scope.QuqueTitle == "All Requests"  ){ //&& ( $scope.Config.isBMSUser || $scope.Config.isHoBMSUser)
				UpdateMeetingDateSearch();
			}
									
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}
	
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\Buttons.html```FileName```<div id="ButtonDiv" style="margin:10px;  ">
	<div class="text-danger" style="font-weight:bold;width:100%;padding:8px 20px;">{{ErrorMessage}}</div>
	

	<!--div style="float:left;padding:5px"  >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnSave()" >			
			Save
		</button>									
	</div-->
	
	<div style="float:left;padding:5px 20px" ng-repeat="sf in StatusFlow" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple"   ng-click="TakeWFAction(sf)" >			
			{{sf.Title}}
		</button>									
	</div>

	
	
	<div style="float:left;padding:5px">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onBackClick()" >						 
			Back to Queue
		</button>				 		
	</div>

	
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\CheckLog.html```FileName```<div  data-ng-init="LogCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-6 main-header-title">Counterparty A&S Expiry Check Log</div>
		<div class=" col-md-2" style="font-weight:bold;font-size:14px">
			<a href="https://workplace.emiratesislamic.ae/EITRY/FX/_layouts/15/NintexWorkflow/StartWorkflow.aspx?List={e2426709-2fb7-4c75-80b0-c04bd701e7b8}&ID=179&ItemGuid={ED70D6CA-1D13-4113-8A07-6DD34769E809}&TemplateID={3e8d3cf9-7b18-4d15-8783-10c5b96d61b4}&Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandSCheckLog">
				<span>Start Warning WF</span>
			</a>
		</div>
		<div class=" col-md-2" style="font-weight:bold;font-size:14px">
			<a  href="https://workplace.emiratesislamic.ae/EITRY/FX/_layouts/15/NintexWorkflow/StartWorkflow.aspx?List={e2426709-2fb7-4c75-80b0-c04bd701e7b8}&ID=179&ItemGuid={ED70D6CA-1D13-4113-8A07-6DD34769E809}&TemplateID={1333e9e9-27ea-436e-89e7-b5447f2e57ae}&Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandSCheckLog">
				<span>Start Expiry WF</span>
			</a>			
		</div>	
		<div class=" col-md-2" style="padding-right:100px">						
			<div class=" appCountButton topright"  style="font-weight:bold;font-size:14px" >
				<a href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandS">
					<span>Back to Main Page</span>
				</a>
			</div>
				
		</div>		
	</div>

	<div class="row main-data">			
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class='hide' style='width:100px' data-order="{{DateSer(it.ComplectionDate)}}" >ID</th>						
						<th style='width:100px'>CIF</th>
						<th style='width:400px'>Client Name</th>
						<th style='width:100px'>Client Type</th>
						<th style='width:100px'>Client Categorization</th>
						<th style='width:60px'>Assessment Date</th>
						<th style='width:80px'>ExpiryDate</th>
						<th style='width:80px'>Status</th>	
						<th style='width:60px'>Warn.Email Dt</th>
						<th style='width:60px'>Exp.Email Dt</th>	
						<th class='hide'></th>
																																										
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class='hide' style='width:100px'>ID</th>		            	
						<th style='width:100px'>CIF</th>
						<th style='width:400px'>Client Name</th>
						<th style='width:100px'>Client Type</th>
						<th style='width:100px'>Client Categorization</th>
						<th style='width:60px'>Assessment Date</th>
						<th style='width:80px'>ExpiryDate</th>
						<th style='width:80px'>Status</th>		
						<th style='width:60px'>Warn.Email Dt</th>
						<th style='width:60px'>Exp.Email Dt</th>
						<th class='hide'></th>												
		            </tr>
		        </tfoot>		        		        
				<tbody>									
					<tr ng-repeat="it in dataList | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" 
						ng-class-even="'alloTableEven'"
						ng-click="OnItemClick(it, $index)" >	
						<td class='hide'>{{it.ID}}</td>						
						<td style="text-align:center">
							<i class="fa fa-asterisk mandatory " ng-if="IsNew(it.ModifiedDt)" aria-hidden="true" style="color:green"></i>
						{{it.Title}}</td>
						<td style="text-align:left;"  ng-style="{ 'background-color': MeetingStatus(it) }"  >{{it.ClientName}}</td>
						<td style="text-align:center">{{it.ClientType}}</td>
						<td style="text-align:center">{{it.ClientRating}}</td>
						<td style="text-align:center">{{it.AssessmentDate}}</td>
						<td style="text-align:center">{{it.ExpiryDate}}-{{it.ExpairyEmailErr}}</td>
						<td style="text-align:center">{{it.Status}}</td>
						<td style="text-align:center">{{it.WarningEmail}}</td>
						<td style="text-align:center">{{it.ExpairyEmail}}</td>	
						<th class='hide'>{{it.ExpairyEmailErr}}</th>					
					</tr>				 	  
				</tbody>									
			</table>

		</div>
	</div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\Comments.html```FileName```<div class="row" style="margin:5px 18px" ng-show="CommentList.length > 0" >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog"  >
			<div class="col-md-12 divSubHeadingLog" >Audit Log</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:100px;">Rev. Date</th>
							<th style="text-align:center;width:250px;">Action By</th>
							<th style="text-align:center;width:50px;">Rating</th>
							<th style="text-align:center;width:100px;">Ass. Date</th>
							<th style="text-align:center;width:80px;">Status</th>							
							<th class="text-center" style="">Comment</th>			
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="it in CommentList" >	
							<td style="text-align:center;">{{FormatCommentDate(it.Date)}}</td>
							<td style="text-align:left;">{{it.ActionBy}}</td>
							<td style="text-align:center;">{{it.ClientRating}}</td>			
							<td style="text-align:center;">{{it.AssessmentDate}}</td>
							<td style="text-align:center;">{{it.Status}}</td>							
							<td style="text-align:left;">{{it.Comment}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>



```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\ExpairyLog.html```FileName```<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-4 main-header-title">Counterparty A&S Expiry Email Log</div>	
		<div class=" col-md-8" style="padding-right:100px">						
			<div class=" appCountButton topright"  style="font-weight:bold;font-size:14px" >
				<a href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/CounterpartyAandS">
					<span>Back to Main Page</span>
				</a>
			</div>
				
		</div>		
	</div>

	<div class="row main-data">			
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class='hide' style='width:100px'>ID</th>
						<th style='width:100px'>CIF</th>
						<th style='width:400px'>Client Name</th>
						<th style='width:100px'>Notification Type</th>
						<th style='width:100px'>Expiry Date</th>	
						<th style='width:100px'>Notification Date</th>																																						
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class='hide' style='width:100px'>ID</th>
						<th style='width:100px'>CIF</th>
						<th style='width:400px'>Client Name</th>
						<th style='width:100px'>Notification Type</th>
						<th style='width:100px'>Expiry Date</th>	
						<th style='width:100px'>Notification Date</th>																	
		            </tr>
		        </tfoot>		        		        
				<tbody>									
					<tr ng-repeat="it in dataList"  ng-class-odd="'alloTableOdd'" 
						ng-class-even="'alloTableEven'"
						ng-click="OnItemClick(it, $index)" >	
						<td class='hide'>{{it.ID}}</td>
						<td style="text-align:center">{{it.Title}}</td>
						<td style="text-align:left">{{it.ClientName}}</td>
						<td style="text-align:center">{{it.ExpType}}</td>
						<td style="text-align:center">{{FormatCommentDate(it.ExpiryDate)}}</td>	
						<td style="text-align:center">{{FormatCommentDate(it.Created)}}</td>						
					</tr>				 	  
				</tbody>									
			</table>
		</div>
	</div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\ExpairyLogCtrl.js```FileName```DocApp.controller('ExpairyLogCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.FormatCommentDate= function(date)    
	{			
		 var dt =  new moment(date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY')
		 return dt;
	}


	$scope.listCtrlOnLoad= function(){
		SetSideBar("Counterparty A&S", "Counterparty A&S");
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
	}
	
	$scope.listCtrlOnLoadInit = function()
	{		
		var filter = "&$orderby=ID desc";// "&$select=ID,CIF,Title,ClientType";			
		$scope.dataList = GetListByFilter("CounterpartyAandSExpiryAuditLog", filter );
		
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
			
			updateTable();
			//$scope.QuqueTitle = queue;
		
		}, 0);
													
	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				
				"pageLength": 20,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 0, "desc" ]],
				"autoWidth": false,
	
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						if( ColCount == 3  ){

							var column = this;
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.main-ListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
							column.data().unique().sort().each( function ( d, j ) {
								
								select.append( '<option value="'+d+'">'+d+'</option>' )
	
							} );
							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
								
								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();
								
								    });							
						}
						
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);				
			});
						
			if( $scope.QuqueTitle == "All Requests"  ){ //&& ( $scope.Config.isBMSUser || $scope.Config.isHoBMSUser)
				UpdateMeetingDateSearch();
			}
									
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}


});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\CprtyAS\ReqModel.html```FileName```
<!-- Manage Request Modal Modal -->
<div id="DetailsModal" class="modal fade" role="dialog" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
           <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title"><span id="modalManageReportHeading"></span>Update Counterparty A&S</h4>
        <span class="hide" id="spRequestItemId"></span>
        <span class="hide" id="spRequestTenorText"></span>
      </div>
      <!-- End Modal content-->

      <div class="modal-body">
          <div class="panel panel-default" style="margin-bottom: 5px;">
                <div class="panel-body">
                 <div class="alert alert-danger saveQueryAlert hide">
                 </div>
                 
                 	<table class="table table-bordered">
                 		<tbody>
                 			<tr>						      
						      <td>CIF</td>
						      <td>{{item.Title}}</td>
						    </tr>
						    <tr>						      
						      <td>Client Name</td>
						      <td>{{item.ClientName}}</td>
						    </tr>
						    <tr>						      
						      <td>ClientType</td>
						      <td>{{item.ClientType}}</td>
						    </tr>
						    <tr>						      
						      <td>Products</td>
						      <td>
						      	<span ng-repeat="prd in item.products" >{{prd}}{{$last ? '' : ', '}}</span>						      
						      </td>
						    </tr>

						    <tr>						      
						      <td>Client Categorization</td>
						      <td>
						      	<select  ng-model="item.ClientRating"  	class="form-control"  ng-disabled="read">
									<option value="C0">C0</option>
									<option value="C1">C1</option>
									<option value="C2">C2</option>
									<option value="C3">C3</option>
								</select>
						      </td>
						    </tr>
						    <tr>						      
						      <td>Assessment Date</td>
						      <td>
						      	<input type="text" class="form-control AssessmentDate" 
                            		data-provider="datepicker" placeholder="Assessment Date"  
                            		ng-model="item.AssessmentDate"   ng-disabled="read"
                            		 />
						      </td>
						    </tr>
						    
						    <tr>						      
						      <td>Expiry Date</td>
						      <td>
						      	{{GetExpiryDate()}}						      
						      </td>
						    </tr>


						    <tr>						      
						      <td>Status</td>
						      <td>
						      	<select  ng-model="item.Status"	class="form-control"  ng-disabled="read">
									<option value="New">New</option>
									<option value="Active">Active</option>
									<option value="Expired">Expired</option>
									<option value="Not Existing">Not Existing</option>
									<option value="Not Applicable">Not Applicable</option>
								</select>
						      </td>
						    </tr>
						    
						    <!--tr>						      
						      <td>Last Review Date</td>
						      <td>{{item.ReviewDate}}</td>
						    </tr>


						    <tr>						      
						      <td>New Review Date</td>
						      <td>
						      	<input type="text" class="form-control NewReviewDate" 
                            		data-provider="datepicker" placeholder="New Review Date"  
                            		ng-model="item.NewReviewDate"   ng-disabled="read" />
						      </td>
						    </tr-->
						    
						    <tr>						      
						      <td>Comment</td>
						      <td>
						      	
						      	<input type="text" class="form-control" ng-model="item.CurrentComment"   />
						      </td>
						    </tr>

						    
						    <tr>						      						      
						      <td colspan="2">
						      	<button type="button" class="btn EI-ButtonPurple" ng-click="SaveItem()" ng-if="!read" >Save</button>						      	
						      </td>						      
						    </tr>

                 		</tbody>
                 	</table>
                 	
                 	<div ng-include="'/EITRY/FX/SiteAssets/TryUtil/Proj/CprtyAS/Comments.html'" ></div>
                 	                                                                   
                 </div>
          </div>
      </div>
    </div>
  </div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DailyDigest\DailyDigestDetails.html```FileName```<div class="panel panel-default" style="width: 100%;border-color:#fff" data-ng-init="listCtrlOnLoad()">
		
	<h3>Welcome {{CurrentUserName.Title}}</h3>
			
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DailyDigest\DailyDigestDetailsCtrl.js```FileName``````File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DailyDigest\DailyDigestList.html```FileName```<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class="main-header">
		<div class="main-header-title"  ng-clcik="ItemClick(10)" >Daily Digest</div>					  		
	</div>
	
	<div class="row main-data">
		<div id="divOverlay" style="display:none;">
			<i class="fa fa-refresh fa-spin fa-5x"></i>
		</div>		
		<div class="row">
			<div class="col-md-12" style="margin:15px " >
				<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/DailyDigest/MyTasks.html'" ></div>
			</div>
		</div>
		
		
	</div>
	
	<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/DailyDigest/ReqModel.html'" ></div> 

</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DailyDigest\DailyDigestListCtrl.js```FileName```DocApp.controller('DailyDigestListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
		
	$scope.listCtrlOnLoad= function(){
	
		SetSideBar("DailyDigest", "Daily Digest");			
		
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);			
	}
	

	$scope.listCtrlOnLoadInit = function()
	{
		$scope.userDetails = CurrentUserDetails();
		
		var filter = "";		
		
		DestroyTable();
		
		$scope.dataList = GetNintexTasks();
		
		var filter = ""; //"&$filter= StatusId ne 8&$orderby=ID";
		//$scope.dataList = GetListData("ProjectTracker", filter );
		$scope.$apply();
		
		updateTable();
					
	}
	
	function OnItemClick(id){
	
		var item = $scope.dataList[id-1];
		
		
		if( item.WorkflowName == "WakalaDlaApproval" ){
			var listName = "WakalaUAT";
			
			//Get list item details
			var itemDet = GetListItemByID(listName, item.ListItemId);
			item.Message = itemDet.EmailBody;

			//Get nintex actions nintexFlow
			$scope.nintexFlow = [];
		    $scope.nintexFlow = GetRunningWorkflowTasksForCurrentUserForListItem( item.ListItemId, listName);
		}
		
		$scope.SelItem = item;
		$scope.$apply();
		$('#ReqDetailsModal').modal('toggle');
		
	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				"searching": false,
				"searching": false,
				"pageLength": 5,
				"order": [[ 1, "asc" ]],
				"autoWidth": false,
				dom: 'Bfrtip',
				buttons: true ? [				        	
			       /* {
						text: '<button type="button" class="btn EI-ButtonPurple  AddNewItem" ><i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Project</button>',
						action: function ( e, dt, node, config ) {
							window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/NewProjectTracker/";
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonOrange " >In Progress</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("In Progress", "In Progress");
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >Not started</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("Not started", "Not started");
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >Completed</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("Completed", "Completed");
						}					
					},

					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >All Items</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("", "");
						}					
					}*/
				] : [],				    
				//responsive: true,
			    //"pageLength": 15,
			    
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						var column = this;
						var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
							.appendTo( $(column.footer()).empty() )
							.on( 'change', function () {
								$('.main-ListTable').DataTable()
								.search('').columns().search('').draw();
								var val = $.fn.dataTable.util.escapeRegex(
									$(this).val()
								);
								column
									.search( val ? '^'+val+'$' : '', true, false )
									.draw();
							} );
						column.data().unique().sort().each( function ( d, j ) {
							
							select.append( '<option value="'+d+'">'+d+'</option>' )

						} );
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr", function(){	
					
										
				auctionReqstItemElem = $(this);				
				var id =  $($(auctionReqstItemElem ).children()[0]).text();
				OnItemClick(id);
				//$scope.item = $scope.dataList[id]; 
				
				//$('#ReqDetailsModal').modal('toggle');
				return;
							
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				var id =  $($(auctionReqstItemElem ).children()[0]).text();
				//debugger;
				$scope.item = $scope.dataList[id]; 
				window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/ProjectTrackerDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
									
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function GetNintexTasks()
	{
	   var res = [];
	        
	    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
	    console.log(webserUrl);
	    
	    var soapRequest  =     
	    	'<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:nin="http://nintex.com">' + 
		   		'<soap:Header/>' +
		   		'<soap:Body>' +
			      	'<nin:GetRunningWorkflowTasksForCurrentUser>' +
			        '<nin:fileUrl></nin:fileUrl>' +
			      	'</nin:GetRunningWorkflowTasksForCurrentUser>' +
		   		'</soap:Body>' +
			'</soap:Envelope>';
			
		 var soapRequest1  =		
			'<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:nin="http://nintex.com">' +
				'<soap:Header/>' + 
				'<soap:Body>' +
					'<nin:GetRunningWorkflowTasksCollection>' +
					'<nin:userlogin>' + $scope.userDetails.LoginName + '</nin:userlogin>' +
					//'<nin:userlogin>i:0#.w|ebil\\' + $scope.userDetails.LoginName + '</nin:userlogin>' +
					'</nin:GetRunningWorkflowTasksCollection>' +
				'</soap:Body>' +
			'</soap:Envelope>';
	                
	    $.ajax({ 
	        type: "POST", 
	        url: webserUrl, 
	        contentType: "text/xml", 
	        dataType: "xml", 
	        async: false,
	        beforeSend: function (request) 
	        { 
	         request.setRequestHeader("SOAPAction", "http://nintex.com/GetRunningWorkflowTasksCollection"); 
	        }, 
	        data: soapRequest1, 
	        success: function(data, status, req) {
	            if (status == "success") 
	            {
	            	var count = 0;
	            	$(req.responseText).find("UserTask").each(function(){  
	            		var item = {};
	            		//var v =  $(this);
	            		taskName = $(this)[0].getElementsByTagName('taskname')[0].textContent;
	            		WorkflowName = $(this)[0].getElementsByTagName('WorkflowName')[0].textContent;

	            		sharepointtaskid= $(this)[0].getElementsByTagName('sharepointtaskid')[0].textContent;
	            		 if(sharepointtaskid)
		                {
		                    //res1 =  GetOutcomesForFlexiTask(SharePointTaskId, ListName, taskName );
		                    //res = res.concat(res1);
		                    //console.log(taskName  + "- " + SharePointTaskId);
		                }   
		                
		                var taskdet = taskName.split("`");
		                if(taskdet.length >= 2 ){
			                count++;
			                item.ID = count; 
			                
			                item.Title = taskdet[1]; 
			                item.ListItemId = taskdet[0];
			                item.WorkflowName = WorkflowName;
			                item.sharepointtaskid = sharepointtaskid;  
			                 
			                res.push(item);  
			             } 		
					});              
	            }
	            else
	            {
	                alert("Error : " + req.responseText);
	                console.log("Error : " + req.responseText);
	            }
	        }, 
	        error: ErrorOccur 
	    });
	    
	    return res;
	    
	}




});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DailyDigest\MyTasks.html```FileName```	
<div id="divDataTable" style="width:100%">
	<table ng-clcik="ItemClick(10)" class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
		<thead>
			<tr>					
				<th class="hide" >ID</th>
				<th>WorkflowName</th>		            	
				<th>Task</th>
										
			</tr>
		</thead>
		
		<tfoot class="ttcpFooter">
            <tr class="ttcpFtrTrCompleted">	
            	<th class="hide">ID</th>
            	<th>WorkflowName</th>		            	
				<th>Task</th>
            </tr>
        </tfoot>
        
        
		<tbody>									
			<tr ng-repeat="item in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
				<td class="hide">{{item.ID}}</td>	
				<td>{{item.WorkflowName}}</td>				
				<td>{{item.Title}}</td>
			</tr>				 	  
		</tbody>									
	</table>			
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DailyDigest\ReqModel.html```FileName```<!-- Manage Request Modal Modal -->
<div id="ReqDetailsModal" class="modal fade" role="dialog" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
           <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title"><span id="modalManageReportHeading"></span>Task Details</h4>
        <span class="hide" id="spRequestItemId"></span>
        <span class="hide" id="spRequestTenorText"></span>
      </div>
      <!-- End Modal content-->

      <div class="modal-body">
          <div class="panel panel-default" style="margin-bottom: 5px;">
                <div class="panel-body">
                 <div class="alert alert-danger saveQueryAlert hide">
                 </div>
                      <ul class="nav nav-tabs" style="font-size:14px">
                        <li class="active"><a  target="_self" data-toggle="tab" href="#fdRequestDetails">Request Details</a></li>                                              
                      </ul>
                      <div class="tab-content mngQueryTabs" style="background-color: transparent;border: none;">
                        
                        <div id="fdRequestDetails" class="tab-pane fade in active">
                        	<div class="detailsPannel" >
                        		<div class="row">
									<div style="padding-left:50px" >		
										<div  style="float:left;padding:5px" ng-repeat="sf in nintexFlow" >
											<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="TakeNintexWFAction(sf)" >			
												{{sf.Title}}	
											</button>							
										</div>
														
									</div>
								</div>
								<div class="row" style="padding-left:50px">								
									<div  ng-bind-html="SelItem.Message| html"></div>
								</div>
                   		                         		 
                        	</div>
                        	
                        	
                        </div>                                              
                      </div>
                 </div>
          </div>
      </div>
    </div>
  </div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DealReleaseRequest\Buttons.html```FileName```<div id="ButtonDiv" style="margin:10px;  ">
	<div class="text-danger" style="font-weight:bold;width:100%;padding:8px 20px;">{{ErrorMessage}}</div>
	

	<!--div style="float:left;padding:5px"  >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnSave()" >			
			Save
		</button>									
	</div-->
	
	<div style="float:left;padding:5px 20px" ng-repeat="sf in StatusFlow" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple"   ng-click="TakeWFAction(sf)" >			
			{{sf.Title}}
		</button>									
	</div>

	
	
	<div style="float:left;padding:5px">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onBackClick()" >						 
			Back to Queue
		</button>				 		
	</div>

	
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DealReleaseRequest\Comments.html```FileName```<div class="row" style="margin:0px" ng-show="item.CommentList.length > 0" >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" >
			<div class="col-md-12 divSubHeadingLog" >Audit Log</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:100px;">From Status</th>
							<th style="text-align:center;width:100px;">Action</th>
							<th style="text-align:center;width:100px;">To Status</th>
							<th style="text-align:center;width:300px;">Update By</th>
							<th style="text-align:center;width:150px;">Date Time</th>
							<th class="text-center" style="">Comment</th>			
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="it in item.CommentList" >	
							<td style="text-align:left;">{{GetStatusText(it.FromStatus)}}</td>
							<td style="text-align:left;">{{it.Action}}</td>
							<td style="text-align:left;">{{GetStatusText(it.ToStatus)}}</td>			
							<td style="text-align:left;">{{it.ActionBy}}</td>
							<td style="text-align:left;">{{FormatCommentDate(it.Date)}}</td>
							<td style="text-align:left;">{{it.Comment}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>



```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DealReleaseRequest\DealDetails.html```FileName```<form name="myForm"></form>

<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="listCtrlOnLoad()" >
  <div class="panel panel-default" style="width: 100%">
   
    
    <div class="panel-heading item-panel-heading" >  
    	
    	<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;">						
			<span ng-click="UpdateApprovedEmailDeatilsAng('5')">Status : {{ GetStatusText(item.StatusCode) }}</span>
		</p>
		
		<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;">						
			<span>SP Ref. : {{ item.SPRef }}</span>
		</p>

			
    	<div class="pannel-header">
			<div class="main-header-title">Deal Release Details</div>						
		</div>		   		
    </div>

    <div class="meeting-panel-body">        	
        <form name="af" novalidate>	    	    
	    	<div class="tab-content pageTabContentStyles" >    	    		    			    		    			    		
	    		<div id="tabDetails" class="tab-pane fade in active"  >	
	    			
	    			<div class="row content divPnlSrchRsltCharts" >
	    				<div class="col-md-12 divSubHeading" >Request Details</div>

					 	<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="RequestType" class="form-control" ng-model="item.RequestType" ng-disabled="read" required  errmsg="Request Type" >
							    	<option ng-repeat="m  in Config.RequestType">{{m}}</option>											 						
								</select>
							    <span>Request Type<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.RequestType.$touched) && af.RequestType.$invalid " class="text-danger">Request Type required</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="Desk" class="form-control" ng-model="item.Desk" ng-disabled="read" required 
							    	ng-change="onDeskChange()">
							    	<option ng-repeat="m  in Config.DeskList">{{m.Title}}</option>											 						
								</select>
							    <span>Desk<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.Desk.$touched) && af.Desk.$invalid " class="text-danger">Desk required</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="Product" class="form-control" ng-model="item.Product" ng-disabled="read" required >
							    	<option ng-repeat="m  in Config.Product">{{m}}</option>											 						
								</select>
							    <span>Product<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.Product.$touched) && af.Product.$invalid " class="text-danger">Product required</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol" >
						 	<label class="form-group has-float-label">
						 		<div ng-show="!read" id="DealerDiv"></div>
						 		<div ng-show="read" ng-repeat="rm in item.Dealer.results" style="float:left;border:1px silver solid;padding-left:7px;padding-right:7px;background:white;height:35px;padding-top:10px">{{rm.Title}}</div>
						 		<span>Dealer<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
						 		<p ng-show="invalidDealer" class="text-danger">Dealer required</p>

						 	</label>	 	
						 </div>
						 
						 <div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label FormLabel">													
								 <input name="Title" class="form-control Title digits" type="Text" maxlength="100" errmsg="Deal ID"  
						    		data-provider="datepicker" ng-model="item.Title" ng-disabled="read"  required />		    			
									<span>Deal ID<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
								<p ng-show="(se || af.Title.$touched) && af.Title.$invalid " class="text-danger">Deal ID required</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label FormLabel">													
								 <input name="TransactionAmtCCY" class="form-control TransactionAmtCCY" type="text" maxlength="100" errmsg="CCY & Transaction Amount"
						    		data-provider="datepicker" ng-model="item.TransactionAmtCCY" ng-disabled="read"  required />		    			
									<span>CCY & Transaction Amount<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
								<p ng-show="(se || af.TransactionAmtCCY.$touched) && af.TransactionAmtCCY.$invalid " class="text-danger">CCY & Transaction Amount required</p>
							</label>										 
						</div>
						
						<!--div class="form-group input-group col-md-4 HedgeDivCol">
						  <label class="has-float-label">
						    <input name="TradeDate" class="form-control TradeDate" type="text"
						    	data-provider="datepicker" ng-model="item.TradeDate" ng-disabled="read"  Bigdate-Validator required />
						    <span>Trade Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
						    <p ng-show="(se || af.TradeDate.$touched) && af.TradeDate.$invalid " class="text-danger">
						    	<span ng-if="item.TradeDate">Value date should be greater than or equal to Trade date</span>
						    	<span ng-if="!item.TradeDate">Trade Date required</span>
						    </p>
						  </label>	 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
						  <label class="has-float-label">
						    <input name="ValueDate" class="form-control ValueDate" type="text"
						    	data-provider="datepicker" ng-model="item.ValueDate" ng-disabled="read" Bigdate-Validator  required   />
						    <span>Value Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
						    <p ng-show="(se || af.ValueDate.$touched) && af.ValueDate.$invalid " class="text-danger">						    	
						    	<span ng-if="item.ValueDate">Value date should be greater than or equal to Trade date</span>
						    	<span ng-if="!item.ValueDate">Value date required</span>

						    </p>
						  </label>	 
						</div>



						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="ValidationType" class="form-control" ng-model="item.ValidationType" ng-disabled="read" required >
							    	<option ng-repeat="m  in Config.ValidationType">{{m}}</option>											 						
								</select>
							    <span>Validation Type<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.ValidationType.$touched) && af.ValidationType.$invalid " class="text-danger">Validation Type required</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="Counterparty" class="form-control" ng-model="item.Counterparty" ng-disabled="read" required >
							    	<option ng-repeat="m  in Config.Counterparty">{{m}}</option>											 						
								</select>
							    <span>Counterparty<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.Counterparty.$touched) && af.Counterparty.$invalid " class="text-danger">Counterparty required</p>
							</label>										 
						</div-->
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="Reason" class="form-control" ng-model="item.Reason" ng-disabled="read" required >
							    	<option ng-repeat="m  in Config.Reason">{{m}}</option>											 						
								</select>
							    <span>Reason<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.Reason.$touched) && af.Reason.$invalid " class="text-danger">Reason required</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-12 HedgeDivCol">
							<label class="form-group has-float-label FormLabel">									
								<textarea  name="Description" id="Description" ng-model="item.Description" ng-disabled="read"  class="multiLineInput" required
									style="height:100px"    maxlength="1000"  errmsg="Detailed Description"
									 ></textarea>		
									<span>Detailed Description<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
								<p ng-show="(se || af.Description.$touched) && af.Description.$invalid " class="text-danger">Detailed Description required</p>
							</label>										 
						</div>
					</div>
					
					<div class="row content divPnlSrchRsltCharts"   ng-if="Config.isBMSUser && !(item.StatusCode == '1' || item.StatusCode == '2' || item.StatusCode == '3' || item.StatusCode == '4' || item.StatusCode == '6'|| item.StatusCode == '7' || item.StatusCode == '11')" >
						<div class="col-md-12 divSubHeading" >BMS</div>
					
												
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="OpRickLogged" class="form-control" ng-model="item.OpRickLogged" ng-disabled="bmsRead" required 
							    	 errmsg="Operational Risk event to be logged">
							    	<option value="Yes">Yes</option>
							    	<option value="No">No</option>											 						
								</select>
							    <span>Operational Risk event to be logged<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.OpRickLogged.$touched) && af.OpRickLogged.$invalid " class="text-danger">Operational Risk event to be logged required</p>
							</label>										 
						</div>

						
						<div class="form-group input-group col-md-4 HedgeDivCol" ng-if="item.OpRickLogged == 'Yes'">
							<label class="form-group has-float-label FormLabel">													
								 <input name="OpRickId" class="form-control OpRickId" type="text" maxlength="100"
						    		 ng-model="item.OpRickId" ng-disabled="bmsRead"  required />		    			
									<span>Ops Risk Event ID<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
								<p ng-show="(se || af.OpRickId.$touched) && af.OpRickId.$invalid " class="text-danger">Ops Risk Event ID required</p>
							</label>										 
						</div>


						
					</div>

					
					<div class="row content divPnlSrchRsltCharts"   ng-if="StatusFlow.length > 0 && item.ID" >
						<div class="col-md-12 divSubHeading" >Comment</div>
					
						<div class="form-group input-group col-md-12 HedgeDivCol">
							<label class="form-group has-float-label FormLabel">									
								<textarea  name="CurrentComment{{$index}}" id="CurrentComment" ng-model="item.CurrentComment" class="multiLineInput"   maxlength="100"
									 ></textarea>						
								<p ng-show="(se || af.CurrentComment.$touched) && af.CurrentComment.$invalid " class="text-danger">Comment required</p>
							</label>										 
						</div>
						
					</div>

  			
    				
   				    <div class="row" style="width: 100%;">
						<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/DealReleaseRequest/Buttons.html'" ></div>	
					</div>
					
   				    <div style="width:100%;" ng-include="'../SiteAssets/TryUtil/Proj/DealReleaseRequest/Comments.html'"></div> 
   				    										    				    				    					    		
	    		</div>	    			    										
					
				
																											
	    	</div>
    	</form>
    	
    	<!--div class="row" style="width: 100%;">
			<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/MeetingGroup.html'" ></div>	
		</div-->	
				
    </div>
    
  </div>  
</div>


	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DealReleaseRequest\DealRelDetailsCtrl.js```FileName```
DocApp.controller('DealRelDetailsCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	
	$scope.onDeskChange = function()    
	{			
		for(i=0;i<$scope.Config.DeskList.length;i++){
			if($scope.Config.DeskList[i].Title == $scope.item.Desk ){
				$scope.Config.Product = $scope.Config.DeskList[i].Products;
				if($scope.Config.Product.length == 1){
					$scope.item.Product = $scope.Config.Product[0];
				}
				break;
			}
		}	 
	}

	
	$scope.onBackClick = function()    
	{			
		 $location.path("DealRelease");
	}
	
	$scope.GetStatusText = function(StatusId){			
		return GetStatusText($scope.Config.Status, StatusId);		
	}
	
	$scope.FormatCommentDate= function(date)    
	{			
		 var dt =  new moment(date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY hh:mm A')
		 return dt;
	}
	
	$scope.UpdateApprovedEmailDeatilsAng = function(ToStatusId){
		UpdateApprovedEmailDeatils();
	}
		
	//$scope.UpdateApprovedEmailDeatils1 = function(ToStatusId){
	function UpdateApprovedEmailDeatils(ToStatusId){		 		
		if(ToStatusId == "5"){
			//Get Email template
			var DealReleaseEmailTemplate = GetListItemByTitle("FXConfig", "DealReleaseEmailTemplate");
			var Body = DealReleaseEmailTemplate.Value;
			
			var DealerNameList = "";
			if($scope.item.Dealer.results)
			{
				$.each($scope.item.Dealer.results,
				function(key, Obj)
				{											
					DealerNameList += Obj.Title;
				});
			}
			Body = strReplaceAll(Body, "##DealerList##" , DealerNameList );
			
			for (property in $scope.item) 
			{	
				var RepVal = "";	
				if($scope.item[property ])
				{
					RepVal = $scope.item[property ];
				}				
				Body = strReplaceAll(Body, "##" + property   + "##" , RepVal );		
			}
			
			Body = htmlEscape(Body);
			
			//Email
			var valuepairs = [[ "EmailAlert", true], [ "Email", Body ] ];
			//var valuepairs = [[ "Email", Body ] ];
			UpdateField("DealReleaseRequest", $scope.item.ID, valuepairs, true );
		}
		else{
			$scope.item.EmailAlert = false;
		}
	}
	
	$scope.TakeWFAction_ = function(StatusFlowObj ){
	
		$('#divOverlay').show();
		$('#ListDetails').hide();

		setTimeout(function(){ 		
    		$scope.TakeWFActionProc(StatusFlowObj);
    	}, 50);

	}

	$scope.TakeWFAction = function(StatusFlowObj ){
	
		/*
		for (control of $scope.["af"].$$controls) {
	        control.$setDirty();
	        control.$validate();3
	    }
    */
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		if( !$scope.item.CurrentComment  && ( StatusFlowObj.ToStatusId == "6" || StatusFlowObj.ToStatusId == "9" || StatusFlowObj.ToStatusId == "4"  || StatusFlowObj.ToStatusId == "3" || StatusFlowObj.ToStatusId == "7")){
		
			$scope.ErrorMessage = "Comment Required";
			$('#divOverlay').hide();
			$('#ListDetails').show();
        	return false;
		}
				
		if( StatusFlowObj.ToStatusId == "1" || ValidateItem()){
			
			//Audit log with comment
			if(StatusFlowObj.ToStatusId != "1"){			
				addDealComment($scope.item.CommentList, $scope.item.StatusCode, StatusFlowObj.Title, StatusFlowObj.ToStatusId, GetSiteConfig("CurrentUser").Title, $scope.item.CurrentComment);				
			}
			
			$scope.item.Comments = angular.toJson($scope.item.CommentList);
			$scope.item.CurrentComment = "";
			
			$scope.item.StatusCode = StatusFlowObj.ToStatusId;
			$scope.item.Dealer = getUserInfo("DealerDiv");
						
			
			var IsNewReq = $scope.item.ID ? false : true;
			var id = UpdateList($scope.item, "DealReleaseRequest", IsNewReq, IsNewReq);
			//debugger;
				
			UpdateApprovedEmailDeatils(StatusFlowObj.ToStatusId);
														
			if(!$scope.item.SPRef){
			
				if(!$scope.item.ID){
					$scope.item.ID = id;
				}
				
				if($scope.item.ID){
					 $scope.item.SPRef = new moment($scope.item.Created).format('YYYYMM') + "-" + $scope.item.ID;
					
					var valuepairs = [];
					valuepairs.push( ["SPRef", $scope.item.SPRef ]);	
					UpdateField("DealReleaseRequest", $scope.item.ID, valuepairs );
				}
				
			}
			
			if(IsNewReq && id && StatusFlowObj.ToStatusId == "1" ){				
				 $location.path("DealRelDetails/" + id );				
			}
			else{
				if(StatusFlowObj.ToStatusId != "1"){
					$location.path("DealRelease");
				}
			}
			
		}
				
		$('#divOverlay').hide();
		$('#ListDetails').show();		
	}
	
	


	$scope.listCtrlOnLoad = function(){
        	    	    	   			
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		SetSideBar("Deal Release", "Deal Release");	
		
		$scope.read = true;
		$scope.bmsRead = true;
		$scope.Config = LoadDealReleaseConfig();
		$scope.invalidDealer = false;

		
		
		
		//$scope.ShowSaveButton = false;
		
		setTimeout(function(){ 		
    		$scope.listDetailsOnLoadInit();
    	}, 1);
	}
	
	$scope.listDetailsOnLoadInit = function(){		
		
		$scope.itenId = $routeParams.itenId;
		//$scope.ShowSaveButton = true;
		var isRequestor = false;
		$scope.ShowComment = false;
		

		
		if($routeParams.itenId){
		
			$scope.ShowComment = true;

			var listFilter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID&$filter=ID eq " + $routeParams.itenId;
			//filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID" + filter;
			var listItems = GetListData("DealReleaseRequest", listFilter );
					
			if(listItems.length > 0 ){				
				$scope.item = listItems[0];	
				
				$scope.item.CommentList =  angular.fromJson($scope.item.Comments);
				if(!$scope.item.CommentList ){
					$scope.item.CommentList= [];
				}	
						
				if( _spPageContextInfo.userId == $scope.item.AuthorId){
					isRequestor  = true;
				}
								    			    			    			    	
				//$scope.ins = angular.fromJson(listItems[0].HedgingInstrument);				
				//debugger;				
			}
		}
		else{
			$scope.item = {};		
			$scope.item.StatusCode = "1";
			isRequestor  = true;	
			$scope.item.CommentList= [];
			$scope.item.Desk = $scope.Config.DeskInitVal;
			$scope.onDeskChange();
			
			//$scope.item.HedgeDate =  moment().format('DD-MMM-YYYY');
		}
		$scope.item.isRequestor  = isRequestor;
		
		if(isRequestor && ( $scope.item.StatusCode == "1" || $scope.item.StatusCode == "3"   ) ){
			$scope.read = false;
		}
		
		if($scope.Config.isBMSUser && ( $scope.item.StatusCode == "5" || $scope.item.StatusCode == "9"  ) ){
			$scope.bmsRead = false;
		}


		$scope.StatusFlow = [];
		var StatusFlow = GetStatusFlow($scope.item.StatusCode, $scope.item.isRequestor, $scope.Config.isBMSUser,  $scope.Config.isHoBMSUser )
		$scope.StatusFlow = StatusFlow;
		
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();
		
		setTimeout(function(){ 		
			initializeSinglePeoplePicker("DealerDiv");
			
			if($routeParams.itenId){
				PopulateMembers( $scope.item.DealerId, "DealerDiv");
			}
			else{
				var cuser = {};
				cuser.results = [];
				cuser.results.push(_spPageContextInfo.userId);			
				PopulateMembers(cuser , "DealerDiv" );
			}
			/*
			$('.TradeDate').datetimepicker({
				format: 'DD-MMM-YYYY',
				//defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
		    });	     	     
		    $(".TradeDate").on("dp.change", function() {
		        $scope.item.TradeDate = $(".TradeDate").val();	
		        var temp = $scope.item.ValueDate;
		        $scope.item.ValueDate = "";					
				$scope.$apply();
				$scope.item.ValueDate = temp;					
				$scope.$apply();

		    });
		    
		    $('.ValueDate').datetimepicker({
				format: 'DD-MMM-YYYY',
				//defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
		    });	     	     
		    $(".ValueDate").on("dp.change", function() {
		        $scope.item.ValueDate = $(".ValueDate").val();	
		        					
				var temp = $scope.item.TradeDate;
		        $scope.item.TradeDate = "";					
				$scope.$apply();
				$scope.item.TradeDate = temp;					
				$scope.$apply();

		    });
		    */
		    $('.digits').on('input', function(e){
		        this.value = this.value.replace(/[^0-9]/g, '');
		    });		    
		    
		}, 500);


		
	}
	
	
	
	function GetStatusFlow(CurrentStatusID, isRequestor, isBMSUser, isHoBMSUser)
	{
		var Filter = ",FromStatus/StatusId,ToStatus/Title,ToStatus/StatusId,FromStatus/StatusId&$expand=FromStatus/Id&$expand=ToStatus/Id&$orderby= ButtonOrder asc&$filter=FromStatus/StatusId eq " + CurrentStatusID ;
		
		
		var res =  GetListData("DealReleaseFlow", Filter );
		var ret = [];
		if(res[0].ToStatusId)
		{
			$.each(res ,
			function(key, Obj)
			{
				var addFlw = false;
				if(isRequestor && Obj.ActionBy == "Requestor"){
					addFlw = true;	
				}
				if(isBMSUser && Obj.ActionBy == "BMS"){
					addFlw = true;	
				}
				if(isHoBMSUser&& Obj.ActionBy == "HoBMS"){
					addFlw = true;	
				}
				
				if(addFlw){
					Obj.ToStatusId = Obj.ToStatus.StatusId;
					Obj.FromStatusId = Obj.FromStatus.StatusId;
					ret.push(Obj);
				}
				
			});
	
			return ret;
		}
		else
		{
			return null;
		}
	}
	
	function ValidateItem(){
				
		var errMessage = "";
		$scope.invalidDealer = false;
				
		if ( $scope.af.$valid) {
				
            $scope.errMessage = "";  
            
			var Dealer = getUserInfo("DealerDiv");
        	if(!Dealer ){
        		//errMessage +=  "Dealer required. ";
        		//$scope.ErrorMessage = errMessage;
        		$scope.invalidDealer = true;
        		return false;
        	}      
        	/*
			if( new moment($scope.item.TradeDate, "DD-MMM-YYYY") >  new moment($scope.item.ValueDate, "DD-MMM-YYYY") ){
				errMessage +=  "Value date should be greater than or equal to Trade date";
				$scope.ErrorMessage = errMessage;
				return false;	
			}		        		
			*/		 
            return true;     
        } 
        else {
        	/*
        	if( new moment($scope.item.TradeDate, "DD-MMM-YYYY") >  new moment($scope.item.ValueDate, "DD-MMM-YYYY") ){
				errMessage +=  "Value date should be greater than or equal to Trade date";
				$scope.ErrorMessage = errMessage;
				//return false;	
			}	
			*/
			
        	$scope.se = true;
        	if( $scope.af.$error.required  != null || $scope.af.$error.required  != undefined ){	
        		$.each($scope.af.$error.required, function(id, err){
        			
        			if(  err.$$attr.errmsg == null || err.$$attr.errmsg == undefined ){	
        				//errMessage += err.$name + " required. ";        				
        			}
        			else{        			 
        				//errMessage += err.$$attr.errmsg + " required. ";
        			}
        		});
        	}        
        	
			var Dealer = getUserInfo("DealerDiv");
        	if(!Dealer ){
        		//errMessage +=  "Dealer required. ";
        		$scope.invalidDealer = true;
        	}        		
        	$scope.ErrorMessage = errMessage;
        	return false;
		}
	}

						  
				
});

//var Config = [];
var DealReleaseConfigList = [];
var DealReleaseConfig = [];
var DealReleaseStatusList = [];

function LoadDealReleaseConfig(){
	
	DealReleaseConfigList = GetConfigList("DealReleaseConfig");
		
	
	Conf = {};
	Conf.RequestType = [];
	Conf.Desk = [];
	Conf.DeskList = [];
	
	Conf.Product = [];
	Conf.ValidationType = [];
	Conf.Counterparty = [];
	Conf.Reason = [];
	Conf.Status = [];
	Conf.isBMSUser = false; //BMS Users
	Conf.DeskInitVal = "";
	
	var TRYPermisionsFilter = "Title eq 'Deal Release Req BMS Users' and " + "Names/Id eq " + "'" + _spPageContextInfo.userId + "'";
	Conf.isBMSUser = IsCurrentInUsersList("UserPermissionsList" , "Title,Names/Id&$expand=Names/Id", TRYPermisionsFilter); //JSCommon.js	
	
	var TRYPermisionsFilter = "Title eq 'HoBMS' and " + "Names/Id eq " + "'" + _spPageContextInfo.userId + "'";
	Conf.isHoBMSUser = IsCurrentInUsersList("UserPermissionsList" , "Title,Names/Id&$expand=Names/Id", TRYPermisionsFilter); //JSCommon.js
	
	
	$.each(DealReleaseConfigList, function(id, val){
		if(val.RequestType){
			Conf.RequestType.push(val.RequestType);				
		}
		
		if(val.Desk){	
			
			if( val.DeskInitiatorsId && val.DeskInitiatorsId.results.includes(_spPageContextInfo.userId) ){
				Conf.DeskInitVal = val.Desk;
			}
			
			
			var dsk = {};
			if(val.Desk){
				dsk.Title = val.Desk;
				if(val.ProductList){				
					dsk.Products = val.ProductList.results;
				}
				//Conf.dskList = dsk;
				Conf.DeskList.push(dsk);
			}								
			Conf.Desk.push(val.Desk);				
		}		
					
		if(val.Product){										
			Conf.Product.push(val.Product);							
		}
		/*
		if(val.ValidationType){			
			Conf.ValidationType.push(val.ValidationType);				
		}
		
		if(val.Counterparty){			
			Conf.Counterparty.push(val.Counterparty);				
		}
		*/
		
		if(val.Reason){			
			Conf.Reason.push(val.Reason);				
		}
									
	});
	
	DealReleaseStatusList = GetConfigList("DealReleaseStatusList");
	$.each(DealReleaseStatusList, function(id, val){
		var status = {};
		status.id = val.StatusId;
		status.status = val.Title;
		Conf.Status.push(status);		
	});
	
	return Conf;
}

function GetStatusText(StatusList, StatusId){
	
	res = "";
	if(StatusId){
		//Conf.Status
		for(i=0;i<StatusList.length;i++){
			if(StatusList[i].id == StatusId ){
				res = StatusList[i].status;
				break;
			}
		}			
	}
		
	return res;
}

function addDealComment(CommentList, FromStatus, Action, ToStatus, ActionBy, Comment){
	var log = {};
	
	log.FromStatus = FromStatus;
	log.Action = Action;
	log.ToStatus = ToStatus;
	log.Date=  moment().format('YYYY-MM-DD hh:mm A');
	log.ActionBy = ActionBy;
	log.Comment = Comment;
	CommentList.push(log);
}





```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DealReleaseRequest\DealRelList.html```FileName```<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-4 main-header-title">Deal Release Request</div>	
		<div class=" col-md-8">			
			
			<div class=" appCountButton topright"  >
				<button type="button" class="btn active" ng-if="DDCPTYCount"
					onclick="window.open('https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/CounterpartyManagement.aspx','_blank')" >
					{{DDCPTYCount}}
				</button>
			</div>
				
		</div>		
	</div>
	
	<div  class="row content  divPnlButton" >
	
		<div class="col-md-9">
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  New Request
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('My Requests')"  ng-class="GetButtonClass('My Requests')" >
				My Requests
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('BMS')" ng-class="GetButtonClass('BMS')" ng-show="Config.isBMSUser">
				 BMS {{BMSCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('HoBMS')" ng-class="GetButtonClass('HoBMS')"  ng-show="Config.isHoBMSUser">
				 HoBMS {{HoBMSCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('All Requests')"  ng-class="GetButtonClass('All Requests')"  >
				 All Requests
			</button>
		
		</div>
		
		<div class="col-md-3">								
			
	        
	        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
            	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
            </button>
	        
			 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ListingQueue(QuqueTitle)" title="Refresh">
	            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
	         </button>	
	         
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
	        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
	        </button>            				
		</div>						            	
							
	</div>
	
	
	
	<div class="row main-data">			
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class='hide' style='width:100px'>ID</th>
						<th style='width:60px'>SP Ref.</th>
						<th style='width:60px'>Req. Type</th>
						<th style='width:100px'>Deal Ref</th>
						<th style='width:60px'>Desk</th>
						<th style='width:80px'>Product</th>	
						<!--th style='width:80px'>Counterparty</th-->											
						<th style='width:100px'>Amount & CCY</th>
						<th style='width:250px'>Requestor</th>
						<th style='width:80px'>Req. Date</th>
						<th style='width:150px'>Status</th>	
						
						
						<!--th style='width:100px'>Trade Date </th>						
						<th style='width:100px'>Ops Risk Event ID</th-->
									
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class='hide' style='width:100px'>ID</th>
						<th style='width:60px'>SP Ref.</th>
						<th style='width:60px'>Req. Type</th>
						<th style='width:100px'>Deal Ref</th>
						<th style='width:60px'>Desk</th>
						<th style='width:80px'>Product</th>	
						<!--th style='width:80px'>Counterparty</th-->											
						<th style='width:100px'>Amount & CCY</th>
						<th style='width:250px'>Requestor</th>
						<th style='width:80px'>Req. Date</th>
						<th style='width:150px'>Status</th>	
	
												
		            </tr>
		        </tfoot>		        		        
				<tbody>									
					<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
						<td class='hide'>{{it.ID}}</td>
						<td style="text-align:center">{{it.SPRef}}</td>
						<td style="text-align:center">{{it.RequestType}}</td>
						<td style="text-align:center">{{it.Title}}</td>
						<td style="text-align:center">{{it.Desk}}</td>
						<td style="text-align:center">{{it.Product}}</td>
						<!--td style="text-align:center">{{it.Counterparty}}</td-->												
						<td style="text-align:center">{{it.TransactionAmtCCY}}</td>												
						<td style="text-align:center">{{it.Author.Title}}</td>
						<td style="text-align:center">{{it.Created}}</td>
						<td style="text-align:center">{{GetStatusText(it.StatusCode)}}</td>
						
						<!--td style="text-align:center">{{it.TradeDate}}</td>												
						<td style="text-align:center">{{it.OpRickId}}</td-->
						
					</tr>				 	  
				</tbody>									
			</table>
		</div>

	</div>


</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\DealReleaseRequest\DealRelListCtrl.js```FileName```
var selTab = "";

DocApp.controller('DealRelListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad= function(){
	
		SetSideBar("Deal Release", "Deal Release");			
	
		//$('#divOverlay').show();
		//$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
			
	}
	 // ["ALM","BMS","F&E","S&S"];
	$scope.listCtrlOnLoadInit = function()
	{		
		var tab = '';
		try {
		  if(window.location.href.split('?')[1].split('=')[0] == 'tab'){
		  	selTab = window.location.href.split('?')[1].split('=')[1];		  	
		  }
		}
		catch(err) { tab = '';	}

		
		$scope.startDate = moment().subtract(7, 'days');
		$scope.endDate = moment();
		
		$scope.Config = LoadDealReleaseConfig();
		
		if($scope.Config.isBMSUser || $scope.Config.isHoBMSUser ){
			$scope.BMSCount = "(" + GetListItemsCount("DealReleaseRequest", "StatusCode", "(StatusCode eq 2 or StatusCode eq 5 or StatusCode eq 9 or StatusCode eq 11)") + ")";
			$scope.HoBMSCount = "(" + GetListItemsCount("DealReleaseRequest", "StatusCode", "StatusCode eq 8 or StatusCode eq 12 ") + ")";			
			
			$scope.DDCPTYCount="DD CPTY (" + GetListItemsCount("DDCustomerForm", "Title", "(StatusCode eq '20' or StatusCode eq '21' or StatusCode eq '22' or StatusCode eq '26')") + ")";
		}
		
		if(!selTab){
			if($scope.Config.isBMSUser ){
				selTab = "BMS";
			}
			else if($scope.Config.isHoBMSUser ){
				selTab = "HoBMS";
			}
			else{
				selTab = "My Requests";
			}			
		}
		
		$scope.ListingQueue(selTab);
		$scope.$apply();	
							
					
	}
	
	$scope.GetStatusText = function(StatusId){	
			
		if($scope.Config.isBMSUser || $scope.Config.isHoBMSUser ){
			return GetStatusText($scope.Config.Status, StatusId);
		}
		else
		{
			if(StatusId == 8 || StatusId == 9 || StatusId == 10 || StatusId == 12 ){
				return GetStatusText($scope.Config.Status, 5);
			}
			else{
				return GetStatusText($scope.Config.Status, StatusId);
			}
		}
	
				
	}
	
	$scope.GetButtonClass = function(title){
		if( title == $scope.QuqueTitle ){
			return "EI-ButtonPurple-Selected";
		}
		else{
			return '';
		}
	}
	
	$scope.ClearFilter = function(){
	
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}


		updateTable();
	}
	
	


	
	
	$scope.AddNew= function(){
		window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/NewDealRel/";
	}
	
	
	$scope.ListingQueue = function(queue){
		
		selTab = queue;
		
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		
		DestroyTable();


		var filter = "";
		if(queue == "My Requests"){
			filter = "&$filter=Author/Id eq " + _spPageContextInfo.userId;
		}
		else if(queue == "BMS"){
			filter = "&$filter=StatusCode eq 2 or StatusCode eq 5 or StatusCode eq 9 or StatusCode eq 11";
		}
		else if(queue == "HoBMS"){
			filter = "&$filter=StatusCode eq 8 or StatusCode eq 12 ";
		}
		else if(queue == "All Requests"){								
			startdt = $scope.startDate.clone();
			enddt = $scope.endDate.clone();
			console.log( "Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );			
			var filter = "&$filter=Created ge '" + startdt.subtract(1, 'days').format("YYYY-MM-DD") +  ", 23:59:59' and Created le '";
			filter += enddt.add(1, 'days').format("YYYY-MM-DD") +  ", 00:00:01' ";					
		}
		else{
			queue = "My Requests";
			filter = "&$filter=Author/Id eq " + _spPageContextInfo.userId;
		}
		
		

		

		filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID" + filter;			
		$scope.dataList = GetListData("DealReleaseRequest", filter );
		
		
		
		
		
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
			
			updateTable();
			$scope.QuqueTitle = queue;
		
		}, 0);

		
	}
	
	$scope.ExportToExcel = function(){
	
		var filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID";		
		//$scope.dataList = GetListData("DealReleaseRequest", filter );
		
		var res = [];        
        var row = [
        	'Status', 
			'Request Type', 
			'Desk', 
			'Product', 
			'Dealer', 
			'Title', 
			'TransactionAmtCCY', 
			//'TradeDate', 
			//'ValueDate', 
			//'ValidationType', 
			//'Counterparty', 
			'Reason', 
			'Description', 
			//'Comments', 
			'OpsRisk Event Logged', 
			'OpsRisk Event Id',
			'Link',
			//'Audit Log'
        ];
        res.push(row);   
        
        
        $.each($scope.dataList, function(id, val){
        	var row = [];
        	row.push( $scope.GetStatusText(val.StatusCode) );
			row.push(val.RequestType);
			row.push(val.Desk);
			row.push(val.Product);
			row.push(val.Dealer);
			row.push(val.Title);
			row.push(val.TransactionAmtCCY);
			//row.push(val.TradeDate);
			//row.push(val.ValueDate);
			//row.push(val.ValidationType);
			//row.push(val.Counterparty);
			row.push(val.Reason);
			row.push(val.Description);
			//row.push(val.Comments);
			row.push(val.OpRickLogged);
			row.push(val.OpRickId);
			row.push("https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/DealRelDetails/" + val.ID);
			//row.push(val.Comments)
			/*
			var CommentList =  angular.fromJson(val.Comments);
			$.each( CommentList, function(index, cmd) 
            {    			
				var cmd text = cmd. ""	
				DataList.push(dataRec);	                
            });
			*/

			
			
        	res.push(row);
		}); 
		
		ExcelReportDownload(res, 'ActionTracker-' + moment().format('DD-MM-YYYY-HH-mm-ss') +'.xlsx')

	}

			
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				
				"pageLength": 20,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 1, "desc" ]],
				"autoWidth": false,
	
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						if( ColCount == 2 || ColCount == 4 || ColCount == 5 || ColCount == 10  ){

							var column = this;
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.main-ListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
							column.data().unique().sort().each( function ( d, j ) {
								
								select.append( '<option value="'+d+'">'+d+'</option>' )
	
							} );
							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
								
								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();
								
								    });							
							/*
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.auctionListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val )
										.draw();
								} );							
							$.each(ResponsibilityList , function(id, val){
								select.append( '<option value="'+ val.Title +'">'+ val.Title +'</option>' )	
	
							});
							*/
						}
						
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				//var id =  $($(auctionReqstItemElem ).children()[0]).text();
				var id = auctionReqstItemElem[0].children[0].textContent;

				//debugger;
				$scope.item = $scope.dataList[id]; 
				window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/DealRelDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
						
			if( $scope.QuqueTitle == "All Requests"  ){ //&& ( $scope.Config.isBMSUser || $scope.Config.isHoBMSUser)
				UpdateMeetingDateSearch();
			}
			
			/*
			var ht = "<button class='btn btn-success buttons-html5 iconButton pull-right' type='button' ng-click='ExportToExcel()' title='Export To Excel'  style='padding-right:10px'>";     
			ht += "<i class='fa fa-download actionButtonSign' aria-hidden='true'></i>";
			ht += "</button>";			
			$('#main-ListTable_filter').before(ht);
			*/
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}
	
	
	
	function UpdateMeetingDateSearch(){
		setTimeout(function(){		
		       
		    var ht = "<div style='display: inline;margin: 0px 20px;float:right;'><label>Creation Date : <input type='text' class='TableDateRangeFilter' name='reportrange' id='reportrange'/></label></div>";
		    $scope.dateApplired = false;
		    
		    $('#main-ListTable_filter').before(ht);
		    
		    var start =  $scope.startDate; //moment().subtract(29, 'days');
		    var end = $scope.endDate; //moment();
		
		    function cb(start, end) {
		       // $('#reportrange span').html( "Targert date from <b>" +  start.format('DD-MMM-YYYY') + '</b> to <b>' + end.format('DD-MMM-YYYY') + '</b>' );
		        $scope.startDate = start;
		        $scope.endDate = end;
		        /*
		        if($scope.firstTimeLoad){
		        	$scope.firstTimeLoad = false;					
				}
				else{
					console.log( "On Change : Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );
				}
				*/
				//console.log( "1. On Change : Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );				
				
		        $('#reportrange').val( start.format('DD-MMM-YYYY') + ' to ' + end.format('DD-MMM-YYYY')  );		        		        
		    }
		
		    $('#reportrange').daterangepicker({
		        startDate: start,
		        endDate: end,
		        ranges: {
		           'Last 7 days': [ moment().subtract(7, 'days'), moment() ],
		           'Today': [moment(), moment()],
		           /*'Last Two Days': [moment(), moment().add(2, 'days')],
		           'Next 7 Days': [moment(), moment().add(7, 'days')],
		           'L 30 Days': [moment(), moment().add(30, 'days')],*/
		           'This Month': [moment().startOf('month'), moment().endOf('month')],	
		          // 'Last Month': [moment().startOf('month'), moment().endOf('month')],		           
		           	   		                
		           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
		           'This Year': [moment().startOf('year'), moment().endOf('year')],
		        },
		        locale: {
		        	format: 'DD-MMM-YYYY'
		        }
		    }, cb);
		    
		    $('#reportrange').on('apply.daterangepicker', function(ev, picker) {
			  //$scope.startDate = start;	
			   $scope.startDate = picker.startDate;
		       $scope.endDate = picker.endDate;

			  //console.log( "2. On App. : Start: " + $scope.startDate.format("DD-MMM-YYYY") + ", End: " + $scope.endDate.format("DD-MMM-YYYY") );			   		  
		      $scope.ListingQueue($scope.QuqueTitle);
			});
		
		    cb(start, end);
		    
	    
	    }, 200);
	}

	
	
	
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\Buttons.html```FileName```<div>
	<div style="color:blue;border:0px #441d61 solid;padding:2px;margin:10px">{{FXCommonMessage}}</div>	
</div>
<div id="InProgressMsgDiv" style="font-weight:bold;font-size:18px;color:blue;">Updating, please wait..</div>
<div id="ButtonDiv">
	<!--<input type="button" class="Button" ng-click="SubmitNewRequest()" value="Submit" /> -->
	<div style="font-weight:bold;color:red;width:100%;padding-top:3px">{{ErrorMessage}}</div>

	<div style="float:left;padding:5px" ng-show="SelObj.StatusCode == 1" >
		<div class="EIButtonStyle"  ng-click="SaveItem()" >
				Save							
		</div>
	</div>

	<div style="float:left;padding:5px" ng-repeat="sf in StatusFlow">
		<div class="EIButtonStyle"  ng-click="TakeWFAction(sf)" >
				{{sf.Title}}							
		</div>
	</div>

	
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\CCYAmount.html```FileName```<style>
	
	.deriDivOdd{
		padding: 5px;margin: 10px;background-color:#f1f1f1;border: 1px solid #f1f1f1 ;
	}
	.deriDivEven{
		padding: 5px;margin: 10px;background-color:#ddd;border: 1px solid #ddd ;
	}


	.CCYCtrlDiv200, .CCYCtrlDiv150, .CCYCtrlDiv50, .CCYCtrlDiv90, .CCYCtrlDiv100{
		height: 25px;
		min-width: 50px;
		float: left;	
		margin: 10px 20px 30px 10px ;
	}	
	.CCYCtrlDiv200{				
		width: 150px;		
	}
	.CCYCtrlDiv150{				
		width: 150px;		
	}	
	.CCYCtrlDiv50{
		width: 50px;
		margin: 10px 3px 30px 2px;
	}
	.CCYCtrlDiv90{
		width: 90px;
	}
	.CCYCtrlDiv100{
		width: 100px;
	}
	.CCYCtrl{
		font-size: 12px !important;
		font-family: Arial, Helvetica, sans-serif;
		color: #444 !important;
		width:100%;
		height: 23px;
		min-width: 50px;
		float: left;
	}

	.deleteButton{

		background-color: transparent;
		border: 0px !important;
		padding: 0px 0px 5px 0px !important;	
	}

	.deleteButton:hover{
		background-color: transparent;
		border: 0px !important;
	}

</style>

<div>

	<div class="row" ng-repeat="t in SelObj.DerivativeProdList" 
	ng-class-odd="'deriDivOdd'" ng-class-even="'deriDivEven'" >
		
		

		<div class="CCYCtrlDiv200"  >
			<label class="has-float-label">
				<select ng-disabled="SelObj.edd" ng-model="t.DerivativeType" class="CCYCtrl" >
					<option ng-repeat="c in DerivativeTypesList">{{c.Title}}</option>
				</select>
			  	<span>Derivative Type</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv90" style="margin: 10px 3px 30px 10px;">
			<label class="has-float-label">
				<input class="CCYCtrl" type="text" ng-model="t.StartDate"  gtdatepicker readonly="true" ng-change="UpdateTenor(t, 'StartDate')" 
					class="textBox"  ng-disabled="SelObj.edd">
			  <span>Start Date</span>			  
			</label>
		</div>

		<div class="CCYCtrlDiv50" >
			<label class="has-float-label">
				<select class="CCYCtrl" ng-disabled="SelObj.edd" ng-model="t.Day"  ng-change="UpdateTenor(t, 'Day')">
					<option value='0'>0</option>
					<option value='1'>1</option>
					<option value='2'>2</option>
					<option value='3'>3</option>
					<option value='4'>4</option>
					<option value='5'>5</option>
					<option value='6'>6</option>
					<option value='7'>7</option>
					<option value='8'>8</option>
					<option value='9'>9</option>
					<option value='10'>10</option>
					<option value='11'>11</option>
					<option value='12'>12</option>
					<option value='13'>13</option>
					<option value='14'>14</option>
					<option value='15'>15</option>
					<option value='16'>16</option>
					<option value='17'>17</option>
					<option value='18'>18</option>
					<option value='19'>19</option>
					<option value='20'>20</option>
					<option value='21'>21</option>
					<option value='22'>22</option>
					<option value='23'>23</option>
					<option value='24'>24</option>
					<option value='25'>25</option>
					<option value='26'>26</option>
					<option value='27'>27</option>
					<option value='28'>28</option>
					<option value='29'>29</option>
					<option value='30'>30</option>
					<option value='31'>31</option>
				</select>
				  <span>Days</span>			  
			</label>
		</div>

		<div class="CCYCtrlDiv50" >
			<label class="has-float-label">
				<select class="CCYCtrl" ng-disabled="SelObj.edd" ng-model="t.Month"   style="width:40px;height:24px" ng-change="UpdateTenor(t, 'Month')" >
					<option value='0'>0</option>
					<option value='1'>1</option>
					<option value='2'>2</option>
					<option value='3'>3</option>
					<option value='4'>4</option>
					<option value='5'>5</option>
					<option value='6'>6</option>
					<option value='7'>7</option>
					<option value='8'>8</option>
					<option value='9'>9</option>
					<option value='10'>10</option>
					<option value='11'>11</option>
					<option value='12'>12</option>
				</select>
				<span>Months</span>			  
			</label>
		</div>

		<div class="CCYCtrlDiv50" >
			<label class="has-float-label">
				<select class="CCYCtrl" ng-disabled="SelObj.edd" ng-model="t.Year"  ng-change="UpdateTenor(t, 'Year')" >
					<option value='0'>0</option>
					<option value='1'>1</option>
					<option value='2'>2</option>
					<option value='3'>3</option>
					<option value='4'>4</option>
					<option value='5'>5</option>
					<option value='6'>6</option>
					<option value='7'>7</option>
					<option value='8'>8</option>
					<option value='9'>9</option>
					<option value='10'>10</option>
					<option value='11'>11</option>
					<option value='12'>12</option>
					<option value='13'>13</option>
					<option value='14'>14</option>
					<option value='15'>15</option>
				</select>	
				<span>Years</span>			  
			</label>
		</div>

		<div class="CCYCtrlDiv90" style="margin: 10px 20px 30px 3px;" >
			<label class="has-float-label">
				<input class="CCYCtrl"  type="text" ng-model="t.MaturityDate" style="width:90px" gtdatepicker readonly="true" ng-change="UpdateTenor(t, 'MaturityDate')" 
				class="textBox"  ng-disabled="SelObj.edd">
				<span>Maturity Date</span>			  
			</label>
		</div>
		
		<div class="CCYCtrlDiv100" >
			<label class="has-float-label">
			  <input class="CCYCtrl"  class="form-control" type="text" required  errmsg="Floating Rate 2"
				  ng-model="t.FloatingRate2" ng-disabled="adminRead"  />
			  <span>Floating Rate 2</span>			  
			</label>	 
		</div>

		<div class="CCYCtrlDiv90"  >
			<label class="has-float-label">
				<input class="CCYCtrl"  type="text" ng-model="t.FstPayDate" gtdatepicker readonly="true" ng-change="UpdateTenor(t, 'StartDate')" 
						class="textBox"  ng-disabled="SelObj.edd">
			  	<span>Fst. Pay Date</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv90"  >
			<label class="has-float-label">
				<select class="CCYCtrl" ng-disabled="SelObj.edd" ng-model="t.Currency" >
					<option ng-repeat="c in Currencylist ">{{c.CurrencyCode}}</option>
				</select>
			  	<span>CCY</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
							
				<input class="CCYCtrl" ng-disabled="SelObj.edd"  type="text" ng-model="t.Amount" id="AmountBought" 
					ng-change="DerAmountOnChange(t)" >

			  	<span>Amount</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
				<select class="CCYCtrl" ng-model="t.Benchmark" ng-disabled="SelObj.edd">
					<option>EBOR</option>
					<option>SAIBOR</option>
					<option>SOFR</option>
				</select>
			  	<span>Benchmark</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
				<input class="CCYCtrl" ng-disabled="SelObj.edd"  type="text" ng-model="t.BenchmarkAmt"  >
			  	<span>Benchmark Value</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
				<input class="CCYCtrl" ng-disabled="SelObj.edd"  type="text" ng-model="t.TenorLP"  >
			  	<span>Tenor LP</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
				<input class="CCYCtrl" ng-disabled="SelObj.edd"  type="numbernumber" ng-model="t.OfferedRate" valid-number>
			  	<span>Floor Rate(%)</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
				<input class="CCYCtrl" ng-disabled="SelObj.edd"  type="number" ng-model="t.OfferedRate2" valid-number >
			  	<span>CAP Rate(%)</span>			  
			</label>	 	
		</div>

		<div class="CCYCtrlDiv150"  >
			<label class="has-float-label">	
				<input class="CCYCtrl" ng-disabled="SelObj.edd"  type="number" ng-model="t.FloatingRate2" valid-number >			
			  	<span>Floating Rate 2(%)</span>			  
			</label>	 	
		</div>

		<!-- <div class="CCYCtrlDiv150"  >
			<label class="has-float-label">
				
			  	<span>Derivative</span>			  
			</label>	 	
		</div> -->

		<div class="col-md-12 " style="padding-bottom:5px">
			<div class="row">
				<div  class="col-md-4 " >
					<button type="button" class="btn btn-link" ng-click="ShowRateSheet(t)" >Edit Term Sheet</button>
					<a class="btn btn-link" ng-if="t.PdfPath" href="{{t.PdfPath}}" target="_blank" style="margin-left:20px">{{GetFileName(t.PdfPath)}}</a>
				</div>
				<div  class="col-md-2 ">
					
				</div>								
				<div  class="col-md-6 " >
					<button class="btn deleteButton pull-right" type="button" title="Remove" ng-click="RemoveCCYAmount($index)">	            	
						<img  ng-hide="SelObj.ed" style="width:16px;height:16px" src="/EITRY/FX/SiteAssets/images/delete.png" alt="remove" ng-click="RemoveCCYAmount($index)">
					</button>
				</div>
			</div>			
			
		</div>

	</div>

	<div class="row" style="padding: 25px;margin: 0px;" >
		<button type="button" class="btn btn-link" ng-click="AddNewCCYAmount()" >Add Derivative</button>
	</div>

	

</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\DerivariveCtrl.js```FileName```

DocApp.controller('DerivativesCtrl', function($scope, $interval,$location, $timeout,$routeParams){

    $scope.ShowItem = "DataList";
    $scope.currentUrl = $location.absUrl();
    $scope.ProjectTitle = "Derivatives RFQ UAT";
    $scope.MasterList = "DerivativesRFQUAT";
    $scope.StatusFlowList = "DerivativesProcessFlowV2";
    $scope.StatusListName = "DerivativesStatus";
    $scope.ConfigList = "DerivativesConfig";
    $scope.RateSheetTemplate = "DerivativesRateSheetTemplate";
    $scope.DerivativesScenarioConfigList = "DerivativesScenarioConfig";

    $scope.LastDataRefresh = "";
    $scope.Attachments = [];
    var count = 0;

    //Rate Sheet
    $scope.ShowRateSheet = function(der) {

        $scope.selDer = der; 
        updateReateSheet(der)               
        $('#RateSheetTabButton').trigger('click');
    }

    $scope.templateCtrlOnLoad = function() { 

        $scope.DerivateTypesList =  GetConfigList("DerivativeTypes", "");
        if(!$scope.TemplateDerivativeType){
            $scope.TemplateDerivativeType = "Collared Floater Deposit";
        }
        
        //updateReateSheet();

        var template = GetListData($scope.RateSheetTemplate, ",DerivativeType/Title&$expand=DerivativeType&$orderby=Order0 asc&$filter=DerivativeType/Title eq '" + $scope.TemplateDerivativeType +"'");
        var pages = [];
        var page = [];
        var lastRowType = "";
        template.forEach( (t) =>{

            t.firstTableRow = false;

            if(t.RowType === 'New Page'){                
               if(page.length > 0){
                pages.push(page);
               }
               page = [];              
            }
            else{
                if(t.RowType === 'Table Row' && ( lastRowType != 'Table Row' || page.length == 0 ) ){
                    t.firstTableRow = true;
                }
                // if( $scope.SelObj){                   
                //     t = TempalteDataReplace(t, dataArr);
                // }            
                page.push(t);
            }
            lastRowType = t.RowType;                        
        })
        if(page.length > 0){
            pages.push(page);
            page = []; 
        }
        $scope.ReportPages = pages;                        
        //$scope.RateSheetTemplateList = template;

        try{
            $scope.$apply();	
        }catch(err){}

    }

    $scope.TemplateDerivativeTypeChange = function(queue) { 
        
    }

    $scope.TemplateEdit = function(item) { 
        $('#TemplateModal').modal('toggle');
        $scope.selPage = item;
        try{
            $scope.$apply();	
        }catch(err){}
    }

    $scope.SaveTemplateItem = function(item) {    

        var ColumnOne = item.ColumnOne;
        var ColumnTwo = item.ColumnTwo;

        var valuepairs = [];
        if(item.RowType === "Text"){
            var ColumnOne = htmlEscape($("#ColumnOneTextEdit").html());
            valuepairs = [[ "ColumnOne", ColumnOne  ]]; 
        }
        else if(item.RowType === "Table Row"){
            ColumnOne = htmlEscape($("#ColumnOneTableEdit").html());
            ColumnTwo = htmlEscape($("#ColumnTwoTableEdit").html());
            valuepairs = [[ "ColumnOne", ColumnOne  ], [ "ColumnTwo", ColumnTwo  ] ];
        }
                
        UpdateField($scope.RateSheetTemplate, item.ID, valuepairs );	

        try{
            $scope.$apply();	
        }catch(err){}
        
        $scope.templateCtrlOnLoad();

        

        $('#TemplateModal').modal('toggle');
    }

    $scope.jspdfReport = function(){
        var pdf = new jsPDF('p', 'pt', 'letter');
        pdf.canvas.height = 72 * 11;
        pdf.canvas.width = 72 * 8.5;

        var element = document.getElementById('divReport');

        pdf.fromHTML(element);

        pdf.save('test.pdf');
    }

    function UploadPDF(path){
        //debugger;        

        //var pdfFileNme = 'RateSheet-' + "$scope.SelObj.SPRefNo" + '-' + moment().format('DD-MM-YYYY-HH-mm-ss') + '.pdf'

        var pdfFileNme = `TeamSheet-${$scope.SelObj.ID}-${moment().format('DD-MM-YYYY-HH-mm-ss')}.pdf`;

		var element = document.getElementById('divReport');
		var opt = {
		  margin:       [.2,.5,.7,.5], //[top, left, bottom, right]
		  filename:     pdfFileNme, //'RateSheet-' + "$scope.SelObj.SPRefNo" + '-' + moment().format('DD-MM-YYYY-HH-mm-ss') + '.pdf',
		  image:        { type: 'jpeg', quality: 1 },
		  html2canvas:  { scale: 2 },
		  jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },          
		  pagebreak: { before: '.beforeClass', after: 'afterClass' },    
          //pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }     
		};

        html2pdf().from(element).set(opt).outputPdf('blob', pdfFileNme ).then(function(pdf_blob) {
         
             $timeout(function() {
                
                try{
                    //var attachURL = SiteRelativeUrl + path; // "https://workplace.emiratesislamic.ae/EITRY/FX/_api/web/getfolderbyserverrelativeurl('/EITRY/FX/DerivativesTeamSheets/34')/files/add(overwrite=true, url='" + pdfFileNme +"')"
                    
                    var attachURL = `${SiteURL}/_api/web/getfolderbyserverrelativeurl('${path}')/files/add(overwrite=true, url='${pdfFileNme}')`; 
                    
                    jQuery.ajax({
                        url: attachURL,
                        type: "POST",
                        data: pdf_blob,
                        processData: false,
                        headers: {
                            "accept": "application/json;odata=verbose",
                            "X-RequestDigest": jQuery("#__REQUESTDIGEST").val()
                        }
                    });

                    $scope.selDer.PdfPath = SiteHomeURL + path + "/" + pdfFileNme;
                    try{
                        $scope.$apply();	
                    }catch(err){}

                    $('#divOverlay').hide();

                    //alert("done")
                }catch(err){}
                                            
            }, 200);	
        });

    }

    function CreateSPFolder( docLibName, folderName){ 

        var path =  '/' + SiteRelativeUrl + docLibName + '/' + folderName + '' ;
        
    
        var ctx = SP.ClientContext.get_current();  
        var folder = ctx.get_web().getFolderByServerRelativeUrl(path);  
        ctx.load(folder, "Name"); 
        
        ctx.executeQueryAsync(  
            function() {  
                UploadPDF(path);
            },  
            function(s, args) {  
               if (args.get_errorTypeName() === "System.IO.FileNotFoundException") {  
                  //CreateFolder(docLibName, folderName); 
                  
                 var clientContext;  
                 var oWebsite;  
                 var oList;  
                 var itemCreateInfo;  
             
                 clientContext = new SP.ClientContext.get_current();  
                 oWebsite = clientContext.get_web();  
                 oList = oWebsite.get_lists().getByTitle(docLibName);  
             
                 itemCreateInfo = new SP.ListItemCreationInformation();  
                 itemCreateInfo.set_underlyingObjectType(SP.FileSystemObjectType.folder);  
                 itemCreateInfo.set_leafName(folderName);  
                 var oListItem = oList.addItem(itemCreateInfo);  
                 oListItem.update();  
             
                 clientContext.load(oListItem);  
                 clientContext.executeQueryAsync(  
                     Function.createDelegate(this, function(){
                         alert("Folder Created");
                        UploadPDF(path);
                     }),  
                     Function.createDelegate(this, function(){
                         alert("Error"); 
                     })  
                 ); 
               }  
               else {  
                  console.log("Error: " + args.get_message());  
               }  
            }  
         ); 
    }

    $scope.PDFReport = function()    
	{	
         $('#divOverlay').show();
         CreateSPFolder( "DerivativesTeamSheets", $scope.SelObj.ID);

        return;

        //Create Folder - //DerivativesTeamSheets/[ItemID]/
        
		var pdfFileNme = 'RateSheet-' + "$scope.SelObj.SPRefNo" + '-' + moment().format('DD-MM-YYYY-HH-mm-ss') + '.pdf'
		var element = document.getElementById('divReport');
		var opt = {
		  margin:       [.2,.5,.7,.5], //[top, left, bottom, right]
		  filename:     pdfFileNme, //'RateSheet-' + "$scope.SelObj.SPRefNo" + '-' + moment().format('DD-MM-YYYY-HH-mm-ss') + '.pdf',
		  image:        { type: 'jpeg', quality: 1 },
		  html2canvas:  { scale: 2 },
		  jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },          
		  pagebreak: { before: '.beforeClass', after: '.afterClass' },    
          //pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }      
		};


        debugger;

        
        
				
        html2pdf().from(element).set(opt).toPdf().get('pdf').then(function (pdf) {

            var totalPages = pdf.internal.getNumberOfPages(); 
            //print current pdf width & height to console
            console.log("getHeight:" + pdf.internal.pageSize.getHeight());
            console.log("getWidth:" + pdf.internal.pageSize.getWidth());
            for (var i = 1; i <= totalPages; i++) {
              pdf.setPage(i);
              pdf.setFontSize(10);
              pdf.setTextColor('balck');


              //divided by 2 to go center
              //header
            //   pdf.text("Emirates Islamic Bank", pdf.internal.pageSize.getWidth()-2, .1)
            //   pdf.text("Treasury and Markets ", pdf.internal.pageSize.getWidth()-2, .2)
            //   pdf.text("+971 (0) 4 4152333", pdf.internal.pageSize.getWidth()-2, .3)

            
              pdf.text('--------------------------------', pdf.internal.pageSize.getWidth()/4, pdf.internal.pageSize.getHeight()-.3 )
              pdf.text('Page ' + i + ' of ' + totalPages + " Signature", pdf.internal.pageSize.getWidth()/4, 
              pdf.internal.pageSize.getHeight()-.2);
            } 
        
        }).save();
		
	}	

    function pdfCallback(pdfObject) {
        var number_of_pages = pdfObject.internal.getNumberOfPages()
        var pdf_pages = pdfObject.internal.pages
        var myFooter = "Footer info"
        for (var i = 1; i < pdf_pages.length; i++) {
            // We are telling our pdfObject that we are now working on this page
            pdfObject.setPage(i)
    
            pdfObject.text("my header text", 10, 10)
    
            // The 10,200 value is only for A4 landscape. You need to define your own for other page sizes
            pdfObject.text(myFooter, 10, 200)
        }
    }
        
    //End of Rate Sheet

   
              
    //Request List
    $scope.listCtrlOnLoad = function(queue) { 
                
        //
        //$('#ReqDetailsModal').modal('toggle');

        // setTimeout(function(){ 
        //     updateReateSheet();
        //     $('#ReqDetailsModal').modal('toggle');

        //     setTimeout(function(){ 
        //        //$scope.PDFReport()
        //     }, 1000);

        // }, 500);

        // return;

        var userDet = GetCurrentUserID();
        if (userDet) {
            $scope.CurrUserID = userDet.UserID; //User.js
            $scope.CurrUserName = userDet.UserName; //User.js
            $scope.NtId = userDet.NtId; //User.js
        } else {
            alert("Unable to get current user details ");
            return;
        }

        var TRYPermisionsFilter = "Title eq 'TRYDerivativesUsers' and " + "Names/Id eq " + "'" + $scope.CurrUserID + "'";
        $scope.IsTryUser = IsCurrentInUsersList("UserPermissionsList", "Title,Names/Id&$expand=Names/Id", TRYPermisionsFilter); //JSCommon.js

        $scope.StatusConfigList = GetStatusConfigList($scope.StatusListName);
        //$scope.DerivateTypesList =  GetConfigList("DerivativeTypes", "");
        $scope.DerivativeTypesList =  GetConfigList("DerivativeTypes", ",Title,Category");       
        $scope.Currencylist =  GetConfigList("T0SmartBusinessCurrency", "&$filter=Include eq 1");
        $scope.SegmentList =  GetConfigList("SegmentList", ",Title,Email,ColumnOrder&$orderby=ColumnOrder asc");
          
        
        if(!queue){
            queue = "All Requests";
        }

        //DocCtrlInitOnLoad($scope, cond); //Init.js        
        $scope.QueueTitle = queue;

        var Filter = ",Author/Name,Author/Title,RMName/Name,RMName/Title,CCEmailList/Name,CCEmailList/Id&$expand=Author/Id&$expand=RMName/Id,CCEmailList/Id";
        $scope.FXList = GetListData($scope.MasterList, Filter + "&$orderby=ID desc");

        setTimeout(function(){ 

            $('.ReqDetailsTab a').on('shown.bs.tab', function(event){

                var target = $(event.target).text();    // active tab
                var y = $(event.relatedTarget).text();  // previous tab
                        
                if(target == "Rate Sheet"){
                    $scope.SeletedStatusTab = "Rate Sheet";

                    updateReateSheet();
                }
            });
        }, 1000);


    }

    $scope.QueueTaskListing = function(Title, type ){

    }
    //End of Request List

   //Selected Item

    $scope.AmountOnChange = function(){ 
        $scope.SelObj.Amount = AntTxtBoxOnChange($scope.SelObj.Amount);  
    }

    function NumberWithComa(){
        
        return AntTxtBoxOnChange($scope.SelObj.Amount);
    }

    $scope.DerAmountOnChange = function(t){ 
        t.Amount = AntTxtBoxOnChange(t.Amount);  
    }

    $scope.NewRFQ = function(IsCancel, IsCopy, DirectDealCust, SelAuthReq, SelDDTransactionType) {
        var DocObj = [];       
        DocObj.Title= "";  
        DocObj.AccountTitle= "";
        DocObj.SegmentName= "";
        DocObj.SubscriberID = "";
        DocObj.DerivativeCategory="Asset";
        DocObj.Amount= "";  
        DocObj.RMContactNumber="";
        DocObj.RequestorComments="";
        DocObj.TRYComments= "";       
   
        DocObj.SPRefNo = "";
        DocObj.StatusCode = "1";
        $scope.ShowReasonText = false; 
        
        DocObj.DerivativeProdList= [];
        var derivative= {};
        derivative.DerivativeType = "";
        derivative.Tenor= "";
        derivative.Currency= "";
        derivative.Amount= 0;
        derivative.Currency2= "";
        derivative.Amount2= 0;
        derivative.IndexMargin = "";
        derivative.IndexMargin2 = "";
        derivative.CancelDate = "";
        derivative.CancelType = "";
        derivative.OfferedRate ="";
        derivative.OfferedRate2 ="";
        derivative.CoverRate ="";
        derivative.CoverRate2 ="";
        derivative.EstimatedRevenue ="";		
        derivative.RequiredPFE ="";
        derivative.ApprovedPFE ="";
        derivative.Status = "";

        DocObj.DerivativeProdList.push(derivative);

    
        $scope.Attachments = "";
        $scope.TRYAttachments = ""; 

        
        $scope.OnItemClick(DocObj, 1);
    }

    $scope.OnItemClick = function(DocObj) {

        // $('#ReqDetailsModal').modal('toggle');
        // return;

    	$scope.ValidAmt="";
        $("#InProgressMsgDiv").hide();
        $("#InProgressMsgDivDD").hide();
        $("#ButtonDiv").show();
        //if (DocObj.Amount) DocObj.Amount= addCommas(DocObj.Amount);
        //if (DocObj.AmountCharged) DocObj.AmountCharged = addCommas(DocObj.AmountCharged);
        //var ContactPerson = "ContactPerson";
       	var CCEmailCap = "CCEmail";
        var RMName= "RMName";
        $scope.loading = false;
        $scope.SelObj = [];
        $scope.ErrorMessage = "";
        DocObj.edd = false; // edd => delear edit
        DocObj.edarc = false; 
        DocObj.edbms = false;
        var IsOriginator = false;
        if (DocObj.StatusCode == "1") {
            IsOriginator = true;            
        } else if ($scope.CurrUserID == DocObj.AuthorId || $scope.CurrUserID == DocObj.RMNameId) {
            IsOriginator = true;            
       }
       if (DocObj.CCEmailList && DocObj.CCEmailList.results && DocObj.CCEmailList.results.length > 0) {
            $.each(DocObj.CCEmailList.results,function(index,value){
			
				if ($scope.CurrUserID == value.Id ) {
               		 IsOriginator = true; 
               		
               		 
               	}
			});
		}
      
        //Originator cannot be be an TRY User for a request
        var TryUser = $scope.IsTryUser;
        var ARCUser = $scope.IsMRUser;
        
        var BMSUser = $scope.IsBMSUser;

      
        DocObj.IsOriginator = IsOriginator;
        var PickedUpDelear = false;
        if ($scope.CurrUserID == DocObj.PickedUpDelearId) {
            PickedUpDelear = true
            DocObj.edd = false;
        }
        DocObj.ed = true; //EditDisabled
        DocObj.edd = true;
        DocObj.edcif = true; //EditDisabled
        DocObj.edcsubid = true;
        DocObj.edarc= true;
       if (DocObj.StatusCode == "1") {
          DocObj.ed = false;
       }

        if(DocObj.StatusCode == "1" && $scope.IsTryUser ){
            DocObj.edd = false;
        }
        if (IsOriginator && (DocObj.StatusCode == "8" && DocObj.StatusCode == "16")) {
            DocObj.ed = false;
        }
       
        //$scope.IsTryUser		
        initializePeoplePickerMultiple(CCEmailCap);
        //initializePeoplePickerMultiple(ContactPerson);
        initializePeoplePickerMultiple(RMName);
        //DocObj.EIContact= getUserInfoAsArray(EIContact);
        DocObj.Status = $scope.StatusConfigList[DocObj.StatusCode]; //GetStatus(DocObj.StatusCode,$scope.StatusListName);
        $scope.SelObj = DocObj;  
        
		if ($scope.SelObj.DerivativeProducts)
	    {
			$scope.SelObj.DerivativeProdList = angular.fromJson($scope.SelObj.DerivativeProducts);
	    }
	    else
	    {
	        $scope.SelObj.DerivativeProdList= [];
	        var derivative= {};
			derivative.DerivativeType = "";
			derivative.Tenor= "";
			derivative.Currency= "";
			derivative.Amount= 0;
			derivative.Currency2= "";
			derivative.Amount2= 0;
			derivative.IndexMargin = "";
			derivative.IndexMargin2 = "";
			derivative.CancelDate = "";
			derivative.CancelType = "";
			derivative.OfferedRate ="";
			derivative.CoverRate ="";
			derivative.EstimatedRevenue ="";		
			derivative.RequiredPFE ="";
			derivative.ApprovedPFE ="";
			derivative.Status = "";
			DocObj.DerivativeProdList.push(derivative);
	    }
    
        clearPP(CCEmailCap + "_TopSpan");
        clearPP(RMName+ "_TopSpan");
        
        // if ($scope.SelObj.RMNameId) {
        //     PopulateMembers($scope.SelObj.RMNameId, RMName);
        // }
        // if ($scope.SelObj.CCEmailListId) {
        //     PopulateMembers($scope.SelObj.CCEmailListId, CCEmailCap);
        // }

        //  if (DocObj.SPRefNo) {         	
        //  	$scope.Attachments = getFolderFiles(DocObj.SPRefNo);
         	
        //  	var SPRefNoTRY = DocObj.SPRefNo + "-TRY"; 
        //  	$scope.TRYAttachments = getFolderFiles(SPRefNoTRY);
         	
        //  }

        var PickedUpByDealerAlert = false;
        var PickedUpByARCDealerAlert = false;
        $scope.StatusFlow = [];
        var StatusFlow = GetStatusFlow(DocObj.StatusCode,$scope.StatusFlowList);
        $.each(StatusFlow,
            function(key, Obj) {
            	if (Obj.InitiatorTask && IsOriginator) {            	
	            	$scope.StatusFlow.push(Obj);
	            	$scope.SelObj.ed = false;
            	}
            	if (Obj.InitiatorTask ) {            		            	
	            	$scope.SelObj.ed = false;
	            	if (DocObj.StatusCode == "11"){
			        	$scope.SelObj.ed = true;
			        	//$scope.SelObj.edcif= false;
			        }
			        if (DocObj.StatusCode == "12"){
			        	$scope.SelObj.ed = true;
			        	$scope.SelObj.edcsubid= false;
			        }
			        if (DocObj.StatusCode == "28")
                    {
                    	DocObj.ed = true;
                    	DocObj.edcif= false;
                    }
            	}

                //else if (Obj.DelearQueueTask && TryUser && $scope.PickedUpCount == 0) {
                else if (Obj.DelearQueueTask && TryUser) {

                    $scope.StatusFlow.push(Obj);
                } 
                if(Obj.ARCDealerTask && (ARCUser) && $scope.PickedUpCount == 0 )
		        {
		            $scope.StatusFlow.push(Obj);		           
		        }
		        else if(Obj.ARCMyTask && PickedUpDelear )
		        {
		            $scope.StatusFlow.push(Obj);
		            DocObj.edarc = false;                                   
		        }
		        //if(Obj.BMSDealerTask && (BMSUser) && $scope.PickedUpCount == 0 )
		        if(Obj.BMSDealerTask && (BMSUser)  )

		        {
		            $scope.StatusFlow.push(Obj);		           
		        }
		        else if(Obj.BMSMyTask && PickedUpDelear )
		        {
		            $scope.StatusFlow.push(Obj);
		            DocObj.edbms = false;                                   
		        }


                else if (Obj.DelearMyTask && PickedUpDelear) {
                    $scope.StatusFlow.push(Obj);
                    DocObj.edd = false;
                    if (Obj.ARCMyTask && $scope.IsMRUser)
                    {
                    	DocObj.edarc = false;
                    	DocObj.edd = true;
                    }
                    if (DocObj.StatusCode == "27")
                    {
                    	DocObj.edd = true;
                    	DocObj.edcif= false;
                    }
                } 
                if (!PickedUpDelear && Obj.DelearMyTask && TryUser ) {
                    PickedUpByDealerAlert = true;
                }                
            });
        if (PickedUpByDealerAlert) {
            alert("Deal already pickedup by another dealer.");
        }
        
        if (DocObj.Amount) DocObj.Amount = addCommas(DocObj.Amount);
        //if (DocObj.AmountBought) DocObj.AmountBought = addCommas(DocObj.AmountBought);
/*
        var maskHeight = ($scope.FXList.length * 48) + 300; //$(document).height();  
        if (maskHeight < $(document).height()) {
            maskHeight = $(document).height();
        }
        var maskWidth = $(window).width();
        // calculate the values for center alignment
        //debugger;
        var dialogTop = (row * 48) - ($('#dialog-box').height()) + 50; //($('#dialog-box').height()); //20; // (maskHeight/3) - ($('#dialog-box').height()); 
        if (dialogTop < 20) {
            dialogTop = 20;
        }
        var dialogLeft = 100; //(maskWidth/2) - ($('#dialog-box').width()/2); 
        // assign values to the overlay and dialog box
        $('#dialog-overlay').css({
            height: maskHeight,
            width: maskWidth
        }).show();
        $('#dialog-box').css({
            top: dialogTop,
            left: dialogLeft
        }).show();
        window.location = "#RequestDetailsDIV";
        */

        $('#ReqDetailsModal').modal('toggle');
    }

    $scope.TakeWFAction = function(StatusFlow) {
        $("#InProgressMsgDiv").show();
        $("#ButtonDiv").hide();
        $timeout(function() {
            TakeAction(StatusFlow, $scope);
            $("#InProgressMsgDiv").hide();
            $("#ButtonDiv").show();
        }, 100);
    }

    $scope.SaveItem = function() {

        
        $scope.SelObj.CCEmailList = getUserInfo("CCEmail");
        $scope.SelObj.RMName = getUserInfo("RMName");

        $scope.SelObj.DerivativeProducts =angular.toJson($scope.SelObj.DerivativeProdList);

        var IsNewReq = true;
        if ($scope.SelObj.ID) {
            IsNewReq = false;            
            var id = UpdateList($scope.SelObj, $scope.MasterList, IsNewReq, IsNewReq, true);
        } else {
        	$scope.SelObj.AttachmentFileRef = $scope.UniqueItemID;        	
            var id = UpdateList($scope.SelObj, $scope.MasterList, IsNewReq, IsNewReq);                                    
        }
        
        alert("Updated")
    }


    //End of Selected Item

    //CCY functions
    $scope.UpdateTenor = function(t, cap)	
	{
        var StartDate = t.StartDate;
        var MaturityDate = t.MaturityDate;
         
        if( (cap === "MaturityDate" && StartDate)){            
            var ToDate = new moment(MaturityDate, "DD-MMM-YYYY");		
            var diffDuration = moment.duration(ToDate.diff( new moment( StartDate, "DD-MMM-YYYY" ) ) );			
            t.Year = diffDuration.years() + "";
            t.Month = diffDuration.months() + "";
            t.Day = diffDuration.days() + "";
        }
        else if (StartDate) {

            ToDate = new moment(StartDate, "DD-MMM-YYYY");;
            if(t.Year)
            {				
                ToDate = ToDate.add(t.Year, 'years');
            }
            if(t.Month)
            {				
                ToDate = ToDate.add(t.Month , 'months');
            }
            if(t.Day)
            {				
                ToDate = ToDate.add(t.Day , 'days');
            }			
            t.MaturityDate = ToDate.format("DD-MMM-YYYY");
        }
	}

    $scope.AddNewCCYAmount= function()
	{			
        var derivative= {};        
        derivative.DerivativeType = "";
        derivative.StartDate = "";
        derivative.Day = "";
        derivative.Month = "";
        derivative.Year = "";
        derivative.MaturityDate = "";
        derivative.FloatingRate2 = "";
        derivative.FstPayDate= "";
        derivative.Currency= "";
        derivative.Amount= "";
        derivative.Benchmark= "";
        derivative.BenchmarkAmt= 0;
        derivative.TenorLP = "";
        derivative.OfferedRate ="";

        derivative.OfferedRate2= 0;
        derivative.FloatingRate2= "";



        // derivative.Tenor= "";              
        // derivative.Currency2= "";
        // derivative.Amount2= 0;
        // derivative.IndexMargin = "";
        // derivative.IndexMargin2 = "";
        // derivative.CancelDate = "";
        // derivative.CancelType = "";
        // derivative.OfferedRate ="";
        // derivative.CoverRate ="";
        // derivative.EstimatedRevenue ="";		
        // derivative.RequiredPFE ="";
        // derivative.ApprovedPFE ="";
        // derivative.Status = "";

        $scope.SelObj.DerivativeProdList.push(derivative);	
	}

    $scope.RemoveCCYAmount= function(index)	
	{
		$scope.SelObj.DerivativeProdList.splice(index, 1);
	}



    //End of CCY functions



    //Common


    $scope.GetFileName = function(fullPath)	
	{
		var filename = "";
        if(fullPath){
            try{
                filename = fullPath.substring(fullPath.lastIndexOf('/')+1);
            }catch(exp){
                filename = fullPath;
            }
        }        
        return filename;
	} 

    function GetStatusConfigList(ListName)
    {
        var StatusConfigList = GetConfigList(ListName, "" );	
        var res = {};
        
        $.each(StatusConfigList ,
        function(key, Obj)
        {
            res[Obj.StatusId] = Obj.Title;
        });
        
        return res;	
    }

    $scope.GetButtonClass = function(title){
		if( title == $scope.QueueTitle ){
			return "EI-ButtonPurple-Selected";
		}
		else{
			return '';
		}
	}

    $scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}
	
	$scope.FormatDate = function(date){
		return new moment(date).format("DD-MMM-YYYY");
	}

    function GetStatusFlow(CurrentStatusID,ListName)
    {
        var Filter = "&$filter=FromStatus eq " + CurrentStatusID + "&$orderby= ButtonOrder asc ";
        return GetListData(ListName, Filter );
    }

    function addCommas(nStr)
    {
        nStr += '';
        x = nStr.split('.');
        x1 = x[0];
        x2 = x.length > 1 ? '.' + x[1] : '';
        var rgx = /(\d+)(\d{3})/;
        while (rgx.test(x1)) {
            x1 = x1.replace(rgx, '$1' + ',' + '$2');
        }
        return x1 + x2;
    }

    function updateReateSheet(det){

        $scope.SheetItem = $scope.SelObj;
      
        var days = new moment(det.MaturityDate, "DD-MMM-YYYY").diff( new moment(det.StartDate, "DD-MMM-YYYY"), 'days' )
        var AmtNum = GetNumber(det.Amount);

        var dataArr = [];
        //##days## 
        dataArr.push({title : '##CLIENT_NAME##', value :  $scope.SelObj.AccountTitle});
        dataArr.push({title : '##CIF##', value :  $scope.SelObj.Title});
        // dataArr.push({title : '##CIF##', value :  $scope.SelObj.Title});
        // dataArr.push({title : '##CIF##', value :  $scope.SelObj.Title});

        dataArr.push({title : '##days##', value :  days});        
        dataArr.push({title : '##Amount##', value : det.Amount});
        dataArr.push({title : '##AmountNum##', value : AmtNum});
        dataArr.push({title : '##StartDate##', value : det.StartDate});
        dataArr.push({title : '##EndDate##', value : det.MaturityDate });
        dataArr.push({title : '##FirstProfitDate##', value : det.FstPayDate });
        dataArr.push({title : '##TenorLP##', value : det.TenorLP });

        dataArr.push({title : '##BenchmarkAmt##', value : det.BenchmarkAmt });
        dataArr.push({title : '##Currency##', value : det.Currency});
        dataArr.push({title : '##Benchmark##', value : det.Benchmark });
        
        dataArr.push({title : '##FloorRate##', value : det.OfferedRate });
        dataArr.push({title : '##CapRate##', value : det.OfferedRate2 });
        dataArr.push({title : '##FloorRate##', value : det.OfferedRate });
        dataArr.push({title : '##FloatingRate##', value : det.FloatingRate2 });


       

        
        var filter = ",DerivativeType/Title,COne/Title,COne/TitleTemplate,COne/Formula,"
            + "CTwo/TitleTemplate,CTwo/Formula,CThree/Title,CThree/TitleTemplate,CThree/Formula,"
            + "CFour/Title,CFour/TitleTemplate,CFour/Formula,CFive/Title,CFive/TitleTemplate,CFive/Formula,"
            + "CSix/Title,CSix/TitleTemplate,CSix/Formula,CSeven/Title,CSeven/TitleTemplate,CSeven/Formula"
            + "&$expand=COne&$expand=CTwo&$expand=CThree&$expand=CFour&$expand=CFive&$expand=CSix&$expand=CSeven"
            + "&$expand=DerivativeType&$filter=DerivativeType/Title eq '" + det.DerivativeType + "'";
        
        var ScenarioConfig = GetListData($scope.DerivativesScenarioConfigList, filter);
        if(ScenarioConfig.length == 1){
            ScenarioConfig = ScenarioConfig[0]
        }


        if(ScenarioConfig.COne){

            //ScenarioConfig.Rates =  ScenarioReplace(ScenarioConfig.Rates, dataArr)
            ScenarioConfig.COne =  ScenarioReplace(ScenarioConfig.COne, dataArr)
            ScenarioConfig.CTwo =  ScenarioReplace(ScenarioConfig.CTwo, dataArr)
            ScenarioConfig.CThree =  ScenarioReplace(ScenarioConfig.CThree, dataArr)
            ScenarioConfig.CFour =  ScenarioReplace(ScenarioConfig.CFour, dataArr)
            ScenarioConfig.CFive =  ScenarioReplace(ScenarioConfig.CFive, dataArr)
            ScenarioConfig.CSix =  ScenarioReplace(ScenarioConfig.CSix, dataArr)
            ScenarioConfig.CSeven =  ScenarioReplace(ScenarioConfig.CSeven, dataArr)
            
            //ScenarioConfig.COne
            $scope.SheetItem.ColHead1 = ScenarioConfig.COne.TitleTemplate;
            $scope.SheetItem.ColHead2 = ScenarioConfig.CTwo.TitleTemplate;
            $scope.SheetItem.ColHead3 = ScenarioConfig.CThree.TitleTemplate;
            $scope.SheetItem.ColHead4 = ScenarioConfig.CFour.TitleTemplate;
            $scope.SheetItem.ColHead5 = ScenarioConfig.CFive.TitleTemplate;
            $scope.SheetItem.ColHead6 = ScenarioConfig.CSix.TitleTemplate;
            $scope.SheetItem.ColHead7 = ScenarioConfig.CSeven.TitleTemplate;
            //$scope.SheetItem.ColHead2 = `Floating Rate 1 = Min {Max [${dateStr}, ${det.OfferedRate}%], ${det.OfferedRate2}%}`;
            //$scope.SheetItem.ColHead3 = ScenarioConfig.CTwo.TitleTemplate;
            // $scope.SheetItem.ColHead4 = `Floating Rate 2 = ${dateStr} +  ${ det.TenorLP}`;

            //ScenarioConfig.Rates = ".5,1,2,3,4,5,6,7";
            var scenarioRates = ScenarioConfig.Rates.split(',')

            //var scenarioRates = [0.5, 1, 2, 3, 4, 5, 6, 7];
            $scope.SheetItem.Scenarios = [];
            scenarioRates.forEach( (rateStr) => {

                var rate = 0;
                try{
                    rate = parseFloat(rateStr);
                }
                catch(ex){
                    alert("Invalid rate "  + rateStr);
                    return;
                }
                
                //ScenarioConfig
                //##days## 
                //##col2##
                //scenario.col1 = rate;    
                var rateDataArr = [];
                rateDataArr.push({title : '##Rate##', value : rate });

                var scenario = {};
                scenario.col1  = eval(ScenarioFormulaReplace(ScenarioConfig.COne.Formula, rateDataArr)) ;             
                rateDataArr.push({title : '##col1##', value : scenario.col1 });

                scenario.col2  = eval(ScenarioFormulaReplace(ScenarioConfig.CTwo.Formula, rateDataArr)) ;
                rateDataArr.push({title : '##col2##', value : scenario.col2 });

                // var v = ScenarioFormulaReplace(ScenarioConfig.CThree.Formula, rateDataArr);
                // var v1 = eval(v);

                scenario.col3  = eval(ScenarioFormulaReplace(ScenarioConfig.CThree.Formula, rateDataArr)) ;
                rateDataArr.push({title : '##col3##', value : scenario.col3 });

                scenario.col4  = eval(ScenarioFormulaReplace(ScenarioConfig.CFour.Formula, rateDataArr)) ;
                rateDataArr.push({title : '##col4##', value : scenario.col4 });

                scenario.col5  = eval(ScenarioFormulaReplace(ScenarioConfig.CFive.Formula, rateDataArr)) ;
                rateDataArr.push({title : '##col5##', value : scenario.col5 });

                scenario.col6  = eval(ScenarioFormulaReplace(ScenarioConfig.CSix.Formula, rateDataArr)) ;
                rateDataArr.push({title : '##col6##', value : scenario.col6 });

                scenario.col7  = eval(ScenarioFormulaReplace(ScenarioConfig.CSeven.Formula, rateDataArr)) ;
                rateDataArr.push({title : '##col7##', value : scenario.col7 });  
                
                $scope.SheetItem.Scenarios.push(scenario);

                //no if days 
                //OfferedRate2 - Cap
                //OfferedRate - Floor 
                // scenario.col2 = Math.min(det.OfferedRate2 , Math.max(det.OfferedRate, rate) );

                // scenario.col3 =  (det.Amount * (scenario.col2/100) * days) /360 
                // scenario.col4 = scenario.col1 + det.TenorLP;
                // scenario.col5 = det.Amount * (scenario.col4/100) * days /360 
                // scenario.col6 = scenario.col5 * -1  
                // scenario.col7 = scenario.col3 
                // 
            })
        }

        



        //var ScenarioConfig = GetListData($scope.DerivativesScenarioConfigList, ",DerivativeType/Title&$expand=DerivativeType&$filter=DerivativeType/Title eq '" + det.DerivativeType +"'");


        //SelObj

          //$scope.SheetItem.StartDate = det.StartDate; //"18-Aug-23";
        //$scope.SheetItem.EndDate = det.MaturityDate; //"18-Nov-23";
        
        // var Filter = ",Author/Name,Author/Title,RMName/Name,RMName/Title,CCEmailList/Name,CCEmailList/Id&$expand=Author/Id&$expand=RMName/Id,CCEmailList/Id";
        // Filter += "&$filter=ID eq 1"
        // $scope.SheetItem = GetListData($scope.MasterList, Filter + "&$orderby=ID desc")[0];

        

       

        // $scope.SheetItem.EIBOR = det.//"3M";
        // $scope.SheetItem.EIBOR = det.//"3M";     
        // $scope.SheetItem.TenorLP = det.//1.25;


        // if($scope.selDer){
        //     $scope.SheetItem.OfferedRate = parseFloat($scope.selDer.OfferedRate);
        //     $scope.SheetItem.OfferedRate2 = parseFloat($scope.selDer.OfferedRate2);
        //     $scope.SheetItem.Amount = parseFloat($scope.selDer.Amount);
        // }
        // else{
        //     $scope.SheetItem.OfferedRate2 = 4.5; //Cap
        //     $scope.SheetItem.OfferedRate = 3.5;//Floor
        //     $scope.SheetItem.Amount = 10000000;
        // }               

        
                        
        var dateStr = `${det.Currency} ${GetDateStr(det)} ${det.Benchmark}` 

        
    

       
       




        var template = GetListData($scope.RateSheetTemplate, ",DerivativeType/Title&$expand=DerivativeType&$orderby=Order0 asc&$filter=DerivativeType/Title eq '" + det.DerivativeType +"'");
        var pages = [];
        var page = [];
        var lastRowType = "";
        template.forEach( (t) =>{

            t.firstTableRow = false;

            if(t.RowType === 'New Page'){                
               if(page.length > 0){
                pages.push(page);
               }
               page = [];              
            }
            else{
                if(t.RowType === 'Table Row' && ( lastRowType != 'Table Row' || page.length == 0 ) ){
                    t.firstTableRow = true;
                }
                if( $scope.SelObj){                   
                    t = TempalteDataReplace(t, dataArr);
                }            
                page.push(t);
            }
            lastRowType = t.RowType;                        
        })
        if(page.length > 0){
            pages.push(page);
            page = []; 
        }
        $scope.ReportPages = pages;                        
        $scope.RateSheet = template;

        try{
            $scope.$apply();	
        }catch(err){}
    }

    function TempalteDataReplace(t, dataArr){

      
        //t, dataArr
        dataArr.forEach( (data) => {
            t.ColumnOne =  strReplaceAll(t.ColumnOne, data.title, data.value)
            t.ColumnTwo =  strReplaceAll(t.ColumnTwo, data.title, data.value)
        }); 
        return t;             
    }

    function ScenarioReplace(t, dataArr){ //dataArr, COne, CTwo, CThree, CFour, CFive, CSix, CSeven ){
        
        dataArr.forEach( (data) => {            
            t.TitleTemplate =  strReplaceAll(t.TitleTemplate, data.title, data.value)
            t.Formula =  strReplaceAll(t.Formula, data.title, data.value)
         }); 
        return t;             
    }

    function ScenarioFormulaReplace(t, dataArr){ 
        
        dataArr.forEach( (data) => {            
            var val = "";
            if(data.value ){ //repalce %
                val = data.value.toString().replace(/%+$/, '');               
            }
            t =  strReplaceAll(t, data.title, val)
           
         }); 
        return t;             
    }

    function GetDateStr(t){
        var res = "";
        if(t.Year)
        {		
            res ? res += " " : res;		
            res += "t.Year year"
        }
        if(t.Month)
        {	
            res ? res += " " : res;
            res += "t.Month months"			            
        }
        if(t.Day)
        {	            
            res ? res += " " : res;
            res += "t.Day days"			         
        }			
    }

   

    //End of Common
        
});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\DerivativesInit.js```FileName```// $(document).keyup(function(e) {
//     if (e.keyCode == 27) { // escape key maps to keycode `27`	
//         $('#dialog-overlay, #dialog-box').hide();
//         //  $("#ShowSearchResult").hide();
//         //   $("#CustomerSearchInput").val("");
//     }
// });

function DocCtrlInitOnLoad($scope, cond) {
    
    $scope.StatusSearch = "";
    $scope.SPRefNoSearch = "";
    $scope.NameSearch = "";
    $scope.CIFSearch = "";
    $scope.RequestorSearch = "";
    $scope.SegmentSearch = "";
    $scope.ShowSearchResult = false;
    $scope.PickedUpCount = 0;
    //GetDays(); //JSCommon.js , get days for calender
    //USer
    var userDet = GetCurrentUserID();
    if (userDet) {
        $scope.CurrUserID = userDet.UserID; //User.js
        $scope.CurrUserName = userDet.UserName; //User.js
        $scope.NtId = userDet.NtId; //User.js
    } else {
        alert("Unable to get current user details ");
        return;
    }
    var TRYPermisionsFilter = "Title eq 'TRYDerivativesUsers' and " + "Names/Id eq " + "'" + $scope.CurrUserID + "'";
    $scope.IsTryUser = IsCurrentInUsersList("UserPermissionsList", "Title,Names/Id&$expand=Names/Id", TRYPermisionsFilter); //JSCommon.js
    //---Is ARC User
    var ReadPermisionsFilter = "Title eq 'EIB TRY READ' and " + "Names/Id eq " + "'" + $scope.CurrUserID + "'";
    $scope.IsReadOnlyUser = IsCurrentInUsersList("UserPermissionsList", "Title,Names/Id&$expand=Names/Id", ReadPermisionsFilter); //JSCommon.js
    
    var IsMRUserFilter= "Title eq 'DerivativesMarketRiskUsers' and " + "Names/Id eq " + "'" + $scope.CurrUserID + "'";
		$scope.IsMRUser = IsCurrentInUsersList("UserPermissionsList", "Title,Names/Id&$expand=Names/Id", IsMRUserFilter); //JSCommon.js

	 var IsBMSUserFilter= "Title eq 'DerivativesBMSUsers' and " + "Names/Id eq " + "'" + $scope.CurrUserID + "'";
		$scope.IsBMSUser = IsCurrentInUsersList("UserPermissionsList", "Title,Names/Id&$expand=Names/Id", IsBMSUserFilter); //JSCommon.js

    $scope.SegmentList = GetListItemByList("SegmentList", "Title,Email,ColumnOrder&$orderby=ColumnOrder asc");   
    $scope.FXConfig = GetListItemByList($scope.ConfigList, "Title,Value");
    FXConfig = $scope.FXConfig;   
    $scope.SegmentCond = GetUserInEmailList($scope.SegmentList, $scope.NtId, "Segment");
    $scope.StatusConfigList = GetStatusConfigList($scope.StatusListName);
    $scope.CurrencyDetList = GetListData("T0SmartBusinessCurrency");   
    $scope.TransactionTypeList = GetListData("DerivativesTransactionType");  
    $scope.DerivateTypesList =  GetListItem("DerivativeTypes", "Title");
    $scope.DerivativeTypesList =  GetListItemByList("DerivativeTypes", "Title,Category");  
    $scope.FXCommonMessage = GetConfig($scope.FXConfig, "FXMessage");
    	if($scope.IsTryUser)
		{
			cond = "Pending with TRY";
		}	
		else if($scope.IsMRUser)
		{
			cond = "Pending with Market Risk";
			
			
			//$scope.FXMarginARCPendingCount= "(" + GetListItemsCount("FX Margins and Preferential Rates Fixing","Title","StatusCode eq '13' or StatusCode eq '15' or StatusCode eq '19' or StatusCode eq '20'") + ")";
		
		}
		else if ($scope.IsBMSUser)
		{
			cond = "Pending with BMS";

		}

    DocCtrlInit($scope, cond);
}

function DocCtrlInit($scope, cond) {
    //CacheReloadCheck();
    $scope.PickedUpCount = 0;
    UpdateCurrecnyList($scope);
    $scope.LastDataRefresh = new moment().format("h:mm:ss A");
  /*  if ($scope.IsTryUser) {
        $scope.RFQCount = "FX Deals (" + GetListItemsCount("FXRFQ", "Title", "(StatusCode eq '2' or StatusCode eq '3'  or StatusCode eq '5'   or StatusCode eq '6'   or StatusCode eq '7'  or StatusCode eq '8' or StatusCode eq '21' " +
            " or StatusCode eq '14'  or StatusCode eq '15'  or StatusCode eq '17'  or StatusCode eq '22' or StatusCode eq '24' or StatusCode eq '27' or StatusCode eq '28' or StatusCode eq '29' or StatusCode eq '33' or StatusCode eq '34' )") + ")";
        $scope.FXMarginCount = "FX Margin (" + GetListItemsCount("FX Margins and Preferential Rates Fixing", "Title", "StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '10' or StatusCode eq '20'") + ")";
        $scope.BCRCountPastDue = GetListItemsCount("Pipeline", "Title", "CompletionConversion ne '1' and Status ne 'No Longer required' and Date le '" + new moment().subtract(1, 'days').format('YYYY-MM-DD') + ", 00:00:00'");
        $scope.BCRCount = "Pipeline (" + $scope.BCRCountPastDue + "/" + GetListItemsCount("Pipeline", "Title", "CompletionConversion ne '1' and Status ne 'No Longer required'") + ")";
        $scope.OMSCount = "Investments (" + GetListItemsCount("OMSData", "Title", "SystemStatusCode/OrderStatus eq 'Pending with TRY'", "https://workplace.emiratesislamic.ae/EIWM/oms") + ")";
        $scope.ExCompCount = "ExComp (" + GetListItemsCount("ExchangeCompensation", "Title", "(StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '5' or StatusCode eq '6')") + ")";
        //$(".gray-whitetop").append('<li><a href="/EITRY/SitePages/Business%20Call%20Report.aspx"><span class="tab">' + $scope.BCRCount+ '</a></li>');
    }*/
    if ($scope.IsTryUser || $scope.IsReadOnlyUser)
	{
		$scope.WakalaCount= "Wakala (" + GetListItemsCount("Wakala", "Title", "(StatusCode eq '21' or StatusCode eq '22' or StatusCode eq '23' or StatusCode eq '24' or StatusCode eq '25' )") + ")";
	                
	   	$scope.TTValueDateCount= "TT ValueDate (" + GetListItemsCount("TTValueDateAmendment","Title","StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7'") + ")";
		
    	$scope.TZeroCount="T+0 SB (" + GetListItemsCount($scope.MasterList, "Title", "(StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7')") + ")";
 		$scope.CashflowCount="Cashflow (" + GetListItemsCount("CashflowList", "Title", "(StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7')") + ")";
 		
    }

    var Filter = ",Author/Name,Author/Title,RMName/Name,RMName/Title,CCEmailList/Name,CCEmailList/Id&$expand=Author/Id&$expand=RMName/Id,CCEmailList/Id";
    if (cond == "My Requests") {
	    cond = "My Requests";
	    Filter += "&$filter=Author eq " + $scope.CurrUserID;
    } else if ($scope.IsTryUser || $scope.IsReadOnlyUser) {
        if (cond == "Requests In Progress") {
        	cond == "Requests In Progress"
            Filter += "&$filter=(StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '13')";
        } else if (cond == "All Requests") {
            cond = "All Requests";
        } else if (cond == "Pending with EI Market Risk") {
        cond = "Pending with EI Market Risk";
		Filter += "&$filter= (StatusCode eq '4' or StatusCode eq '7' or StatusCode eq '9' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '16' or StatusCode eq '20' or StatusCode eq '20' or StatusCode eq '29' or StatusCode eq '35') ";
        }
        else if (cond == "Pending with BMS") {
        cond = "Pending with BMS";
		Filter += "&$filter= (StatusCode eq '30' or StatusCode eq '36' or StatusCode eq '40') ";
        }
        else {
            cond = "Pending with TRY";
            Filter += "&$filter= (StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '10' or StatusCode eq '11' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '19' or StatusCode eq '22' or StatusCode eq '23' or StatusCode eq '25' or StatusCode eq '26' or StatusCode eq '27') ";
        }
    } else if ($scope.IsMRUser) {
        if (cond == "Requests In Progress") {
        	cond == "Requests In Progress"
            Filter += "&$filter=(StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7')";
        } else if (cond == "All Requests") {
            cond = "All Requests";
        } 
        else if(cond == "Pending with TRY") {
            cond = "Pending with TRY";
            Filter += "&$filter= (StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '10' or StatusCode eq '11' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '19' or StatusCode eq '23'  or StatusCode eq '25' or StatusCode eq '26' or StatusCode eq '27') ";
        }
        else if (cond == "Pending with BMS") {
        cond = "Pending with BMS";
		Filter += "&$filter= (StatusCode eq '30' or StatusCode eq '36' or StatusCode eq '40') ";
        }
        else  {
        cond = "Pending with EI Market Risk";
		Filter += "&$filter= (StatusCode eq '4' or StatusCode eq '7' or StatusCode eq '9' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '16' or StatusCode eq '20'  or StatusCode eq '29' or StatusCode eq '35') ";
        }
        
    }    
    else if ($scope.IsBMSUser) {
        if (cond == "Requests In Progress") {
        	cond == "Requests In Progress"
            Filter += "&$filter=(StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7')";
        } else if (cond == "All Requests") {
            cond = "All Requests";
        } 
        else if(cond == "Pending with TRY") {
            cond = "Pending with TRY";
            Filter += "&$filter= (StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '10' or StatusCode eq '11' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '19' or StatusCode eq '23'  or StatusCode eq '25' or StatusCode eq '26' or StatusCode eq '27') ";
        }
        else if  (cond == "Pending with EI Market Risk") {
        cond = "Pending with EI Market Risk";
		Filter += "&$filter= (StatusCode eq '4' or StatusCode eq '7' or StatusCode eq '9' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '16' or StatusCode eq '20'  or StatusCode eq '29' or StatusCode eq '35') ";
        }
        else {
        cond = "Pending with BMS";
		Filter += "&$filter= (StatusCode eq '30' or StatusCode eq '36' or StatusCode eq '40') ";
        }
        
        
    } 
    else {
        if (cond == "Requests In Progress") {
            cond = "Requests In Progress";
            Filter += "&$filter=(Author/Id eq " + $scope.CurrUserID + " or RMName/Id eq " + $scope.CurrUserID + "  or CCEmailList/Id eq " + $scope.CurrUserID + $scope.SegmentCond + ")" 
            + " and (StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '13' )";           
        } 
        else if (cond == "All Requests") {
            cond = "All Requests";            
        	Filter += "&$filter=Author/Id eq " + $scope.CurrUserID + " or RMName/Id eq " + $scope.CurrUserID + "  or CCEmailList/Id eq " + $scope.CurrUserID + $scope.SegmentCond;
        }
        else if (cond == "Pending with TRY") {
            cond = "Pending with TRY";
        	 var cond1 = "Author/Id eq " + $scope.CurrUserID + " or RMName/Id eq " + $scope.CurrUserID + $scope.CurrUserID + 
                "  or CCEmailList/Id eq " + $scope.CurrUserID + $scope.SegmentCond;
            	Filter += "&$filter= ((StatusCode eq '2' or StatusCode eq '3' or StatusCode eq '6' or StatusCode eq '7' or StatusCode eq '10' or StatusCode eq '11' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '19' or StatusCode eq '23'  or StatusCode eq '25' or StatusCode eq '26' or StatusCode eq '27' ) and " +
                "( " + cond1 + " ) ) ";           
        } 
        else if (cond == "Pending with EI Market Risk") {
            cond = "Pending with EI Market Risk";
        	 var cond1 = "Author/Id eq " + $scope.CurrUserID + " or RMName/Id eq " + $scope.CurrUserID + $scope.CurrUserID + 
                "  or CCEmailList/Id eq " + $scope.CurrUserID + $scope.SegmentCond;
            	Filter += "&$filter= ((StatusCode eq '4' or StatusCode eq '9' or StatusCode eq '13' or StatusCode eq '14' or StatusCode eq '17' or StatusCode eq '16' or StatusCode eq '20'  or StatusCode eq '29' or StatusCode eq '35') and " +
                "( " + cond1 + " ) ) ";           
        } 
         else if (cond == "Pending with BMS") {
            cond = "Pending with BMS";
        	 var cond1 = "Author/Id eq " + $scope.CurrUserID + " or RMName/Id eq " + $scope.CurrUserID + $scope.CurrUserID + 
                "  or CCEmailList/Id eq " + $scope.CurrUserID + $scope.SegmentCond;
            	Filter += "&$filter= ((StatusCode eq '30' or StatusCode eq '36' or StatusCode eq '40' ) and " +
                "( " + cond1 + " ) ) ";           
        } 


        else
        {	   
        		cond = "My Requests";   
        	   Filter += "&$filter=Author eq " + $scope.CurrUserID;

        }   
    }    
    $scope.SearchCond = cond;
    $scope.StatusList = [];
    $scope.FXList = GetListData($scope.MasterList, Filter + "&$orderby=ID desc");
    $.each($scope.FXList, function(key, FxObj) {
        if ($.inArray(FxObj.StatusCode, $scope.StatusList) == -1) {
            $scope.StatusList.push(FxObj.StatusCode);
        }
        if (FxObj.PickedUpDelearId == $scope.CurrUserID) {
            $scope.PickedUpCount++;
            FxObj.MyPickedTask = true;
        } else {
            FxObj.MyPickedTask = false;
        }
        FxObj.ShowDet = false;
        if (FxObj.StatusCode == "2"  || FxObj.StatusCode == "6") {
            FxObj.Color = "#EECD86";
        } else {
            switch (FxObj.StatusCode) { 
            	case 3: FxObj.Color ="#ffb0b0"; break;  
            	case 4: FxObj.Color = "#a2f9f4"; break;              
            	case 5:FxObj.Color = "#f96e6e"; break;
            	case 6: FxObj.Color = "#ebd01d"; break; 
                case 7: FxObj.Color ="#ffb0b0"; break;                    
                case 8: FxObj.Color = "#e9a78f"; break;
                case 9: FxObj.Color ="#c3d6f3"; break;
                case 10:FxObj.Color = "#7ac17a"; break;
                case 11: FxObj.Color = "#f9b59d"; break;
                case 11: FxObj.Color = "#f9b59d";break;
                case 12: FxObj.Color = "#f3c389"; break;
                case 13: FxObj.Color = "#f5b0cd"; break; 
                case 14: FxObj.Color = "#c4b0b8"; break; 
                case 16: FxObj.Color ="#e8d3f1"; break;  
                case 17: FxObj.Color ="#e8d3f1"; break; 
                case 25: FxObj.Color ="#a5fbc2"; break; 
                case 30: FxObj.Color = "#3db94a"; break;
                default: FxObj.Color = "#EEDB00"; break;
            }
        }
    });

    $scope.DerivativesRFQ = GetListData($scope.MasterList, "&$filter=(StatusCode eq '12') and Created lt '" + new moment().subtract(24, 'hours').format('YYYY-MM-DD HH:mm:ss') + "'" ,$scope.RFQLists);
    if ($scope.IsTryUser && $scope.DerivativesRFQ.length>0 && $scope.DerivativesRFQ[0].Title != null) {
        for(i=0;i<$scope.DerivativesRFQ.length;i++)
        {
            if($scope.DerivativesRFQ[i].ID)
            {
                var valuepairs = [[ "StatusCode", 42 ],[ "OldStatusCode", $scope.DerivativesRFQ[i].StatusCode ]];   
                UpdateField($scope.MasterList, $scope.DerivativesRFQ[i].ID, valuepairs);
            }
        }
    }
    
    $("#MainDIV").removeClass("Hide");
}

function CacheReloadCheck() {
    //debugger;
    //console.log('CacheReloadCheck : one');
    //FXConfig = GetListData("FXConfig", "" );
    FXConfig = GetListItemByList("LostDealsConfig", "*");
    var FXRefreshCounter = GetConfig(FXConfig, "RefreshCounter");
    var LocCounter = localStorage.getItem("LostDealsRefreshCounter");
    if (FXRefreshCounter != LocCounter) {
        localStorage.setItem("LostDealsRefreshCounter", FXRefreshCounter);
        location.reload(true);
    }
}```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\Details.html```FileName```<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" x-undefined="" />
<title>Untitled 1</title>
</head>

<body>

</body>

</html>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\Listing.html```FileName```
<!-- <script src="../SiteAssets/TryUtilUAT/Proj/Derivarives/DerivativesInit.js"></script> -->

<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-12 main-header-title" >Derivatives RFQ<span style="color:red;font-weight:bold"> UAT</span></div>					
	</div>
	
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/QButtons.html'" style="width:100%" ></div>
		
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/ListingTable.html'" style="width:100%" ></div>


	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/ReqModel.html'" style="width:100%" ></div>
	
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\ListingTable.html```FileName```<div class="row main-data" style="width:100%" >
    <div class="panel-body" style="width:100%">
        <div id="divDataTable" style="width:100%">
            <table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="second-ListTable" style="width:100%">
                <thead>
                   <tr>					
                       <th class="hide">ID</th>
                       <th style="width:150px" >Status</th>	
                       <th style="width:150px">SharePoint Ref. No</th>
					   <th style="width:250px" >Account Title</th>
					   <th style="width:100px" >CCY & Amount</th>
					   <th style="width:100px" >Segment</th>
					   <th style="width:200px" >Requestor</th>
					   <th style="width:80px" >Request Date</th>
					   								
                   </tr>
               </thead>
               <tfoot class="ttcpFooter">
                   <tr class="ttcpFtrTrCompleted">	
						<th class="hide">ID</th>
						<th style="width:120px" >Status</th>	
						<th style="width:150px">SharePoint Ref. No</th>
						<th style="width:250px" >Account Title</th>
						<th style="width:100px" >CCY & Amount</th>
						<th style="width:100px" >Segment</th>
						<th style="width:200px" >Requestor</th>
						<th style="width:80px" >Request Date</th>						
                   </tr>
               </tfoot>
               <tbody>									
                   <tr ng-repeat="o in FXList" ng-class-odd="'alloTableOdd'" 
				   	ng-class-even="'alloTableEven'" ng-click="OnItemClick(o, $index)" >	
                       <td class="hide">{{o.ID}}</td>	                       	            						
                       <td  ng-style="{'background-color': o.Color }" >{{StatusConfigList[o.StatusCode]}}</td>	
					   <td>{{o.SPRefNo}}</td>
					   <td>{{o.AccountTitle}}</td>
					   <td>{{o.CCY}} {{o.Amount}}</td>
					   <td>{{o.SegmentName}}</td>
					   <td>{{o.Author.Title}}</td>
					   <td data-order="{{DateSer(o.Created)}}"  >{{o.Created | date : "dd-MMM-yyyy"}}</td>		
                   </tr>				 	  
               </tbody>
           </table>			
        </div>
    </div>	
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\QButtons.html```FileName```
<div  class="row content  divPnlButton">
	<div class="col-md-10">
				
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="NewRFQ()" >
			<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Submit new Request
		</button>
										
					
		
		<!-- 
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-If="IsMRUser || IsReadOnlyUser"
			 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Pending with TRY')" >
			Pending with TRY{{PendingWithTRYCount}}
		</button> -->

		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
			 ng-click="listCtrlOnLoad('My Requests')" ng-class="GetButtonClass('My Requests')" >
			My Requests{{MyRequestsCount}}
		</button>
		
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
			 ng-click="listCtrlOnLoad('All Requests')"  ng-class="GetButtonClass('All Requests')" >
			All Requests{{AllRequestsCount}}
		</button>

	</div>
	
	<div class="col-md-2">								
			
		
        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
        	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
        </button>
        
		 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="listCtrlOnLoad(QuqueTitle)" title="Refresh">
            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
         </button>	
         
		<!--button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
        </button-->            				
	</div>	


</div-->```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\RateSheet.html```FileName```<style>
    .PrintDiv{
        page-break-inside:avoid;
        /* page-break-after: always; */
    }
    .reportPage{
        width: 100%  !important;
        height: 1000px !important;
        padding: 5px;
        margin: 5px ;
        /* border: 1px #D3D3D3 solid; */
        border-radius: 5px;
        background: white;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        /* page-break-after: always; */
    }
    .reportTableLeft{
        padding: 2px;margin:0px;

        border-left:1px black solid;
        border-right:1px black solid;
        border-bottom:1px black solid;
        
    }
    .reportTableLeftFirst{
        padding: 0px;margin:0px;
        border:1px black solid;        
    }

    .reportTableRight{
        padding: 2px;margin:0px;
        border-right:1px black solid;
        border-bottom:1px black solid; 
        border-left:0px;      
    }   
    .reportTableRightFirst{
        border-top:1px black solid;
        padding: 0px;margin:0px;
        border-right:1px black solid;
        border-top:1px black solid;        
    }

    .footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        background-color: red;
        color: white;
        text-align: center;
    }

    .bottom_link{
        position:absolute;                  /* added */
        bottom:0;                           /* added */
        left:0;                           /* added */
    }

</style>

<div>
    <button type="button" class="btn EI-ButtonPurple" ng-click="PDFReport()" > 
        Generate PDF
    </button>

    <a ng-if="selDer.PdfPath" href="{{selDer.PdfPath}}" target="_blank" style="margin-left:20px">{{GetFileName(selDer.PdfPath)}}</a>

    <!-- <button type="button" class="btn EI-ButtonPurple" ng-click="jspdfReport()" >
        jspdf
    </button> -->
</div>

<br/><hr/>

<div style="margin:50px;margin: auto;">

    <div id="divReport" style="width: 700px  !important;margin: 0px auto">

       

        <!-- -->

        <div  ng-class="{'beforeClass': $index != 0 }" class=" row "  ng-repeat="pages in ReportPages">

            <div class="reportPage " >   

                <div class="row" >
                    <div  class="col-md-7"></div>
                    <div  class="col-md-4 " style="margin-right:10px ;font-family: Arial, Helvetica, sans-serif;font-size: 10px">
                        <div class="pull-right ">
                            <img style="width:140px;height:40px ;" id="imgEnbdLogo2" src="../../../EITRY/FX/SiteAssets/TryUtil/img/Emirates-Islamic.jpg"  />
                            <div>Emirates Islamic Bank</div>
                            <div>Treasury and Markets</div>
                            <div>+971 (0) 4 4152333</div>
                        </div>                        
                    </div>
                </div>
                                                         
                <div class="row"  ng-repeat="page in pages" style="padding: 0px;margin:0px 10px">
                                
                    <div  ng-if="page.RowType == 'Text' "  class=" col-md-12 " contenteditable="true" 
                        ng-bind-html="page.ColumnOne | html" id="ColumnOne"
                        style="padding: 0px">
                    </div>  

                    <div ng-if="page.RowType == 'Table Row' " ng-class="{'reportTableLeftFirst': page.firstTableRow}" class=" reportTableLeft col-md-4  " contenteditable="true"
                        ng-bind-html="page.ColumnOne | html" id="ColumnOne" >
                    </div>
                    <div ng-if="page.RowType == 'Table Row' "  ng-class="{'reportTableRightFirst': page.firstTableRow }" class=" reportTableRight col-md-8 " contenteditable="true"
                        ng-bind-html="page.ColumnTwo | html" id="ColumnTwo">
                    </div> 

                    <div  ng-if="page.RowType == 'Scenario Analysis' "  class=" col-md-12 " >
                        <div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/Scenario.html'" style="width:100%" ></div>
                    </div>

                    <!-- <div  ng-if="page.RowType == 'New Page' && $index != 0 "  class=" col-md-12 beforeClass" style="height: 10px;color: red;" > 
                        new page
                    </div> -->
                    
                    
                </div>                
            </div>

            <!-- <div class="row ">
                <div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/Scenario.html'" style="width:100%" ></div>
            </div> -->
            
        </div>
    </div>        
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\ReqModel.html```FileName```<div id="divOverlay" style="display:none;">
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<!-- Manage Request Modal Modal -->
<div id="ReqDetailsModal" class="modal fade" role="dialog" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
           <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title"><span id="modalManageReportHeading"></span>Derivatives RFQ Request</h4>
        <span class="hide" id="spRequestItemId"></span>
        <span class="hide" id="spRequestTenorText"></span>
      </div>
      <!-- End Modal content-->

      <div class="modal-body">
          <div class="panel panel-default" style="margin-bottom: 5px;">
            <div class="panel-body">
                <div class="alert alert-danger saveQueryAlert hide">
                </div>

                <!-- <div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/RateSheet.html'" ></div> -->
                
                

                <ul class="nav nav-tabs ReqDetailsTab" style="font-size:14px">
                  <li class="active"><a  target="_self" data-toggle="tab" href="#RequestDetailsTab">Request Details</a></li>                      
                  <li ><a target="_self" data-toggle="tab" href="#RateSheetTab" id="RateSheetTabButton">Term Sheet</a></li>                                        
                </ul>

                <div class="tab-content">

                  <div id="RequestDetailsTab" class="tab-pane fade in active" style="padding:2px">
                    <div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/RequestDetails.html'" style="width:100%" ></div>
                  </div>

                  <div id="RateSheetTab" class="tab-pane fade padd15">                                      
                    <div class="detailsPannel"  style="padding:2px">                              		
                      <div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/RateSheet.html'" ></div>
                    </div>                          
                  </div>

                </div>

            </div>
          </div>
      </div>
    </div>
  </div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\RequestDetails.html```FileName```<style>

    td.TDCap {
        background:#f1f1f1;/*#f1f1f1;	*/
        height:20px;
        padding-top:3px;
        padding-left:3px;
        width:150px;
        border-bottom:1px white solid;
        font-weight:bold;
        color:black
    }
    td.TDVal{
        width:500px;
        height:17px;
        background:white;
        padding:3px;
        color:black;
        font-weight:bold;
        /*background:#F9F9F9;*/
        border-bottom:1px white solid;
    }

    .Required:after { content:"*"; color: Red;  }

    div.DivCap{
        float:left;
        background:#CCFFCC;	
        height:20px;
        padding-top:6px;
        padding-left:3px;
        width:150px;
        font-weight:bold;
        color:black
    }
    div.DivVal{
        float:left;
        height:17px;
        background:white;
        padding-top:3px;
        color:black;
        font-weight:bold;
        background:#F9F9F9;
        padding-left:10px;
        
    }

    div.DivCol {
        float:left;
        background:#CCFFCC;	
        height:17px;
        padding-top:3px;
        padding-left:3px;	
    }

    DIV.BlankRow {
        clear: both; margin: 0; padding: 0; width: auto;
        border-bottom:4px white solid
    }

    .EIButtonStyle {
        text-align: center;
        border-radius: 8px;
        padding: 7px 8px !important;
        border: 0pt solid #f2f2f2;
        margin: 0px;
        font-size: 9pt;
        height: 27px;
        font-family: Roboto !important;   
        font-weight: bold;
        color: white !important;
        background-color: #441D61;
        box-sizing: border-box;
        vertical-align: text-bottom;
        white-space: nowrap;
        word-wrap: break-word;
        border-collapse: collapse;
        direction: ltr;
        text-align: default;
        vertical-align: middle;
        cursor: pointer;
        float:	left;
        margin-left:0px;
        margin-right:10px;
        box-shadow: 
            0 1px 2px #fff, /*bottom external highlight*/
            0 -1px 1px #666, /*top external shadow*/ 
            inset 0 -1px 1px rgba(0,0,0,0.5), /*bottom internal shadow*/ 
            inset 0 1px 1px rgba(255,255,255,0.8); /*top internal highlight*/
    }


</style>

<div style="font-family:Roboto , Helvetica, sans-serif !important;font-size:13px;background:white" id="RequestDetailsDIV" >		
	<div style="width:100%;">
		<table style="width:100%" >
			<!-- <tr>
				<td colspan="2" style="font-weight:bold;text-align:center;color:#fff;background:hsla(274, 54%, 25%, 0.66);border-top: solid 1px #FFF;border-bottom: double 3px #FFF;">
					<div style="float:left;padding-top:5px;padding-left:5px;font-size:14px;padding-bottom:3px">Derivatives RFQ Request</div>
					<div style="float:right;padding:3px;">
						<img src="/EITRY/FX/SiteAssets/images/CloseButton.png" ng-click="OnItemClose()" style="width:20px;height:20px">						
					</div>					
				</td>
			</tr>  -->
			<tr>
				<td class="TDCap" style="width:250px" >Status</td>
				<td class="TDVal">
					{{SelObj.Status}}					
				</td>
			</tr>
			<tr ng-show="SelObj.SPRefNo">
				<td class="TDCap" >SharePoint Ref. No</td>
				<td class="TDVal">
					{{SelObj.SPRefNo}}
				</td>
			</tr>
			
			<tr>
				<td class="TDCap Required" >Account Title</td>
				<td class="TDVal">
					<input ng-disabled="SelObj.ed" id="ClientName" type="text" ng-model="SelObj.AccountTitle" ng-disabled="false" style="width:300px">
				</td>
			</tr>
			<tr>
				<td class="TDCap Required">CIF</td>
				<td class="TDVal">
					<input ng-disabled="SelObj.ed" type="text" only-Digitsnodec ng-model="SelObj.Title" style="width:230px" maxlength="8"	>					
				</td>
			</tr>			
			<tr>
				<td class="TDCap Required">Segment Name</td>
				<td class="TDVal">
					<div style="float:left">
						<select ng-disabled="SelObj.ed" ng-show="!SelObj.ed" ng-model="SelObj.SegmentName"  style="height:23px;" 	>
							<option ng-repeat="s  in SegmentList" ng-if="s.Title!='Staff' && s.Title!='Personal Banking' && s.Title!='Advantage Banking'">{{s.Title}}</option>
						</select>
						<input type="text" ng-disabled="SelObj.ed" style="width: 300px;" ng-show="SelObj.ed" ng-model="SelObj.SegmentName">
					</div>
				</td>
			</tr>	
			<tr>
				<td class="TDCap Required" >Derivative Category</td>
				<td class="TDVal" >				
					<div style="float:left">
						<div class="radio" style="float:left;margin-top:0px;margin-left:5px; margin-bottom:0px">
				        <label>
				            <input  ng-disabled="SelObj.ed" ng-model="SelObj.DerivativeCategory" type="radio" name="rdoLoss" ng-value="'Asset'">
				              Asset
				        </label>
				    </div>
				    <div class="radio" style="float:left;margin-top:0px;margin-left:15px;margin-bottom:0px">
				        <label>
				            <input ng-disabled="SelObj.ed" ng-model="SelObj.DerivativeCategory" type="radio" name="rdoLoss" ng-value="'Liability'">
				              Liability
				        </label>
				    </div>
					</div>
				</td>
			</tr>
				<tr>
                <td class="TDCap Required">Derivative Transaction Type</td>
                <td class="TDVal">
                    <div style="float:left">
                        <select ng-disabled="SelObj.ed" ng-model="SelObj.TransactionType" ng-show="!SelObj.ed" style="width:300px; height:23px" ng-change="OnTTcChange()">
							<option ng-repeat="t in filtered = (DerivativeTypesList | filter: {Category : SelObj.DerivativeCategory })">{{t.Title}}</option>
						</select>
                        <input type="text" ng-disabled="SelObj.ed" style="width: 300px;" ng-show="SelObj.ed" ng-model="SelObj.TransactionType">
                    </div>
                </td>
            </tr>
			<tr ng-show="SelObj.DerivativeCategory == 'Asset'">
				<td class="TDCap Required">Client Internal Rating</td>
				<td class="TDVal">
					<input type="text" ng-disabled="SelObj.ed" style="width: 300px;"  ng-model="SelObj.ClientInternalRating">
					
				</td>
			</tr>					
			<tr ng-show="SelObj.DerivativeCategory == 'Asset'">
				<td class="TDCap Required">Facility Status</td>
				<td class="TDVal">
					<select ng-disabled="SelObj.ed" ng-model="SelObj.FacilityStatus" style="width:300px; height:23px" ng-change="OnTTcChange()">
							<option>Existing with EI</option>
							<option>New Facility</option>
							<option>Other Bank Financing</option>
					</select>
					
				</td>
			</tr>
			<tr ng-show="SelObj.DerivativeCategory == 'Asset' && SelObj.FacilityStatus=='Existing with EI'">
				<td class="TDCap Required">Facility Reference No</td>
				<td class="TDVal">
					<input type="text" ng-disabled="SelObj.ed" style="width: 300px;" ng-model="SelObj.FacilityRefNo">					
				</td>
			</tr>			
			<tr>
                <td class="TDCap Required">CCY & Amount</td>
                <td class="TDVal">
                    <div>
                        <div style="float:left">
                            <select ng-disabled="SelObj.ed" ng-model="SelObj.CCY" ng-show="!SelObj.ed" style="width:60px">
								<option ng-repeat="c in Currencylist ">{{c.CurrencyCode}}</option>
							</select>
                            <input type="text" ng-disabled="SelObj.ed" style="width:60px" ng-show="SelObj.ed" ng-model="SelObj.CCY">
                        </div>
                        <div class="DivCol" style="width:80px;border-left:10px white solid;;border-right:3px white solid;background:#f1f1f1" >Amount</div>
                        <div style="float:left;width:150px">
                            <input ng-disabled="SelObj.ed"  type="text" ng-model="SelObj.Amount" id="AmountBought" 
							style="width:144px" valid-number currencyfield="CurrencyBought" ng-change="AmountOnChange()" >
                        </div>
                    </div>
                </td>
            </tr> 
            <tr>
				<td class="TDCap Required">Tenor</td>
				<td class="TDVal">
					<input type="text" ng-disabled="SelObj.ed" style="width: 300px;"  ng-model="SelObj.Tenor">
					
				</td>
			</tr>
			<tr ng-show="SelObj.DerivativeCategory == 'Asset'">
				<td class="TDCap Required">Facility Pricing (Margin+Underlying Benchmark Rate)</td>
				<td class="TDVal">
					<input type="text" ng-disabled="SelObj.ed" style="width: 300px;"  ng-model="SelObj.FacilityPricing">					
				</td>
			</tr>		   
			<tr ng-show="SelObj.DerivativeCategory == 'Asset'">
				<td class="TDCap Required">Amortization/Cashflows</td>
				<td class="TDVal">				
					<input type="file" id="ctlFileAttachment" ng-hide="SelObj.ed" />
					<span ng-repeat="url  in Attachments"><a target="_blank" ng-href="{{url}}">{{url.substring(url.lastIndexOf('/')+1) | decodeURIComponent}}</a>
					<br></span>

				</td>
			</tr>
            <tr>
				<td class="TDCap Required">RM Name</td>
				<td class="TDVal">				
					<div ng-hide="SelObj.ed" id="RMName"></div>
                    <div ng-show="SelObj.ed" ng-repeat="rm in SelObj.RMName.results" style="float:left;border-right:1px silver solid;padding-left:7px;padding-right:7px">{{rm.Title}}</div>
                    <div class="Comment" ng-hide="SelObj.ed">Max 4 users</div>					
				</td>
			</tr>	
			
			<tr>
				<td class="TDCap">RM Contact Number</td>
				<td class="TDVal">
					<input ng-disabled="SelObj.ed" type="text" ng-model="SelObj.RMContactNumber" style="width:300px">
				</td>
			</tr>	
			<tr>
				<td class="TDCap">CC Email</td>
				<td class="TDVal">
					<div id="CCEmail"></div>
					<div class="Comment" ng-hide="SelObj.ed">Max 4 users</div>
				</td>
			</tr>     
			 <tr>
                    <td class="TDCap">Requestor Comment</td> 
                    <td class="TDVal">
                        <textarea ng-disabled="SelObj.ed" ng-model="SelObj.RequestorComments" ng-disabled="false" style="width:365px"></textarea>
                    </td>
            </tr>
            
            
			
             <tr ng-show="SelObj.StatusCode != 1"> 
                    <td colspan="2" style="font-weight:bold;text-align:center;color:#fff;background:hsla(274, 54%, 25%, 0.66)">For TRY/EI Risk Use Only</td>
             </tr>
             <tr ng-show="SelObj.StatusCode != 1">
            	<td class="TDCap">Derivative</td>
            	<td><span style="color:blue">The PFE limit advised by Market Risk is without MTM buffer</span></td>
            </tr>  
             <tr ng-show="SelObj.StatusCode != 1 || IsTryUser">
            	
            	<td class="TDVal" colspan="2"><div style="background:white" ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/CCYAmount.html'"></div></td>
             </tr> 
             <tr>
             
             
            <tr ng-show="IsTryUser || IsMRUser">
            	<td class="TDCap">TRY Attachment</td>
				<td class="TDVal">
					<input type="file" id="ctlTRYFileAttachment" ng-show="SelObj.StatusCode == 3 || SelObj.StatusCode == 7" />
					<span ng-repeat="url  in TRYAttachments"><a target="_blank" ng-href="{{url}}">{{url.substring(url.lastIndexOf('/')+1) | decodeURIComponent}}</a>
					<br></span>
				</td>
            </tr>
            <tr ng-show="SelObj.StatusCode != 1">
				<td class="TDCap">TRY Comments</td>
				<td class="TDVal">
					<textarea ng-model="SelObj.TRYComments" ng-disabled="SelObj.edd" style="width:365px;height:80px" maxlength="300" ></textarea>					
			</td>
			<tr style="display:none" >
                    <td colspan="2" style="font-weight:bold;background:#0c95c0;text-align:center;color:white">For EI Market Risk Use Only</td>
             </tr>
			<tr  ng-show="SelObj.StatusCode != 1">
				<td class="TDCap">EI Market Risk Comments</td>
				<td class="TDVal">
					<textarea ng-model="SelObj.EIMarketRiskComments" ng-disabled="SelObj.edarc" style="width:365px;height:80px" maxlength="300" ></textarea>					
			</td>
			<tr  ng-show="SelObj.StatusCode >29">
				<td class="TDCap">BMS Comments</td>
				<td class="TDVal">
					<textarea ng-model="SelObj.BMSComments" ng-disabled="SelObj.edbms" style="width:365px;height:80px" maxlength="300" ></textarea>					
			</td>
			
			  <tr ng-show="SelObj.StatusCode >24"> 
                    <td colspan="2" style="font-weight:bold;text-align:center;color:#fff;background:hsla(274, 54%, 25%, 0.66)">Customer Appropriateness & Suitability Questionnaire  </td>
             </tr>
             <tr ng-show="SelObj.StatusCode >24">
             		<td class="TDCap">Upload Customer Appropriateness & Suitability Questionnaire<br/>
             			<a href="https://workplace.emiratesislamic.ae/EITRY/FX/Documents/AandSUpdateFinal.xlsx" >Download Template</a>
             					</td>
             	<td class="TDCap" >
             		<input type="file" id="file" accept=".xlsx" ng-disabled="SelObj.edcif" ng-model="csvFile" style="float:left; width:300px" />
             		<span ng-show="SelObj.ASFilePath">
             		<a href="{{SelObj.ASFilePath}}">Click to view/download latest A & S File</a></span>

			 	</td>
             </tr>
        		
		</table>
				
	</div>	
</div>

<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/Buttons.html'" ></div>
<div class="BlankRow"></div>
<div>
	<div ng-bind-html="SelObj.History | html"></div>
</div>

<div class="BlankRow"  style="height:50px"></div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\Scenario.html```FileName```<style>
    .sinData{
        text-align: center;
    }
</style>
<div class="row">
    <div class="col-md-2"></div>
</div>
<table border="1">
    <thead>
        <th>{{SheetItem.ColHead1}}</th>
        <th>{{SheetItem.ColHead2}}</th>
        <th>{{SheetItem.ColHead3}}</th>
        <th>{{SheetItem.ColHead4}}</th>
        <th>{{SheetItem.ColHead5}}</th>
        <th>{{SheetItem.ColHead6}}</th>
        <th>{{SheetItem.ColHead7}}</th>
    </thead>
    <tbody>
        <tr ng-repeat="sin in SheetItem.Scenarios" style="text-align:center">
            <td>{{sin.col1}}</td>
            <td>{{sin.col2}}</td>
            <td>{{sin.col3 | number}}</td>
            <td>{{sin.col4}}</td>
            <td>{{sin.col5 | number}}</td>
            <td style="color:red">{{sin.col6 | number}}</td>
            <td>{{sin.col7 | number}}</td>
        </tr>
    </tbody>
</table>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\Tenor.html```FileName``````File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Derivarives\Teplate.html```FileName```<style>
    .PrintDiv{
        page-break-inside:avoid;
        /* page-break-after: always; */
    }
    .reportPage{
        width: 100%  !important;
        height: 1000px !important;
        padding: 5px;
        margin: 5px ;
        /* border: 1px #D3D3D3 solid; */
        border-radius: 5px;
        background: white;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
        /* page-break-after: always; */
    }
    .reportTableLeft{
        padding: 2px;margin:0px;

        border-left:1px black solid;
        border-right:1px black solid;
        border-bottom:1px black solid;
        
    }
    .reportTableLeftFirst{
        padding: 0px;margin:0px;
        border:1px black solid;        
    }

    .reportTableRight{
        padding: 2px;margin:0px;
        border-right:1px black solid;
        border-bottom:1px black solid; 
        border-left:0px;      
    }   
    .reportTableRightFirst{
        border-top:1px black solid;
        padding: 0px;margin:0px;
        border-right:1px black solid;
        border-top:1px black solid;        
    }

    .footer {
        position: fixed;
        left: 0;
        bottom: 0;
        width: 100%;
        background-color: red;
        color: white;
        text-align: center;
    }

    .bottom_link{
        position:absolute;                  /* added */
        bottom:0;                           /* added */
        left:0;                           /* added */
    }

    .teplateEdit:hover{
        background-color: #FFFFE0;
        cursor:pointer;
        font-weight:bold;
    }

    .tableEdit{
        border:1px black solid;          
    }

</style>

<div>
    <div class="form-group input-group col-md-2 HedgeDivCol">
        <label class="form-group has-float-label">
            <select name="DerivativeType" class="form-control" ng-model="TemplateDerivativeType" ng-change="templateCtrlOnLoad()"  >
                <option ng-repeat="c in DerivateTypesList">{{c.Title}}</option>											 						
            </select>
            <span>Derivative Type</span>
             
        </label>										 
    </div>

</div>
<div style="margin:50px;margin: auto;" data-ng-init="templateCtrlOnLoad()">
    <div id="divReport" style="width: 700px  !important;margin: 0px auto">
        <div class="row" >
            <div  class="col-md-7"></div>
            <div  class="col-md-4 " style="margin-right:10px ;font-family: Arial, Helvetica, sans-serif;font-size: 10px">
                <div class="pull-right ">
                    <img style="width:140px;height:40px ;" id="imgEnbdLogo2" src="../../../EITRY/FX/SiteAssets/TryUtil/img/Emirates-Islamic.jpg"  />
                    <div>Emirates Islamic Bank</div>
                    <div>Treasury and Markets</div>
                    <div>+971 (0) 4 4152333</div>
                </div>                        
            </div>
        </div>

        <div class="row "  ng-repeat="pages in ReportPages">
            <div class="reportPage " >                                            
                <div class="row"  ng-repeat="page in pages" style="padding: 0px;margin:0px 10px" ng-click="TemplateEdit(page)" >
                    
                    <!-- <div  class="col-md-1 ">{{page.Order0}}</div> -->
                    <div  ng-if="page.RowType == 'Text' "  class=" col-md-11 teplateEdit" contenteditable="false" 
                        ng-bind-html="page.ColumnOne | html" id="ColumnOne" >
                    </div>
                    
                    <div ng-if="page.RowType == 'Table Row' " ng-class="{'reportTableLeftFirst': page.firstTableRow}"
                        class=" teplateEdit reportTableLeft col-md-4  " contenteditable="false"
                        ng-bind-html="page.ColumnOne | html" id="ColumnOne" >
                    </div>

                    <div ng-if="page.RowType == 'Table Row' "  ng-class="{'reportTableRightFirst': page.firstTableRow }" 
                        class=" teplateEdit reportTableRight col-md-7 " contenteditable="false"
                        ng-bind-html="page.ColumnTwo | html" id="ColumnTwo">
                    </div> 

                </div>                
            </div>           
        </div>
    </div>        
</div>

<div id="TemplateModal" class="modal fade " role="dialog" data-keyboard="false" data-backdrop="static">
	<div class="modal-dialog " style="width:1200px">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">×</span>
				</button>
				<h4 class="modal-title"><span id="modalManageReportHeading"></span>Edit Template</h4>
				<span class="hide" id="spRequestItemId"></span>
				<span class="hide" id="spRequestTenorText"></span>
			</div>
			<!-- End Modal content-->
			
			<!-- Modal body-->
			<div class="modal-body">
			
				<div class="panel panel-default" style="margin-bottom: 5px;">
                <div class="panel-body" style="margin-bottom:10px">                
	                 <div class="alert alert-danger saveQueryAlert hide" ></div>	                     
	                      <div class="tab-content mngQueryTabs" style="background-color: transparent;border: none;">	                        
	                        <div id="meetActionDetails" class="tab-pane fade in active">
                                
                                <div class="row"   style="padding: 0px;margin:0px 10px">

                                    <!-- <div  class="tableEdit col-md-1 ">{{selPage.Order0}}</div> -->

                                    <div  ng-if="selPage.RowType == 'Text' "  class="tableEdit col-md-12 " contenteditable="true" 
                                        ng-bind-html="selPage.ColumnOne | html" id="ColumnOneTextEdit"
                                        style="padding: 0px;border: 0px black;">
                                    </div>  

                                    <div ng-if="selPage.RowType == 'Table Row' " class=" tableEdit col-md-4  " contenteditable="true"
                                        ng-bind-html="selPage.ColumnOne | html" id="ColumnOneTableEdit" >
                                    </div>
                                    <div ng-if="selPage.RowType == 'Table Row' " class=" tableEdit col-md-8 " contenteditable="true"
                                        ng-bind-html="selPage.ColumnTwo | html" id="ColumnTwoTableEdit" >
                                    </div> 

                                </div>  
                                
                                <div class="row" style="margin: 20px">                                    
                                    <button type="button" class="btn btn-sm EI-ButtonPurple " ng-click="SaveTemplateItem(selPage)" >Save</button>
                                </div>
	                        </div>		                        	                      	                      
	                      </div>	                      	                      	                      
	                 </div>	                 
	            </div>	          				
			</div>
		</div>
	</div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\Attachment.html```FileName```<div class="row" style="margin-left: 3px;margin-right: 3px;" ng-show="item.Attachments.length > 0">
	<table id="dtFdRequestDocs" class="table table-condensed table-bordered table-hover dataTable no-footer" cellspacing="0" style="background-color: white;width: 100%;">
		<thead>
			<tr style="background-color: #d9d9d9;">
				<th class="hide">ID</th>
				<th>Document Name</th>							
				<th>Uploaded By</th>
				<th>Date</th>
				<th class="text-center">File</th>
				<th></th>
			</tr>
		</thead>
		<tbody>
			<tr  ng-repeat="at in item.Attachments track by $index" >
				<td>{{at.Name}}</td>							
				<td>{{at.uploadedBy}}</td>
				<td>{{at.documentDate}}</td>
				<td class="text-center">
					<a  target="_blank" href="{{at.fileUrl}}" ><i class="ChkFile fa fa-file-pdf-o" aria-hidden="true" style="font-size: 18px;"></i></a> 
				</td>
				<td class="text-center">
					<a href="" ng-click="DeleteAttachment(at)"  ng-hide="read"  >
						<i ng-hide="at.deleted" class="fa fa-trash-o DelFdReqDocIco" aria-hidden="true" style="font-size: 18px;"></i>
					</a>
				</td>
			</tr>		
		</tbody>
	</table>
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\Buttons.html```FileName```<div id="ButtonDiv" style="margin:10px;  ">

	<div style="font-weight:bold;color:red;width:100%;padding-top:0px;padding-bottom:6px;padding-left:8px" 
		ng-show="item.ProductType == 'FX' && item.IgnoreBusinessFlow == true && Config.isHoTRY ">
		Note : Please be informed that the request does not include Business Segment approval.
	</div>
	
	<div class="text-danger" style="font-weight:bold;width:100%;padding:8px 20px;">{{ErrorMessage}}</div>
	
	

	<!--div style="float:left;padding:5px"  >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnSave()" >			
			Save
		</button>									
	</div-->
	
	<!--div style="float:left;padding:5px 20px" ng-repeat="sf in StatusFlow" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple"   ng-click="TakeWFAction(sf)" >			
			{{sf.Title}}
		</button>									
	</div-->

	<div ng-hide="read">
	
		<div style="float:left;padding:5px" ng-show="item.StatusCode== 1 ">				
			<button type="button" class="btn EI-ButtonPurple" ng-click="Save()" >						 
				Save
			</button>			 		
		</div>

	
		<div style="float:left;padding:5px" ng-show="item.ProductType == 'FX' " >	
			<button type="button" class="btn EI-ButtonPurple" ng-click="StartWF(false)" >						 
				{{item.StatusCode== 1 ? 'Submit' : 'Resubmit' }} with segment approval
			</button>			 		
		</div>
		
		<div style="float:left;padding:5px">				
			<button type="button" class="btn EI-ButtonPurple" ng-click="StartWF(true)" >						 
				{{item.StatusCode== 1 ? 'Submit' : 'Resubmit' }} without segment approval
			</button>			 		
		</div>
	</div>

	
	
	<div style="float:left;padding:5px" ng-repeat="sf in nintexFlow">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="TakeNintexWFAction(sf)" >	
			{{sf.Title}}
		</button>							
	</div>
	
	<div style="float:left;padding:5px" ng-show="item.StatusCode== 7 ">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onCancelClick()" >						 
			Cancel
		</button>				 		
	</div>


	<div style="float:left;padding:5px">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onBackClick()" >						 
			Back to Queue
		</button>				 		
	</div>

	
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\Comments.html```FileName```<div class="row" style="margin:0px" ng-show="item.AuditLog.length > 0" >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" style="margin:0px" >
			<div class="col-md-12 divSubHeadingLog" >Audit Log</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:120px;">Action</th>
							<th style="text-align:center;width:120px;">Action Type</th>
							<th style="text-align:center;width:200px;">By</th>
							<th style="text-align:center;width:100px;">Date &Time</th>
							<th style="text-align:center;width:300px;">Comments</th>			
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="it in item.AuditLog" >	
							<td style="text-align:center;">{{it.Title}}</td>
							<td style="text-align:center;">{{it.Action}}</td>
							<!--td style="text-align:left;"><span ng-show="it.Action">{{it.Author.Title}}{{it.WFComment.split(":")[}}</span></td-->
							<td style="text-align:center;"><span ng-show="it.Action">{{commentApprover(it.ActionBy.Title, it.WFComment ) }}</span></td>
							
							<td style="text-align:center;">{{FormatDate(it.ActionTime)}}</td>									
							<td style="text-align:left;">{{it.Comment}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>



```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\ERDetails.html```FileName```<style>

	.CloseButton{
		position:absolute;
		top:0px;
		right:0px;
		cursor:pointer;				
	}
	
	
</style>

<form name="myForm"></form>

<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="listCtrlOnLoad()" >
  <div class="panel panel-default" style="width: 100%">
   
    
    <div class="panel-heading item-panel-heading" >  
    	
    	<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;">						
			<span >Status : {{ GetStatusText(item.StatusCode) }}</span>
		</p>
		
		<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;" ng-show="item.Title">						
			<span ng-click="openFlow()">SP Ref. : {{ item.Title }}</span>
		</p>
		
		<p class="label label-warning itemStatus" style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;cursor:pointer">						
			<span ng-click="listCtrlOnLoad(true)">Copy</span>
		</p>


			
    	<div class="pannel-header">
			<div class="main-header-title">ERS Margin Update</div>						
		</div>		   		
    </div>

    <div class="meeting-panel-body">        	
        <form name="af" novalidate>	    	    
	    	<div class="tab-content pageTabContentStyles" >    	    		    			    		    			    		
	    		<div id="tabDetails" class="tab-pane fade in active"  >	
	    			
	    			<div class="row content divPnlSrchRsltCharts" >
	    				<div class="col-md-12 divSubHeading" >Request Details</div>
	    				<div class="col-md-12 " style="padding-top:10px;padding-bottom:1px;padding-left:10px;text-align:center" >
	    					<div class="col-md-4" style="padding-left:5px;padding-right:5px;">
	    						<span style="padding-left:0px;">*Margin is the difference between PAR & Customer rates and it is in AED</span>
	    					</div>
	    					<div class="col-md-3" >
	    						<span style="padding-left:10px;">*<span style="color:#604c69;font-weight:bold">{{item.ProductType == 'FX' ? 'CUB' : 'CXB' }}</span> - Bank buy from customer</span>
	    						
	    					</div>
	    					<div class="col-md-3" >
	    						<span style="padding-left:10px;">*<span style="color:#604c69;font-weight:bold">{{item.ProductType == 'FX' ? 'CUS' : 'CXS' }}</span>- Bank sell to customer</span>
	    					</div>
	    					
	    					
		    				<!--div style="padding-top:10px;padding-bottom:1px;padding-left:10px;font-weight:bold">*Margin in terms of AED</div>
		    				<div style="padding-top:10px;padding-bottom:1px;padding-left:10px;font-weight:bold">*{{item.ProductType == 'FX' ? 'CUB' : 'CXB' }} - Bank buy from customer</div>
		    				<div style="padding-top:10px;padding-bottom:1px;padding-left:10px;font-weight:bold" >*{{item.ProductType == 'FX' ? 'CUS' : 'CXS' }}- Bank sell to customer</div-->
	    				</div>
	    				<div class="col-md-12" style="margin:10px !important" >
	    				
	    					<div class="row" style="margin-top:10px;border:1px gray solid;background-color:#F0F8FF !important;padding:20px" ng-repeat="req in ReqDetails track by $index">
	    					
	    						<div class="form-group input-group col-md-15 HedgeDivCol">	
									<label class="form-group has-float-label">
										<select name="ProductType{{$index}}" class="form-control" ng-model="item.ProductType" ng-disabled="read" required  errmsg="Product Type" >
									    	<option value=""></option>
									    	<option value="FX" >FX</option>
									    	<option value="Banknote">Banknote</option>									    											 						
										</select>										
										<span>Product type<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
										<p ng-show="(se || af['ProductType' + $index].$touched) && af['ProductType' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								<div class="form-group input-group HedgeDivCol col-md-15" >	
									<label class="form-group has-float-label">
										<select name="Currency{{$index}}" class="form-control" ng-model="req.Currency" ng-disabled="read" required  errmsg="Currency" >
	    									<option value=""></option>									    
									    	<option ng-repeat="cr in Config.CurrencyList">{{cr.CurrencyCode}}</option>											 						
										</select>										
										<span>Currency<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
										<p ng-show="(se || af['Currency' + $index].$touched) && af['Currency' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								<!--ng-required="req.BuySell == 'Sell' || req.BuySell == 'Both'"-->
								
								<div class="form-group input-group col-md-17 HedgeDivCol" 	  >	
									<label class="form-group has-float-label">
										<input name="CurrentCMargin{{$index}}" class="form-control" type="text" ng-model="req.CurrentCMargin" required  
											ng-disabled="read"  />										
										<span>Current {{item.ProductType == 'FX' ? 'CUB' : 'CXB' }} margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['CurrentCMargin' + $index].$touched) && af['CurrentCMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								<div class="form-group input-group col-md-17 HedgeDivCol" >	
									<label class="form-group has-float-label">
										<input name="ProposedCBMargin{{$index}}" class="form-control" type="text" ng-model="req.ProposedCBMargin" required  
											ng-disabled="read"  />										
										<span>Proposed {{item.ProductType == 'FX' ? 'CUB' : 'CXB' }} margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['ProposedCBMargin' + $index].$touched) && af['ProposedCBMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								<div class="form-group input-group col-md-17 HedgeDivCol" >	
									<label class="form-group has-float-label">
										<input name="CurrentCSMargin{{$index}}" class="form-control" type="text" ng-model="req.CurrentCSMargin" required  
											ng-disabled="read"  />										
										<span>Current {{item.ProductType == 'FX' ? 'CUS' : 'CXS' }} margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['CurrentCSMargin' + $index].$touched) && af['CurrentCSMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								<div class="form-group input-group col-md-17 HedgeDivCol" >	
									<label class="form-group has-float-label">
										<input name="ProposedCSMargin{{$index}}" class="form-control" type="text" ng-model="req.ProposedCSMargin" required  
											ng-disabled="read"  />										
										<span>Proposed {{item.ProductType == 'FX' ? 'CUS' : 'CXS' }} margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['ProposedCSMargin' + $index].$touched) && af['ProposedCSMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								<div class="col-md-05 HedgeDivCol " style="padding-top:14px !important" ng-hide="read"  >
									<button type="button" class="btn btn-primary btn-xs" ng-click="DeleteCurrency($index)" ng-show="$index != 0 " >
											<i class="fa fa-trash" aria-hidden="true" ></i>
									</button>
								</div>
								
								<div class="col-md-05 input-group HedgeDivCol " style="padding-top:14px !important;" ng-hide="read;"  >
									<button type="button" class="btn btn-primary btn-xs" ng-click="ResetCurrency($index)"   >
											<i class="fa fa-history" aria-hidden="true" ></i>
									</button>
								</div>
								
								<!--div class="col-md-4"></div>								
								<div class="col-md-17">
									<span>{{item.ProductType == 'FX' ? 'CUB' : 'CXB' }} - Bank buy from customer</span>									
								</div>
								<div class="col-md-17"></div>
								<div class="col-md-17">									
									<span>{{item.ProductType == 'FX' ? 'CUS' : 'CXS' }}- Bank sell to customer</span>
								</div-->


								
								


								
								<!--div class="form-group input-group col-md-1 HedgeDivCol">	
									<label class="form-group has-float-label">
										<select name="BuySell{{$index}}" class="form-control" ng-model="req.BuySell" ng-disabled="read" required  errmsg="BuySell Type" >
									    	<option value=""></option>
									    	<option value="Buy">Buy</option>
									    	<option value="Sell">Sell</option>
									    	<option value="Both">Both</option>											 						
										</select>										
										<span>Buy/Sell<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
										<p ng-show="(se || af['BuySell' + $index].$touched) && af['BuySell' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div-->
								
								
								<!--
								<div class="form-group input-group col-md-17 HedgeDivCol"  >	
									<label class="form-group has-float-label">
										<input name="CurrentSellMargin{{$index}}" class="form-control" type="number" ng-model="req.CurrentSellMargin" 
											ng-disabled="read" ng-required="req.BuySell == 'Sell' || req.BuySell == 'Both'" />										
										<span>Current Sell Margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									<p ng-show="(se || af['CurrentSellMargin' + $index].$touched) && af['CurrentSellMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								<div class="form-group input-group col-md-17 HedgeDivCol" ng-show="req.BuySell == 'Sell' || req.BuySell == 'Both'">	
									<label class="form-group has-float-label">
										<input name="ProposedSellMargin{{$index}}" class="form-control" type="number" ng-model="req.ProposedSellMargin" 
										 ng-disabled="read" ng-required="req.BuySell == 'Sell' || req.BuySell == 'Both'" />										
										<span>Proposed Sell Margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
										<p ng-show="(se || af['ProposedSellMargin' + $index].$touched) && af['ProposedSellMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								<div class="form-group input-group col-md-17 HedgeDivCol" ng-show="req.BuySell == 'Buy' || req.BuySell == 'Both'">	
									<label class="form-group has-float-label">
										<input  name="CurrentBuyMargin{{$index}}" class="form-control" type="number" ng-model="req.CurrentBuyMargin" 
										ng-disabled="read" ng-required="req.BuySell == 'Buy' || req.BuySell == 'Both'"  />										
										<span>Current Buy Margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
										<p ng-show="(se || af['CurrentBuyMargin' + $index].$touched) && af['CurrentBuyMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								<div class="form-group input-group col-md-17 HedgeDivCol"  ng-show="req.BuySell == 'Buy' || req.BuySell == 'Both'">	
									<label class="form-group has-float-label">
										<input  name="ProposedBuyMargin{{$index}}" class="form-control" type="number" ng-model="req.ProposedBuyMargin"  
										ng-disabled="read" ng-required="req.BuySell == 'Buy' || req.BuySell == 'Both'" />										
										<span>Proposed Buy Margin<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
										<p ng-show="(se || af['ProposedBuyMargin' + $index].$touched) && af['ProposedBuyMargin' + $index].$invalid " class="text-danger">required.</p>										     
									</label>										 
								</div>
								
								<div class="col-md-05 HedgeDivCol " style="padding-top:14px !important" ng-hide="read"  >
									<button type="button" class="btn btn-primary btn-xs" ng-click="DeleteCurrency($index)" ng-show="$index != 0 " >
											<i class="fa fa-trash" aria-hidden="true" ></i>Delete
									</button>
								</div>


-->


								
	    					</div>
	    						    						    					
	    				</div>
	    				
	    				<div class="row" ng-hide="read" style="margin-bottom:10px">
					  		<button type="button" class="btn btn-primary btn-xs pull-right" style="margin-right:50px;width:100px;margin-left:50px"
								 ng-click="AddNewCurrecny()" >
								 	<i class="fa fa-plus" aria-hidden="true" style="padding-right:4px" ></i>
									Add
							</button>
					  	</div>
					  	
					  	
					  	<div class="form-group input-group col-md-12 HedgeDivCol" ng-hide="read"   >	
							<label class="form-group has-float-label">
								<input class="form-control" style="height:28px" id="filesDocument" name="filesDocument" type="file" style="width: 100%;" multiple ng-model="filesDocument" />
								<!--button type="button" class="btn EI-ButtonPurple" ng-click="UploadAttachment()" >Upload</button-->											
								<span>Attachment<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
								<p ng-show="(se || af['ProposedBuyMargin' + $index].$touched) && af['ProposedBuyMargin' + $index].$invalid " class="text-danger">required.</p>										     
							</label>										 
						</div>


					  	
						
						<div class="form-group input-group col-md-12 HedgeDivCol" style="margin-top:15px !important">
							<label class="form-group has-float-label FormLabel">													
								<textarea  name="CurrentComment" id="CurrentComment" ng-model="item.CurrentComment"  class="multiLineInput" style="height:80px" ></textarea>		    			
								<span>Comment</span>
								<p ng-show="(se || af['CurrentComment'].$touched) && af['CurrentComment'].$invalid " class="text-danger">Comment required.</p>								
							</label>																 
						</div>
						
						<!--div class="form-group input-group col-md-12 HedgeDivCol" style="padding-bottom:0px">
							<label class="form-group has-float-label FormLabel">									
								<textarea  name="CurrentComment" id="CurrentComment" ng-model="item.CurrentComment"  class="multiLineInput"   maxlength="500" style="height:100px"
									 ></textarea>						
								<p ng-show="(se || af.CurrentComment.$touched) && af.CurrentComment.$invalid " class="text-danger">Comment required.</p>
								
							</label>										 
						</div-->
						
						<div class="form-group input-group col-md-12 HedgeDivCol" style="margin-top:15px !important">
							<div ng-include="'../SiteAssets/TryUtilUAT/Proj/ExchangeRate/Attachment.html'"></div>
						</div>
						
						
	   				    <div style="width:100%;" ng-include="'../SiteAssets/TryUtilUAT/Proj/ExchangeRate/Buttons.html'"></div> 
	   				    
							
						<div class="col-md-12" style="padding:10px;" >
							<div style="width:100%" ng-include="'../SiteAssets/TryUtilUAT/Proj/ExchangeRate/Comments.html'" ></div>	
						</div>
						
					</div>
					
					

				


  			
    				
   				    
   				    										    				    				    					    		
	    		</div>	    			    										
					
				
																											
	    	</div>
    	</form>
    	
    	<!--div class="row" style="width: 100%;">
			<div style="width:100%" ng-include="'../SiteAssets/TryUtilUAT/Proj/MeetingTracker/MeetingGroup.html'" ></div>	
		</div-->	
				
    </div>
    
  </div>  
</div>


	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\ERDetailsCtrl.js```FileName```
DocApp.controller('ERDetailsCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.commentApprover = function(Approver, comment){			
		if(comment){
			try{
				var str = comment.split(":")[2]
				return str.substring(str.indexOf('(')+1, str.length-1)
			}catch(ex){
				return comment;
			}
			window.open($scope.item.WFLink.Url, "_blank");
		}
		else{
			return Approver;
		}
	}

	
	$scope.openFlow = function(date){			
		if($scope.item.WFLink){
			window.open($scope.item.WFLink.Url, "_blank");
		}
	}

	$scope.FormatDate = function(date){		
		if(date){
			return new moment(date).format('DD-MMM-YYYY hh:mm A')
		}
	}


	$scope.onCancelClick= function(){		
		var valuepairs = [ [ "StatusCode", "9"] ];
		UpdateField(ExchangeRateList, $scope.item.ID, valuepairs );
		
		//var valuepairs = [ [ "SpRef", $scope.item.Title], [ "Title", "Cancel" ], [ "Action", "Cancel" ], [ "ActionTime", new moment(val, "DD-MMM-YYYY").format('YYYY-MM-DD HH:mm:ss') ], [ "Comment", $scope.item.CurrentComment ] ];
		
		var item = {
			"__metadata": { "type": 'SP.Data.' + ERSMarginUpdateAuditLog + 'ListItem' },
			"SpRef": $scope.item.Title,
			"Title":  "Cancel",
			"Action":  "Cancel",
			"ActionTime": new moment().format('YYYY-MM-DD HH:mm:ss'),
			"Comment": $scope.item.CurrentComment, 						
		};
		
		CreateListItem(ERSMarginUpdateAuditLog, item);
		
		window.location = TryUtilURL + "ERSMargin";
	}
	
	$scope.UploadAttachment = function(){		
		UploadFileIntoFolder($scope, AttachmentDocLib, $scope.item.ID, $('#filesDocument') );	
	}

	
	$scope.DeleteAttachment = function(fileObj){
		
		$scope.FileDeleteErrorMsg = "";
		$scope.deleteDocument = fileObj;
		fileObj.deleted = true;		
		DeleteDocument($scope, AttachmentDocLib, $scope.item.ID );
	}
	
	$scope.AddNewCurrecny = function(){  			
		var req = {};
		
		req.ProductType = "";
		req.Currency = "";
		req.CurrentSellMargin = "";
		req.ProposedSellMargin = "";
		req.CurrentBuyMargin = "";
		req.ProposedBuyMargin = "";
		
		$scope.ReqDetails.push(req);
	}
	
	$scope.DeleteCurrency = function(id){
		$scope.ReqDetails.splice(id,1);
	}
	$scope.ResetCurrency = function(id){
		$scope.ReqDetails[id].CurrentCMargin = "";
		$scope.ReqDetails[id].ProposedCBMargin = "";
		$scope.ReqDetails[id].CurrentCSMargin = "";
		$scope.ReqDetails[id].ProposedCSMargin = "";				
	}
	
	function CloseOrRefreshAfterFileUpload(RedirectURL){
	
		$timeout(function(){ 
		
			if(FileUploadDoneFlag){
				if(RedirectURL){
					window.location = RedirectURL
				}else{
					RefreshDocuments($scope, AttachmentDocLib, $scope.item.Id, false );
				}
			}
			else{
				CloseOrRefreshAfterFileUpload(RedirectURL);
			} 				
		},500);
	}
	
	$scope.onBackClick = function()    
	{			
		 $location.path("ERSMargin");
	}
	
	$scope.GetStatusText = function(StatusId){
		//return $scope.Config.Status[StatusId];		 			
		return GetExchangeReateStatusText($scope.Config.Status, StatusId);		
	}
	
	$scope.FormatCommentDate= function(date)    
	{			
		 var dt =  new moment(date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY hh:mm A')
		 return dt;
	}
	
	
	$scope.Save = function(){
	
		
		ValidateAndSave(true);
		
		
	}
	
	$scope.StartWF = function(IgnoreBusinessFlow){
	
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		if(IgnoreBusinessFlow && $scope.item.ProductType == 'FX' && !$scope.item.CurrentComment){
			$scope.ErrorMessage = "Comment Required";
			$('#divOverlay').hide();
			$('#ListDetails').show();
			return;
		}

		setTimeout(function(){ 	
			//IgnoreBusinessFlow	
			if(ValidateAndSave(false)){
				if(!IgnoreBusinessFlow){
					IgnoreBusinessFlow = false;
				}
							
				var valuepairs = [ [ "IgnoreBusinessFlow", IgnoreBusinessFlow ], [ "StartWF", true]];
				UpdateField(ExchangeRateList, $scope.item.ID, valuepairs );
								
				$('#divOverlay').hide();
				$('#ListDetails').show();
				
				CloseOrRefreshAfterFileUpload(TryUtilURL + "ERSMargin");
				
				
			}
			else{				
				$scope.$apply();
				
				$('#divOverlay').hide();
				$('#ListDetails').show();

			}
    		
    	}, 50);

	}
	
	$scope.TakeNintexWFAction = function(task){
	
		$('#divOverlay').show();
		$('#ListDetails').hide();
		$scope.ErrorMessage = "";
		
		if((task.Title == "Reject" || task.Title == "Cancel" ) && !$scope.item.CurrentComment ){
			$scope.ErrorMessage = "Comment Required";
			$('#divOverlay').hide();
			$('#ListDetails').show();
			return;
		}
		
		if($scope.item.CurrentComment){
			var valuepairs = [ [ "CurrentComment", $scope.item.CurrentComment ] ];
			UpdateField(ExchangeRateList, $scope.item.ID, valuepairs );
			//$scope.item.CurrentComment = "";
		}
		
		var res = ProcessFlexiTaskResponse2( task.Title, task.TaskId, $scope.item.CurrentComment);
		
		GoBackOnChange();					
		
	}
		
	
	function GetEmailBody(){
	
		var L1 = $scope.item.ProductType == 'FX' ? 'CUB' : 'CXB'
		var L2 = $scope.item.ProductType == 'FX' ? 'CUS' : 'CXS';

		var link = "<a href='" + TryUtilURL + "ERSMarginDetails/" + $scope.item.ID + "' >Request</a>"
				
		var emailText = '';
		emailText += "<div style='font-weight:normal;font-family:Arial, Helvetica, sans-serif;font-size:12px'>";
		emailText += "Dear User,<br/><br />";
		emailText += link + " has been submitted for approval<br /><br />";
		
		emailText += "<table style='font-weight:normal;font-family:Arial, Helvetica, sans-serif;font-size:12px'>";
		emailText += "<tbody>";

		$.each($scope.ReqDetails, function(id, val){
			                
			emailText += "<tr>"                     
			emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:150px;border-bottom:1px white solid;color:black'>Product Type</td>";
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + $scope.item.ProductType + "</td>";

			emailText += "</tr> ";

			emailText += "<tr>"
			emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Currency</td>";
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.Currency + "</td>";

			emailText += "</tr> ";

			emailText += "<tr>"
			emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Current " + L1 + " margin</td>";
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.CurrentCMargin + "</td>";

			emailText += "</tr> ";

			emailText += "<tr>"
			emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Proposed " + L1 + " margin</td>";
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.ProposedCBMargin + "</td>";

			emailText += "</tr> ";

			emailText += "<tr>"
			emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Current " + L2 + " margin</td>";
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.CurrentCSMargin + "</td>";

			emailText += "</tr> ";

			emailText += "<tr>"
			emailText += "<td style='background:#deeaf6;height:20px;padding-top:3px;padding-left:10px;width:100px;border-bottom:1px white solid;color:black'>Proposed " + L2 + " margin</td>";
			emailText += "<td style='text-align: center;background-color: #F9F9F9;width:150px;'>" + val.ProposedCSMargin + "</td>";
        
			emailText += "</tr> ";

			emailText += "<tr>"
			emailText += "<td colspan='2' style='height:20px;' > </td>";
			emailText += "</tr> ";
		
		});

		emailText += "</tbody>";
		emailText += "</table>";
		
		return htmlEscape(emailText);
		
	}


	function ValidateAndSave(ignoreValidate){
	
		if( ignoreValidate || ValidateItem()){
		
			$scope.item.ReqDetails = angular.toJson($scope.ReqDetails);
			
			if($scope.item.Title){
				$scope.item.EmailBody = GetEmailBody();
			}
			
			var IsNewReq = $scope.item.ID ? false : true;
			var id = UpdateList($scope.item, ExchangeRateList, IsNewReq, IsNewReq);
			
			if(!$scope.item.Title){
			
				if(!$scope.item.ID){
					$scope.item.ID = id;
				}
				
				if($scope.item.ID){
					$scope.item.Title = new moment($scope.item.Created).format('YYYYMM') + "-" + $scope.item.ID;					
					$scope.item.EmailBody = GetEmailBody();
										
					var valuepairs = [];
					valuepairs.push( ["Title", $scope.item.Title ], ["EmailBody", $scope.item.EmailBody ]);	
					UpdateField(ExchangeRateList, $scope.item.ID, valuepairs );
																				
				}								
				
			}
			
			FileUploadDoneFlag = false;
			var elem = $('#filesDocument');
			if(!$scope.read && !(elem.val() == "" || elem.val() == null || elem.val() == undefined )  ){
				
				UploadFileIntoFolder($scope, AttachmentDocLib, $scope.item.ID, $('#filesDocument') );
				
			}
			else{
				FileUploadDoneFlag = true;
			}
			
			if(ignoreValidate){
												
				if(	IsNewReq){
					CloseOrRefreshAfterFileUpload(TryUtilURL + "ERSMarginDetails/" + id);	
				}	
				else{
					CloseOrRefreshAfterFileUpload();
				}
			}
			
						

			return true;
		}		
		else{
			return false;
		}
		
	}
	

			
	$scope.actionOnBack = function(){		
		
		//alert('done');
		if($scope.item.ReturnPath){
			
			window.location = TryUtilURL +  $scope.item.ReturnPath;
		}
		else{
			RefreshDocuments($scope, AttachmentDocLib, $scope.item.Id, false );
		}
	}

	$scope.listCtrlOnLoad = function(IsCopy){
        	    	    	   			
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		SetSideBar("ERS Margin Update", "ERS Margin Update");	
		
		$scope.Config = LoadExchangeRateConfig();
		
		//turn;
		$scope.read = true;
		
		setTimeout(function(){ 		
    		$scope.listDetailsOnLoadInit(IsCopy);
    	}, 1);
	}
	
	$scope.listDetailsOnLoadInit = function(IsCopy){		
		
		$scope.itenId = $routeParams.itenId;
		//$scope.ShowSaveButton = true;
		var isRequestor = false;
		$scope.ShowComment = false;
		
		if(!IsCopy){
			$scope.ReqDetails = [];
		}
		
		
		if(!IsCopy && $routeParams.itenId){
		
			$scope.ShowComment = true;

			var listFilter = ",Author/Title&$expand=Author/ID&$filter=ID eq " + $routeParams.itenId;
			//filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID" + filter;
			var listItems = GetListData(ExchangeRateList, listFilter );
					
			if(listItems.length > 0 ){				
				$scope.item = listItems[0];	
				$scope.item.CurrentComment = "";
				//$scope.item.AuditLog =  angular.fromJson($scope.item.AuditLog);
				
				var Filter = ",Author/Title,ActionBy/Title&$filter=SpRef eq '" + $scope.item.Title  + "'&$expand=ActionBy/Id&$expand=Author/Id" ;	    	
				$scope.item.AuditLog =  GetListData(ERSMarginUpdateAuditLog, Filter );
	
	
				$scope.ReqDetails =  angular.fromJson($scope.item.ReqDetails);

				if(!$scope.item.AuditLog ){
					$scope.item.AuditLog= [];
				}	
						
				if( _spPageContextInfo.userId == $scope.item.AuthorId){
					isRequestor  = true;
				}			
			}
			
			$scope.nintexFlow = [];
			var flow = GetRunningWorkflowTasksForCurrentUserForListItem( $scope.item.Id, ExchangeRateList);
			
			//Remove withdrow on Pending for ERS Update
			if($scope.item.StatusCode == '6' ){
				var removeid = -1;
				for(i=0;i<flow.length;i++){ 
					if(flow[i].Title == "Withdraw" ){
						removeid = i;
					}
				}
				
				if( i >= 0 ){
					flow.splice(removeid , 1);
				}
					
			}
			
			flow.sort((a, b) => a.Title.localeCompare(b.Title));
			
			$scope.nintexFlow = flow;			
		    //$scope.nintexFlow = GetRunningWorkflowTasksForCurrentUserForListItem( $scope.item.Id, ExchangeRateList);		    			
			RefreshDocuments($scope, AttachmentDocLib, $scope.item.Id, false );
		}
		else{
			
			$scope.nintexFlow = [];
			var ProductType = "";
			if(IsCopy){
				ProductType = $scope.item.ProductType;
			}
			
			$scope.item = {};		
			$scope.item.StatusCode = "1";
			isRequestor  = true;	
			$scope.item.AuditLog = [];
			if(!IsCopy){
				$scope.AddNewCurrecny();				
			}
			else{
				$scope.item.ProductType = ProductType; 
			}
		}
		
		$scope.item.isRequestor  = isRequestor;
		
		
		if($scope.Config.isFEUser && ( $scope.item.StatusCode == "1" || $scope.item.StatusCode == "3"  || $scope.item.StatusCode == "5"   || $scope.item.StatusCode == "7" || $scope.item.StatusCode == "11"  ) ){
			$scope.read = false;
		}
		

		$scope.StatusFlow = [];
						
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();
						
	}
	
		
	function ValidateItem(){
				
		var errMessage = "";
		$scope.invalidDealer = false;
				
		if ( $scope.af.$valid) {
				
            $scope.errMessage = "";              			        			 
            return true;     
        } 
        else {        				
        	$scope.se = true;
        	if( $scope.af.$error.required  != null || $scope.af.$error.required  != undefined ){	
        		$.each($scope.af.$error.required, function(id, err){
        			
        			if(  err.$$attr.errmsg == null || err.$$attr.errmsg == undefined ){	
        				//errMessage += err.$name + " required. ";        				
        			}
        			else{        			 
        				//errMessage += err.$$attr.errmsg + " required. ";
        			}
        		});
        	}                				
        	$scope.ErrorMessage = errMessage;
        	return false;
		}
	}
	
	var counter1 = 0;
	function GoBackOnChange(){
	
		console.log( counter1++ + ". GoBackOnChange" + moment().format('DD-MM-YYYY-HH-mm-ss') );
		$timeout(function(){ 
		
			if(CheckERSRateStatusChanged( $scope.item.StatusCode, $scope.item.CWMApproval, $scope.item.WBApproval, $scope.item.ID )){ 
				//$('#dialog-overlay, #dialog-box').hide();
				$('#divOverlay').hide();
				$('#ListDetails').show();
				window.location = TryUtilURL + "ERSMargin"; 

			}
			else{
				GoBackOnChange();
			} 				
		},1000);	
	}
	
	function CheckERSRateStatusChanged( LastStatusCode, LastCWMApproval, LastWBApproval, ID)
	{
		var result = false;
		var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ExchangeRateList + "')/Items?$select=StatusCode,CWMApproval,WBApproval&$filter=ID eq " + ID;
			
		  $.ajax({
	        url: URL,
	        type: "GET",
			async: false,
	        headers: {
	            "accept": "application/json;odata=verbose",
	        },
	        success: function(data) 
	        {		
				if(data.d.results)
				{		
					var res = data.d.results[0];
					if( LastStatusCode == 2 ){
						if( res.StatusCode != LastStatusCode || res.CWMApproval != LastCWMApproval || res.WBApproval != LastWBApproval ){
							result = true;
						}
						else{
							result = false;
						}
					}
					else{
						result = data.d.results[0].StatusCode == LastStatusCode ? false : true;	
					}
				}				
															
	        },
	        error: function (error) {
	            alert("Error : " + JSON.stringify(error));
				ErrorLog(ListName, "GetLiveStatus", JSON.stringify(error), "", "OMS");
	        }
	    });
		
		return result;
	
	}
						  
				
});

//var Config = [];
var StatusList = [];
var ERS_Groups;

function LoadExchangeRateConfig(){
	
			
	Conf = {};
	

	Conf.CurrencyList = GetConfigList("CurrencyList");
	
	StatusList = GetConfigList("ExchangeClientMarginStatusList");
	Conf.Status = [];
	$.each(StatusList, function(id, val){
		var status = {};
		status.Id = val.StatusId;
		status.Title = val.Title;
		Conf.Status.push(status);		
	});
	
	if(!ERS_Groups){
		ERS_Groups= {};
		ERS_Groups= RefreshUserInGroupByName(ERS_WBGroup, ERS_Groups);
		ERS_Groups= RefreshUserInGroupByName(ERS_CWMGroup, ERS_Groups);
		ERS_Groups= RefreshUserInGroupByName(ERS_SSGroup, ERS_Groups);
		ERS_Groups= RefreshUserInGroupByName(ERS_HoTMGroup, ERS_Groups);
		ERS_Groups= RefreshUserInGroupByName(ERS_FEGroup, ERS_Groups);
	}
	
	for(j=0;j< ERS_Groups.UserGroupsForUser.length;j++){
		/*
		if( ERS_Groups.UserGroupsIdForUser[j] == HoTMGroup ){
			Conf.isHoTRY = true;
		}
		*/
		switch( ERS_Groups.UserGroupsForUser[j] ){
			case ERS_HoTMGroup:
				Conf.isHoTRY = true;
				break;
			case ERS_FEGroup:
				Conf.isFEUser = true;
				break;
				
			case ERS_WBGroup:
				Conf.isWBUser = true;
				break;
			case ERS_SSGroup:
				Conf.isSSUser = true;
				break;
			case ERS_CWMGroup:
				Conf.isCWMUser = true;
				break;


			


			
		}
	}
	
	return Conf;
}

function RefreshUserInGroupByName(GrpName, grps ){
	
	if(!grps){
		grps = {};
	}
	
	if(!grps.UserGroupsIdForUser){
		grps.UserGroupsIdForUser = [];
	}
	if(!grps.UserGroupsForUser){
		grps.UserGroupsForUser = [];
	}

	var res = false;
	var URL = SiteURL + "_api/web/sitegroups/getbyname('" + GrpName + "')/CanCurrentUserViewMembership";
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {	
			res = data.d.CanCurrentUserViewMembership;
			if(data.d.CanCurrentUserViewMembership){
				grps.UserGroupsForUser.push(GrpName);
				grps.UserGroupsIdForUser.push( UserGroupID(GrpName) );
			}					                       
        },
        error: function (error) {
            res = false;
        }
    });	

	return grps;

	
}


function GetExchangeReateStatusText(StatusList, StatusId){	
	res = "";
	if(StatusId){
		//Conf.Status
		for(i=0;i<StatusList.length;i++){
			if( StatusList[i].Id == parseInt(StatusId) ){
				res = StatusList[i].Title;
				break;
			}
		}			
	}		
	return res;
}




```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\ERList.html```FileName```<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-4 main-header-title">ERS Margin Update<span style="color:red;font-weight:bold"> UAT</span></div>	
		<div class=" col-md-8">			
			
			<div class=" appCountButton topright"  >
				<button type="button" class="btn active" ng-if="DDCPTYCount"
					onclick="window.open('https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/CounterpartyManagement.aspx','_blank')" >
					{{DDCPTYCount}}
				</button>
			</div>
				
		</div>		
	</div>
	
	<div  class="row content  divPnlButton" >
	
		<div class="col-md-10">
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" ng-show="Config.isFEUser" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  New Request
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('FnE')"  ng-class="GetButtonClass('FnE')" >
				F&E {{FnECount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('CWM')" ng-class="GetButtonClass('CWM')" >
				 CWM {{CWMCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('WB')" ng-class="GetButtonClass('WB')" >
				 WB {{WBCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('SnS')" ng-class="GetButtonClass('SnS')" >
				 S&S {{SSCount}}
			</button>
			
	
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('HoTM')" ng-class="GetButtonClass('HoTM')" >
				 HoTM {{HoTMCount}}
			</button>				
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('All Requests')"  ng-class="GetButtonClass('All Requests')"  >
				 All Requests{{AllCount}}
			</button>
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				ng-click="ListingQueue('Report')"  ng-class="GetButtonClass('Report')"  >
				 Report
			</button>

		
		</div>
		
		<div class="col-md-2">								
			
	        
	        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
            	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
            </button>
	        
			 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ListingQueue(QuqueTitle)" title="Refresh">
	            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
	         </button>	
	         
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
	        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
	        </button>            				
		</div>						            	
							
	</div>
	
	
	
	<div class="row main-data">			
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class='hide' style='width:100px'>ID</th>
						<th style='width:150px'>SP Ref.</th>
						<th style='width:150px'>Product Type</th>
						<th style='width:150px'>Currency</th>
						
						<th style='width:150px' ng-show="QuqueTitle == 'Report'" >Current CUB/CXB margin</th>
						<th style='width:150px' ng-show="QuqueTitle == 'Report'">Proposed CXB/CXB margin</th>
						<th style='width:150px' ng-show="QuqueTitle == 'Report'">Current CUS/CXS margin</th>
						<th style='width:150px' ng-show="QuqueTitle == 'Report'" >Proposed CUS/CXS margin</th>
						
						<th style='width:150px'>Req. Date</th>
						<th style='width:150px'>Status</th>										
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class='hide' style='width:100px'>ID</th>
						<th>SP Ref.</th>
						<th >Product Type</th>
						<th >Currency</th>
						
						<th  ng-show="QuqueTitle == 'Report'" >Current CUB/CXB margin</th>
						<th  ng-show="QuqueTitle == 'Report'">Proposed CXB/CXB margin</th>
						<th  ng-show="QuqueTitle == 'Report'">Current CUS/CXS margin</th>
						<th  ng-show="QuqueTitle == 'Report'">Proposed CUS/CXS margin</th>
						
						<th >Req. Date</th>
						<th >Status</th>														
		            </tr>
		        </tfoot>		        		        
				<tbody>									
					<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
						<td class='hide'>{{it.ID}}</td>
						<td style="text-align:center" data-order="{{it.ID}}" >{{it.Title}}</td>
						<td style="text-align:center">{{ it.ProductType }}</td>	
								
						<!--									
						<td style="text-align:center" ng-if="QuqueTitle != 'Report'">{{ ShowAjaxData(it.ReqDetails, "Currency" ) }}</td>																	
						<td style="text-align:center" ng-if="QuqueTitle != 'Report'">{{ ShowAjaxData(it.ReqDetails, "CurrentCMargin" ) }}</td>
						<td style="text-align:center" ng-if="QuqueTitle != 'Report'">{{ ShowAjaxData(it.ReqDetails, "ProposedCBMargin" ) }}</td>
						<td style="text-align:center" ng-if="QuqueTitle != 'Report'">{{ ShowAjaxData(it.ReqDetails, "CurrentCSMargin" ) }}</td>
						<td style="text-align:center" ng-if="QuqueTitle != 'Report'">{{ ShowAjaxData(it.ReqDetails, "ProposedCSMargin" ) }}</td>
						
						
						<td style="text-align:center" ng-if="QuqueTitle == 'Report'">{{it.Currency}}</td>
						<td style="text-align:center" ng-if="QuqueTitle == 'Report'">{{it.CurrentCMargin}}</td>
						<td style="text-align:center" ng-if="QuqueTitle == 'Report'">{{it.ProposedCBMargin}}</td>
						<td style="text-align:center" ng-if="QuqueTitle == 'Report'">{{it.CurrentCSMargin}}</td>
						<td style="text-align:center" ng-if="QuqueTitle == 'Report'">{{it.ProposedCSMargin}}</td>
						-->
						
						<td style="text-align:center" >{{ QuqueTitle == 'Report' ? it.Currency : ShowAjaxData(it.ReqDetails, "Currency" )}}</td>
						<td style="text-align:center" ng-show="QuqueTitle == 'Report'">{{it.CurrentCMargin}}</td>
						<td style="text-align:center" ng-show="QuqueTitle == 'Report'">{{it.ProposedCBMargin}}</td>
						<td style="text-align:center" ng-show="QuqueTitle == 'Report'">{{it.CurrentCSMargin}}</td>
						<td style="text-align:center" ng-show="QuqueTitle == 'Report'">{{it.ProposedCSMargin}}</td>


						
						<td style="text-align:center" data-order="{{DateSer(it.Created)}}" >{{it.Created}}</td>						
						<td style="text-align:center">{{GetStatusText(it.StatusCode)}}</td>
						
						<!--td style="text-align:center">{{it.TradeDate}}</td>												
						<td style="text-align:center">{{it.OpRickId}}</td-->
						
					</tr>				 	  
				</tbody>									
			</table>
		</div>
		

	</div>


</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ExchangeRate\ERListCtrl.js```FileName```
var selTab = "";
var ExchangeRateList = "ExchangeRateFrameworkListUAT";
var UserPermissionsList = "UserPermissionsListUAT";
var AttachmentDocLib = "ExchangeRateFrameworkAttachments";
var ERSMarginUpdateAuditLog = "ERSMarginUpdateAuditLog";

var ERS_WBGroup = "ERS_Margin_WB";
var ERS_CWMGroup = "ERS_Margin_CWM";
var ERS_SSGroup = "ERS_Margin_SS";
var ERS_HoTMGroup = "ERS_Margin_HoTM";
var ERS_FEGroup = "ERS_Margin_FE";

DocApp.controller('ERListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}

	$scope.ShowAjaxData = function(data, column){
		
		var obj = angular.fromJson(data);
		var res = "";
		$.each(obj , function(id, val){
			res = res ? res + ", " : res;
			res += val[column];
			
		});
		return res;
		
	}
	
	$scope.listCtrlOnLoad= function(){
	
		SetSideBar("ERS Margin Update", "ERS Margin Update");			
	
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
			
	}

	$scope.listCtrlOnLoadInit = function()
	{	
		$scope.Config = LoadExchangeRateConfig();
		
		$scope.startDate = moment().subtract(7, 'days');
		$scope.endDate = moment();
			
		
		/*
		$scope.FnECount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 1 or StatusCode eq 3 or StatusCode eq 5 or StatusCode eq 6 or StatusCode eq 7)") + ")";
		
		$scope.HoTMCount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 4 )") + ")";
		$scope.AllCount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 2 or StatusCode eq 3 or StatusCode eq 4 or StatusCode eq 5 or StatusCode eq 7 )") + ")";
		
		$scope.CWMCount = "(" + GetListItemsCount(ExchangeRateList, "CWMApproval", "(CWMApproval eq 1 )") + ")";
		$scope.WBCount = "(" + GetListItemsCount(ExchangeRateList, "WBApproval", "(WBApproval eq 1 )") + ")";
		$scope.SSCount = "(" + GetListItemsCount(ExchangeRateList, "SandSApproval", "(SandSApproval eq 1 )") + ")";
		*/

		var tab = '';
		if(!selTab){
			if($scope.Config.isFEUser){
				selTab = "FnE";
			}
			else if($scope.Config.isHoTRY){
				selTab = "HoTM";
			}			
			else if($scope.Config.isWBUser){
				selTab = "WB";
			}
			else if($scope.Config.isSSUser){
				selTab = "SnS";
			}
			else if($scope.Config.isCWMUser){
				selTab = "CWM";
			}
			else{
				selTab = "All Requests";
			}			
		}
	
		
		$scope.ListingQueue(selTab);
		$scope.$apply();					
					
	}
	
	$scope.GetStatusText = function(StatusId){				
		return GetExchangeReateStatusText($scope.Config.Status, StatusId);					
	}
	
	$scope.GetButtonClass = function(title){
		if( title == $scope.QuqueTitle ){
			return "EI-ButtonPurple-Selected";
		}
		else{
			return '';
		}
	}
	
	$scope.ClearFilter = function(){
	
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}

		updateTable();
	}
	
			
	$scope.AddNew= function(){
		window.location = "/" + TryUtilPath + "NewERSMargin/";
	}
	
	
	$scope.ListingQueue = function(queue){
		
		selTab = queue;
		
		$('#divOverlay').show();
		$('#ListDetails').hide();
		

		
		$scope.FnECount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 1 or StatusCode eq 3 or StatusCode eq 5 or StatusCode eq 6 or StatusCode eq 7 or StatusCode eq 11 )") + ")";
		
		$scope.HoTMCount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 4 )") + ")";
		$scope.AllCount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 2 or StatusCode eq 3 or StatusCode eq 4 or StatusCode eq 5 or StatusCode eq 7 )") + ")";
		
		$scope.CWMCount = "(" + GetListItemsCount(ExchangeRateList, "CWMApproval", "(CWMApproval eq 1 )") + ")";
		$scope.WBCount = "(" + GetListItemsCount(ExchangeRateList, "WBApproval", "(WBApproval eq 1 )") + ")";
		//$scope.SSCount = "(" + GetListItemsCount(ExchangeRateList, "SandSApproval", "(SandSApproval eq 1 )") + ")";
		$scope.SSCount = "(" + GetListItemsCount(ExchangeRateList, "StatusCode", "(StatusCode eq 10 )") + ")";


		
		
		DestroyTable();


		var filter = "";
		
		if(queue == "FnE"){
			filter = "&$filter=StatusCode eq 1 or StatusCode eq 3 or StatusCode eq 5 or StatusCode eq 6 or StatusCode eq 7";
		}
		else if(queue == "HoTM"){
			filter = "&$filter=StatusCode eq 4 ";
		}
		else if(queue == "CWM"){
			filter = "&$filter=CWMApproval eq 1 ";
		}
		else if(queue == "WB"){
			filter = "&$filter=WBApproval eq 1 ";
		}
		else if(queue == "SnS"){
			filter = "&$filter=StatusCode eq 10 ";
		}		
		else if(queue == "Report"){	
		
			startdt = $scope.startDate.clone();
			enddt = $scope.endDate.clone();
			console.log( "Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );	
					
			var filter = "&$filter=StatusCode eq 8 and Created ge '" + startdt.subtract(1, 'days').format("YYYY-MM-DD") +  ", 23:59:59' and Created le '";
			filter += enddt.add(1, 'days').format("YYYY-MM-DD") +  ", 00:00:01' ";			
			
			queue = "Report";								
		}
		else{	
			queue = "All Requests";								
		}
		
		
		filter = ",Author/Title&$expand=Author/ID" + filter;			
		var dataList = GetListData(ExchangeRateList, filter );
		
		
		
		if(queue == "Report"){	
			dataList = SplitRequest(dataList)								
		}		
		$scope.dataList = dataList;
		
								
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
			
			
			updateTable();
			$('#divOverlay').hide();
			$('#divDataTable').show();

			$scope.QuqueTitle = queue;
		
		}, 0);

		
	}
	
	function SplitRequest(dataList){
	
		var res = [];   
		
		$.each(dataList, function(id, val){                	        	
        	var ReqDetails = angular.fromJson(val.ReqDetails);
        	$.each(ReqDetails, function(id, det){        	
				
				row = {};
				row.ID = val.ID;
				row.Created =  val.Created
				row.StatusCode =  val.StatusCode
				row.Title =  val.Title
				row.Created  =  val.Created 
				row.ProductType   =  val.ProductType  
				
				row.Currency =  det.Currency				
				row.CurrentCMargin =  det.CurrentCMargin
				row.ProposedCBMargin =  det.ProposedCBMargin
				row.CurrentCSMargin =  det.CurrentCSMargin
				row.ProposedCSMargin =  det.ProposedCSMargin
								    	        		        	
	        	res.push(row);
	        	
        	});        	        	        	        	
		});
		
		return res;
	}
	
	$scope.ExportToExcel = function(){
	
		var filter = ",Dealer/Title,Author/Title&$expand=Author/ID&$expand=Dealer/ID";		
		
		
		var res = [];        
        var row = [
        	'SP Ref.',
        	'Req. Date', 
        	'Status',        	
        	'Product type',
        	'Currency',    
        	'Current CUB/CXB margin', 
        	'Proposed CXB/CXB margin',   	
        	'Current CUS/CXS margin', 
        	'Proposed CUS/CXS margin',         	        				
        ];
        res.push(row);   
        
        
        $.each($scope.dataList, function(id, val){             
        	
			if($scope.QuqueTitle != "Report"){	
				var ReqDetails = angular.fromJson(val.ReqDetails);
	        	$.each(ReqDetails, function(id, det){
	        		var row = [];
	        		row.push(val.Title);
		        	row.push(val.Created); 
		        	row.push( $scope.GetStatusText(val.StatusCode) );		        	 
		        	row.push(val.ProductType);  
		        		        	
					row.push(det.Currency);									
					row.push(det.CurrentCMargin);
					row.push(det.ProposedCBMargin);
					row.push(det.CurrentCSMargin);
					row.push(det.ProposedCSMargin);				    	        		        	
		        	res.push(row);	        	
	        	});							
			}
			else{
				var row = [];
        		row.push(val.Title);
	        	row.push(val.Created); 
	        	row.push( $scope.GetStatusText(val.StatusCode) );
	        	 
	        	row.push(val.ProductType);  	        	
				row.push(val.Currency);					
				row.push(val.CurrentCMargin);
				row.push(val.ProposedCBMargin);
				row.push(val.CurrentCSMargin);
				row.push(val.ProposedCSMargin);				    	        		        	
	        	res.push(row);								
			}
			   	        	
        	        	        	        	        	
		}); 
		
		ExcelReportDownload(res, 'ERSExchangeClientMargin-' + moment().format('DD-MM-YYYY-HH-mm-ss') +'.xlsx')

	}

			
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				
				"pageLength": 20,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 1, "desc" ]],
				"autoWidth": false,
	
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						if( ColCount == 2 || ColCount == 9 ){

							var column = this;
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.main-ListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
							column.data().unique().sort().each( function ( d, j ) {
								
								select.append( '<option value="'+d+'">'+d+'</option>' )
	
							} );
							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
								
								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();
								
								    });							
							/*
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.auctionListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val )
										.draw();
								} );							
							$.each(ResponsibilityList , function(id, val){
								select.append( '<option value="'+ val.Title +'">'+ val.Title +'</option>' )	
	
							});
							*/
						}
						
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				//var id =  $($(auctionReqstItemElem ).children()[0]).text();
				var id = auctionReqstItemElem[0].children[0].textContent;

				//debugger;
				$scope.item = $scope.dataList[id]; 
				window.location = "/" + TryUtilPath + "ERSMarginDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
						
			if( $scope.QuqueTitle == "Report"  ){ //&& ( $scope.Config.isBMSUser || $scope.Config.isHoBMSUser)
				UpdateMeetingDateSearch();
			}
			
			/*
			var ht = "<button class='btn btn-success buttons-html5 iconButton pull-right' type='button' ng-click='ExportToExcel()' title='Export To Excel'  style='padding-right:10px'>";     
			ht += "<i class='fa fa-download actionButtonSign' aria-hidden='true'></i>";
			ht += "</button>";			
			$('#main-ListTable_filter').before(ht);
			*/
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}
	
	
	
	function UpdateMeetingDateSearch(){
		setTimeout(function(){		
		       
		    var ht = "<div style='display: inline;margin: 0px 20px;float:right;'><label>Creation Date : <input type='text' class='TableDateRangeFilter' name='reportrange' id='reportrange'/></label></div>";
		    $scope.dateApplired = false;
		    
		    $('#main-ListTable_filter').before(ht);
		    
		    var start =  $scope.startDate; //moment().subtract(29, 'days');
		    var end = $scope.endDate; //moment();
		
		    function cb(start, end) {
		       // $('#reportrange span').html( "Targert date from <b>" +  start.format('DD-MMM-YYYY') + '</b> to <b>' + end.format('DD-MMM-YYYY') + '</b>' );
		        $scope.startDate = start;
		        $scope.endDate = end;
		        /*
		        if($scope.firstTimeLoad){
		        	$scope.firstTimeLoad = false;					
				}
				else{
					console.log( "On Change : Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );
				}
				*/
				//console.log( "1. On Change : Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );				
				
		        $('#reportrange').val( start.format('DD-MMM-YYYY') + ' to ' + end.format('DD-MMM-YYYY')  );		        		        
		    }
		
		    $('#reportrange').daterangepicker({
		        startDate: start,
		        endDate: end,
		        ranges: {
		           'Last 7 days': [ moment().subtract(7, 'days'), moment() ],
		           'Today': [moment(), moment()],
		           /*'Last Two Days': [moment(), moment().add(2, 'days')],
		           'Next 7 Days': [moment(), moment().add(7, 'days')],
		           'L 30 Days': [moment(), moment().add(30, 'days')],*/
		           'This Month': [moment().startOf('month'), moment().endOf('month')],	
		          // 'Last Month': [moment().startOf('month'), moment().endOf('month')],		           
		           	   		                
		           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
		           'This Year': [moment().startOf('year'), moment().endOf('year')],
		        },
		        locale: {
		        	format: 'DD-MMM-YYYY'
		        }
		    }, cb);
		    
		    $('#reportrange').on('apply.daterangepicker', function(ev, picker) {
			  //$scope.startDate = start;	
			   $scope.startDate = picker.startDate;
		       $scope.endDate = picker.endDate;
			 	$scope.$apply();
			  //console.log( "2. On App. : Start: " + $scope.startDate.format("DD-MMM-YYYY") + ", End: " + $scope.endDate.format("DD-MMM-YYYY") );			   		  
		      $scope.ListingQueue("Report");
			});
		
		    cb(start, end);
		    
	    
	    }, 200);
	}
	
	function UpdateMeetingDateSearch(){
	
		setTimeout(function(){		
		       
		    var ht = "<div style='display: inline;margin: 0px 20px;float:right;'><label>Creation Date : <input type='text' class='TableDateRangeFilter' name='reportrange' id='reportrange'/></label></div>";
		    $scope.dateApplired = false;
		    
		    $('#main-ListTable_filter').before(ht);
		    
		    var start =  $scope.startDate; //moment().subtract(29, 'days');
		    var end = $scope.endDate; //moment();
		
		    function cb(start, end) {
		       // $('#reportrange span').html( "Targert date from <b>" +  start.format('DD-MMM-YYYY') + '</b> to <b>' + end.format('DD-MMM-YYYY') + '</b>' );
		        $scope.startDate = start;
		        $scope.endDate = end;
		        /*
		        if($scope.firstTimeLoad){
		        	$scope.firstTimeLoad = false;					
				}
				else{
					console.log( "On Change : Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );
				}
				*/
				//console.log( "1. On Change : Start: " + startdt.format("DD-MMM-YYYY") + ", End: " + enddt.format("DD-MMM-YYYY") );				
				
		        $('#reportrange').val( start.format('DD-MMM-YYYY') + ' to ' + end.format('DD-MMM-YYYY')  );		        		        
		    }
		
		    $('#reportrange').daterangepicker({
		        startDate: start,
		        endDate: end,
		        ranges: {
		           'Last 7 days': [ moment().subtract(7, 'days'), moment() ],
		           'Today': [moment(), moment()],
		           /*'Last Two Days': [moment(), moment().add(2, 'days')],
		           'Next 7 Days': [moment(), moment().add(7, 'days')],
		           'L 30 Days': [moment(), moment().add(30, 'days')],*/
		           'This Month': [moment().startOf('month'), moment().endOf('month')],	
		          // 'Last Month': [moment().startOf('month'), moment().endOf('month')],		           
		           	   		                
		           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],
		           'This Year': [moment().startOf('year'), moment().endOf('year')],
		        },
		        locale: {
		        	format: 'DD-MMM-YYYY'
		        }
		    }, cb);
		    
		    $('#reportrange').on('apply.daterangepicker', function(ev, picker) {
			  //$scope.startDate = start;	
			   $scope.startDate = picker.startDate;
		       $scope.endDate = picker.endDate;

			  //console.log( "2. On App. : Start: " + $scope.startDate.format("DD-MMM-YYYY") + ", End: " + $scope.endDate.format("DD-MMM-YYYY") );			   		  
		      $scope.ListingQueue($scope.QuqueTitle);
			});
		
		    cb(start, end);
		    
	    
	    }, 200);
	}


	
	
	
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Flow\GoJsFunctions.js```FileName```// function FlowDiagramInit(){
		    
//     setTimeout(function(){
//         $(".main").css("margin-left", "5px");
//         GoJSFlowDiagramInit();			
//     }, 1000);

//     //window.addEventListener('DOMContentLoaded', init);
// }



function GoJSFlowDiagramInit() {
 
  var $ = go.GraphObject.make;  // for conciseness in defining templates

  myDiagram =
    $(go.Diagram, "myDiagramDiv",  // must name or refer to the DIV HTML element
      {
        grid: $(go.Panel, "Grid",
          $(go.Shape, "LineH", { stroke: "lightgray", strokeWidth: 0.25 }),
          $(go.Shape, "LineH", { stroke: "gray", strokeWidth: 0.25, interval: 10 }),
          $(go.Shape, "LineV", { stroke: "lightgray", strokeWidth: 0.25 }),
          $(go.Shape, "LineV", { stroke: "gray", strokeWidth: 0.25, interval: 10 })
        ),
        "draggingTool.dragsLink": true,
        "draggingTool.isGridSnapEnabled": true,
        "linkingTool.isUnconnectedLinkValid": true,
        "linkingTool.portGravity": 20,
        "relinkingTool.isUnconnectedLinkValid": true,
        "relinkingTool.portGravity": 20,
        "relinkingTool.fromHandleArchetype":
          $(go.Shape, "Diamond", { segmentIndex: 0, cursor: "pointer", desiredSize: new go.Size(8, 8), fill: "tomato", stroke: "darkred" }),
        "relinkingTool.toHandleArchetype":
          $(go.Shape, "Diamond", { segmentIndex: -1, cursor: "pointer", desiredSize: new go.Size(8, 8), fill: "darkred", stroke: "tomato" }),
        "linkReshapingTool.handleArchetype":
          $(go.Shape, "Diamond", { desiredSize: new go.Size(7, 7), fill: "lightblue", stroke: "deepskyblue" }),
        "rotatingTool.handleAngle": 270,
        "rotatingTool.handleDistance": 30,
        "rotatingTool.snapAngleMultiple": 15,
        "rotatingTool.snapAngleEpsilon": 15,
        "undoManager.isEnabled": true
      });

  // when the document is modified, add a "*" to the title and enable the "Save" button
  myDiagram.addDiagramListener("Modified", function(e) {
    var button = document.getElementById("SaveButton");
    if (button) button.disabled = !myDiagram.isModified;
    var idx = document.title.indexOf("*");
    if (myDiagram.isModified) {
      if (idx < 0) document.title += "*";
    } else {
      if (idx >= 0) document.title = document.title.substr(0, idx);
    }
  });

  // Define a function for creating a "port" that is normally transparent.
  // The "name" is used as the GraphObject.portId, the "spot" is used to control how links connect
  // and where the port is positioned on the node, and the boolean "output" and "input" arguments
  // control whether the user can draw links from or to the port.
  function makePort(name, spot, output, input) {
    // the port is basically just a small transparent circle
    return $(go.Shape, "Circle",
      {
        fill: null,  // not seen, by default; set to a translucent gray by showSmallPorts, defined below
        stroke: null,
        desiredSize: new go.Size(7, 7),
        alignment: spot,  // align the port on the main Shape
        alignmentFocus: spot,  // just inside the Shape
        portId: name,  // declare this object to be a "port"
        fromSpot: spot, toSpot: spot,  // declare where links may connect at this port
        fromLinkable: output, toLinkable: input,  // declare whether the user may draw links to/from here
        cursor: "pointer"  // show a different cursor to indicate potential link point
      });
  }

  var nodeSelectionAdornmentTemplate =
    $(go.Adornment, "Auto",
      $(go.Shape, { fill: null, stroke: "deepskyblue", strokeWidth: 1.5, strokeDashArray: [4, 2] }),
      $(go.Placeholder)
    );

  var nodeResizeAdornmentTemplate =
    $(go.Adornment, "Spot",
      { locationSpot: go.Spot.Right },
      $(go.Placeholder),
      $(go.Shape, { alignment: go.Spot.TopLeft, cursor: "nw-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),
      $(go.Shape, { alignment: go.Spot.Top, cursor: "n-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),
      $(go.Shape, { alignment: go.Spot.TopRight, cursor: "ne-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),

      $(go.Shape, { alignment: go.Spot.Left, cursor: "w-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),
      $(go.Shape, { alignment: go.Spot.Right, cursor: "e-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),

      $(go.Shape, { alignment: go.Spot.BottomLeft, cursor: "se-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),
      $(go.Shape, { alignment: go.Spot.Bottom, cursor: "s-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" }),
      $(go.Shape, { alignment: go.Spot.BottomRight, cursor: "sw-resize", desiredSize: new go.Size(6, 6), fill: "lightblue", stroke: "deepskyblue" })
    );

  var nodeRotateAdornmentTemplate =
    $(go.Adornment,
      { locationSpot: go.Spot.Center, locationObjectName: "ELLIPSE" },
      $(go.Shape, "Ellipse", { name: "ELLIPSE", cursor: "pointer", desiredSize: new go.Size(7, 7), fill: "lightblue", stroke: "deepskyblue" }),
      $(go.Shape, { geometryString: "M3.5 7 L3.5 30", isGeometryPositioned: true, stroke: "deepskyblue", strokeWidth: 1.5, strokeDashArray: [4, 2] })
    );

  myDiagram.nodeTemplate =
    $(go.Node, "Spot",
      { locationSpot: go.Spot.Center },
      new go.Binding("location", "loc", go.Point.parse).makeTwoWay(go.Point.stringify),
      { selectable: true, selectionAdornmentTemplate: nodeSelectionAdornmentTemplate },
      { resizable: true, resizeObjectName: "PANEL", resizeAdornmentTemplate: nodeResizeAdornmentTemplate },
      { rotatable: true, rotateAdornmentTemplate: nodeRotateAdornmentTemplate },
      new go.Binding("angle").makeTwoWay(),
      // the main object is a Panel that surrounds a TextBlock with a Shape
      $(go.Panel, "Auto",
        { name: "PANEL" },
        new go.Binding("desiredSize", "size", go.Size.parse).makeTwoWay(go.Size.stringify),
        $(go.Shape, "Rectangle",  // default figure
          {
            portId: "", // the default port: if no spot on link data, use closest side
            fromLinkable: true, toLinkable: true, cursor: "pointer",
            fill: "white",  // default color
            strokeWidth: 2,
            //stroke: "red" // status border color               
          },
         // {stroke: "red" },
       
           
           new go.Binding('stroke', "borderColor",  function(borderColor) {
              return borderColor; // "#" + Math.floor(Math.random()*16777215).toString(16);
            }),
           
          new go.Binding("figure"),
          new go.Binding("fill")),
        $(go.TextBlock,
          {
            font: "bold 11pt Helvetica, Arial, sans-serif",
            margin: 1,
            maxSize: new go.Size(250, NaN),
            wrap: go.TextBlock.WrapFit,
            editable: true
          },
          new go.Binding("text").makeTwoWay())
      ),
      // four small named ports, one on each side:
      makePort("T", go.Spot.Top, false, true),
      makePort("L", go.Spot.Left, true, true),
      makePort("R", go.Spot.Right, true, true),
      makePort("B", go.Spot.Bottom, true, false),
      { // handle mouse enter/leave events to show/hide the ports
        mouseEnter: function(e, node) { showSmallPorts(node, true); },
        mouseLeave: function(e, node) { showSmallPorts(node, false); }
      }
    );

  function showSmallPorts(node, show) {
    node.ports.each(function(port) {
      if (port.portId !== "") {  // don't change the default port, which is the big shape
        port.fill = show ? "rgba(0,0,0,.3)" : null;
      }
    });
  }

  var linkSelectionAdornmentTemplate =
    $(go.Adornment, "Link",
      $(go.Shape,
        // isPanelMain declares that this Shape shares the Link.geometry
        { isPanelMain: true, fill: null, stroke: "deepskyblue", strokeWidth: 0 })  // use selection object's strokeWidth
    );

  myDiagram.linkTemplate =
    $(go.Link,  // the whole link panel
      { selectable: true, selectionAdornmentTemplate: linkSelectionAdornmentTemplate},
      { relinkableFrom: true, relinkableTo: true, reshapable: true  },
      {
        routing: go.Link.AvoidsNodes,
        curve: go.Link.JumpOver,
        corner: 5,
        toShortLength: 4
      },
      new go.Binding("points").makeTwoWay(),
      $(go.Shape,  // the link path shape
        { isPanelMain: true, strokeWidth: 2   },
        
        //{stroke: "red" } 
        
        new go.Binding('stroke', "color",  function(color) {
          return color; // "#" + Math.floor(Math.random()*16777215).toString(16);
        })
        
        
        ), //link color //stroke: "#" + Math.floor(Math.random()*16777215).toString(16)
      $(go.Shape,  // the arrowhead
        { toArrow: "Standard", stroke: null }, 
        
        new go.Binding('stroke', "color",  function(color) {
          return color; // "#" + Math.floor(Math.random()*16777215).toString(16);
        })
        
      ),

      $(go.Panel, "Auto",
        
        $(go.Shape, "RoundedRectangle",  // the link shape
          { fill: "#F8F8F8", strokeWidth: 2   },
          //{stroke: "red" } 
          
           new go.Binding('stroke', "color",  function(color) {
              return color; // "#" + Math.floor(Math.random()*16777215).toString(16);
           })

          
          ),
        $(go.TextBlock,
          {
            textAlign: "center",
            font: "10pt helvetica, arial, sans-serif",
            stroke: "#6b5b95",
            margin: 2,
            minSize: new go.Size(10, NaN),
            editable: true
          },
          new go.Binding("text").makeTwoWay()) //Link Text
      )

    );

    GoJSFlowDiagramLoadFlowDiagram();  // load an initial diagram from some JSON text

  // initialize the Palette that is on the left side of the page
  myPalette =
    $(go.Palette, "myPaletteDiv",  // must name or refer to the DIV HTML element
      {
        maxSelectionCount: 1,
        nodeTemplateMap: myDiagram.nodeTemplateMap,  // share the templates used by myDiagram
        linkTemplate: // simplify the link template, just in this Palette
          $(go.Link,
            { // because the GridLayout.alignment is Location and the nodes have locationSpot == Spot.Center,
              // to line up the Link in the same manner we have to pretend the Link has the same location spot
              locationSpot: go.Spot.Center,
              selectionAdornmentTemplate:
                $(go.Adornment, "Link",
                  { locationSpot: go.Spot.Center },
                  $(go.Shape,
                    { isPanelMain: true, fill: null, stroke: "deepskyblue", strokeWidth: 0 }),
                  $(go.Shape,  // the arrowhead
                    { toArrow: "OpenTriangle", stroke: null })
                )
            },
            {
              routing: go.Link.AvoidsNodes,
              curve: go.Link.JumpOver,
              corner: 5,
              toShortLength: 4
            },
            new go.Binding("points"),
            $(go.Shape,  // the link path shape
              { isPanelMain: true, strokeWidth: 2 }),
            $(go.Shape,  // the arrowhead
              { toArrow: "OpenTriangle", stroke: null })
          ),
        model: new go.GraphLinksModel([  // specify the contents of the Palette
          { text: "Start", figure: "Ellipse", "size":"75 75", fill: "#00AD5F" },
          { text: "Step" },
          { text: "DB", figure: "Database", fill: "lightgray" },
          { text: "???", figure: "Diamond", fill: "lightskyblue" },
          { text: "End", figure: "Ellipse", "size":"75 75", fill: "#CE0620" },
          { text: "Comment", figure: "RoundedRectangle", fill: "lightyellow" }
        ], [
            // the Palette also has a disconnected Link, which the user can drag-and-drop
            { points: new go.List(/*go.Point*/).addAll([new go.Point(0, 0), new go.Point(30, 0), new go.Point(30, 40), new go.Point(60, 40)]) }
          ])
      });
}


function GoJSFlowDiagramSaveFlowDiagram() {
  saveDiagramProperties();  // do this first, before writing to JSON
  document.getElementById("mySavedModel").value = myDiagram.model.toJson();
  myDiagram.isModified = false;
  
   GoJSFlowDiagramUpdateJSONField(myDiagram.model.toJson() )
}
function GoJSFlowDiagramLoadFlowDiagram() {
  myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
  myDiagram.model = GenrateModel();
  loadDiagramProperties();  // do this after the Model.modelData has been brought into memory
}

function loadFromText() {
  myDiagram.model = go.Model.fromJson(document.getElementById("mySavedModel").value);
  //myDiagram.model = GenrateModel();
  loadDiagramProperties();  // do this after the Model.modelData has been brought into memory
}




function saveDiagramProperties() {
  myDiagram.model.modelData.position = go.Point.stringify(myDiagram.position);
}
function loadDiagramProperties(e) {
  // set Diagram.initialPosition, not Diagram.position, to handle initialization side-effects
  var pos = myDiagram.model.modelData.position;
  if (pos) myDiagram.initialPosition = go.Point.parse(pos);
}


function GoJSFlowDiagramLoadFlowDiagramAddStatus(title, id, jsonArr, showStatusCode, colorId){

    colorId ? colorId = colorId : colorId = id;
    var add = true;
    for(i=0;i<statusList.length;i++){
        if(  statusList[i].key ==  id ){
            add = false;
            break;
        }
    }

    if(add){
        var status = {};
        
        

        var colorCode = "blue";
        for(i=0;i<WakalaStatusList.length;i++){
            if( WakalaStatusList[i].StatusId ==  colorId ){
                colorCode = WakalaStatusList[i].BorderColor;
                break;
            }
        }

        if(showStatusCode){    	
            status.text = title + "[" + id + "]";	
        }
        else{
            status.text = title;
        }	
        
        status.key= id;
        status.size = "250 40" ;
        status.borderColor = colorCode;
        
        var js = null;
        for(i=0;i<jsonArr.length;i++){
            if(  jsonArr[i].key ==  id ){
                js = jsonArr[i];
                break;
            } 		
        }
        if(js){
            status.loc = js.loc;
        }
        else{
            status.loc = "-180 " + yaxis;	
            yaxis = yaxis + 70;	
        }				    	
        statusList.push(status );
    }
}

var yaxis = -200;
var statusList = [];
var JsonID = 0;
var WakalaStatusList;

function GenrateModel(){

    WakalaStatusList = GetListData("DerivativesStatus" );

    
    var flowList = "Derivatives";
    var Filter = "&$filter=Title eq '" + flowList + "'";	
    var flowList = "DerivativesProcessFlow"; // "WakalaFlowDLA";
    
    var jsonList = GetListData("DiagramJSON", Filter );
    if(jsonList.length > 0){
        JsonID = jsonList[0].ID;
    }
    var nodeDataArray = [];
     var linkDataArray = [];    
    if(jsonList[0].JSON){
	    var nodeDataArray = JSON.parse(jsonList[0].JSON).nodeDataArray;
	    var linkDataArray = JSON.parse(jsonList[0].JSON).linkDataArray;
    }
    //var Filter = "&$filter=ActionType eq 'Action' or ActionType eq 'ForDiagram' ";
    var Filter = ",ToStatus/StatusId,FromStatus/Title,FromStatus/StatusId,ToStatus/Title&$expand=ToStatus/Id&$expand=FromStatus/Id&$orderby= ID asc";
    var flows = GetListData(flowList, Filter);			
    /*
    GoJSFlowDiagramLoadFlowDiagramAddStatus("Business", 200, nodeDataArray, false, 1);
    GoJSFlowDiagramLoadFlowDiagramAddStatus("TRY Queue", 201, nodeDataArray, false, 21);
    GoJSFlowDiagramLoadFlowDiagramAddStatus("TRY Picked Queue", 202, nodeDataArray, false, 31);
    GoJSFlowDiagramLoadFlowDiagramAddStatus("DLA Approval", 203, nodeDataArray, false, 70);
    GoJSFlowDiagramLoadFlowDiagramAddStatus("TF/ARC", 204, nodeDataArray, false, 51);
  */

    var flowList = [];
    flows.forEach((fl) => {
    
        var addFromSt = true;
        var addToSt = true;		
        GoJSFlowDiagramLoadFlowDiagramAddStatus(fl.FromStatus.Title, fl.FromStatus.StatusId, nodeDataArray, true);
        GoJSFlowDiagramLoadFlowDiagramAddStatus(fl.ToStatus.Title, fl.ToStatus.StatusId, nodeDataArray, true);
        
        var colorCode = "blue";
        for(i=0;i<WakalaStatusList.length;i++){
            //if( WakalaStatusList[i].StatusId ==  fl.ToStatus.StatusId ){
            if( WakalaStatusList[i].StatusId ==  fl.FromStatus.StatusId ){

                colorCode = WakalaStatusList[i].BorderColor;
                break;
            }
        }
        
        var f = {};
        f.from = fl.FromStatus.StatusId;
        f.to = fl.ToStatus.StatusId;
        f.text =  fl.Title;
        f.color = colorCode; //fl.Color ? fl.Color : "#" + Math.floor(Math.random()*16777215).toString(16);
        f.fromPort = "B";
        f.toPort = "T";
        //f.colorCode = f1.colorCode;
        
        //f.points = "T";
        
        var js = null;
        for(i=0;i<linkDataArray.length;i++){
            if(  linkDataArray[i].from ==  fl.FromStatus.StatusId && linkDataArray[i].to ==  fl.ToStatus.StatusId ){
                js = linkDataArray[i];
                break;
            } 		
        }
        if(js){
            f.points= js.points;
        }
        
        flowList.push(f);
                                                
    });
    /*
    var model = {};
    
    model.class = "GraphLinksModel";
    model.linkFromPortIdProperty = "fromPort";
    model.linkToPortIdProperty = "toPort";
    model.modelData = {"position":"-451 -60"};
    model.nodeDataArray =  statusList;
    model.linkDataArray = [];
    */
    
    var model = go.Model.fromJson(document.getElementById("mySavedModel").value);
    model.modelData = {"position":"-800 -100"};
    model.nodeDataArray =  statusList;
    model.linkDataArray = flowList;

    
    return model;
        
}

function GoJSFlowDiagramUpdateJSONField( jsonVal)
{
debugger;
    if(!JsonID) return;
    
    var valuepairs = [];
    valuepairs.push( ["JSON", jsonVal ]);
    
    var RetVal = "";
    $().SPServices(
    {
        operation: 'UpdateListItems',
        listName: "DiagramJSON",
        ID: JsonID,
        valuepairs: valuepairs,
        async: false,
        completefunc: function(xData, Status) 
        {		
            if(Status== 'success') 
            {
                var strError = $(xData.responseXML).SPFilterNode('ErrorText').text();
                if(strError != "") 
                {
                    //alert(ListItemID );						
                    RetVal= "Error : " +  strError;	
                    alert(RetVal);
                                        
                }
                else
                {
//					console.log( "  xData.responseText : "+  xData.responseText );
                    alert("Updated.");
                }
            }			
        }
    });
    
    return RetVal;
        
}```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Flow\StatusFlow.html```FileName```


<div id="sample" data-ng-init="listCtrlOnLoad()">
  <div style="width: 100%; display: flex; justify-content: space-between">
    <div id="myPaletteDiv" style="width: 105px; margin-right: 2px; background-color: whitesmoke; border: solid 1px rgb(163, 133, 133);display: none;"></div>
    <div id="myDiagramDiv" style="flex-grow: 1; height: 1800px;width: 1250px; border: solid 1px black"></div>
  </div>

  <div style="break-after:page"></div>

 
  <div class="noprint">
    <div>
    	<input type="button" value="Save1"  onclick="GoJSFlowDiagramSaveFlowDiagram()" />
    	
	      <!--button id="SaveButton" onclick="save()" >Save</button-->
	      <input type="button" value="Load" onclick="loadFromText()"  />
      
      Diagram Model saved in JSON format:
    </div>
    <textarea id="mySavedModel" style="width:100%;height:300px;display:none" >                                                       
        { "class": "GraphLinksModel",
        "linkFromPortIdProperty": "fromPort",
        "linkToPortIdProperty": "toPort",
        "modelData": {"position":"-451 -60"},
        "nodeDataArray": [
      {"text":"Draft","key":11,"loc":"-180 -40","size":"250 30"},
      {"text":"Submitted","key":21,"loc":"210 90","size":"226 44"},
      {"text":"Resubmitted","key":22,"loc":"530 90","size":"250 46"},
      {"text":"Submitted – Picked by TRY","key":31,"loc":"220 230","size":"250 53"},
      {"text":"TRY Rejected","key":13,"loc":"540 571.5","size":"260 52"},
      {"text":"Rate Offered","key":12,"loc":"-170 90","size":"250 43"},
      {"text":"RM Accepted","key":23,"loc":"-320 357.5","size":"250 45"},
      {"text":"Negotiate","key":25,"loc":"-170 230","size":"250 45"},
      {"text":"RM Rejected","key":16,"loc":"-280 20","size":"155 30"},
      {"text":"Rejected","key":14,"loc":"560 719","size":"250 48"},
      {"text":"Accepted  – Picked by TRY","key":32,"loc":"-320 580","size":"250 58"},
      {"text":"TRY Approved","key":41,"loc":"100 580","size":"250 61"},
      {"text":"TRY Approved Picked by TF/ARC","key":51,"loc":"-310 740","size":"250 58"},
      {"text":"Validated","key":24,"loc":"-310 910","size":"250 52"},
      {"text":"Validated – Picked by TRY","key":33,"loc":"-310 1070","size":"250 60"},
      {"text":"TRY Returned","key":42,"loc":"190 1070","size":"253 57"},
      {"text":"TRY Confirmed","key":43,"loc":"-310 1250","size":"250 53"},
      {"text":"TRY Returned Picked up by TF/ARC","key":52,"loc":"190 910","size":"250 59"},
      {"text":"TRY Confirmed Picked up by TF/ARC","key":53,"loc":"-310 1430","size":"250 63"},
      {"text":"Deal Booked","key":15,"loc":"-310 1570","size":"250 30"},
      {"text":"Expired","key":100,"loc":"520 -30","size":"250 30"},
      {"text":"Pending with ENBD","key":64,"loc":"570 910","size":"250 62"},
      {"text":"Approved- Pending with TRY","key":26,"loc":"580 1100","size":"250 57"},
      {"text":"Approved- Picked up by TRY","key":27,"loc":"580 1270","size":"250 69"}
      ],
        "linkDataArray": [
      {"from":11,"to":21,"fromPort":"B","toPort":"T","text":"Submit","points":[-180,-25,-180,-15,-180,-12,210,-12,210,58,210,68]},
      {"from":13,"fromPort":"","toPort":"","text":"Resubmit","points":[540,545.5,540,535.5,540,327.75,623,327.75,623,120,623,110]},
      {"from":14,"to":22,"fromPort":"R","toPort":"R","text":"Resubmit","points":[685,719,695,719,695,90,680,90,665,90,655,90]},
      {"from":21,"to":31,"fromPort":"B","toPort":"T","text":"Pick up","points":[210,112,210,122,210,157.75,220,157.75,220,193.5,220,203.5]},
      {"from":31,"to":13,"fromPort":"B","toPort":"T","text":"Reject","points":[220,256.5,220,266.5,220,401,540,401,540,535.5,540,545.5]},
      {"from":31,"to":12,"fromPort":"B","toPort":"T","text":"Offer Rate","points":[220,256.5,220,266.5,25,266.5,25,58.5,-170,58.5,-170,68.5]},
      {"from":12,"to":23,"fromPort":"L","toPort":"T","text":"Accept","points":[-295,90,-305,90,-320,90,-320,207.5,-320,325,-320,335]},
      {"from":23,"to":32,"fromPort":"B","toPort":"T","text":"Pick up","points":[-320,380,-320,390,-320,465.5,-320,465.5,-320,541,-320,551]},
      {"from":32,"to":13,"fromPort":"B","toPort":"T","text":"Reject","points":[-320,609,-320,619,-320,620,-188,620,-188,532,540,532,540,535.5,540,545.5]},
      {"from":32,"to":41,"fromPort":"R","toPort":"L","text":"Approve","points":[-195,580,-185,580,-110,580,-110,580,-35,580,-25,580]},
      {"from":41,"to":51,"fromPort":"B","toPort":"T","text":"Pick up","points":[100,610.5,100,620.5,100,660.75,-310,660.75,-310,701,-310,711]},
      {"from":51,"to":14,"fromPort":"B","toPort":"T","text":"Reject","points":[-310,769,-310,779,125,779,125,685,560,685,560,695]},
      {"from":51,"to":24,"fromPort":"","toPort":"","text":"Validate","points":[-310,769,-310,779,-310,826.5,-310,826.5,-310,874,-310,884]},
      {"from":24,"to":33,"fromPort":"B","toPort":"T","text":"Pick up","points":[-310,936,-310,946,-310,988,-310,988,-310,1030,-310,1040]},
      {"from":33,"to":42,"fromPort":"R","toPort":"L","text":"Return to TF/ARC","points":[-185,1070,-175,1070,-60.75,1070,-60.75,1070,53.5,1070,63.5,1070]},
      {"from":33,"to":43,"fromPort":"B","toPort":"T","text":"Confirm","points":[-310,1100,-310,1110,-310,1161.75,-310,1161.75,-310,1213.5,-310,1223.5]},
      {"from":42,"to":52,"fromPort":"B","toPort":"T","text":"Pick up","points":[190,1098.5,190,1108.5,324.5,1108.5,324.5,870.5,190,870.5,190,880.5]},
      {"from":52,"to":14,"fromPort":"B","toPort":"T","text":"Reject","points":[190,939.5,190,949.5,375,949.5,375,685,560,685,560,695]},
      {"from":52,"to":24,"fromPort":"L","toPort":"R","text":"Validate","points":[65,910,55,910,-60,910,-60,910,-175,910,-185,910]},
      {"from":43,"to":53,"fromPort":"B","toPort":"T","text":"Pick up","points":[-310,1276.5,-310,1286.5,-310,1337.5,-310,1337.5,-310,1388.5,-310,1398.5]},
      {"from":53,"to":15,"fromPort":"B","toPort":"T","text":"Deal Booked","points":[-310,1461.5,-310,1471.5,-310,1508.25,-310,1508.25,-310,1545,-310,1555]},
      {"from":31,"to":21,"fromPort":"R","toPort":"R","text":"Back to Queue","points":[345,230,355,230,355,90,344,90,333,90,323,90]},
      {"from":32,"to":23,"fromPort":"B","toPort":"T","text":"Back to Queue","points":[-320,609,-320,619,-187,619,-187,325,-320,325,-320,335]},
      {"from":33,"to":24,"fromPort":"B","toPort":"T","text":"Back to Queue","points":[-310,1100,-310,1110,-310,1110,-172,1110,-172,876,-310,876,-310,874,-310,884]},
      {"from":51,"to":41,"fromPort":"B","toPort":"T","text":"Back to Queue","points":[-310,769,-310,779,-105,779,-105,539.5,100,539.5,100,549.5]},
      {"from":52,"to":42,"fromPort":"B","toPort":"T","text":"Back to Queue","points":[190,939.5,190,949.5,190,990.5,190,990.5,190,1031.5,190,1041.5]},
      {"from":53,"to":43,"fromPort":"B","toPort":"T","text":"Back to Queue","points":[-310,1461.5,-310,1471.5,-310,1471.5,-172,1471.5,-172,1212,-310,1212,-310,1213.5,-310,1223.5]},
      {"from":22,"to":31,"fromPort":"B","toPort":"","text":"Pick up","points":[530,113,530,123,530,230,442.5,230,355,230,345,230]},
      {"from":12,"to":25,"fromPort":"B","toPort":"T","text":"Negotiate","points":[-170,111.5,-170,121.5,-170,159.5,-170,159.5,-170,197.5,-170,207.5]},
      {"from":25,"to":31,"fromPort":"","toPort":"L","text":"Pick up","points":[-45,230,-35,230,25,230,25,230,85,230,95,230]},
      {"from":12,"to":16,"fromPort":"","toPort":"","text":"Reject","points":[-295,90,-305,90,-305,51.75,-192.5,51.75,-192.5,20,-202.5,20]},
      {"from":100,"to":22,"fromPort":"B","toPort":"T","text":"Resubmit","points":[520,-15,520,-5,520,26,530,26,530,57,530,67]},
      {"from":26,"to":27,"fromPort":"B","toPort":"T","text":"Pick up","points":[580,1128.5,580,1138.5,580,1182,580,1182,580,1225.5,580,1235.5]},
      {"from":27,"to":13,"fromPort":"L","toPort":"T","text":"Reject","points":[455,1270,445,1270,402,1270,402,535.5,540,535.5,540,545.5]},
      {"from":27,"to":22,"fromPort":"R","toPort":"R","text":"Back to Queue","points":[705,1270,715,1270,715,90,690,90,665,90,655,90]},
      {"from":29,"to":13,"fromPort":"B","toPort":"T","text":"Reject"},
      {"from":29,"to":12,"fromPort":"B","toPort":"T","text":"Offer Rate"},
      {"from":29,"to":21,"fromPort":"B","toPort":"T","text":"Back to Queue"},
      {"from":64,"to":26,"fromPort":"B","toPort":"T","text":"Approve","points":[570,941,570,951,570,1006.25,580,1006.25,580,1061.5,580,1071.5]},
      {"from":64,"to":13,"fromPort":"B","toPort":"R","text":"Reject","points":[570,941,570,951,570,951,708,951,708,571.5,680,571.5,670,571.5]},
      {"from":31,"to":21,"fromPort":"","toPort":"","text":"Send for Approval","points":[220,203.5,220,193.5,220,157.75,210,157.75,210,122,210,112]},
      {"from":32,"to":23,"fromPort":"B","toPort":"T","text":"Send for Approval","points":[-320,609,-320,619,-187,619,-187,325,-320,325,-320,335]}
      ]}

    

    

    

    </textarea>
  </div>
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\Flow\StatusFlow.js```FileName```DocApp.controller('StatusFlow', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad = function(){
		setTimeout(function(){
		
			$(".main").css("margin-left", "5px");
			GoJSFlowDiagramInit();			
		}, 1000);

	}
	
	
	
	


});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\HomePage\HomePage.html```FileName```<div class="panel panel-default" style="width: 100%;border-color:#fff" data-ng-init="listCtrlOnLoad()">
		
	<h3>Welcome {{CurrentUserName.Title}}<span style="color:red;font-weight:bold"> UAT</span></h3>
			
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\HomePage\HomePageCtrl.js```FileName```DocApp.controller('HomePageCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad= function(){
		SetSideBar("Home", "Home");			
		$scope.CurrentUserName = GetSiteConfig("CurrentUser");
		
		var page = GetQueryStringParams("page");
		if(page){
			//alert(page);
			window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/" + page;
		}			
	}
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\IiconList\IconList.html```FileName```<div class="panel panel-default" style="width: 100%;border-color:#fff" data-ng-init="listCtrlOnLoad()">
		
	<h3>IconList</h3>
	
	<div ng-repeat="icn in iconList" style=";;float:left;padding:1px;border:1px gray solid"  >	
		<div style="float:left;width:150px;padding-left:8px;padding-top:8px">{{icn}}</div>
		<div style="float:left;width:80px;background-color:#462157;color:white;;font-size:34px;text-align:center"><i class="fa fab font20" aria-hidden="true" ng-class="icn"  ></i></div>	
	</div>

			
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\IiconList\IconListCtrl.js```FileName```DocApp.controller('IconListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad= function(){
		SetSideBar("IconList", "Icon List");			
		setIconList();
				
	}
	
	function setIconList(){
	
		$scope.iconList = [
        	'fa-ad',
			'fa-address-book',
			'fa-address-card',
			'fa-adjust',
			'fa-air-freshener',
			'fa-align-center',
			'fa-align-justify',
			'fa-align-left',
			'fa-align-right',
			'fa-allergies',
			'fa-ambulance',
				'fa-american-sign-language-interpreting',
				'fa-anchor',
				'fa-angle-double-down',
				'fa-angle-double-left',
				'fa-angle-double-right',
				'fa-angle-double-up',
				'fa-angle-down',
				'fa-angle-left',
				'fa-angle-right',
				'fa-angle-up',
				'fa-angry',
				'fa-ankh',
				'fa-apple-alt',
				'fa-archive',
				'fa-archway',
				'fa-arrow-alt-circle-down',
				'fa-arrow-alt-circle-left',
				'fa-arrow-alt-circle-right',
				'fa-arrow-alt-circle-up',
				'fa-arrow-circle-down',
				'fa-arrow-circle-left',
				'fa-arrow-circle-right',
				'fa-arrow-circle-up',
				'fa-arrow-down',
				'fa-arrow-left',
				'fa-arrow-right',
				'fa-arrow-up',
				'fa-arrows-alt',
				'fa-arrows-alt-h',
				'fa-arrows-alt-v',
				'fa-assistive-listening-systems',
				'fa-asterisk',
				'fa-at',
				'fa-atlas',
				'fa-atom',
				'fa-audio-description',
				'fa-award',
				'fa-baby',
				'fa-baby-carriage',
				'fa-backspace',
				'fa-backward',
				'fa-bacon',
				'fa-bahai',
				'fa-balance-scale',
				'fa-balance-scale-left',
				'fa-balance-scale-right',
				'fa-ban',
				'fa-band-aid',
				'fa-barcode',
				'fa-bars',
				'fa-baseball-ball',
				'fa-basketball-ball',
				'fa-bath',
				'fa-battery-empty',
				'fa-battery-full',
				'fa-battery-half',
				'fa-battery-quarter',
				'fa-battery-three-quarters',
				'fa-bed',
				'fa-beer',
				'fa-bell',
				'fa-bell-slash',
				'fa-bezier-curve',
				'fa-bible',
				'fa-bicycle',
				'fa-biking',
				'fa-binoculars',
				'fa-biohazard',
				'fa-birthday-cake',
				'fa-blender',
				'fa-blender-phone',
				'fa-blind',
				'fa-blog',
				'fa-bold',
				'fa-bolt',
				'fa-bomb',
				'fa-bone',
				'fa-bong',
				'fa-book',
				'fa-book-dead',
				'fa-book-medical',
				'fa-book-open',
				'fa-book-reader',
				'fa-bookmark',
				'fa-border-all',
				'fa-border-none',
				'fa-border-style',
				'fa-bowling-ball',
				'fa-box',
				'fa-box-open',
				'fa-boxes',
				'fa-braille',
				'fa-brain',
				'fa-bread-slice',
				'fa-briefcase',
				'fa-briefcase-medical',
				'fa-broadcast-tower',
				'fa-broom',
				'fa-brush',
				'fa-bug',
				'fa-building',
				'fa-bullhorn',
				'fa-bullseye',
				'fa-burn',
				'fa-bus',
				'fa-bus-alt',
				'fa-business-time',
				'fa-calculator',
				'fa-calendar',
				'fa-calendar-alt',
				'fa-calendar-check',
				'fa-calendar-day',
				'fa-calendar-minus',
				'fa-calendar-plus',
				'fa-calendar-times',
				'fa-calendar-week',
				'fa-camera',
				'fa-camera-retro',
				'fa-campground',
				'fa-candy-cane',
				'fa-cannabis',
				'fa-capsules',
				'fa-car',
				'fa-car-alt',
				'fa-car-battery',
				'fa-car-crash',
				'fa-car-side',
				'fa-caravan',
				'fa-caret-down',
				'fa-caret-left',
				'fa-caret-right',
				'fa-caret-square-down',
				'fa-caret-square-left',
				'fa-caret-square-right',
				'fa-caret-square-up',
				'fa-caret-up',
				'fa-carrot',
				'fa-cart-arrow-down',
				'fa-cart-plus',
				'fa-cash-register',
				'fa-cat',
				'fa-certificate',
				'fa-chair',
				'fa-chalkboard',
				'fa-chalkboard-teacher',
				'fa-charging-station',
				'fa-chart-area',
				'fa-chart-bar',
				'fa-chart-line',
				'fa-chart-pie',
				'fa-check',
				'fa-check-circle',
				'fa-check-double',
				'fa-check-square',
				'fa-cheese',
				'fa-chess',
				'fa-chess-bishop',
				'fa-chess-board',
				'fa-chess-king',
				'fa-chess-knight',
				'fa-chess-pawn',
				'fa-chess-queen',
				'fa-chess-rook',
				'fa-chevron-circle-down',
				'fa-chevron-circle-left',
				'fa-chevron-circle-right',
				'fa-chevron-circle-up',
				'fa-chevron-down',
				'fa-chevron-left',
				'fa-chevron-right',
				'fa-chevron-up',
				'fa-child',
				'fa-church',
				'fa-circle',
				'fa-circle-notch',
				'fa-city',
				'fa-clinic-medical',
				'fa-clipboard',
				'fa-clipboard-check',
				'fa-clipboard-list',
				'fa-clock',
				'fa-clone',
				'fa-closed-captioning',
				'fa-cloud',
				'fa-cloud-download-alt',
				'fa-cloud-meatball',
				'fa-cloud-moon',
				'fa-cloud-moon-rain',
				'fa-cloud-rain',
				'fa-cloud-showers-heavy',
				'fa-cloud-sun',
				'fa-cloud-sun-rain',
				'fa-cloud-upload-alt',
				'fa-cocktail',
				'fa-code',
				'fa-code-branch',
				'fa-coffee',
				'fa-cog',
				'fa-cogs',
				'fa-coins',
				'fa-columns',
				'fa-comment',
				'fa-comment-alt',
				'fa-comment-dollar',
				'fa-comment-dots',
				'fa-comment-medical',
				'fa-comment-slash',
				'fa-comments',
				'fa-comments-dollar',
				'fa-compact-disc',
				'fa-compass',
				'fa-compress',
				'fa-compress-alt',
				'fa-compress-arrows-alt',
				'fa-concierge-bell',
				'fa-cookie',
				'fa-cookie-bite',
				'fa-copy',
				'fa-copyright',
				'fa-couch',
				'fa-credit-card',
				'fa-crop',
				'fa-crop-alt',
				'fa-cross',
				'fa-crosshairs',
				'fa-crow',
				'fa-crown',
				'fa-crutch',
				'fa-cube',
				'fa-cubes',
				'fa-cut',
				'fa-database',
				'fa-deaf',
				'fa-democrat',
				'fa-desktop',
				'fa-dharmachakra',
				'fa-diagnoses',
				'fa-dice',
				'fa-dice-d20',
				'fa-dice-d6',
				'fa-dice-five',
				'fa-dice-four',
				'fa-dice-one',
				'fa-dice-six',
				'fa-dice-three',
				'fa-dice-two',
				'fa-digital-tachograph',
				'fa-directions',
				'fa-divide',
				'fa-dizzy',
				'fa-dna',
				'fa-dog',
				'fa-dollar-sign',
				'fa-dolly',
				'fa-dolly-flatbed',
				'fa-donate',
				'fa-door-closed',
				'fa-door-open',
				'fa-dot-circle',
				'fa-dove',
				'fa-download',
				'fa-drafting-compass',
				'fa-dragon',
				'fa-draw-polygon',
				'fa-drum',
				'fa-drum-steelpan',
				'fa-drumstick-bite',
				'fa-dumbbell',
				'fa-dumpster',
				'fa-dumpster-fire',
				'fa-dungeon',
				'fa-edit',
				'fa-egg',
				'fa-eject',
				'fa-ellipsis-h',
				'fa-ellipsis-v',
				'fa-envelope',
				'fa-envelope-open',
				'fa-envelope-open-text',
				'fa-envelope-square',
				'fa-equals',
				'fa-eraser',
				'fa-ethernet',
				'fa-euro-sign',
				'fa-exchange-alt',
				'fa-exclamation',
				'fa-exclamation-circle',
				'fa-exclamation-triangle',
				'fa-expand',
				'fa-expand-alt',
				'fa-expand-arrows-alt',
				'fa-external-link-alt',
				'fa-external-link-square-alt',
				'fa-eye',
				'fa-eye-dropper',
				'fa-eye-slash',
				'fa-fan',
				'fa-fast-backward',
				'fa-fast-forward',
				'fa-fax',
				'fa-feather',
				'fa-feather-alt',
				'fa-female',
				'fa-fighter-jet',
				'fa-file',
				'fa-file-alt',
				'fa-file-archive',
				'fa-file-audio',
				'fa-file-code',
				'fa-file-contract',
				'fa-file-csv',
				'fa-file-download',
				'fa-file-excel',
				'fa-file-export',
				'fa-file-image',
				'fa-file-import',
				'fa-file-invoice',
				'fa-file-invoice-dollar',
				'fa-file-medical',
				'fa-file-medical-alt',
				'fa-file-pdf',
				'fa-file-powerpoint',
				'fa-file-prescription',
				'fa-file-signature',
				'fa-file-upload',
				'fa-file-video',
				'fa-file-word',
				'fa-fill',
				'fa-fill-drip',
				'fa-film',
				'fa-filter',
				'fa-fingerprint',
				'fa-fire',
				'fa-fire-alt',
				'fa-fire-extinguisher',
				'fa-first-aid',
				'fa-fish',
				'fa-fist-raised',
				'fa-flag',
				'fa-flag-checkered',
				'fa-flag-usa',
				'fa-flask',
				'fa-flushed',
				'fa-folder',
				'fa-folder-minus',
				'fa-folder-open',
				'fa-folder-plus',
				'fa-font',
				'fa-football-ball',
				'fa-forward',
				'fa-frog',
				'fa-frown',
				'fa-frown-open',
				'fa-funnel-dollar',
				'fa-futbol',
				'fa-gamepad',
				'fa-gas-pump',
				'fa-gavel',
				'fa-gem',
				'fa-genderless',
				'fa-ghost',
				'fa-gift',
				'fa-gifts',
				'fa-glass-cheers',
				'fa-glass-martini',
				'fa-glass-martini-alt',
				'fa-glass-whiskey',
				'fa-glasses',
				'fa-globe',
				'fa-globe-africa',
				'fa-globe-americas',
				'fa-globe-asia',
				'fa-globe-europe',
				'fa-golf-ball',
				'fa-gopuram',
				'fa-graduation-cap',
				'fa-greater-than',
				'fa-greater-than-equal',
				'fa-grimace',
				'fa-grin',
				'fa-grin-alt',
				'fa-grin-beam',
				'fa-grin-beam-sweat',
				'fa-grin-hearts',
				'fa-grin-squint',
				'fa-grin-squint-tears',
				'fa-grin-stars',
				'fa-grin-tears',
				'fa-grin-tongue',
				'fa-grin-tongue-squint',
				'fa-grin-tongue-wink',
				'fa-grin-wink',
				'fa-grip-horizontal',
				'fa-grip-lines',
				'fa-grip-lines-vertical',
				'fa-grip-vertical',
				'fa-guitar',
				'fa-h-square',
				'fa-hamburger',
				'fa-hammer',
				'fa-hamsa',
				'fa-hand-holding',
				'fa-hand-holding-heart',
				'fa-hand-holding-usd',
				'fa-hand-lizard',
				'fa-hand-middle-finger',
				'fa-hand-paper',
				'fa-hand-peace',
				'fa-hand-point-down',
				'fa-hand-point-left',
				'fa-hand-point-right',
				'fa-hand-point-up',
				'fa-hand-pointer',
				'fa-hand-rock',
				'fa-hand-scissors',
				'fa-hand-spock',
				'fa-hands',
				'fa-hands-helping',
				'fa-handshake',
				'fa-hanukiah',
				'fa-hard-hat',
				'fa-hashtag',
				'fa-hat-cowboy',
				'fa-hat-cowboy-side',
				'fa-hat-wizard',
				'fa-hdd',
				'fa-heading',
				'fa-headphones',
				'fa-headphones-alt',
				'fa-headset',
				'fa-heart',
				'fa-heart-broken',
				'fa-heartbeat',
				'fa-helicopter',
				'fa-highlighter',
				'fa-hiking',
				'fa-hippo',
				'fa-history',
				'fa-hockey-puck',
				'fa-holly-berry',
				'fa-home',
				'fa-horse',
				'fa-horse-head',
				'fa-hospital',
				'fa-hospital-alt',
				'fa-hospital-symbol',
				'fa-hot-tub',
				'fa-hotdog',
				'fa-hotel',
				'fa-hourglass',
				'fa-hourglass-end',
				'fa-hourglass-half',
				'fa-hourglass-start',
				'fa-house-damage',
				'fa-hryvnia',
				'fa-i-cursor',
				'fa-ice-cream',
				'fa-icicles',
				'fa-icons',
				'fa-id-badge',
				'fa-id-card',
				'fa-id-card-alt',
				'fa-igloo',
				'fa-image',
				'fa-images',
				'fa-inbox',
				'fa-indent',
				'fa-industry',
				'fa-infinity',
				'fa-info',
				'fa-info-circle',
				'fa-italic',
				'fa-jedi',
				'fa-joint',
				'fa-journal-whills',
				'fa-kaaba',
				'fa-key',
				'fa-keyboard',
				'fa-khanda',
				'fa-kiss',
				'fa-kiss-beam',
				'fa-kiss-wink-heart',
				'fa-kiwi-bird',
				'fa-landmark',
				'fa-language',
				'fa-laptop',
				'fa-laptop-code',
				'fa-laptop-medical',
				'fa-laugh',
				'fa-laugh-beam',
				'fa-laugh-squint',
				'fa-laugh-wink',
				'fa-layer-group',
				'fa-leaf',
				'fa-lemon',
				'fa-less-than',
				'fa-less-than-equal',
				'fa-level-down-alt',
				'fa-level-up-alt',
				'fa-life-ring',
				'fa-lightbulb',
				'fa-link',
				'fa-lira-sign',
				'fa-list',
				'fa-list-alt',
				'fa-list-ol',
				'fa-list-ul',
				'fa-location-arrow',
				'fa-lock',
				'fa-lock-open',
				'fa-long-arrow-alt-down',
				'fa-long-arrow-alt-left',
				'fa-long-arrow-alt-right',
				'fa-long-arrow-alt-up',
				'fa-low-vision',
				'fa-luggage-cart',
				'fa-magic',
				'fa-magnet',
				'fa-mail-bulk',
				'fa-male',
				'fa-map',
				'fa-map-marked',
				'fa-map-marked-alt',
				'fa-map-marker',
				'fa-map-marker-alt',
				'fa-map-pin',
				'fa-map-signs',
				'fa-marker',
				'fa-mars',
				'fa-mars-double',
				'fa-mars-stroke',
				'fa-mars-stroke-h',
				'fa-mars-stroke-v',
				'fa-mask',
				'fa-medal',
				'fa-medkit',
				'fa-meh',
				'fa-meh-blank',
				'fa-meh-rolling-eyes',
				'fa-memory',
				'fa-menorah',
				'fa-mercury',
				'fa-meteor',
				'fa-microchip',
				'fa-microphone',
				'fa-microphone-alt',
				'fa-microphone-alt-slash',
				'fa-microphone-slash',
				'fa-microscope',
				'fa-minus',
				'fa-minus-circle',
				'fa-minus-square',
				'fa-mitten',
				'fa-mobile',
				'fa-mobile-alt',
				'fa-money-bill',
				'fa-money-bill-alt',
				'fa-money-bill-wave',
				'fa-money-bill-wave-alt',
				'fa-money-check',
				'fa-money-check-alt',
				'fa-monument',
				'fa-moon',
				'fa-mortar-pestle',
				'fa-mosque',
				'fa-motorcycle',
				'fa-mountain',
				'fa-mouse',
				'fa-mouse-pointer',
				'fa-mug-hot',
				'fa-music',
				'fa-network-wired',
				'fa-neuter',
				'fa-newspaper',
				'fa-not-equal',
				'fa-notes-medical',
				'fa-object-group',
				'fa-object-ungroup',
				'fa-oil-can',
				'fa-om',
				'fa-otter',
				'fa-outdent',
				'fa-pager',
				'fa-paint-brush',
				'fa-paint-roller',
				'fa-palette',
				'fa-pallet',
				'fa-paper-plane',
				'fa-paperclip',
				'fa-parachute-box',
				'fa-paragraph',
				'fa-parking',
				'fa-passport',
				'fa-pastafarianism',
				'fa-paste',
				'fa-pause',
				'fa-pause-circle',
				'fa-paw',
				'fa-peace',
				'fa-pen',
				'fa-pen-alt',
				'fa-pen-fancy',
				'fa-pen-nib',
				'fa-pen-square',
				'fa-pencil-alt',
				'fa-pencil-ruler',
				'fa-people-carry',
				'fa-pepper-hot',
				'fa-percent',
				'fa-percentage',
				'fa-person-booth',
				'fa-phone',
				'fa-phone-alt',
				'fa-phone-slash',
				'fa-phone-square',
				'fa-phone-square-alt',
				'fa-phone-volume',
				'fa-photo-video',
				'fa-piggy-bank',
				'fa-pills',
				'fa-pizza-slice',
				'fa-place-of-worship',
				'fa-plane',
				'fa-plane-arrival',
				'fa-plane-departure',
				'fa-play',
				'fa-play-circle',
				'fa-plug',
				'fa-plus',
				'fa-plus-circle',
				'fa-plus-square',
				'fa-podcast',
				'fa-poll',
				'fa-poll-h',
				'fa-poo',
				'fa-poo-storm',
				'fa-poop',
				'fa-portrait',
				'fa-pound-sign',
				'fa-power-off',
				'fa-pray',
				'fa-praying-hands',
				'fa-prescription',
				'fa-prescription-bottle',
				'fa-prescription-bottle-alt',
				'fa-print',
				'fa-procedures',
				'fa-project-diagram',
				'fa-puzzle-piece',
				'fa-qrcode',
				'fa-question',
				'fa-question-circle',
				'fa-quidditch',
				'fa-quote-left',
				'fa-quote-right',
				'fa-quran',
				'fa-radiation',
				'fa-radiation-alt',
				'fa-rainbow',
				'fa-random',
				'fa-receipt',
				'fa-record-vinyl',
				'fa-recycle',
				'fa-redo',
				'fa-redo-alt',
				'fa-registered',
				'fa-remove-format',
				'fa-reply',
				'fa-reply-all',
				'fa-republican',
				'fa-restroom',
				'fa-retweet',
				'fa-ribbon',
				'fa-ring',
				'fa-road',
				'fa-robot',
				'fa-rocket',
				'fa-route',
				'fa-rss',
				'fa-rss-square',
				'fa-ruble-sign',
				'fa-ruler',
				'fa-ruler-combined',
				'fa-ruler-horizontal',
				'fa-ruler-vertical',
				'fa-running',
				'fa-rupee-sign',
				'fa-sad-cry',
				'fa-sad-tear',
				'fa-satellite',
				'fa-satellite-dish',
				'fa-save',
				'fa-school',
				'fa-screwdriver',
				'fa-scroll',
				'fa-sd-card',
				'fa-search',
				'fa-search-dollar',
				'fa-search-location',
				'fa-search-minus',
				'fa-search-plus',
				'fa-seedling',
				'fa-server',
				'fa-shapes',
				'fa-share',
				'fa-share-alt',
				'fa-share-alt-square',
				'fa-share-square',
				'fa-shekel-sign',
				'fa-shield-alt',
				'fa-ship',
				'fa-shipping-fast',
				'fa-shoe-prints',
				'fa-shopping-bag',
				'fa-shopping-basket',
				'fa-shopping-cart',
				'fa-shower',
				'fa-shuttle-van',
				'fa-sign',
				'fa-sign-in-alt',
				'fa-sign-language',
				'fa-sign-out-alt',
				'fa-signal',
				'fa-signature',
				'fa-sim-card',
				'fa-sitemap',
				'fa-skating',
				'fa-skiing',
				'fa-skiing-nordic',
				'fa-skull',
				'fa-skull-crossbones',
				'fa-slash',
				'fa-sleigh',
				'fa-sliders-h',
				'fa-smile',
				'fa-smile-beam',
				'fa-smile-wink',
				'fa-smog',
				'fa-smoking',
				'fa-smoking-ban',
				'fa-sms',
				'fa-snowboarding',
				'fa-snowflake',
				'fa-snowman',
				'fa-snowplow',
				'fa-socks',
				'fa-solar-panel',
				'fa-sort',
				'fa-sort-alpha-down',
				'fa-sort-alpha-down-alt',
				'fa-sort-alpha-up',
				'fa-sort-alpha-up-alt',
				'fa-sort-amount-down',
				'fa-sort-amount-down-alt',
				'fa-sort-amount-up',
				'fa-sort-amount-up-alt',
				'fa-sort-down',
				'fa-sort-numeric-down',
				'fa-sort-numeric-down-alt',
				'fa-sort-numeric-up',
				'fa-sort-numeric-up-alt',
				'fa-sort-up',
				'fa-spa',
				'fa-space-shuttle',
				'fa-spell-check',
				'fa-spider',
				'fa-spinner',
				'fa-splotch',
				'fa-spray-can',
				'fa-square',
				'fa-square-full',
				'fa-square-root-alt',
				'fa-stamp',
				'fa-star',
				'fa-star-and-crescent',
				'fa-star-half',
				'fa-star-half-alt',
				'fa-star-of-david',
				'fa-star-of-life',
				'fa-step-backward',
				'fa-step-forward',
				'fa-stethoscope',
				'fa-sticky-note',
				'fa-stop',
				'fa-stop-circle',
				'fa-stopwatch',
				'fa-store',
				'fa-store-alt',
				'fa-stream',
				'fa-street-view',
				'fa-strikethrough',
				'fa-stroopwafel',
				'fa-subscript',
				'fa-subway',
				'fa-suitcase',
				'fa-suitcase-rolling',
				'fa-sun',
				'fa-superscript',
				'fa-surprise',
				'fa-swatchbook',
				'fa-swimmer',
				'fa-swimming-pool',
				'fa-synagogue',
				'fa-sync',
				'fa-sync-alt',
				'fa-syringe',
				'fa-table',
				'fa-table-tennis',
				'fa-tablet',
				'fa-tablet-alt',
				'fa-tablets',
				'fa-tachometer-alt',
				'fa-tag',
				'fa-tags',
				'fa-tape',
				'fa-tasks',
				'fa-taxi',
				'fa-teeth',
				'fa-teeth-open',
				'fa-temperature-high',
				'fa-temperature-low',
				'fa-tenge',
				'fa-terminal',
				'fa-text-height',
				'fa-text-width',
				'fa-th',
				'fa-th-large',
				'fa-th-list',
				'fa-theater-masks',
				'fa-thermometer',
				'fa-thermometer-empty',
				'fa-thermometer-full',
				'fa-thermometer-half',
				'fa-thermometer-quarter',
				'fa-thermometer-three-quarters',
				'fa-thumbs-down',
				'fa-thumbs-up',
				'fa-thumbtack',
				'fa-ticket-alt',
				'fa-times',
				'fa-times-circle',
				'fa-tint',
				'fa-tint-slash',
				'fa-tired',
				'fa-toggle-off',
				'fa-toggle-on',
				'fa-toilet',
				'fa-toilet-paper',
				'fa-toolbox',
				'fa-tools',
				'fa-tooth',
				'fa-torah',
				'fa-torii-gate',
				'fa-tractor',
				'fa-trademark',
				'fa-traffic-light',
				'fa-trailer',
				'fa-train',
				'fa-tram',
				'fa-transgender',
				'fa-transgender-alt',
				'fa-trash',
				'fa-trash-alt',
				'fa-trash-restore',
				'fa-trash-restore-alt',
				'fa-tree',
				'fa-trophy',
				'fa-truck',
				'fa-truck-loading',
				'fa-truck-monster',
				'fa-truck-moving',
				'fa-truck-pickup',
				'fa-tshirt',
				'fa-tty',
				'fa-tv',
				'fa-umbrella',
				'fa-umbrella-beach',
				'fa-underline',
				'fa-undo',
				'fa-undo-alt',
				'fa-universal-access',
				'fa-university',
				'fa-unlink',
				'fa-unlock',
				'fa-unlock-alt',
				'fa-upload',
				'fa-user',
				'fa-user-alt',
				'fa-user-alt-slash',
				'fa-user-astronaut',
				'fa-user-check',
				'fa-user-circle',
				'fa-user-clock',
				'fa-user-cog',
				'fa-user-edit',
				'fa-user-friends',
				'fa-user-graduate',
				'fa-user-injured',
				'fa-user-lock',
				'fa-user-md',
				'fa-user-minus',
				'fa-user-ninja',
				'fa-user-nurse',
				'fa-user-plus',
				'fa-user-secret',
				'fa-user-shield',
				'fa-user-slash',
				'fa-user-tag',
				'fa-user-tie',
				'fa-user-times',
				'fa-users',
				'fa-users-cog',
				'fa-utensil-spoon',
				'fa-utensils',
				'fa-vector-square',
				'fa-venus',
				'fa-venus-double',
				'fa-venus-mars',
				'fa-vial',
				'fa-vials',
				'fa-video',
				'fa-video-slash',
				'fa-vihara',
				'fa-voicemail',
				'fa-volleyball-ball',
				'fa-volume-down',
				'fa-volume-mute',
				'fa-volume-off',
				'fa-volume-up',
				'fa-vote-yea',
				'fa-vr-cardboard',
				'fa-walking',
				'fa-wallet',
				'fa-warehouse',
				'fa-water',
				'fa-wave-square',
				'fa-weight',
				'fa-weight-hanging',
				'fa-wheelchair',
				'fa-wifi',
				'fa-wind',
				'fa-window-close',
				'fa-window-maximize',
				'fa-window-minimize',
				'fa-window-restore',
				'fa-wine-bottle',
				'fa-wine-glass',
				'fa-wine-glass-alt',
				'fa-won-sign',
				'fa-wrench',
				'fa-x-ray',
				'fa-yen-sign',
				'fa-yin-yang',
				'fa-500px',
				'fa-accessible-icon',
				'fa-accusoft',
				'fa-acquisitions-incorporated',
				'fa-adn',
				'fa-adobe',
				'fa-adversal',
				'fa-affiliatetheme',
				'fa-airbnb',
				'fa-algolia',
				'fa-alipay',
				'fa-amazon',
				'fa-amazon-pay',
				'fa-amilia',
				'fa-android',
				'fa-angellist',
				'fa-angrycreative',
				'fa-angular',
				'fa-app-store',
				'fa-app-store-ios',
				'fa-apper',
				'fa-apple',
				'fa-apple-pay',
				'fa-artstation',
				'fa-asymmetrik',
				'fa-atlassian',
				'fa-audible',
				'fa-autoprefixer',
				'fa-avianex',
				'fa-aviato',
				'fa-aws',
				'fa-bandcamp',
				'fa-battle-net',
				'fa-behance',
				'fa-behance-square',
				'fa-bimobject',
				'fa-bitbucket',
				'fa-bitcoin',
				'fa-bity',
				'fa-black-tie',
				'fa-blackberry',
				'fa-blogger',
				'fa-blogger-b',
				'fa-bluetooth',
				'fa-bluetooth-b',
				'fa-bootstrap',
				'fa-btc',
				'fa-buffer',
				'fa-buromobelexperte',
				'fa-buy-n-large',
				'fa-buysellads',
				'fa-canadian-maple-leaf',
				'fa-cc-amazon-pay',
				'fa-cc-amex',
				'fa-cc-apple-pay',
				'fa-cc-diners-club',
				'fa-cc-discover',
				'fa-cc-jcb',
				'fa-cc-mastercard',
				'fa-cc-paypal',
				'fa-cc-stripe',
				'fa-cc-visa',
				'fa-centercode',
				'fa-centos',
				'fa-chrome',
				'fa-chromecast',
				'fa-cloudscale',
				'fa-cloudsmith',
				'fa-cloudversify',
				'fa-codepen',
				'fa-codiepie',
				'fa-confluence',
				'fa-connectdevelop',
				'fa-contao',
				'fa-cotton-bureau',
				'fa-cpanel',
				'fa-creative-commons',
				'fa-creative-commons-by',
				'fa-creative-commons-nc',
				'fa-creative-commons-nc-eu',
				'fa-creative-commons-nc-jp',
				'fa-creative-commons-nd',
				'fa-creative-commons-pd',
				'fa-creative-commons-pd-alt',
				'fa-creative-commons-remix',
				'fa-creative-commons-sa',
				'fa-creative-commons-sampling',
				'fa-creative-commons-sampling-plus',
				'fa-creative-commons-share',
				'fa-creative-commons-zero',
				'fa-critical-role',
				'fa-css3',
				'fa-css3-alt',
				'fa-cuttlefish',
				'fa-d-and-d',
				'fa-d-and-d-beyond',
				'fa-dailymotion',
				'fa-dashcube',
				'fa-delicious',
				'fa-deploydog',
				'fa-deskpro',
				'fa-dev',
				'fa-deviantart',
				'fa-dhl',
				'fa-diaspora',
				'fa-digg',
				'fa-digital-ocean',
				'fa-discord',
				'fa-discourse',
				'fa-dochub',
				'fa-docker',
				'fa-draft2digital',
				'fa-dribbble',
				'fa-dribbble-square',
				'fa-dropbox',
				'fa-drupal',
				'fa-dyalog',
				'fa-earlybirds',
				'fa-ebay',
				'fa-edge',
				'fa-elementor',
				'fa-ello',
				'fa-ember',
				'fa-empire',
				'fa-envira',
				'fa-erlang',
				'fa-ethereum',
				'fa-etsy',
				'fa-evernote',
				'fa-expeditedssl',
				'fa-facebook',
				'fa-facebook-f',
				'fa-facebook-messenger',
				'fa-facebook-square',
				'fa-fantasy-flight-games',
				'fa-fedex',
				'fa-fedora',
				'fa-figma',
				'fa-firefox',
				'fa-firefox-browser',
				'fa-first-order',
				'fa-first-order-alt',
				'fa-firstdraft',
				'fa-flickr',
				'fa-flipboard',
				'fa-fly',
				'fa-font-awesome',
				'fa-font-awesome-alt',
				'fa-font-awesome-flag',
				'fa-fonticons',
				'fa-fonticons-fi',
				'fa-fort-awesome',
				'fa-fort-awesome-alt',
				'fa-forumbee',
				'fa-foursquare',
				'fa-free-code-camp',
				'fa-freebsd',
				'fa-fulcrum',
				'fa-galactic-republic',
				'fa-galactic-senate',
				'fa-get-pocket',
				'fa-gg',
				'fa-gg-circle',
				'fa-git',
				'fa-git-alt',
				'fa-git-square',
				'fa-github',
				'fa-github-alt',
				'fa-github-square',
				'fa-gitkraken',
				'fa-gitlab',
				'fa-gitter',
				'fa-glide',
				'fa-glide-g',
				'fa-gofore',
				'fa-goodreads',
				'fa-goodreads-g',
				'fa-google',
				'fa-google-drive',
				'fa-google-play',
				'fa-google-plus',
				'fa-google-plus-g',
				'fa-google-plus-square',
				'fa-google-wallet',
				'fa-gratipay',
				'fa-grav',
				'fa-gripfire',
				'fa-grunt',
				'fa-gulp',
				'fa-hacker-news',
				'fa-hacker-news-square',
				'fa-hackerrank',
				'fa-hips',
				'fa-hire-a-helper',
				'fa-hooli',
				'fa-hornbill',
				'fa-hotjar',
				'fa-houzz',
				'fa-html5',
				'fa-hubspot',
				'fa-ideal',
				'fa-imdb',
				'fa-instagram',
				'fa-instagram-square',
				'fa-intercom',
				'fa-internet-explorer',
				'fa-invision',
				'fa-ioxhost',
				'fa-itch-io',
				'fa-itunes',
				'fa-itunes-note',
				'fa-java',
				'fa-jedi-order',
				'fa-jenkins',
				'fa-jira',
				'fa-joget',
				'fa-joomla',
				'fa-js',
				'fa-js-square',
				'fa-jsfiddle',
				'fa-kaggle',
				'fa-keybase',
				'fa-keycdn',
				'fa-kickstarter',
				'fa-kickstarter-k',
				'fa-korvue',
				'fa-laravel',
				'fa-lastfm',
				'fa-lastfm-square',
				'fa-leanpub',
				'fa-less',
				'fa-line',
				'fa-linkedin',
				'fa-linkedin-in',
				'fa-linode',
				'fa-linux',
				'fa-lyft',
				'fa-magento',
				'fa-mailchimp',
				'fa-mandalorian',
				'fa-markdown',
				'fa-mastodon',
				'fa-maxcdn',
				'fa-mdb',
				'fa-medapps',
				'fa-medium',
				'fa-medium-m',
				'fa-medrt',
				'fa-meetup',
				'fa-megaport',
				'fa-mendeley',
				'fa-microblog',
				'fa-microsoft',
				'fa-mix',
				'fa-mixcloud',
				'fa-mixer',
				'fa-mizuni',
				'fa-modx',
				'fa-monero',
				'fa-napster',
				'fa-neos',
				'fa-nimblr',
				'fa-node',
				'fa-node-js',
				'fa-npm',
				'fa-ns8',
				'fa-nutritionix',
				'fa-odnoklassniki',
				'fa-odnoklassniki-square',
				'fa-old-republic',
				'fa-opencart',
				'fa-openid',
				'fa-opera',
				'fa-optin-monster',
				'fa-orcid',
				'fa-osi',
				'fa-page4',
				'fa-pagelines',
				'fa-palfed',
				'fa-patreon',
				'fa-paypal',
				'fa-penny-arcade',
				'fa-periscope',
				'fa-phabricator',
				'fa-phoenix-framework',
				'fa-phoenix-squadron',
				'fa-php',
				'fa-pied-piper',
				'fa-pied-piper-alt',
				'fa-pied-piper-hat',
				'fa-pied-piper-pp',
				'fa-pied-piper-square',
				'fa-pinterest',
				'fa-pinterest-p',
				'fa-pinterest-square',
				'fa-playstation',
				'fa-product-hunt',
				'fa-pushed',
				'fa-python',
				'fa-qq',
				'fa-quinscape',
				'fa-quora',
				'fa-r-project',
				'fa-raspberry-pi',
				'fa-ravelry',
				'fa-react',
				'fa-reacteurope',
				'fa-readme',
				'fa-rebel',
				'fa-red-river',
				'fa-reddit',
				'fa-reddit-alien',
				'fa-reddit-square',
				'fa-redhat',
				'fa-renren',
				'fa-replyd',
				'fa-researchgate',
				'fa-resolving',
				'fa-rev',
				'fa-rocketchat',
				'fa-rockrms',
				'fa-safari',
				'fa-salesforce',
				'fa-sass',
				'fa-schlix',
				'fa-scribd',
				'fa-searchengin',
				'fa-sellcast',
				'fa-sellsy',
				'fa-servicestack',
				'fa-shirtsinbulk',
				'fa-shopify',
				'fa-shopware',
				'fa-simplybuilt',
				'fa-sistrix',
				'fa-sith',
				'fa-sketch',
				'fa-skyatlas',
				'fa-skype',
				'fa-slack',
				'fa-slack-hash',
				'fa-slideshare',
				'fa-snapchat',
				'fa-snapchat-ghost',
				'fa-snapchat-square',
				'fa-soundcloud',
				'fa-sourcetree',
				'fa-speakap',
				'fa-speaker-deck',
				'fa-spotify',
				'fa-squarespace',
				'fa-stack-exchange',
				'fa-stack-overflow',
				'fa-stackpath',
				'fa-staylinked',
				'fa-steam',
				'fa-steam-square',
				'fa-steam-symbol',
				'fa-sticker-mule',
				'fa-strava',
				'fa-stripe',
				'fa-stripe-s',
				'fa-studiovinari',
				'fa-stumbleupon',
				'fa-stumbleupon-circle',
				'fa-superpowers',
				'fa-supple',
				'fa-suse',
				'fa-swift',
				'fa-symfony',
				'fa-teamspeak',
				'fa-telegram',
				'fa-telegram-plane',
				'fa-tencent-weibo',
				'fa-the-red-yeti',
				'fa-themeco',
				'fa-themeisle',
				'fa-think-peaks',
				'fa-trade-federation',
				'fa-trello',
				'fa-tripadvisor',
				'fa-tumblr',
				'fa-tumblr-square',
				'fa-twitch',
				'fa-twitter',
				'fa-twitter-square',
				'fa-typo3',
				'fa-uber',
				'fa-ubuntu',
				'fa-uikit',
				'fa-umbraco',
				'fa-uniregistry',
				'fa-unity',
				'fa-untappd',
				'fa-ups',
				'fa-usb',
				'fa-usps',
				'fa-ussunnah',
				'fa-vaadin',
				'fa-viacoin',
				'fa-viadeo',
				'fa-viadeo-square',
				'fa-viber',
				'fa-vimeo',
				'fa-vimeo-square',
				'fa-vimeo-v',
				'fa-vine',
				'fa-vk',
				'fa-vnv',
				'fa-vuejs',
				'fa-waze',
				'fa-weebly',
				'fa-weibo',
				'fa-weixin',
				'fa-whatsapp',
				'fa-whatsapp-square',
				'fa-whmcs',
				'fa-wikipedia-w',
				'fa-windows',
				'fa-wix',
				'fa-wizards-of-the-coast',
				'fa-wolf-pack-battalion',
				'fa-wordpress',
				'fa-wordpress-simple',
				'fa-wpbeginner',
				'fa-wpexplorer',
				'fa-wpforms',
				'fa-wpressr',
				'fa-xbox',
				'fa-xing',
				'fa-xing-square',
				'fa-y-combinator',
				'fa-yahoo',
				'fa-yammer',
				'fa-yandex',
				'fa-yandex-international',
				'fa-yarn',
				'fa-yelp',
				'fa-yoast',
				'fa-youtube',
				'fa-youtube-square',
				'fa-zhihu'


    		];        
	}
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\DocApp.js```FileName```var DocApp = angular.module('DocApp', ["ngRoute", 'angular.filter']); //



DocApp.config(  function($routeProvider, $locationProvider) {
    $routeProvider
    .when("/", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/HomePage/HomePage.html",
        controller : "HomePageCtrl",
        title : "Home"
    })
    .when("/IconList", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/IiconList/IconList.html",
        controller : "IconListCtrl",
        title : "IconList"

    })
    .when("/DailyDigest", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/DailyDigest/DailyDigestList.html",
        controller : "DailyDigestListCtrl",
        title : "DailyDigest"

    })
    .when("/DailyDigestDetails/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ProjectTracker/ProjectTrackerDetails.html",
        controller : "ProjectTrackerDetailsCtrl",  
        title : "DailyDigest"      
    })

    
    .when("/ProjectTracker", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ProjectTracker/ProjectTrackerList.html",
        controller : "ProjectTrackerListCtrl",
        title : "ProjectTracker"
    })     
    .when("/NewProjectTracker", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ProjectTracker/ProjectTrackerDetails.html",
        controller : "ProjectTrackerDetailsCtrl",  
        title : "ProjectTracker"      
    })
    .when("/ProjectTrackerDetails/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ProjectTracker/ProjectTrackerDetails.html",
        controller : "ProjectTrackerDetailsCtrl",  
        title : "ProjectTracker"      
    })
    
    .when("/TRYProjectTracker", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/TRYProjectTracker/ProjectTrackerList.html",
        controller : "TRYProjectTrackerListCtrl",
        title : "TRYProjectTracker"
    }) 
    
    
     
    .when("/ActionTracker", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/MeetingList.html",
        controller : "MeetingListCtrl",
        title : "MeetingList"
    })     
    .when("/NewAction/:type", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/MeetingDetails.html",
        controller : "MeetingDetailsCtrl",  
        title : "MeetingDetailsCtrl"      
    })
    .when("/ActionDetails/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/MeetingDetails.html",
        controller : "MeetingDetailsCtrl",  
        title : "MeetingDetails"      
    })
    .when("/MeetingView", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/MeetingViewList.html",
        controller : "MeetingViewListCtrl",  
        title : "MeetingViewListCtrl"      
    })
    .when("/MeetingViewDetails/:itenId?", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/Meeting.html",
        controller : "MeetingListCtrl",  
        title : "MeetingListCtrl"      
    })
    .when("/ActionTrackerAdminView", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/AdminView.html",
        controller : "AdminViewCtrl",  
        title : "AdminViewCtrl"      
    })
    
     .when("/UserAccess", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/UserAccess/UserAccess.html",
        controller : "UserAccessCtrl",
        title : "UserAccess"

    })



    
    
    .when("/DealRelease", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/DealReleaseRequest/DealRelList.html",
        controller : "DealRelListCtrl"
     })     
    .when("/NewDealRel", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/DealReleaseRequest/DealDetails.html",
        controller : "DealRelDetailsCtrl"
    })
    .when("/DealRelDetails/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/DealReleaseRequest/DealDetails.html",
        controller : "DealRelDetailsCtrl"      
    })
    
    .when("/CounterpartyAandS", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CprtyAS/ASList.html",
        controller : "ASListCtrl"
     })   
     .when("/CounterpartyAandSExpLog", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CprtyAS/ExpairyLog.html",
        controller : "ExpairyLogCtrl"
     }) 
     .when("/CounterpartyAandSCheckLog", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CprtyAS/CheckLog.html",
        controller : "ASListCtrl"
     }) 

     
	
    .when("/ERSMargin", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ExchangeRate/ERList.html",
        controller : "ERListCtrl"
     })     
    .when("/NewERSMargin", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ExchangeRate/ERDetails.html",
        controller : "ERDetailsCtrl"
    })
    .when("/ERSMarginDetails/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/ExchangeRate/ERDetails.html",
        controller : "ERDetailsCtrl"      
    })
    
     .when("/CostApproval", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CostApproval/CostApprovalList.html",
        controller : "CostApprovalCtrl"
     })     
    .when("/NewCostApproval", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CostApproval/CostApprovalDetails.html",
        controller : "CostApprovalCtrl"
    })
    .when("/CostApprovalDetails/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CostApproval/CostApprovalDetails.html",
        controller : "CostApprovalCtrl"      
    })

    
    
    .when("/CounterpartyAandS", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CprtyAS/ASList.html",
        controller : "ASListCtrl"
     })   
     .when("/CounterpartyAandSExpLog", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/CprtyAS/ExpairyLog.html",
        controller : "ExpairyLogCtrl"
     })		
	  
    .when("/StatusFlow/:flow", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Flow/StatusFlow.html",
        controller : "StatusFlow"

    })  

    .when("/Derivarives", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/Listing.html",
        controller : "DerivativesCtrl",         

    })
    .when("/DerivariveTeplate", {
        templateUrl : "/EITRY/FX/SiteAssets/TryUtilUAT/Proj/Derivarives/Teplate.html",
        controller : "DerivativesCtrl",         

    })
    

    .when("/new", {
        templateUrl : "/EITRY/FX/SiteAssets/App/html/Details.html",
        controller : "ActiveList"
	})
	.when("/details/:itenId", {
        templateUrl : "/EITRY/FX/SiteAssets/App/html/Details.html",
        controller : "ActiveList"

    })    
    .when("/admin", {
        templateUrl : "/EITRY/FX/SiteAssets/App/html/AdminPage.html",
        controller : "AdminPageCtrl",
    })

    

    
    .when("/testui", {
        templateUrl : "/EITRY/FX/SiteAssets/App/html/TestUI.html",
        controller : "TestUICtrl"

    })      
    .when("/report", {
        templateUrl : "/gops/WBCDD/Counterparty/SiteAssets/App/html/Report.html",
        controller : "ReportCtrl",
    })            
    .when("/NewItem", {
        templateUrl : "/gops/WBCDD/Counterparty/SiteAssets/App/html/Details.html",
        controller : "listDetailsCtrl",
         title : "NewHedge"

    })
    .when("/ItemDetails/:itenId", {
        templateUrl : "/gops/WBCDD/Counterparty/SiteAssets/App/html/Details.html",
        controller : "listDetailsCtrl",
        title : "ItemDetails"

    })

    
    
});
//$locationProvider.html5Mode(true);


DocApp.filter('html', function($sce) {
    return function(val) {
        return $sce.trustAsHtml(val);
    };
});

DocApp.directive('formatValidator', function() {
//debugger;
    return {
      // element must have ng-model attribute
      // or $validators does not work
      require: 'ngModel',
      link: function(scope, elm, attrs, ctrl) {
        ctrl.$validators.FormatValidator = function(modelValue, viewValue) {
        	
        	var valid = true;
        	if(viewValue && attrs.format){
        		var regex = new RegExp(attrs.format, "g");
            	valid = viewValue && regex.test(viewValue);
        	}        	
            //debugger;
            return valid; 
        };
      } 
    };
});


DocApp.directive('bigdateValidator', function() {
    return {
      // element must have ng-model attribute
      // or $validators does not work
      require: 'ngModel',
      link: function(scope, elm, attrs, ctrl) {
        ctrl.$validators.DuplicateValidator = function(modelValue, viewValue) {
        	
        	
        	var fromDateTitle = "TradeDate";
        	var toDateTitle = "ValueDate";
        	
        	if( !viewValue ){
        		return false;        		
        	}
        	
        	
			var fromDate = scope.item[fromDateTitle];
			var toDate = scope.item[toDateTitle];
			
			if( fromDate && toDate ){       	        	
	        	if( new moment(fromDate, "DD-MMM-YYYY") >  new moment(toDate, "DD-MMM-YYYY") ){
					return false;;	
				}	
			}
			
        	return  true ;        	
			//return true;       	
        };
      } 
    };
});



DocApp.directive('duplicateValidator', function() {
    return {
      // element must have ng-model attribute
      // or $validators does not work
      require: 'ngModel',
      link: function(scope, elm, attrs, ctrl) {
        ctrl.$validators.DuplicateValidator = function(modelValue, viewValue) {
        	var valid = true;
        	
        	if(attrs.format){
        		var regex = new RegExp(attrs.format, "g");
        		valid = viewValue && regex.test(viewValue);
            	if(!valid){
            		return true; //if format error teturn true. Show error in format.this is save multiple server calls	
            	}
        	} 
        	
        	if(valid && attrs.dupvallist && attrs.dupvalcol && attrs.dupvalajaxcol){
            	//debugger;
            	valid = GetDuplicate(scope, attrs.dupvallist , attrs.dupvalcol, viewValue, attrs.dupvalajaxcol, attrs.rowid );            	
            }
        	return  valid ;        	
			//return true;       	
        };
      } 
    };
});


DocApp.directive('isinValidator', function() {
//Format : XSXXXXXXXXXXX
    return {
      // element must have ng-model attribute
      // or $validators does not work
      require: 'ngModel',
      link: function(scope, elm, attrs, ctrl) {
        ctrl.$validators.myValidator = function(modelValue, viewValue) {
            // validate viewValue with your custom logic
            //var valid = (viewValue && viewValue.length == 13) || false;
            var regex = new RegExp("^\\w{2}\\d{11}$", "g");
            var valid = (viewValue && regex.test(viewValue)) || false;
            
            /*
            if(valid){
            	debugger;
            	if(GetDuplicate("AuctionList", "OrderAmounts", viewValue, "Amounts" ).length ){
            		console.log("duplicate");
            	}
            }
            */
            debugger;
            return valid; 
        };
      } 
    };
});


DocApp.directive('sinoValidator', function() {
	//Format : XXXX-XX
    return {
      // element must have ng-model attribute
      // or $validators does not work
      require: 'ngModel',
      link: function(scope, elm, attrs, ctrl) {
        ctrl.$validators.myValidator = function(modelValue, viewValue) {
            // validate viewValue with your custom logic
            var regex = new RegExp("^\\w{4}-\\d{2}$", "g");
            var valid = (viewValue && regex.test(viewValue)) || false;                        
            //var valid = (viewValue && viewValue.length == 6) || false;
            if(valid){
            	//console.log("Check for duplicate: " + viewValueDS);
            }
            return valid; 
        };
      } 
    };
});


// | dateFilter:startDate:endDate 
DocApp.filter('dateFilter', function() 
{
   return function (items, startDate , endDate, col) 
   {           
		if (!startDate && !endDate) {
            return items;
        }
        
		var retArray = [];
		 angular.forEach(items, function(obj) {
            var receivedDate = new moment( obj[col], "DD-MMM-YYYY");
            if (moment(receivedDate).isSameOrAfter(startDate) && moment(receivedDate).isSameOrBefore(endDate)) {
                retArray.push(obj);
            }
        });
        return retArray;		
  };

});

// | orFilter:'HedgeType':'v1':'v2'
DocApp.filter('orFilter', function() 
{
   return function (items, col, val1 , val2, val3 ) 
   {           
		if (!col || !val1 || !val2) {
            return items;
        }
        
		var retArray = [];
		 angular.forEach(items, function(obj) {
		 	
		 	if(val3){
		 		if( obj[col] == val1 ||  obj[col] == val2 ||  obj[col] == val3){
			 		retArray.push(obj)
			 	} 
		 	}
		 	else{
			 	if( obj[col] == val1 ||  obj[col] == val2){
			 		retArray.push(obj)
			 	}      
			}      
        });
        return retArray;		
  };
});


DocApp.directive('input',function(){
  return {
    restrict: 'E',
    scope: {
      ngModel: '=',
      ngChange: '&',
      type: '@'
    },
    link: function (scope, element, attrs) {
      if(scope.type.toLowerCase()!='file'){
        return;
      }
      element.bind('change', function(){
      	//debugger;
        let files =  element[0].files;
        scope.ngModel = files;
        try{
        	scope.$apply();
        	scope.ngChange();
        }catch(ex){
        	console.log(ex);        	
        }
        
        
      });
    }
  }
  
});

DocApp.directive('gtdatepicker', function () {
    return {
        restrict: 'A',
        require: 'ngModel',
         link: function (scope, element, attrs, ngModelCtrl) {
            element.datepicker({
                dateFormat: 'dd-M-yy',
                //minDate : new Date,
                onSelect: function (date) {                	
					ngModelCtrl.$setViewValue(date);
                    scope.$apply();
                }
            });
        }
    };
});



/*
DocApp.directive('amountValidator', function() {
    return {
      require: 'ngModel',
      link: function(scope, elm, attrs, ctrl) {
      
        ctrl.$validators.AmountValidator= function(modelValue, viewValue) {
        	var valid = true;
        	
        	
        	
        	if(attrs.MinAmt){
        		
        	} 
        	
        	
        	return  valid ;        	
			//return true;       	
        };
      } 
    };
});
*/



```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\email.js```FileName```function updateEmailList($scope, StatusFlowObj, Title, Template, path, sendEmail, AuctionDate, OrderID ){
		
	var newItem = true;
	var email = {};
	
	email.Title = Title ? Title  : "Email";
	
	//email.To = StatusFlowObj.EamilTo ? UpdateEmailList(StatusFlowObj.EamilTo) : "";
	//email.CC = StatusFlowObj.EmailCC ? UpdateEmailList(StatusFlowObj.EmailCC) : "";
	
	email.Subject = updateFieldData($scope, StatusFlowObj.EmailSubject);
	/*
	if( Title == "CustomerEmail" ){
		email.ToUserOrGroupId = { 'results' : [353, 127] }; //"353; 127";			
	}
	*/
	
	path = strReplaceAll(path, "##ID##", $scope.item.ID);	
	link = SiteURL + "/SitePages/AppHome.aspx#!" + path;
	link = "<a href='" + link +"'>link</a>"
	Template = strReplaceAll( Template, "##ItemLink##", link);
	StatusFlowObj.EmailBody = strReplaceAll(StatusFlowObj.EmailBody, "##RequestDetails##" , Template );
	var body = updateFieldData($scope, StatusFlowObj.EmailBody);
	email.Body = htmlEscape(body );
	email.Email = sendEmail ? true : false;
	
			
	if( Title == "CounterpartyEmails" ){	
		item = {
			"__metadata": { "type": 'SP.Data.CounterpartyEmailsListItem' },
			"Title": email.Title,
			"Subject": email.Subject,
			"Body": body ,
			"Email": email.Email,		
		};
		
		if(StatusFlowObj.EmailToId){
			item.ToUserOrGroupId = StatusFlowObj.EmailToId; // UserGroupSting(StatusFlowObj.EamilToId);
		}
		else{
			alert("To email not configured.");
			return;
		}

		if(StatusFlowObj.EmailCCId){
			item.CcUserOrGroupId =  StatusFlowObj.EmailCCId;
		}
		
		CreateListItem(Title, item)
	}
		
}


function UpdateEmailList(email){
	var emailList = "";
	
	var list = email.split(';');
	$.each(list , function(id, val){
	
		if( _.startsWith(val, '##') && _.endsWith(val, '##') ){
			val = strReplaceAll(val, '##', '');			
			emailList  +=  GetSiteConfig("UserMaster", "TEAM_EMAIL", val  );			
		}
		else if( EmailRegEx.test(val)) {
			emailList += val + ";"
		}				
	});
	return emailList 
		
}

function updateFieldData($scope, txt){

	for (property in $scope.item) 
	{	
		var RepVal = "";	
		if($scope.item[property ])
		{
			RepVal = $scope.item[property ];
		}
		
		txt= strReplaceAll(txt, "##" + property   + "##" , RepVal );		
	}
	
	return txt;
}

function UserGroupSting(users){
	var userInfo = ''
	for (var i = 0; i < users.length; i++) {
        var user = users[i];
		var userID = GetSPUserInfo(users[i].Key);
        if (!userID) {
            userID = GetSPUserInfo(users[i].Key);
        }
        userInfo += userID + ";#" + user.DisplayText + ";#";
    }
     return userInfo;
}


```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\ErrorLog.js```FileName```debugger;
//alert('7 1 2')
console.log('test 123');
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\FileUpload.js```FileName```var FileUploadDoneFlag = false;



function UploadFileIntoFolder($scope, docLibName, folderName, elem, ddlDocType, newFileName){
	
	FileUploadDoneFlag = false;

	if(!docLibName || !folderName){
		FileUploadDoneFlag = true;
		return;
	}

	if(!docLibName){
		docLibName = AttachmentDocLib;
	}
	
	var ctx = SP.ClientContext.get_current();  
	var folder = ctx.get_web().getFolderByServerRelativeUrl( '/' + SiteRelativeUrl + docLibName + '/' + folderName + '' );  
	ctx.load(folder, "Name");  
	   
	ctx.executeQueryAsync(  
	   function() {  
		  if (folder.get_name()) {  
			 //console.log(folder.get_name());  
			 UploadReqDocuments($scope, docLibName, $scope.item.ID, $('#filesDocument') );
		  }  
		  else {  
			 //console.log("Folder exists but is hidden (security-trimmed) for us.");  
		  }  
	   },  
	   function(s, args) {  
		  if (args.get_errorTypeName() === "System.IO.FileNotFoundException") {  
			 //CreateFolder(docLibName, folderName); 
			 
			var clientContext;  
			var oWebsite;  
			var oList;  
			var itemCreateInfo;  
		
			clientContext = new SP.ClientContext.get_current();  
			oWebsite = clientContext.get_web();  
			oList = oWebsite.get_lists().getByTitle(docLibName);  
		
			itemCreateInfo = new SP.ListItemCreationInformation();  
			itemCreateInfo.set_underlyingObjectType(SP.FileSystemObjectType.folder);  
			itemCreateInfo.set_leafName(folderName);  
			var oListItem = oList.addItem(itemCreateInfo);  
			oListItem.update();  
		
			clientContext.load(oListItem);  
			clientContext.executeQueryAsync(  
				Function.createDelegate(this, function(){
					//alert("Folder Created");
					UploadReqDocuments($scope, docLibName, $scope.item.ID, $('#filesDocument') );
				}),  
				Function.createDelegate(this, function(){
					alert("Error");

				})  
			);

		  }  
		  else {  
			 console.log("Error: " + args.get_message());  
		  }  
	   }  
	); 

	
}



function ShowUploadAttachmentModel($scope, att){
	
	$scope.attachmentTypes = GetConfigList("DocumentTypes");
	
	document.getElementById("filesFdReqSuppDocument").value = "";
	
	$scope.DocuemntTypeDocuemntType = "";
	
	if(att){
		debugger;
	}
	
	//$scope.$apply();
	$('#fdReqSuppDocUploadModal').modal('toggle');

}
function ShowDeleteAttachmentModel($scope, fileObj){			
		$scope.FileDeleteErrorMsg = "";
		$scope.deleteDocument = fileObj;
		$('#ConfirmDocDeleteModal').modal('toggle');
}


function onError(sender, args) {
	
	//alert(args.get_message() + args.get_stackTrace())
}

function RefreshDocuments($scope, docLibName, folderName, applay){ 
	
	if(!folderName){
		return;
	}
	
	$scope.item.Documents = [];
	
	//var folderUrl = 'Shared Documents/'+ $('#spRequestItemId').text();
	var folderUrl = docLibName + '/' + folderName + '';
	
	var webUrl = _spPageContextInfo.webAbsoluteUrl;
	var requestHeaders = { "accept": "application/json;odata=verbose" };
	$.ajax({
		url: webUrl + "/_api/web/GetFolderByServerRelativeUrl('" + folderUrl + "')?$expand=DocumentType,Files,ListItemAllFields,ListItemAllFields/Modified,ListItemAllFields/Id&$orderby=TimeLastModified desc",
		contentType: "application/json;odata=verbose",
		headers: requestHeaders,
		success:  function(data, request){			
			var attachments = [];
							
			$.each(data.d.Files.results, function(index, file) 
            {    		
				var attach = {};
				attach.deleted = false;
				attach.Name = file.Name;		
				attach.fileName = file.Name.substr(0, file.Name.indexOf('.') );
				attach.fileUrl = SiteHomeURL  + file.ServerRelativeUrl +"";
				attach.ServerRelativeUrl = file.ServerRelativeUrl;
				var requestHeaders = { "accept": "application/json;odata=verbose" };
				$.ajax({
					url: file.ListItemAllFields.__deferred.uri,
					contentType: "application/json;odata=verbose",
					headers: requestHeaders,
					success: function(data){
						if(data.d.DocumentType != null && data.d.DocumentType != undefined && data.d.DocumentType != ""){
							attach.documentType = data.d.DocumentType;
						}						
						attach.uploadedBy = GetSiteConfig("GetPortalUserName", data.d.AuthorId);												
						attach.documentDate = moment(data.d.Created).format("DD-MMM-YYYY");												
					},
					async: false,
					error: onError
				});				
				attachments.push(attach );	 
				               
            });

			$scope.item.Attachments = attachments;
			if(applay){
				$scope.$apply();
			}
			
						
		},
		async: false,
		error: onError
	}); 			
}

function BidUploadDocuments($scope, docLibName, folderName, elem ){ 
	
}


function UploadReqDocuments($scope, docLibName, folderName, elem, ddlDocType, newFileName ){ 	
	
	if(ddlDocType){
		$scope.DocuemntTypeDocuemntType = ddlDocType ;
	}
	
	$scope.AttachmentErrorMsg = "";		
	if(elem.val() == "" || elem.val() == null || elem.val() == undefined){
		$scope.AttachmentErrorMsg = "Please select a File to Upload!";
		return;
	}
	else if(elem.val().length > 80){
		$scope.AttachmentErrorMsg = "File Name Exceeds Allowed Limit. Please reduce the File Name!";
		return;			
	}
	/*
	else if(!$scope.DocuemntTypeDocuemntType ){
		$scope.AttachmentErrorMsg = "Please select docuemnt type!";
		return;			
	}
	*/
	
	var fileName = "";
    // Define the folder path for this example.
    var serverRelativeUrlToFolder =  '/' + SiteRelativeUrl + docLibName + '/' + folderName + ''; // 'Shared Documents/'+ $('#spRequestItemId').text();
    

    // Get test values from the file input and text input page controls.
    var fileInput = $(elem);
    var fileCount = fileInput[0].files.length;
    // Get the server URL.
    var serverUrl = _spPageContextInfo.webAbsoluteUrl;
    var filesUploaded = 0;
    for(var i = 0; i < fileCount; i++){
        // Initiate method calls using jQuery promises.
        // Get the local file as an array buffer.
        var getFile = getFileBuffer(i);
        getFile.done(function (arrayBuffer,i) {

            // Add the file to the SharePoint folder.
            var addFile = addFileToFolder(arrayBuffer,i,newFileName);
            addFile.done(function (file, status, xhr) {
                filesUploaded++;
                if(fileCount == filesUploaded){
                    filesUploaded = 0;
                    //alert('done');
                    //$scope.actionOnBack();
                    FileUploadDoneFlag = true;
					if($scope.afterFileUpload){
						$scope.afterFileUpload();
					}
                }
				// Get the list item that corresponds to the uploaded file.
				var getItem = getListItem(file.d.ListItemAllFields.__deferred.uri);
				
				getItem.done(function (listItem, status, xhr) {
																			
				});
				
				getItem.fail(onError);
            });
            addFile.fail(onError);
        });
        getFile.fail(onError);
    }

    // Get the local file as an array buffer.
    function getFileBuffer(i) {
        var deferred = jQuery.Deferred();
        var reader = new FileReader();
        reader.onloadend = function (e) {
            deferred.resolve(e.target.result,i);
        }
        reader.onerror = function (e) {
            deferred.reject(e.target.error);
        }
        reader.readAsArrayBuffer(fileInput[0].files[i]);
        return deferred.promise();
    }

    // Add the file to the file collection in the Shared Documents folder.
    function addFileToFolder(arrayBuffer,i, fileName) {
    var index = i;

        // Get the file name from the file input control on the page.
		if(!fileName){
	        fileName = fileInput[0].files[index].name;
	    }

        // Construct the endpoint.
        var fileCollectionEndpoint = String.format(
                "{0}/_api/web/getfolderbyserverrelativeurl('{1}')/files" +
                "/add(overwrite=true, url='{2}')",
                serverUrl, serverRelativeUrlToFolder, fileName);

        // Send the request and return the response.
        // This call returns the SharePoint file.
        return jQuery.ajax({
            url: fileCollectionEndpoint,
            type: "POST",
            data: arrayBuffer,
            processData: false,
            headers: {
                "accept": "application/json;odata=verbose",
                "X-RequestDigest": jQuery("#__REQUESTDIGEST").val()
            }
        });
    }
	
	// Get the list item that corresponds to the file by calling the file's ListItemAllFields property.
    function getListItem(fileListItemUri) {

        // Send the request and return the response.
        return $.ajax({
            url: fileListItemUri,
            type: "GET",
            headers: { "accept": "application/json;odata=verbose" }
        });
    }
	
	// Change the display name and title of the list item.
    function updateListItem(itemMetadata, ddlDocType ) {
    
    	if(!ddlDocType ){
    		ddlDocType  = $('#ddlDocType').val()
    	}

        // Define the list item changes. Use the FileLeafRef property to change the display name. 
        // For simplicity, also use the name as the title. 
        // The example gets the list item type from the item's metadata, but you can also get it from the
        // ListItemEntityTypeFullName property of the list.
        var body = String.format("{{'__metadata':{{'type':'{0}'}},'Title':'{1}','DocumentType':'{2}'}}", itemMetadata.type, fileName, ddlDocType );

        // Send the request and return the promise.
        // This call does not return response content from the server.
        return $.ajax({
            url: itemMetadata.uri,
            type: "POST",
            data: body,
            headers: {
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "content-type": "application/json;odata=verbose",
                "IF-MATCH": itemMetadata.etag,
                "X-HTTP-Method": "MERGE"
            }
        });
    }
}


function ChkNCreateFolder(docLibName, folderName){

	if(!docLibName || !folderName){
		return;
	}
	
	var ctx = SP.ClientContext.get_current();  
	var folder = ctx.get_web().getFolderByServerRelativeUrl( '/' + SiteRelativeUrl + docLibName + '/' + folderName + '' );  
	ctx.load(folder, "Name");  
	   
	ctx.executeQueryAsync(  
	   function() {  
		  if (folder.get_name()) {  
			 //console.log(folder.get_name());  
		  }  
		  else {  
			 //console.log("Folder exists but is hidden (security-trimmed) for us.");  
		  }  
	   },  
	   function(s, args) {  
		  if (args.get_errorTypeName() === "System.IO.FileNotFoundException") {  
			 CreateFolder(docLibName, folderName); 
		  }  
		  else {  
			 console.log("Error: " + args.get_message());  
		  }  
	   }  
	); 
}


async function CreateFolder(docLibName, reqId){

	var clientContext;  
	var oWebsite;  
	var oList;  
	var itemCreateInfo;  

	clientContext = new SP.ClientContext.get_current();  
	oWebsite = clientContext.get_web();  
	oList = oWebsite.get_lists().getByTitle(docLibName);  

	itemCreateInfo = new SP.ListItemCreationInformation();  
	itemCreateInfo.set_underlyingObjectType(SP.FileSystemObjectType.folder);  
	itemCreateInfo.set_leafName(reqId);  
	var oListItem = oList.addItem(itemCreateInfo);  
	oListItem.update();  

	clientContext.load(oListItem);  
	clientContext.executeQueryAsync(  
		Function.createDelegate(this, function(){

		}),  
		Function.createDelegate(this, function(){

		})  
	);
	
	
}


function DeleteDocument($scope, docLibName, folderName){

	//var docNameTBD = $(fdReqSuppDocTBDElem.parent().parent().children()[0]).text();

	var clientContext;  
	var oWebsite;  
	var fileUrl;  
	clientContext = new SP.ClientContext.get_current();  
	oWebsite = clientContext.get_web();  
	clientContext.load(oWebsite);  
	clientContext.executeQueryAsync(function ()   
	{  
		//fileUrl = "/gops/Applications/WBTRYFDRates/Shared Documents/"+ $('#spRequestItemId').text() +"/"+ docNameTBD +"";  
		this.fileToDelete = oWebsite.getFileByServerRelativeUrl($scope.deleteDocument.ServerRelativeUrl);  
		this.fileToDelete.deleteObject();  
		  
		clientContext.executeQueryAsync(  
			Function.createDelegate(this, successHandler),  
			Function.createDelegate(this, errorHandler)  
		);  
		
	}, errorHandler);  
	  
	function successHandler()   
	{  
		setTimeout(function(){		
			RefreshDocuments($scope, docLibName, folderName, true);	
			$('#ConfirmDocDeleteModal').modal('toggle');		
		}, 200);
	}  
	function errorHandler() {  
		$scope.FileDeleteErrorMsg = "Document Deletion Failed!";		
	}  
}



function UploadAgreementFile($scope, docLibName, folderName, files){ 	
	
	
	
	$scope.AttachmentErrorMsg = "";	
		
	if(files[0].name.length > 80){
		$scope.AttachmentErrorMsg = "File Name Exceeds Allowed Limit. Please reduce the File Name!";
		return;			
	}
	
	
	var fileName = "";
    // Define the folder path for this example.
    var serverRelativeUrlToFolder =  '/' + SiteRelativeUrl + docLibName + '/' + folderName + ''; // 'Shared Documents/'+ $('#spRequestItemId').text();
    

    // Get test values from the file input and text input page controls.  
    var fileCount = files.length;
    // Get the server URL.
    var serverUrl = _spPageContextInfo.webAbsoluteUrl;
    var filesUploaded = 0;
    for(var i = 0; i < fileCount; i++){
        // Initiate method calls using jQuery promises.
        // Get the local file as an array buffer.
        var getFile = getFileBuffer(i);
        getFile.done(function (arrayBuffer,i) {

            // Add the file to the SharePoint folder.
            var addFile = addFileToFolder(arrayBuffer,i,newFileName);
            addFile.done(function (file, status, xhr) {
                filesUploaded++;
                if(fileCount == filesUploaded){
                    filesUploaded = 0;
                }
				
				
            });
            addFile.fail(onError);
        });
        getFile.fail(onError);
    }

    // Get the local file as an array buffer.
    function getFileBuffer(i) {
        var deferred = jQuery.Deferred();
        var reader = new FileReader();
        reader.onloadend = function (e) {
            deferred.resolve(e.target.result,i);
        }
        reader.onerror = function (e) {
            deferred.reject(e.target.error);
        }
        reader.readAsArrayBuffer(fileInput[0].files[i]);
        return deferred.promise();
    }

    // Add the file to the file collection in the Shared Documents folder.
    function addFileToFolder(arrayBuffer,i, fileName) {
    var index = i;

        // Get the file name from the file input control on the page.
		if(!fileName){
	        fileName = fileInput[0].files[index].name;
	    }

        // Construct the endpoint.
        var fileCollectionEndpoint = String.format(
                "{0}/_api/web/getfolderbyserverrelativeurl('{1}')/files" +
                "/add(overwrite=true, url='{2}')",
                serverUrl, serverRelativeUrlToFolder, fileName);

        // Send the request and return the response.
        // This call returns the SharePoint file.
        return jQuery.ajax({
            url: fileCollectionEndpoint,
            type: "POST",
            data: arrayBuffer,
            processData: false,
            headers: {
                "accept": "application/json;odata=verbose",
                "X-RequestDigest": jQuery("#__REQUESTDIGEST").val()
            }
        });
    }
	
	// Get the list item that corresponds to the file by calling the file's ListItemAllFields property.
    function getListItem(fileListItemUri) {

        // Send the request and return the response.
        return $.ajax({
            url: fileListItemUri,
            type: "GET",
            headers: { "accept": "application/json;odata=verbose" }
        });
    }
	
	// Change the display name and title of the list item.
    function updateListItem(itemMetadata, ddlDocType ) {
    
    	if(!ddlDocType ){
    		ddlDocType  = $('#ddlDocType').val()
    	}

        // Define the list item changes. Use the FileLeafRef property to change the display name. 
        // For simplicity, also use the name as the title. 
        // The example gets the list item type from the item's metadata, but you can also get it from the
        // ListItemEntityTypeFullName property of the list.
        var body = String.format("{{'__metadata':{{'type':'{0}'}},'Title':'{1}','DocumentType':'{2}'}}", itemMetadata.type, fileName, ddlDocType );

        // Send the request and return the promise.
        // This call does not return response content from the server.
        return $.ajax({
            url: itemMetadata.uri,
            type: "POST",
            data: body,
            headers: {
                "X-RequestDigest": $("#__REQUESTDIGEST").val(),
                "content-type": "application/json;odata=verbose",
                "IF-MATCH": itemMetadata.etag,
                "X-HTTP-Method": "MERGE"
            }
        });
    }
}


```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\GlobalVariables.js```FileName```var EmailRegEx = /^[A-Z0-9._%+-]+@([A-Z0-9-]+\.)+[A-Z]{2,4}$/i;

var SiteHomeURL = "https://workplace.emiratesislamic.ae/";

var SiteRelativeUrl =  "EITRY/FX/";
var SiteURL = SiteHomeURL + SiteRelativeUrl;

var ShowAlerts = false;

var UserGroupsForUser;
var UserGroupsIdForUser;
var isAdmin = false;

var DocLibURL = SiteHomeURL + "Attachments/";

var AddAttachmentURL = SiteHomeURL + "";

var Config = [];


var PagePath = "SitePages/TryUtilUat.aspx#!";
var TryUtilPath = SiteRelativeUrl + "SitePages/TryUtilUAT.aspx#!/";
var TryUtilURL = SiteHomeURL + SiteRelativeUrl + "SitePages/TryUtilUAT.aspx#!/";


var MeetingTrackerList = "MeetingTracker_UATList";
var ActionResponsibilityList = "ActionResponsibilityList_UAT";





```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\JqDocReady.js```FileName```$(document).ready(function () {	
	$('.divNonRecomendedBrowser').hide();
	
});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\JSCommon.js```FileName```function ExcelReportDownload(data, fileName ){
	var wb = XLSX.utils.book_new();
	wb.Props = {
	    Title: "Report",
	    Subject: "Report",
	    Author: "SP",
	    //CreatedDate: new Date(2017,12,19),
	    //dateNF:"dd/MMM/yyyy",
	    //dateNF:'mm/dd/yy;@',cellDates:true
	};
	
	function s2ab(s) {            
        var buf = new ArrayBuffer(s.length);
        var view = new Uint8Array(buf);
        for (var i=0; i<s.length; i++) view[i] = s.charCodeAt(i) & 0xFF;
        return buf;        
    } 
    
    wb.SheetNames.push("Sheet1");
	var ws = XLSX.utils.aoa_to_sheet(data);
	wb.Sheets["Sheet1"] = ws;
	var wbout = XLSX.write(wb, {bookType:'xlsx',  type: 'binary', dateNF:"dd/MMM/yy",cellDates:true});
	
	saveAs(new Blob([s2ab(wbout)],{type:"application/octet-stream"}), fileName);


}

function CheckBlank(FiledData, FieldName, ErrorMsg )
{	
	if(!FiledData)
	{
		ErrorMsg = AddErr( ErrorMsg, "Please provide " + FieldName);
	}
	
	return ErrorMsg;
}


function CheckValidAmount(FiledData, FieldName, ErrorMsg, AllowOnlyMillion, Min, Max )
{	
	if(!FiledData)
	{
		ErrorMsg = AddErr( ErrorMsg, "Please provide " + FieldName);
		return ErrorMsg;
	}
	else
	{
		FiledData = strReplaceAll( FiledData, ",", "")
		var amt ;
		if(!$.isNumeric(FiledData))
		{
			ErrorMsg = AddErr(ErrorMsg, FieldName + " should be number");	
			return ErrorMsg;		
		}
		else{
			FiledData = parseInt(FiledData.replaceAll(',', ''));
		}
		
		if(AllowOnlyMillion){					
			if( FiledData % 1000000){
				ErrorMsg = AddErr(ErrorMsg, "Only multiples of million allowed in amount[" + FieldName + "]" );
				return ErrorMsg;
			}
		}
		
		if(Min){
			Min += "";
			Min =   parseInt( Min .replaceAll(',', '') ); 
			if(FiledData < Min ){
				ErrorMsg = AddErr(ErrorMsg, "Amount[" +FieldName  + "] is less than minimum size" );
				return ErrorMsg;			
			}
		}
		
		if(Max){
			Max += "";
			Max =   parseInt( Max.replaceAll(',', '') ); 
			if(FiledData > Max ){
				ErrorMsg = AddErr(ErrorMsg, "Amount[" +FieldName  + "] is greater than maximum size" );
				return ErrorMsg;			
			}
		}

		
		
			
	}	
	return ErrorMsg;
}



function AddErr(err, msg)
{
	if(err)
	{
		err += ", ";
	}
	else
	{
		err = " ";
	}
	err += msg;
	return err;
}


function UpdateDateSearch($scope){
	setTimeout(function(){
		var ht = "<div class='row dataTables_filter DateSearchDiv '>";
		ht += "<div class='col-md-6'>";
		ht += "<input type='text' class='form-control FromSearchDate DateSearchBox' data-provider='datepicker' placeholder='From Date' ng-model='FromSearchDate' />";
		ht += "</div>"; 	
		ht += "<div class='col-md-6'>";
		ht += "<input type='text' class='form-control ToSearchDate DateSearchBox' data-provider='datepicker' placeholder='To Date' ng-model='FromSearchDate' />";
		ht += "</div>";
		ht += "</div>";
		$('#auctionListTable_filter').before(ht); 
		
		$('.FromSearchDate').datetimepicker({
			format: 'DD-MMM-YYYY',
			useCurrent: false,
	    });	 
	    $(".FromSearchDate").on("dp.change", function() {
	        $scope.startDate = new moment($(".FromSearchDate").val(), "DD-MMM-YYYY" );
			$scope.$apply();
	    });
	    
	    $('.ToSearchDate').datetimepicker({
			format: 'DD-MMM-YYYY',
			useCurrent: false,
	    });
	    $(".ToSearchDate").on("dp.change", function() {
	        $scope.endDate=  new moment($(".ToSearchDate").val(), "DD-MMM-YYYY" )// $(".ToSearchDate").val();
			$scope.$apply();
	    });	
    
    }, 200);
}



function AntTxtBoxOnChange(val){
	val += ""
	var i = 0;	
	var formatAmount =  numberWithCommas(val.replace(/\,/g, '').replace(/ /g,'').replace(/([a-zA-Z])/g, function(match) { 
		if(match.toLowerCase() === "k" || match.toLowerCase() === "b" || match.toLowerCase() === "m"){
			if(i++ === 0){return match;}
			else {return match;}
		}
		else {return "";}
	}).replace('k','000').replace('b','000000000').replace('m','000000').replace('K','000').replace('B','000000000').replace('M','000000'));
	
	return formatAmount;
}

function SetSideBar(pageTitle, leftTitle){
	
	$(document).prop('title', pageTitle);
	
	$(".sidenav a").each(function() { 		
		if($(this)[0].title == leftTitle ){			
			this.className = "SelectedNav"; 
		}
		else{
			this.className = "";
		}	
	});
}

function GetCutoffTime(date, ConfigTitle ){

	if(!date){
		date = new moment().format("DD-MMM-YYYY");
	}
	var time = GetSiteConfig("ApplicationConfigrations", ConfigTitle );
	
	var t = time.split(":");
	var hh = "00";
	if( !_.isNil( t[0] ) ){
		hh = t[0];
	}	
	var mm = "00";		
	if( !_.isNil( t[1] ) ){
		mm = t[1];
	}	
	
	var cutoffTime = new moment(date  + " " + hh + ":" + mm , "DD-MMM-YYYY HH:mm");

	return cutoffTime;	
}

function IsCutoffTime(date, ConfigTitle ){ //string date with format DD-MMM-YYYY
	
	if(!date){
		return false;
	}
	
	if(!ConfigTitle){
		ConfigTitle = "OrderCutoffTime";
	}
	var time = GetSiteConfig("ApplicationConfigrations", ConfigTitle);
	
	var t = time.split(":");
	var hh = "00";
	if( !_.isNil( t[0] ) ){
		hh = t[0];
	}	
	var mm = "00";		
	if( !_.isNil( t[1] ) ){
		mm = t[1];
	}	
	
	var cutoffTime = new moment(date  + " " + hh + ":" + mm , "DD-MMM-YYYY HH:mm");
	
	return cutoffTime.isBefore();
			
	
}

function CutoffTime(date, ConfigTitle){

	if(!ConfigTitle){
		ConfigTitle = "OrderCutoffTime";
	}


	var time = GetSiteConfig("ApplicationConfigrations", ConfigTitle);
	
	var t = time.split(":");
	var hh = "00";
	if( !_.isNil( t[0] ) ){
		hh = t[0];
	}	
	var mm = "00";		
	if( !_.isNil( t[1] ) ){
		mm = t[1];
	}			
	if(!date){
		date = new moment().format("DD-MMM-YYYY");
	}
		
	var cutoffTime = new moment(date  + " " + hh + ":" + mm , "DD-MMM-YYYY HH:mm");			
	
	var auctionDate = "";
	if(cutoffTime.isBefore()){
		auctionDate = new moment().format("YYYY-MM-DD");
	}
	else{
		auctionDate = new moment().subtract(1, 'days').format("YYYY-MM-DD");
	}		
	return auctionDate;	
}


function ExcelDateFormat(excelDateNo, ExcelDateFormat){
	
	if(_.isNil(ExcelDateFormat) ){
		ExcelDateFormat = "DD-MMM-YYYY";
	}
	
	return moment(Math.round((excelDateNo - 25569)*86400*1000)).format(ExcelDateFormat);
}

function GetExcelDateNumber(date, ExcelDateFormat){
	
	if(_.isNil(ExcelDateFormat) ){
		ExcelDateFormat = "DD-MMM-YYYY";
	}
	
	var unixNo = parseInt(new moment(date, ExcelDateFormat).format("x"));
	var dateNo = Math.round (unixNo / 86400000) + 25569
	return dateNo;		

}



function formatTenorStrip(value){

	if(value == "Non-Standard" ){	
		return value;				
	}else{
		value = value.replace(" Month", "");
		value = value.replace(" Months", "")
	}
	return value;
}


function formatTenor(value){

	if(value == "Non-Standard" ){	
		return value;	
	}
		
	if(parseInt(value)){			
		return value + " Month"
	}else{
		return value;
	}
}

function onAmountChange(Amount, round){
	var i = 0;
	if(round){
		Amount = _.round(Amount);
	}
	
	Amount = Amount + "";
	var formatAmount =  numberWithCommas( Amount.replace(/\,/g, '').replace(/ /g,'').replace(/([a-zA-Z])/g, function(match) { 
		if(match.toLowerCase() === "b" || match.toLowerCase() === "m"){
			if(i++ === 0){return match;}
			else {return match;}
		}
		else {return "";}
	}).replace('b','000000000').replace('m','000000').replace('B','000000000').replace('M','000000'));
	
	
	return formatAmount;
	
}


function addAuditLog(AuditLogList, FromStage, ToStage ,SubmittedBy, Action){
	var log = {};
	
	log.FromStage = FromStage;
	log.ToStage = ToStage;
	log.SubmittedBy = SubmittedBy;
	log.Date =  moment().format('YYYY-MM-DD hh:mm A');
	log.Action = Action;

	AuditLogList.push(log);
}

function addComment(CommentList, Status, From, Comment){
	var log = {};
	
	log.Status= Status;
	log.From= From;
	log.Date=  moment().format('YYYY-MM-DD hh:mm A');
	log.Comment= Comment;

	CommentList.push(log);
}



function numberWithCommas(number) {
    var parts = number.toString().split(".");
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    return parts.join(".");
}

function checkValidBrowser(){
	isValidBrowser = true;

	if (navigator.userAgent.search("MSIE") >= 0) {
		isValidBrowser = false;
	}
	else if (navigator.userAgent.search("Firefox") >= 0) {
		isValidBrowser = false;
	}
	else if (navigator.userAgent.search("Safari") >= 0 && navigator.userAgent.search("Chrome") < 0) {
		isValidBrowser = false;
	}
	else if (navigator.userAgent.search("Opera") >= 0) {
		isValidBrowser = false;
	}
	else if (navigator.userAgent.search("Edge") >= 0) {
		isValidBrowser = false;
	}	
	return isValidBrowser;				
}


function jqAlert(outputMsg, titleMsg, onCloseCallback) {
    if (!outputMsg) return;
    
    var div=$('<div></div>');
    div.html(outputMsg).dialog({
        title: titleMsg,
        resizable: false,
        modal: true,
        buttons: {
            "OK": function () {
                $(this).dialog("close");
            }
        },
        close: onCloseCallback
    });
    if (!titleMsg) div.siblings('.ui-dialog-titlebar').hide();
}
 
function GetQueryStringParams(sParam)
{
    var sPageURL = window.location.search.substring(1);    
    var sURLVariables = sPageURL.split('&');
    for (var i = 0; i < sURLVariables.length; i++)
    {
        var sParameterName = sURLVariables[i].split('=');
        if (sParameterName[0] == sParam)
        {
            return sParameterName[1];
        }
    }
}
function GetScope()
{
	var sel = 'div[id="ListDetails"]';
    $scope =  angular.element(sel).scope();
        
	if(!$scope )
	{	
		alert("Error: Unable to access Angular Data");
		return null;
	}	
	else
	{
		return $scope;	
	}	
}

function CheckUserInGroup() {
	var Userflag = false;
	$().SPServices({

		operation: "GetGroupCollectionFromUser",
		userLoginName: $().SPServices.SPGetCurrentUser(),
		async: false,
		completefunc: function(xData, Status) {
			if ($(xData.responseXML).find("Group[Name = 'EIB TRY']").length == 1) {
				//alert("login inside of the Group user");
				Userflag = true;
			} else {
				//alert("login outside of the Group user");
				Userflag = false;

			}
		}

	});
	return Userflag;
}


function GetRfeFileName(str)
{
	 return String(str).replace(/\//g, '-');
}

function htmlEscape(str) {
    return String(str)
        .replace(/&/g, '&amp;')
//        .replace(/"/g, '&quot;')
//        .replace(/'/g, '&#39;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
}


// code to log error in ErrorLogs list
function ErrorLog(listname, ErrorTitle, ErrorMessage, itemid,Project) {
	var valuepairs = [
		["Title", listname],
		["ErrorTitle", ErrorTitle],
		["Description", ErrorMessage],
		["ItemID", itemid],
		["ProjectName", Project]
	];
	$().SPServices({
		operation: 'UpdateListItems',
		listName: "ErrorLogs",
		batchCmd: "New",
		valuepairs: valuepairs,
		async: false,
		completefunc: function(xData, Status) {
			//jqAlert(Status);
		}
	});

}





function GetStatusFlow(CurrentStatusID)
{
	var Filter = "&$filter=FromStatus eq " + CurrentStatusID + "&$orderby= ButtonOrder asc ";
	return GetListData("StatusFlow", Filter );
}


function strReplaceAll(string, Find, Replace) {
	
    try {
    	if(string){
	    	string += "";
	        return string.replace( new RegExp(Find, "gi"), Replace );       
	      }
	      else{
	      	return string;
	      }
    } catch(ex) {
        return string;
    }
}

function GetConfig(ConfigList, Title)
{
	var ret = "";
	for(i=0;i<ConfigList.length;i++)
	{
		if(ConfigList[i].Title == Title )
		{
			ret = ConfigList[i].Value;
			break;
		}
	}
	return ret;
}

function GetNumber(strNum){
	var res = 0;
	try {
		res = parseInt(strReplaceAll(strNum, ",", ""))	}
	catch(err) {
		res = 0;
	}
	return res;
}

function RoundToMillion(strNum, type){

	var num = 0;
	try {
		num = parseInt(strReplaceAll(strNum, ",", ""))	
	}
	catch(err){
		res = 0;
	}
	
	if(num){
		if(type == 'up' ){
			num = Math.ceil( num / 1000000) * 1000000;
		}
		else if(type == 'down' ){
			num = Math.floor( num / 1000000) * 1000000;
		}
		else{
			num = Math.round( num / 1000000) * 1000000;
		}		
	}
	
	return onAmountChange(num) ;
}

function CompairStringNo(A1, A2){
	
	A1 = strReplaceAll(parseFloat(A1), ",", "") ;
	A2 = strReplaceAll(parseFloat(A2 ), ",", "") ;
	
	if(!A1)
	{
		return false;
	}
	else{
		A1 = parseFloat(A1);
	}
	
	if(!A2)
	{
		return false;
	}
	else{
		A2 = parseFloat(A2);
	}
	
	return A1 == A2 ? true : false;

	

}

function AddAmt(A1, A2)
{	
	A1 = A1 + "";
	A2 = A2 + "";
	A1 = parseFloat(strReplaceAll(A1, ",", "") ) ;
	A2 = parseFloat(strReplaceAll(A2, ",", "") ) ;

	
	if(!A1)
	{
		A1 = 0;
	}
	else{
		A1 = parseInt(A1);
	}
	
	if(!A2)
	{
		A2 = 0;
	}
	else{
		A2 = parseInt(A2);
	}
	
	
	return A1 + A2;	
}


function ValidateEmail(email )   
{  	
	var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
	
	if (!filter.test(email )) 
	{
		return false;
	}
	else
	{			
		return true;
	}
	
}  

function GetCurrencyPos(CurrencyDetList, SelCurrency )
{
	var DecPos = 2;
	if( SelCurrency && CurrencyDetList )
	{
		for(i=0;i<CurrencyDetList.length;i++)
		{
			if(CurrencyDetList[i].CurrencyCode == SelCurrency )
			{
				if( CurrencyDetList[i].CurrencyDecimals == "3" )
				{
					DecPos = 3;							
					break;
				}
			}
		}	
	}

	return DecPos;		
}


function msieversion() {

	var res = false;
    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE ");

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))  // If Internet Explorer, return version number
    {
       // alert(parseInt(ua.substring(msie + 5, ua.indexOf(".", msie))));
       if(parseInt(ua.substring(msie + 5, ua.indexOf(".", msie)))<9)
       {
       	alert("Please use Google Chrome or IE9+ to access this SharePoint Site");
       		res = true;
       }
    }
   else  // If another browser, return 0
    {
        //alert('otherbrowser');
    }

    return res;
}


function GetUserInEmailList(DataArray, NtId, ColumnTitle)
{	
	var Result = "";
	if(NtId && DataArray)
	{
		
		NtId = NtId.toLowerCase();
		$.each(DataArray,
		function(key, Obj)
		{
			if(Obj.Email)
			{
				//str1.indexOf(str2)
				if( Obj.Email.toLowerCase().indexOf(NtId) != -1)
				{					
					Result += " or (" +  ColumnTitle + " eq '" + Obj.Title + "' )";
				}
			}
		});
	}
	
	return Result;
}



function fnExcelReport()
{
    var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
    var textRange; var j=0;
    tab = document.getElementById('ListTable'); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params
 // tab_text= tab_text.replace(/<option[^>]*>|<\/option>/gi, ""); // reomves input params
 // tab_text= tab_text.replace(/<select[^>]*>|<\/select>/gi, ""); // reomves input params


    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE "); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"UAQ IPO.xlsx");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

    return (sa);
}```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\ListFunctions.js```FileName```
function AddUpdateListItem(listName,itemFieldValuePair,itemId){
	var deferred = $.Deferred();
 	var listUrl = _spPageContextInfo.webAbsoluteUrl + "/_api/web/lists/getbytitle('" + listName + "')/items";		
 	$.ajax({	
 		url 		:(itemId) ? listUrl +"('" + itemId + "')" : listUrl ,
	    type 		: "POST",
	    async		: false,
	    contentType : "application/json;odata=verbose",
     	data 		: JSON.stringify(itemFieldValuePair),
     	headers 	: (itemId) ?	{  	"Accept": "application/json;odata=verbose","X-RequestDigest": $("#__REQUESTDIGEST").val(),			                
					            		"IF-MATCH": "*","X-HTTP-Method": "MERGE" 	}		
					:	   			{  	"Accept": "application/json;odata=verbose","X-RequestDigest": $("#__REQUESTDIGEST").val()	},
	    success		: function (data) {	
	    	debugger;
	    	if(data)	deferred.resolve(data);	else	deferred.resolve(itemId);	},
        error		: function (request, status, error) { 
        	debugger;
        	deferred.resolve(null); 
        	}			    
	});		
	return deferred.promise(); 				
}  
	
	
function getItemsByREST(listName,filters,restURL) {//debugger;
	var deferred = $.Deferred();	
	if( !restURL )
		restURL = _spPageContextInfo.webAbsoluteUrl + "/_api/web/lists/getByTitle('"+ listName +"')/items?";
	if( filters )
		restURL = restURL + filters ;  
    $.ajax({
        url: restURL,
        type: "GET",
        async: false,
        headers: { "accept": "application/json;odata=verbose" },
        success: function (data) {	
				if (data.d.results) deferred.resolve(data.d.results);         
				else deferred.resolve(data.d); 			            			
			} ,
        error: function (request, status, error) {  deferred.resolve(null) }
    });
    return deferred.promise();
}	


function deleteItemByREST(listName,itemId){

	var deferred = $.Deferred();
	
	$.ajax({
        url: _spPageContextInfo.webAbsoluteUrl + "/_api/web/lists/getbytitle('" + listName +"')/items('" + itemId + "')",
        type: "DELETE",
        headers: {
            "Accept": "application/json;odata=verbose",
            "X-RequestDigest": $("#__REQUESTDIGEST").val(),
            "IF-MATCH": "*"
        },
        success: function (data) {
        	debugger;
			deferred.resolve(data);           
        },
        error: function (request, status, error) { deferred.resolve(null)  }
    });
    
     return deferred.promise();

}```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\MultiplePeoplePicker.js```FileName```/* common*/

function GetSPUserInfo(LoginName) {

    var Data = {};
    $().SPServices({
        operation: "GetUserInfo",
        async: false,
        userLoginName: LoginName,
        completefunc: function(xData, Status) {
            $(xData.responseXML).find("User").each(function() {
                Data.UserId = $(this).attr("ID");
                Data.UserName = $(this).attr("Name");
                Data.FullUserName = $(this).attr("ID") + ";#" + $(this).attr("Name");
            });
        }
    });
    //return Data;
    if (Data.UserId) {
        return Data.UserId;
    } else {
        //AddUserToSharePointGroup(LoginName,"Enterprise Initiative Tracker Visitors");

        return AddUsertoGroup(LoginName, "593")
        //debugger;
        //GetSPUserInfo(LoginName);
    }
}

function AddUsertoGroup(userLoginName, GroupID) {
                var statustext = "";
                $().SPServices({
                                operation: "AddUserToGroup",
                                groupName: "ReadOnlyUsers",
                                userLoginName: userLoginName,
                                async: false,
                                completefunc: function(data, status) {
                                                //debugger;
                                                //console.log(data);
                                                statustext = status;
                                }
                });
                //return statustext;
}


/*
function AddUsertoGroup(userLoginName,GroupName)
{
var useridval="";
$.ajax({
    url: _spPageContextInfo.webAbsoluteUrl + "/_api/web/sitegroups(" + GroupName + ")/users",
    type: "POST",
    async: false,
    contentType: "application/json;odata=verbose",
    data:JSON.stringify({'__metadata': { 'type': 'SP.User' }, 'LoginName': userLoginName}),
    headers: {
        "Accept": "application/json;odata=verbose",
        "X-RequestDigest": $("#__REQUESTDIGEST").val()
    },
    success: function (data) {        
     // console.log(data);
     // alert(data.d.Id);
     useridval= data.d.Id;
    },
    error: function (data) {
      console.log(data);
    }
  });
  return useridval;
}
*/

/* end of Common*/


/* Single*/

function initializeSinglePeoplePicker(peoplePickerElementId) {
                
    // Create a schema to store picker properties, and set the properties.  
    var schema = {};
    //schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';  
    schema['PrincipalAccountType'] = 'User';
    //This value specifies where you would want to search for the valid values
    schema['SearchPrincipalSource'] = 15;
    //This value specifies where you would want to resolve for the valid values
    schema['ResolvePrincipalSource'] = 15;
    schema['AllowMultipleValues'] = false;
    schema['MaximumEntitySuggestions'] = 50;
    schema['Width'] = '100%';                          
    this.SPClientPeoplePicker_InitStandaloneControlWrapper(peoplePickerElementId, null, schema);

} 

function getUserInfo_PrimaryRM() {
    // Get the people picker object from the page.
    var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.PrimaryRM_TopSpan;
    // Get information about all users.
    var userName = getSingleUserInfo(peoplePicker);
    return userName;

}

function getSingleUserInfo(peoplePicker) {

                
    var users = peoplePicker.GetAllUserInfo();
    var userInfo = '';
    var userName = '';
    for (var i = 0; i < users.length; i++) {
                    var user = users[i];
                    /*
                    for (var userProperty in user) {
                                    userInfo += userProperty + ':  ' + user[userProperty] + '<br>';
                    }
                    */
                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                                                if (!userID) {
                                                                                                userID = GetSPUserInfo(users[i].Key);
                                                                                }
                                                                                userInfo += userID + ";#" + user.DisplayText + ";#";

    }
    // Get user keys.
    var keys = peoplePicker.GetAllUserKeys();
    // Get the first user's ID by using the login name.
    // var userName = getUserId(users[0].Key);
    if (users.length > 0) {
                    //var username2 = GetUserId(users[0].Key);
                    userName = GetSPUserInfo(users[0].Key);
                    //debugger;
                    //var username2= GetUserId(users[0].Key);

                    //GetUserId
                    // userName = users[0].Key;
    }
    // alert(userName);
    return userName;

}

function PopulatePeoplePicker_PrimaryRM(Value) {
    //debugger;

    var divPeople = SPClientPeoplePicker.SPClientPeoplePickerDict.PrimaryRM_TopSpan;
    var userObj = {
                    'Key': Value
    };
    divPeople.AddUnresolvedUser(userObj, true);
}


/* End of Single*/

/* Multiple*/



function clearPP(ppid) {
                var spclientPeoplePicker = SPClientPeoplePicker.SPClientPeoplePickerDict[ppid];
                if (spclientPeoplePicker) {
                                //Get the Resolved Users list from Client People Picker
                                var ResolvedUsers = $(document.getElementById(spclientPeoplePicker.ResolvedListElementId)).find("span[class='sp-peoplepicker-userSpan']");
                                //Clear the Client People Picker
                                $(ResolvedUsers).each(function(index) {
                                                spclientPeoplePicker.DeleteProcessedUser(this);
                                });
                }
} 
function getUserInfo(ppID) {
               // debugger;
                var toSpanKey = ppID + "_TopSpan";
                var peoplePicker = null;
                // Get the people picker object from the page.
                //var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
                var ClientPickerDict = this.SPClientPeoplePicker.SPClientPeoplePickerDict;
                // Get the people picker object from the page.
                for (var propertyName in ClientPickerDict) {
                                if (propertyName == toSpanKey) {
                                                peoplePicker = ClientPickerDict[propertyName];
                                                break;
                                }
                }
                if (peoplePicker != null) {
                                // Get information about all users.
                                var users = peoplePicker.GetAllUserInfo();
                                // console.log(users);
                                var userInfo = '';
                                for (var i = 0; i < users.length; i++) {
                                                var user = users[i];
                                                                                                                                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                if (!userID) {
                                                    userID = GetSPUserInfo(users[i].Key);
                                                }
                                                userInfo += userID + ";#" + user.DisplayText + ";#";
                                }
                                return userInfo;
                } else
                                return '';
}

function getUserInfoAsArray(ppID) {
                                                                
                                                                var Result = [];
               // debugger;
                var toSpanKey = ppID + "_TopSpan";
                var peoplePicker = null;
                // Get the people picker object from the page.
                //var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
                var ClientPickerDict = this.SPClientPeoplePicker.SPClientPeoplePickerDict;
                // Get the people picker object from the page.
                for (var propertyName in ClientPickerDict) {
                                if (propertyName == toSpanKey) {
                                                peoplePicker = ClientPickerDict[propertyName];
                                                break;
                                }
                }
                if (peoplePicker != null) {
                                // Get information about all users.
                                var users = peoplePicker.GetAllUserInfo();
                                // console.log(users);
                                var userInfo = '';
                                for (var i = 0; i < users.length; i++) {
                                                var user = users[i];
                                                                                                                                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                if (!userID) {
                                                    userID = GetSPUserInfo(users[i].Key);
                                                }
                                                userInfo += userID + ";#" + user.DisplayText + ";#";
                                                Result.push(user.DisplayText);
                                }
                                return Result;
                } else
                                return Result;
}


function checkUserExists(ppID, CheckUserID) {
                                                                var res = false;
                                                                
               // debugger;
                var toSpanKey = ppID + "_TopSpan";
                var peoplePicker = null;
                // Get the people picker object from the page.
                //var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
                var ClientPickerDict = this.SPClientPeoplePicker.SPClientPeoplePickerDict;
                // Get the people picker object from the page.
                for (var propertyName in ClientPickerDict) {
                                if (propertyName == toSpanKey) {
                                                peoplePicker = ClientPickerDict[propertyName];
                                                break;
                                }
                }
                if (peoplePicker != null) {
                                // Get information about all users.
                                var users = peoplePicker.GetAllUserInfo();
                                // console.log(users);
                                var userInfo = '';
                                for (var i = 0; i < users.length; i++) {
                                                var user = users[i];
                                                                                                                                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                if (!userID) {
                                                    userID = GetSPUserInfo(users[i].Key);
                                                }
                                                if(CheckUserID == userID )
                                               {
                                                           res = true;
                                                           break;
                                                }
                                              
                                                userInfo += userID + ";#" + user.DisplayText + ";#";
                                }
                                return res ;
                } else
                                return res ;
                                
              return res ;                                
}



function initializePeoplePickerMultiple(peoplePickerElementId) {
    //debugger;

    // Create a schema to store picker properties, and set the properties.  
    var schema = {};
    //schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';  
    //schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';  
    schema['PrincipalAccountType'] = 'User';
    //This value specifies where you would want to search for the valid values
    schema['SearchPrincipalSource'] = 15;
    //This value specifies where you would want to resolve for the valid values
    schema['ResolvePrincipalSource'] = 15;
    schema['AllowMultipleValues'] = true;
    schema['MaximumEntitySuggestions'] = 50;
    schema['Width'] = '100%';
    schema['overflow'] = 'inherit';
    this.SPClientPeoplePicker_InitStandaloneControlWrapper(peoplePickerElementId, null, schema);

}

function RMPopulateMembers(ProjectMembers) {
    //debugger;
    //var userField2 = SPClientPeoplePicker.SPClientPeoplePickerDict.ppProjectMembers_TopSpan; // find the people picker element, assuming you dont have multiple people pickers on the form 
    var peoplepicker2 = SPClientPeoplePicker.SPClientPeoplePickerDict.PrimaryRM_TopSpan; // Use SPClientPeoplePicker to get the actual picker object

    if (ProjectMembers && ProjectMembers.results != undefined) {
        for (var i = 0; i < ProjectMembers.results.length; i++) {
            //alert(ProjectMembers[i].ID);
            //alert()                                                               
            peoplepicker2.AddUserKeys(getUser(ProjectMembers.results[i]));
        }
    }

}


function PopulateMembers(ProjectMembers, Title) {
    //debugger;
    //var userField2 = SPClientPeoplePicker.SPClientPeoplePickerDict.ppProjectMembers_TopSpan; // find the people picker element, assuming you dont have multiple people pickers on the form 
    var peoplepicker2 = SPClientPeoplePicker.SPClientPeoplePickerDict.CCEmail_TopSpan; // Use SPClientPeoplePicker to get the actual picker object
    if(Title)
    {
                                peoplepicker2 = SPClientPeoplePicker.SPClientPeoplePickerDict[Title + "_TopSpan" ]; // Use SPClientPeoplePicker to get the actual picker object 
    }
       
    if (ProjectMembers && ProjectMembers.results != undefined) {
        for (var i = 0; i < ProjectMembers.results.length; i++) {
            //alert(ProjectMembers[i].ID);
            //alert()                                                               
            peoplepicker2.AddUserKeys(getUser(ProjectMembers.results[i]));
        }
    }

}

function getUser(id) {
    //debugger;
    var loginName;
    jQuery.ajax({
        url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/GetUserById(" + id + ")",
        type: "GET",
        async: false,
        headers: {
            "Accept": "application/json;odata=verbose"
        },
        success: function(data) {
            var dataResults = data.d;
            loginName = dataResults.LoginName;

        }
    });
    return loginName;
}


/* end of Multiple*/
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\NintexFunctions.js```FileName```function ErrorOccur(data, status, req) { 
	debugger;
    console.log(data.responseText);
    alert(data.responseText + " " + status); 
    
    $('#divOverlay').hide();
	$('#ListDetails').show();
				
    return false;
}


function StartNintexWorkflow(WorkflowName, ListTitle, ID, Comment ) { 

	var associationData = htmlEscape("<Data><WorkFlowComment>" +  Comment  +"</WorkFlowComment></Data>");
	
	var result = '';
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
    //console.log(webserUrl);
    //https://workplace.emiratesislamic.ae/_vti_bin/NintexWorkflow/Workflow.asmx
    var soapRequest  = '<?xml version="1.0" encoding="utf-8"?>' + 
    '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' + 
    '  <soap:Body>' + 
    '    <StartWorkflowOnListItem xmlns="http://nintex.com">' + 
    '      <itemId>' + ID +'</itemId>' + 
    '      <listName>' + ListTitle + '</listName>' + 
    '      <workflowName>' + WorkflowName + '</workflowName>' + 
    '      <associationData>' + associationData +'</associationData>' + 
    '    </StartWorkflowOnListItem>' + 
    '  </soap:Body>' + 
    '</soap:Envelope>';
    
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: true,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/StartWorkflowOnListItem"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
        	result = status;
            if (status == "success") 
            {   
            	/*                             				
				setTimeout(
                function() 
                {
                	$('#divOverlay').hide();
					$('#ListDetails').show();
                	alert("WF Created"); 
                	//endFun();               	
                    
                }, 100);
                */
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);               
            }
        }, 
        error: ErrorOccur 
    });
    
   return result;
}

//
function GetTaskStubsForCurrentUser($scope)
{
   var res = [];
        
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
    console.log(webserUrl);
    
    var soapRequest  =     
    	'<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:nin="http://nintex.com">' + 
	   		'<soap:Header/>' +
	   		'<soap:Body>' +
		      	'<nin:GetTaskStubsForCurrentUser/>' +		       
	   		'</soap:Body>' +
		'</soap:Envelope>';
		
	
                
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/GetTaskStubsForCurrentUser"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
            if (status == "success") 
            {
            	$(req.responseText).find("TaskStub").each(function(){ 
            		var v =  $(this);
            	/*
            		//var v =  $(this);
            		taskName = $(this)[0].getElementsByTagName('taskname')[0].textContent;
            		SharePointTaskId  = $(this)[0].getElementsByTagName('sharepointtaskid')[0].textContent;
            		if(SharePointTaskId )
	                {
	                	var itm = {};
	                	itm.taskName = taskName;
	                	
	                	var asArr = taskName.split('`');
	                	if( asArr.length >= 2 && $.isNumeric(asArr[0]) ){
	                		itm.ID = parseInt(asArr[0]);
	                		itm.Name = asArr[1];
	                		res.push(itm);
	                	}	                		                    
	                    //console.log(taskName  + "- " + SharePointTaskId);
	                }     
	                */       		
				});              
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });
    
    return res;
    
}

function GetUserTasks($scope){
	var resList = [];
	var grps = '';	
	var filter = ",Title,Approvers/Id,Approvers/Title&$expand=Approvers/Id";
	var WakalaDLAApprovers = GetListData("WakalaDLAApprovers", filter );
	$.each(WakalaDLAApprovers,function(index,appit){
		$.each(appit.Approvers.results,function(index,appr){
			if(IsCurrentUserInGroup(appr.Title)){
				//grps += '<nin:userlogin>' + appr.Title + '</nin:userlogin>';
				resList = $.merge( resList, GetRunningWorkflowTasksForCurrentUser(appr.Title));
			}			
		});
		
	});
	
	resList = $.merge( resList, $scope.NtId );

	return resList;

}

function GetRunningWorkflowTasksForCurrentUser(userId)
{

	var grps = '';	
	var filter = ",Title,Approvers/Id,Approvers/Title&$expand=Approvers/Id";
	var WakalaDLAApprovers = GetListData("WakalaDLAApprovers", filter );
	$.each(WakalaDLAApprovers,function(index,appit){
		$.each(appit.Approvers.results,function(index,appr){
			if(IsCurrentUserInGroup(appr.Title)){
				grps += '<nin:userlogin>' + appr.Title + '</nin:userlogin>';
			}			
		});
		
	});
		
   	var res = [];
        
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
    console.log(webserUrl);
    
    var soapRequest1  =     
    	'<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:nin="http://nintex.com">' + 
	   		'<soap:Header/>' +
	   		'<soap:Body>' +
		      	'<nin:GetRunningWorkflowTasksForCurrentUser>' +
		       // '<nin:fileUrl>https://workplace.emiratesislamic.ae/EITRY/FX/Documents/WFUrls.txt</nin:fileUrl>' +
		      	'</nin:GetRunningWorkflowTasksForCurrentUser>' +
	   		'</soap:Body>' +
		'</soap:Envelope>';
		
	var soapRequest  =		
		'<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:nin="http://nintex.com">' +
			'<soap:Header/>' + 
			'<soap:Body>' +
				'<nin:GetRunningWorkflowTasksCollection>' +
				//'<nin:userlogin>i:0#.w|ebil\\' + $scope.NtId + '</nin:userlogin>' +	
				'<nin:userlogin>' + userId + '</nin:userlogin>' +	
				//grps +
				'</nin:GetRunningWorkflowTasksCollection>' +
			'</soap:Body>' +
		'</soap:Envelope>';
                
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/GetRunningWorkflowTasksCollection"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
            if (status == "success") 
            {
            	$(req.responseText).find("UserTask").each(function(){  
            		//var v =  $(this);
            		taskName = $(this)[0].getElementsByTagName('taskname')[0].textContent;
            		SharePointTaskId  = $(this)[0].getElementsByTagName('sharepointtaskid')[0].textContent;
            		if(SharePointTaskId )
	                {
	                	var itm = {};
	                	itm.taskName = taskName;
	                	
	                	var asArr = taskName.split('`');
	                	if( asArr.length >= 2 && $.isNumeric(asArr[0]) ){
	                		itm.ID = parseInt(asArr[0]);
	                		itm.Name = asArr[1];
	                		res.push(itm);
	                	}	                		                    
	                    //console.log(taskName  + "- " + SharePointTaskId);
	                }            		
				});              
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });
    
    return res;
    
}


function GetRunningWorkflowTasksForCurrentUserForListItem(ID, ListName)
{
   var res = [];
    
    
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
    console.log(webserUrl);
    
    var soapRequest  = 
        '<?xml version="1.0" encoding="utf-8"?>' + 
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
        '  <soap:Body>' +
        '    <GetRunningWorkflowTasksForCurrentUserForListItem xmlns="http://nintex.com">' +
        '      <itemId>' + ID + '</itemId>' +
        '      <listName>' + ListName + '</listName>' +
        '    </GetRunningWorkflowTasksForCurrentUserForListItem>' +
        '  </soap:Body>' +
        '</soap:Envelope>';
        
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/GetRunningWorkflowTasksForCurrentUserForListItem"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
            if (status == "success") 
            {
            
            	$(req.responseText).find("UserTask").each(function(){  
            		//var v =  $(this);
            		taskName = $(this)[0].getElementsByTagName('taskname')[0].textContent;
            		SharePointTaskId  = $(this)[0].getElementsByTagName('sharepointtaskid')[0].textContent;
            		 if(SharePointTaskId )
	                {
	                	 res1 =  GetOutcomesForFlexiTask(SharePointTaskId, ListName, taskName );
		                 res = res.concat(res1);
	                }            		
				});
				
				/*
            	$(req.responseText).find("SharePointTaskId").each(function(){  
            		
            		SharePointTaskId = $(this).text();
            		
            		//SharePointTaskId = $(req.responseText).find("SharePointTaskId").text();
	                if(SharePointTaskId )
	                {
	                    res1 =  GetOutcomesForFlexiTask(SharePointTaskId, ListName );
	                    res = res.concat(res1);
	                }
				});	
				*/
				/*
                SharePointTaskId = $(req.responseText).find("SharePointTaskId").text();
                if(SharePointTaskId )
                {
                    res =  GetOutcomesForFlexiTask(SharePointTaskId, ListName );
                }
                else
                {
                   // $('.ActionButtons').append('<input type="button"  value="StartWorkflow" onclick="StartWorkflow()" />');
                }
                */
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });
    
    return res;
    
}

function GetOutcomesForFlexiTask(SharePointTaskId, ListName, taskName )
{    
	var res = [];
    //var webserUrl = "/TestSite/_vti_bin/nintexworkflow/workflow.asmx";
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";

    var soapRequest  =     
        '<?xml version="1.0" encoding="utf-8"?>' +
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
        '  <soap:Body>' +
        '    <GetOutcomesForFlexiTask xmlns="http://nintex.com">' +
        '      <spTaskId>' + SharePointTaskId  +'</spTaskId>' +
        '      <taskListName>Workflow Tasks</taskListName>' +
        '    </GetOutcomesForFlexiTask>' +
        '  </soap:Body>' +
        '</soap:Envelope>';
        
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/GetOutcomesForFlexiTask"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
            if (status == "success") 
            {
            	
            	$(req.responseText).find("ConfiguredOutcome").each(function(){  
            		var act = {};
            		act.Title = $(this).attr("Name");
            		act.TaskId  = SharePointTaskId ;
            		act.taskName = taskName;
            		res.push(act);
            	});	            						
       			
                //UpdateTasks(req.responseText, SharePointTaskId );
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });
    
    return res;
}


function ProcessFlexiTaskResponse2( Action, SharePointTaskId, comment  ){

	//$('#divOverlay').show();
	//$('#ListDetails').hide();
	var res = '';
		
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
    //console.log(webserUrl);    
        
    var soapRequest  =     
        '<?xml version="1.0" encoding="utf-8"?>' +
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
        '  <soap:Body>' +
        '    <ProcessFlexiTaskResponse2 xmlns="http://nintex.com">' +
        '      <comments>' + comment + '</comments>' +
        '      <outcome>'+ Action + '</outcome>' +
        '      <spTaskId>' + SharePointTaskId + '</spTaskId>' +
        '      <taskListName>Workflow Tasks</taskListName>' +
        '    </ProcessFlexiTaskResponse2>' +
        '  </soap:Body>' +
        '</soap:Envelope>';
        
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/ProcessFlexiTaskResponse2"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
        	res = status;
            if ( status == "success") 
            {                	
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });
    
    return res;
}


function ProcessTaskResponse3( SharePointTaskId, comment  ){
debugger;
	//$('#divOverlay').show();
	//$('#ListDetails').hide();
	var res = '';
		
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";
    //console.log(webserUrl);    
        
    var soapRequest  =     
        '<?xml version="1.0" encoding="utf-8"?>' +
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
        '  <soap:Body>' +
        '    <ProcessTaskResponse3 xmlns="http://nintex.com">' +
        '      <comments>' + comment + '</comments>' +
        '      <outcome></outcome>' +
        '      <spTaskId>' + SharePointTaskId + '</spTaskId>' +
        '      <taskListName>Workflow Tasks</taskListName>' +
        '    </ProcessTaskResponse3 >' +
        '  </soap:Body>' +
        '</soap:Envelope>';
        
    $.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/ProcessFlexiTaskResponse2"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
        	res = status;
            if ( status == "success") 
            {                	
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });
    
    return res;
}


function GetNintexWorkflowHistory(itemId, listName ){

	var res = '';		
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";

	//GetWorkflowHistoryForListItem
	var soapRequest  =     
        '<?xml version="1.0" encoding="utf-8"?>' +        	
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
        '  <soap:Body>' +
        '    <GetWorkflowHistoryForListItem xmlns="http://nintex.com">' +
        '      <itemId>' + itemId + '</itemId>' +
        '      <listName>'+ listName + '</listName>' +
        '      <stateFilter>All</stateFilter>' +
        '      <workflowNameFilter>HedgeWorkflow</workflowNameFilter>' +
        '    </GetWorkflowHistoryForListItem>' +
        '  </soap:Body>' +
        '</soap:Envelope>';
        
        
		/*
		
		POST /_vti_bin/nintexworkflow/workflow.asmx HTTP/1.1
		Host: wvmspwebu.uat.emiratesnbd.com
		Content-Type: text/xml; charset=utf-8
		Content-Length: length
		SOAPAction: "http://nintex.com/GetWorkflowHistoryForListItem"
		
		<?xml version="1.0" encoding="utf-8"?>
		<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
		  <soap:Body>
		    <GetWorkflowHistoryForListItem xmlns="http://nintex.com">
		      <itemId>int</itemId>
		      <listName>string</listName>
		      <stateFilter>None or Locked or Running or Completed or Cancelled or Expiring or Expired or Faulting or Terminated or Suspended or Orphaned or HasNewEvents or NotStarted or All</stateFilter>
		      <workflowNameFilter>string</workflowNameFilter>
		    </GetWorkflowHistoryForListItem>
		  </soap:Body>
		</soap:Envelope>

		*/        
	$.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml; charset=utf-8", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/GetWorkflowHistoryForListItem"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
        debugger;
        	res = status;
            if ( status == "success") 
            {                	
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });


/*
<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
  <soap:Body>
    <GetWorkflowHistoryForListItem xmlns="http://nintex.com">
      <itemId>int</itemId>
      <listName>string</listName>
      <stateFilter>None or Locked or Running or Completed or Cancelled or Expiring or Expired or Faulting or Terminated or Suspended or Orphaned or HasNewEvents or NotStarted or All</stateFilter>
      <workflowNameFilter>string</workflowNameFilter>
    </GetWorkflowHistoryForListItem>
  </soap:Body>
</soap:Envelope>

*/
}


function GetNintexWorkflowHistory(itemId, listName ){

	var res = '';		
    var webserUrl = _spPageContextInfo.webAbsoluteUrl + "/_vti_bin/nintexworkflow/workflow.asmx";

	//GetWorkflowHistoryForListItem
	var soapRequest  =     
        '<?xml version="1.0" encoding="utf-8"?>' +        	
        '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">' +
        '  <soap:Body>' +
        '    <GetWorkflowHistoryForListItem xmlns="http://nintex.com">' +
        '      <itemId>' + itemId + '</itemId>' +
        '      <listName>'+ listName + '</listName>' +
        '      <stateFilter>All</stateFilter>' +
        '      <workflowNameFilter>HedgeWorkflow</workflowNameFilter>' +
        '    </GetWorkflowHistoryForListItem>' +
        '  </soap:Body>' +
        '</soap:Envelope>';
        
        
		/*
		
		POST /_vti_bin/nintexworkflow/workflow.asmx HTTP/1.1
		Host: wvmspwebu.uat.emiratesnbd.com
		Content-Type: text/xml; charset=utf-8
		Content-Length: length
		SOAPAction: "http://nintex.com/GetWorkflowHistoryForListItem"
		
		<?xml version="1.0" encoding="utf-8"?>
		<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
		  <soap:Body>
		    <GetWorkflowHistoryForListItem xmlns="http://nintex.com">
		      <itemId>int</itemId>
		      <listName>string</listName>
		      <stateFilter>None or Locked or Running or Completed or Cancelled or Expiring or Expired or Faulting or Terminated or Suspended or Orphaned or HasNewEvents or NotStarted or All</stateFilter>
		      <workflowNameFilter>string</workflowNameFilter>
		    </GetWorkflowHistoryForListItem>
		  </soap:Body>
		</soap:Envelope>

		*/        
	$.ajax({ 
        type: "POST", 
        url: webserUrl, 
        contentType: "text/xml; charset=utf-8", 
        dataType: "xml", 
        async: false,
        beforeSend: function (request) 
        { 
         request.setRequestHeader("SOAPAction", "http://nintex.com/GetWorkflowHistoryForListItem"); 
        }, 
        data: soapRequest, 
        success: function(data, status, req) {
        debugger;
        	res = status;
            if ( status == "success") 
            {                	
            }
            else
            {
                alert("Error : " + req.responseText);
                console.log("Error : " + req.responseText);
            }
        }, 
        error: ErrorOccur 
    });


}


function CheckStatusChanged(LastStatusId, ID)
{
	var result = false;
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + WakalaList +"')/Items?$select=StatusCode&$filter=ID eq " + ID;
		
	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results)
			{		
				result = data.d.results[0].StatusCode == LastStatusId ? false : true;				
			}				
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			//ErrorLog(ListName, "GetLiveStatus", JSON.stringify(error), "", "OMS");
        }
    });
	
	return result;

}

function GetComment(comment, approver){
	var st = comment.lastIndexOf( "(" + approver + ")" ) + approver.length + 2;	
	return comment.substring(st, comment.length);
	
}

function FormatNintexComment(comment, approver) {
	
	if(comment && approver){
		var st = comment.lastIndexOf( "(" + approver + ")" ) + approver.length + 2;	
		if(comment.lastIndexOf( "(" + approver + ")" ) != -1){
			return comment.substring(st, comment.length);
		}
		else{
			return comment;
		}
	}
	else{
		return comment;
	}	
}

function FormatNintexDate(date) {	
	if(date){
		return new moment(date).format('DD-MMM-YYYY hh:mm A');
	}
	else{
		return "";
	}
		
}
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\SinglePPlePicker.js```FileName```/* common*/

function GetSPUserInfo(LoginName) {

    var Data = {};
    $().SPServices({
        operation: "GetUserInfo",
        async: false,
        userLoginName: LoginName,
        completefunc: function(xData, Status) {
            $(xData.responseXML).find("User").each(function() {
                Data.UserId = $(this).attr("ID");
                Data.UserName = $(this).attr("Name");
                Data.FullUserName = $(this).attr("ID") + ";#" + $(this).attr("Name");
            });
        }
    });
    //return Data;
    if (Data.UserId) {
        return Data.UserId;
    } else {
        //AddUserToSharePointGroup(LoginName,"Enterprise Initiative Tracker Visitors");

        return AddUsertoGroup(LoginName, "593")
        //debugger;
        //GetSPUserInfo(LoginName);
    }
}

function AddUsertoGroup(userLoginName, GroupID) {
                var statustext = "";
                $().SPServices({
                                operation: "AddUserToGroup",
                                groupName: "ReadOnlyUsers",
                                userLoginName: userLoginName,
                                async: false,
                                completefunc: function(data, status) {
                                                //debugger;
                                                //console.log(data);
                                                statustext = status;
                                }
                });
                //return statustext;
}


/*
function AddUsertoGroup(userLoginName,GroupName)
{
var useridval="";
$.ajax({
    url: _spPageContextInfo.webAbsoluteUrl + "/_api/web/sitegroups(" + GroupName + ")/users",
    type: "POST",
    async: false,
    contentType: "application/json;odata=verbose",
    data:JSON.stringify({'__metadata': { 'type': 'SP.User' }, 'LoginName': userLoginName}),
    headers: {
        "Accept": "application/json;odata=verbose",
        "X-RequestDigest": $("#__REQUESTDIGEST").val()
    },
    success: function (data) {        
     // console.log(data);
     // alert(data.d.Id);
     useridval= data.d.Id;
    },
    error: function (data) {
      console.log(data);
    }
  });
  return useridval;
}
*/

/* end of Common*/


/* Single*/

function initializeSinglePeoplePicker(peoplePickerElementId) {
                
    // Create a schema to store picker properties, and set the properties.  
    var schema = {};
    //schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';  
    schema['PrincipalAccountType'] = 'User';
    //This value specifies where you would want to search for the valid values
    schema['SearchPrincipalSource'] = 15;
    //This value specifies where you would want to resolve for the valid values
    schema['ResolvePrincipalSource'] = 15;
    schema['AllowMultipleValues'] = false;
    schema['MaximumEntitySuggestions'] = 50;
    schema['Width'] = '350px';                          
    this.SPClientPeoplePicker_InitStandaloneControlWrapper(peoplePickerElementId, null, schema);

} 

function getUserInfo_PrimaryRM() {
    // Get the people picker object from the page.
    var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.PrimaryRM_TopSpan;
    // Get information about all users.
    var userName = getSingleUserInfo(peoplePicker);
    return userName;

}

function getSingleUserInfo(peoplePicker) {

                
    var users = peoplePicker.GetAllUserInfo();
    var userInfo = '';
    var userName = '';
    for (var i = 0; i < users.length; i++) {
                    var user = users[i];
                    /*
                    for (var userProperty in user) {
                                    userInfo += userProperty + ':  ' + user[userProperty] + '<br>';
                    }
                    */
                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                                                if (!userID) {
                                                                                                userID = GetSPUserInfo(users[i].Key);
                                                                                }
                                                                                userInfo += userID + ";#" + user.DisplayText + ";#";

    }
    // Get user keys.
    var keys = peoplePicker.GetAllUserKeys();
    // Get the first user's ID by using the login name.
    // var userName = getUserId(users[0].Key);
    if (users.length > 0) {
                    //var username2 = GetUserId(users[0].Key);
                    userName = GetSPUserInfo(users[0].Key);
                    //debugger;
                    //var username2= GetUserId(users[0].Key);

                    //GetUserId
                    // userName = users[0].Key;
    }
    // alert(userName);
    return userName;

}

function PopulatePeoplePicker_PrimaryRM(Value) {
    //debugger;

    var divPeople = SPClientPeoplePicker.SPClientPeoplePickerDict.PrimaryRM_TopSpan;
    var userObj = {
                    'Key': Value
    };
    divPeople.AddUnresolvedUser(userObj, true);
}


/* End of Single*/

/* Multiple*/



function clearPP(ppid) {
                var spclientPeoplePicker = SPClientPeoplePicker.SPClientPeoplePickerDict[ppid];
                if (spclientPeoplePicker) {
                                //Get the Resolved Users list from Client People Picker
                                var ResolvedUsers = $(document.getElementById(spclientPeoplePicker.ResolvedListElementId)).find("span[class='sp-peoplepicker-userSpan']");
                                //Clear the Client People Picker
                                $(ResolvedUsers).each(function(index) {
                                                spclientPeoplePicker.DeleteProcessedUser(this);
                                });
                }
} 
function getUserInfo(ppID) {
               // debugger;
                var toSpanKey = ppID + "_TopSpan";
                var peoplePicker = null;
                // Get the people picker object from the page.
                //var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
                var ClientPickerDict = this.SPClientPeoplePicker.SPClientPeoplePickerDict;
                // Get the people picker object from the page.
                for (var propertyName in ClientPickerDict) {
                                if (propertyName == toSpanKey) {
                                                peoplePicker = ClientPickerDict[propertyName];
                                                break;
                                }
                }
                if (peoplePicker != null) {
                                // Get information about all users.
                                var users = peoplePicker.GetAllUserInfo();
                                // console.log(users);
                                var userInfo = '';
                                for (var i = 0; i < users.length; i++) {
                                                var user = users[i];
                                                                                                                                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                if (!userID) {
                                                    userID = GetSPUserInfo(users[i].Key);
                                                }
                                                userInfo += userID + ";#" + user.DisplayText + ";#";
                                }
                                return userInfo;
                } else
                                return '';
}

function getUserInfoAsArray(ppID) {
                                                                
                                                                var Result = [];
               // debugger;
                var toSpanKey = ppID + "_TopSpan";
                var peoplePicker = null;
                // Get the people picker object from the page.
                //var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
                var ClientPickerDict = this.SPClientPeoplePicker.SPClientPeoplePickerDict;
                // Get the people picker object from the page.
                for (var propertyName in ClientPickerDict) {
                                if (propertyName == toSpanKey) {
                                                peoplePicker = ClientPickerDict[propertyName];
                                                break;
                                }
                }
                if (peoplePicker != null) {
                                // Get information about all users.
                                var users = peoplePicker.GetAllUserInfo();
                                // console.log(users);
                                var userInfo = '';
                                for (var i = 0; i < users.length; i++) {
                                                var user = users[i];
                                                                                                                                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                if (!userID) {
                                                    userID = GetSPUserInfo(users[i].Key);
                                                }
                                                userInfo += userID + ";#" + user.DisplayText + ";#";
                                                Result.push(user.DisplayText);
                                }
                                return Result;
                } else
                                return Result;
}


function checkUserExists(ppID, CheckUserID) {
                                                                var res = false;
                                                                
               // debugger;
                var toSpanKey = ppID + "_TopSpan";
                var peoplePicker = null;
                // Get the people picker object from the page.
                //var peoplePicker = this.SPClientPeoplePicker.SPClientPeoplePickerDict.peoplePickerDiv_TopSpan;
                var ClientPickerDict = this.SPClientPeoplePicker.SPClientPeoplePickerDict;
                // Get the people picker object from the page.
                for (var propertyName in ClientPickerDict) {
                               if (propertyName == toSpanKey) {
                                                peoplePicker = ClientPickerDict[propertyName];
                                                break;
                                }
                }
                if (peoplePicker != null) {
                                // Get information about all users.
                                var users = peoplePicker.GetAllUserInfo();
                                // console.log(users);
                                var userInfo = '';
                                for (var i = 0; i < users.length; i++) {
                                                var user = users[i];
                                                                                                                                                                                                var userID = GetSPUserInfo(users[i].Key);
                                                if (!userID) {
                                                    userID = GetSPUserInfo(users[i].Key);
                                                }
                                                if(CheckUserID == userID )
                                                {
                                                           res = true;
                                                           break;
                                                }
                                              
                                                userInfo += userID + ";#" + user.DisplayText + ";#";
                                }
                                return res ;
                } else
                                return res ;
                                
              return res ;                                
}



function initializePeoplePickerMultiple(peoplePickerElementId) {
    //debugger;

    // Create a schema to store picker properties, and set the properties.  
    var schema = {};
    //schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';  
    //schema['PrincipalAccountType'] = 'User,DL,SecGroup,SPGroup';  
    schema['PrincipalAccountType'] = 'User';
    //This value specifies where you would want to search for the valid values
    schema['SearchPrincipalSource'] = 15;
    //This value specifies where you would want to resolve for the valid values
    schema['ResolvePrincipalSource'] = 15;
    schema['AllowMultipleValues'] = true;
    schema['MaximumEntitySuggestions'] = 50;
    schema['Width'] = '350px';
    schema['overflow'] = 'inherit';
    this.SPClientPeoplePicker_InitStandaloneControlWrapper(peoplePickerElementId, null, schema);

}

function RMPopulateMembers(ProjectMembers) {
    //debugger;
    //var userField2 = SPClientPeoplePicker.SPClientPeoplePickerDict.ppProjectMembers_TopSpan; // find the people picker element, assuming you dont have multiple people pickers on the form 
    var peoplepicker2 = SPClientPeoplePicker.SPClientPeoplePickerDict.PrimaryRM_TopSpan; // Use SPClientPeoplePicker to get the actual picker object

    if (ProjectMembers.results != undefined) {
        for (var i = 0; i < ProjectMembers.results.length; i++) {
            //alert(ProjectMembers[i].ID);
            //alert()                                                               
            peoplepicker2.AddUserKeys(getUser(ProjectMembers.results[i]));
        }
    }

}


function PopulateMembers(ProjectMembers, Title) {
    debugger;
    //var userField2 = SPClientPeoplePicker.SPClientPeoplePickerDict.ppProjectMembers_TopSpan; // find the people picker element, assuming you dont have multiple people pickers on the form 
    var peoplepicker2 = SPClientPeoplePicker.SPClientPeoplePickerDict.CCEmail_TopSpan; // Use SPClientPeoplePicker to get the actual picker object
    if(Title)
    {
        peoplepicker2 = SPClientPeoplePicker.SPClientPeoplePickerDict[Title + "_TopSpan" ]; // Use SPClientPeoplePicker to get the actual picker object 
    }
       
    if (ProjectMembers && ProjectMembers.results != undefined) {
        for (var i = 0; i < ProjectMembers.results.length; i++) {
            //alert(ProjectMembers[i].ID);
            //alert()                                                               
            peoplepicker2.AddUserKeys(getUser(ProjectMembers.results[i]));
        }
    }

}

function getUser(id) {
    //debugger;
    var loginName;
    jQuery.ajax({
        url: _spPageContextInfo.webAbsoluteUrl + "/_api/Web/GetUserById(" + id + ")",
        type: "GET",
        async: false,
        headers: {
            "Accept": "application/json;odata=verbose"
        },
        success: function(data) {
            var dataResults = data.d;
            loginName = dataResults.LoginName;

        }
    });
    return loginName;
}


/* end of Multiple*/
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\SiteConfig.js```FileName```var ResponsibilityList = [];
var currentUserResp = [];
var IndiviualTaskFilter = "";
var IndiviualStakeHolderFilter = "";

function UpdateResponsibilityConfig(){
	IndiviualTaskFilter = "";
	IndiviualStakeHolderFilter = "";
	
	ResponsibilityList = []
	currentUserResp = []
	var filter = ",Users/Title,Users/Id&$expand=Users/ID,Users/Title"; 
	var resp = GetConfigList(ActionResponsibilityList, filter);
	
	$.each(resp, function(id, val){
		var v = val;
		if(val.Users.results){
			for(i=0;i<val.Users.results.length;i++){
				if(val.Users.results[i].Id == _spPageContextInfo.userId ){
					currentUserResp.push(val.Title);
					
					$.each(val.Users.results , function(uId, uVal){
						
						if(IndiviualTaskFilter ){
							IndiviualTaskFilter  += " or  ";
						}							
						IndiviualTaskFilter += "RespPer/Id eq " + uVal.Id; 
						
						if(IndiviualStakeHolderFilter){
							IndiviualStakeHolderFilter += " or  ";
						}							
						IndiviualStakeHolderFilter += "StakeholderPer/Id eq " + uVal.Id;
						
					});
					
					
					break;
				}
			}
		}
		
		if(	val.Title != 'Admin'){
			ResponsibilityList.push(val);
		}				
	});	
}



//GetConfigList("PayFrequencyList");
function GetConfigList(ListName, filter){
	//debugger;
	if(  Config[ListName] == null || Config[ListName] == undefined ){			
		Config[ListName] = GetListData( ListName, filter);		
	}		
	return Config[ListName];
}


//GetConfigListItem("HedgeStatusList", "HedgeStatus", 1, "Title" );
function GetConfigListItem(ListName, IdColTitle, IdColVal, ValueColTitle ){
	//debugger;
	var res = "";
	var list = GetConfigList(ListName);
	
	for(i=0;i<list.length;i++){
		if(list[i][IdColTitle] == IdColVal ){
			res = list[i][ValueColTitle];
			break;
		}
	}
	return res;	
}



function GetSiteConfig(ConfigType, key1, key2, key3)
{
	//debugger;	
	//DataList 
	//GetSiteConfig("CurrentUser");
	if(ConfigType == "CurrentUser" ){
		if(  Config.CurrentUser == null || Config.CurrentUser == undefined ){			
			Config.CurrentUser = CurrentUserDetails();		
		}				
		
		return Config.CurrentUser;			
	}
	
	//https://wvmspwebu.uat.emiratesnbd.com:4502/gops/WBCDD/WBTRYFDRates/_api/web/siteusers?$select=Id,Title
	
	//GetSiteConfig("GetPortalUserName", "11");
	if(ConfigType == "GetPortalUserName" ){
		
		var res = "";
		if(  Config.PortalUsers == null || Config.PortalUsers == undefined ){								
			Config.PortalUsers = GetPortalUSerList();		
		}
		
		for(i=0;i<Config.PortalUsers .length;i++){
			if(Config.PortalUsers[i].Id == key1 )
			{	
				res = Config.PortalUsers[i].Title;					
				break;
			}
		}

		return res;
	
	}
	
	//GetSiteConfig("ApplicationConfigrations", "Minimum Bid Size");
	if(ConfigType == "ApplicationConfigrations" ){
		if(  Config.ApplicationConfigrations  == null || Config.ApplicationConfigrations == undefined ){			
			Config.ApplicationConfigrations  = GetListData("ApplicationConfigrations", "");		
		}
		
		var res= $.grep(Config.ApplicationConfigrations, function (amObj, index) {	
			return amObj.Title == key1
		});
		
		if(res.length > 0){
			return res[0].Value;
		}
		else{
			return null;
		}	
	}
	
	//GetSiteConfig("EmailTemplate", "AuctionRequestDetails")
	if(ConfigType == "EmailTemplate" ){
		if(  Config.EmailTemplates == null || Config.EmailTemplates == undefined ){			
			Config.EmailTemplates = GetListData("EmailTemplate", "");		
		}
		
		var res= $.grep(Config.EmailTemplates, function (amObj, index) {	
			return amObj.Title == key1
		});
		
		if(res.length > 0){
			return res[0].Body;
		}
		else{
			return null;
		}	
	}
	
									
}





```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\SPListGetItems.js```FileName```function GetListByFilter(ListName, Filter )
{
	var res;
	//var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ListName +"')/Items?$select=*&$filter=Title eq '" + title + "'";
		
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ListName +"')/Items?$top=5000";
	if(	Filter )
	{
		URL += Filter ;
	}

	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results)
			{		
				res = data.d.results;				
			}				
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));			
        }
    });
	
	return res;

}


function GetSiteFieldsList(List, QueryField )
{
	var DataList = [];
	
	//https://workplace.emiratesislamic.ae/EIREMD/_vti_bin/client.svc/web/lists/getByTitle('FRRFields')/Items?$select=Title,List,NeedToUpdate&$filter=( (NeedToUpdate eq '1') and (List eq 'CustomerDetails') )
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('SiteFieldsList')/Items?$select=Title,List,DataType,NeedToUpdate,NeedToView,AddComa,DefaultValueIfBlank&$filter=( (" + QueryField +" eq '1') and (List eq '" + List + "') )";
		
	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {				
			if(data.d.results)
			{						
            	var results = data.d.results;
	            $.each(results , function(index, dataRec) 
	            {    				
					DataList.push(dataRec);	                
	            });
			}
			else
			{
				DataList.push(data.d);
			}		
														
        },
        error: function (error) {
            alert(JSON.stringify(error));
			ErrorLog("OMS", "GetSiteFieldsList", JSON.stringify(error), "", "OMS");	

        }
    });
	
	return DataList;
}

function GetListData(List, FieldSelectionDetails, ReplaceDetails ) 
{
	/*
	ReplaceList[]
		-> columnName
		-> values[]
			-> values[0] id
			-> values[1] value
			
	 this will replace "columnName" column with values[] table id with valie
	 
	 dataRec["Attachments"] = dataRec.AttachmentFiles.results;
					
		$.each(ReplaceList, function(rId, rVal ){
			if(
			//columnName
			$.each(ReplaceList, function(rId, rVal ){
				for(var i = 0; i < rVal.length; i++) {
					if(rVal[i].id == val){
						val =rVal[i].value;
						break;
					}
				}	
			});				
		});
					
	*/
	
	
	
	
	var DataList = [];
	var ColumnList = GetSiteFieldsList(List, "NeedToView" );	
		
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + List +"')/Items?$top=5000&$select=*";
	if(	FieldSelectionDetails  )
	{
		URL += FieldSelectionDetails;
	}
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {							
			if(data.d.results)
			{						
            	var results = data.d.results;
	            $.each(results , function(index, dataRec) 
	            {    
					$.each(ColumnList, function(key,Column)
					{														
						if(Column.DataType == "Date and Time")
						{		
							val = dataRec[Column.Title];
							if(val)
							{
								val = new moment(val).format('DD-MMM-YYYY');
								dataRec[Column.Title] = val;
							}
						}
						
						if(!(  ReplaceDetails == null || ReplaceDetails == undefined ) ){
							if( ReplaceDetails.column == Column.Title ){
								for(var i = 0; i < ReplaceDetails.data.length; i++) {
									if( dataRec[Column.Title] == ReplaceDetails.data[i][ReplaceDetails.idCol] ){
										dataRec[Column.Title] =  ReplaceDetails.data[i][ReplaceDetails.valCol]
									}
									//ReplaceList
								}						
							}	
						}
						
					});	
					
					
					
					
					/*
					if(dataRec.AttachmentFiles.results)
					{
						if(dataRec.AttachmentFiles.results.length > 0 )
						{
						debugger;
							$.each(dataRec.AttachmentFiles.results, function(keyAttach,attach)
							{
								console.log(dataRec.ID + " : " + attach.FileName + " : " + attach.ServerRelativeUrl );
							});						
						}						
					}
					*/													
					DataList.push(dataRec);	                
	            });
			}
			else
			{
				DataList.push(data.d);
			}			
        },
        error: function (error) {
            alert(JSON.stringify(error));
			ErrorLog("OMS", "GetListData", JSON.stringify(error), "", "OMS");	
        }
    });	
	
	if(DataList.length == 0)
	{
		var Data = {};
		$.each(ColumnList, function(key,Column)
		{	
			Data[Column.Title] = null;			
		});					
				
		DataList.push(Data);
	}

	return DataList;
}


function CheckStatusChanged(LastStatusId, ID)
{
	var result = false;
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('HedgeRequests')/Items?$select=StatusId&$filter=ID eq " + ID;
		
	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results)
			{		
				result = data.d.results[0].StatusId == LastStatusId ? false : true;				
			}				
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			ErrorLog(ListName, "GetLiveStatus", JSON.stringify(error), "", "OMS");
        }
    });
	
	return result;

}

function CheckListDuplicate($scope, List, Column, val ){
	//var val = 	'","SeriesNumber":"XXXX-12","';
	
	var res = false;
	var URL = SiteURL + "_vti_bin/ListData.svc" + 
		"/" + List + "?$filter=";

	if($scope.item.Id){
		URL += "( substringof( '" + val + "', " + Column + " )  and (Id ne "+ $scope.item.Id +") )"
	}
	else{
		URL += "substringof( '" + val + "', " + Column + " )"
	}
	
	
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results.length >= 1 )
			{	
				res = true;
			}
			else{
				res = false;
			}			
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			ErrorLog("OMS", "CheckListDuplicate", JSON.stringify(error), "", "OMS");
        }

    });

	return res;
}

//GetDuplicate("AuctionList", "OrderAmounts", "");
function GetDuplicate($scope, List, Column, val, ListColumm, rowid ){
	//debugger;
	if(ListColumm && rowid){
		//var $scope = GetScope();
		var clone =  $scope.item[ListColumm].slice();
		clone.splice(rowid, 1);
		//var listJson = angular.toJson( rClone ); //$scope.item[ListColumm].slice().splice(rowid, 1) );
		var listJson = angular.toJson( clone  );
		var v = listJson.match( new RegExp(val, "g") );
		if( v ){
			return false;
		}			
		return true;	
	} 
	
	//return false;
	
	/*
	//var val = 	'","SeriesNumber":"XXXX-12","';
	var URL = SiteURL + "_vti_bin/ListData.svc" + 
		"/" + List + "?$filter=";

	if($scope.item.Id){
		URL += "( substringof( '" + val + "', " + Column + " )  and (Id ne "+ $scope.item.Id +") )"
	}
	else{
		URL += "substringof( '" + val + "', " + Column + " )"
	}
	
	var res = true;
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results.length >= 1 )
			{	
				res = false;
			}
			else{
				res = true;
			}			
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			ErrorLog("OMS", "GetOMSLiveStatus", JSON.stringify(error), "", "OMS");
        }

    });

		return res;
	*/
}


function GetOrderPlacedByTeam(list){
		
	var URL = SiteURL +  "_api/web/lists/getbytitle('OrderTeamList')/items?&$select=Title,Users/Id,Users/Title&$expand=Users/Id&$filter=Users/Id eq " 
				+ _spPageContextInfo.userId
				
	var res;
	
		$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results.length >= 1 )
			{	
				res = list ? data.d.results : data.d.results[0].Title
			}
			else{
				res = "";
			}			
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			ErrorLog("OMS", "GetOrderPlacedByTeam", JSON.stringify(error), "", "OMS");
        }

    });


	return res;
		
}

function isCurrentUserIsInOrderPlacedByTeam(team){

	var URL = SiteURL +  "_api/web/lists/getbytitle('OrderTeamList')/items?&$select=Title,Users/Id,Users/Title&$expand=Users/Id&$filter=Users/Id eq " 
				+ _spPageContextInfo.userId + " and Title eq '" + team + "'";
				
	var res = false;;
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
		if(data.d.results.length >= 1 )
		{	
			res = true;
		}																				
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
		ErrorLog("OMS", "GetOrderPlacedByTeam", JSON.stringify(error), "", "OMS");
        }
    });


	return res;
		
}


function IsItemExists(ListName, Filter ){

	var res = false;
	
	var URL = SiteURL +  "_api/web/lists/getbytitle('" + ListName +"')/items?&$select=*" + Filter ;
				
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
		if(data.d.results.length >= 1 )
		{	
			res = true;
		}																				
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			ErrorLog("OMS", "GetOrderPlacedByTeam", JSON.stringify(error), "", "OMS");
        }
    });


	return res;


}



function GetPortalUSerList(){

	var res = [];
	
	var URL = SiteURL +  "_api/web/siteusers?$select=Id,Title";
				
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results.length >= 1 )
			{	
				res = data.d.results;
			}																				
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));
			ErrorLog("OMS", "GetOrderPlacedByTeam", JSON.stringify(error), "", "OMS");
        }
    });


	return res;


}

//GetListItemByTitle("ApplicationConfigrations", "RefreshCounter");
function GetListItemByTitle(ListName, title )
{
	var res;
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ListName +"')/Items?$select=*&$filter=Title eq '" + title + "'";
		
	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results)
			{		
				res = data.d.results[0];				
			}				
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));			
        }
    });
	
	return res;

}

function GetListItemByID(ListName, ID )
{
	var res;
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ListName +"')/Items?$select=*&$filter=ID eq " + ID ;
		
	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results)
			{		
				res = data.d.results[0];				
			}				
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));			
        }
    });
	
	return res;

}


function CacheReloadCheck()
{
	//debugger;
	var RefreshCounter = GetListItemByTitle("ApplicationConfigrations", "RefreshCounter");
	if(RefreshCounter){
		RefreshCounter = RefreshCounter.Value;
	}	
	else{
		return;
	}
	var LocCounter = localStorage.getItem("TRYOMSRefreshCounter");	
		
	if(RefreshCounter != LocCounter )
	{
		localStorage.setItem("TRYOMSRefreshCounter", RefreshCounter);
		location.reload(true);
	}
}


function IsCurrentInUsersList(ListTitle, FieldTitle, filter) {
    //debugger;
    var UserAvailable = false;
    var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ListTitle + "')/Items?$top=5000&$select=" + FieldTitle;
    if (filter) {
        URL += "&$filter=" + filter;
    } 
    $.ajax({    
        url: URL,
            type: "GET",
        async: false,
            headers: {      
            "accept": "application/json;odata=verbose",
                
        },
            success: function(data)      {
            if (data.d.results.length>0) {       
               UserAvailable =true;
            }  
        },
            error: function(error) {      
            alert("Error Fetching Permissions List, Try refreshing this page or contact Sharepoint support team");  
            //FXErrorLog("TRY", "Get UserPermision List", JSON.stringify(error), "", "FX Margin");	
            //console.log(ListTitle,"Error fetching GetListItem",JSON.stringify(error),"","BCR");   
        }  
    });
    return UserAvailable ;
}

function GetListItemsCount(ListTitle, FieldTitle, filter) {

	
	var count = [];
	var URL = SiteURL  + "/_api/web/lists/GetByTitle('" + ListTitle + "')/items?$top=5000&$select=" + FieldTitle;

	if (filter) {
		URL += "&$filter=" + filter;
	}	 
	
	$.ajax({    
		url: URL,
		    type: "GET",
		async: false,
		    headers: {      
			"accept": "application/json;odata=verbose",
			    
		},
		    success: function(data)      {
			if (data.d.results) {       
				//alert(data.d.results.length);
				count=data.d.results.length;
			}    
		},
		    error: function(error) {      			
		}  
	});

	return count;
}


function GetFirstSPListItem(ListName, filter)
{
	var res;
	var URL = SiteURL + "_vti_bin/client.svc/web/lists/getByTitle('" + ListName +"')/Items";
	if (filter) {
		URL += "?" + filter;
	}
		
	  $.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function(data) 
        {		
			if(data.d.results)
			{		
				res = data.d.results[0];				
			}				
														
        },
        error: function (error) {
            alert("Error : " + JSON.stringify(error));			
        }
    });
	
	return res;

}





```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\SPListUpdate.js```FileName```function UpdateList( ListItemObj, List, IsNewItem, RetID )
{
	var RetVal = "";
	
	var ColumnList = GetSiteFieldsList(List, "NeedToUpdate");	
	
	if(ColumnList.length > 0)
	{
		var valuepairs = [];
		$.each(ColumnList, function(key,Column)
		{		
			val = ListItemObj[Column.Title];	
			if(!val)
			{	
				if(Column.DefaultValueIfBlank)
				{
					val = Column.DefaultValueIfBlank;
				}
				else 
				{
					val = "";
				}				
			}
			if(Column.DataType == "Date and Time")
			{				
				if(val)
				{
					val = new moment(val, "DD-MMM-YYYY").format('YYYY-MM-DD HH:mm:ss');					
				}				
			}
			else if(Column.DataType == "Person or Group")
			{	
			debugger;
				if( ListItemObj[Column.Title].Id )
				{
					val = ListItemObj[Column.Title].Id;
				}
				else
				{				
					var val = ListItemObj[Column.Title].Name;
					
					if(val)
					{
						val = val.split("|")[1];					
						val = GetUserId(  val , "" ).UserID;
					}
					else
					{
						val = "";
					}
				}
			
			}
			else
			{
				if(Column.AddComa)
				{
					val  = addCommas(val);
				}
			}
			
			valuepairs.push( [Column.Title,val]);						
		});
		
		//valuepairs.push( [Column,val]);
		if(!IsNewItem)
		{
			$().SPServices(
			{
				operation: 'UpdateListItems',
				listName: List,
				ID: ListItemObj["ID"],
				valuepairs: valuepairs,
				async: false,
				completefunc: function(xData, Status) 
				{		
					if(Status== 'success') 
					{
						var strError = $(xData.responseXML).SPFilterNode('ErrorText').text();
						if(strError != "") 
						{
							//alert(ListItemID );						
							RetVal= "Error : " +  strError;
							alert(	RetVal);
							ErrorLog(ErrorLog, "UpdateListItems", RetVal, ListItemObj["ID"], "OMS");						
						}
						else
						{
		//					console.log( "  xData.responseText : "+  xData.responseText );
							//if(ShowAlerts) alert("Updated.");
						}
					}	
					else
					{
						alert("Error while update item.");
					}		
				}
			});
		}
		else
		{
			$().SPServices(
			{
				operation: 'UpdateListItems',
				listName: List,
				batchCmd: "New",
				valuepairs: valuepairs,
				async: false,
				completefunc: function(xData, Status) 
				{		
					if(Status== 'success') 
					{
						var strError = $(xData.responseXML).SPFilterNode('ErrorText').text();
						if(strError != "") 
						{
							//alert(ListItemID );						
							RetVal = "Error : " +  strError;
							ErrorLog(List, "New Item", RetVal, "", "OMS");	
						}
						else
						{
							if(RetID)
							{
								RetVal = $(xData.responseXML).SPFilterNode("z:row").attr("ows_ID");
							}
		//					console.log( "  xData.responseText : "+  xData.responseText );
							if(ShowAlerts) alert("Inserted.");
						}
					}
					else
					{
						alert("Error while insert item.");
					}			
				}
			});

		}
	}	
	return RetVal;
}


function UpdateField(ListName, ID, valuepairs, async )
{
	if(!async){
		async = false;
	}


	var RetVal = "";
	$().SPServices(
	{
		operation: 'UpdateListItems',
		listName: ListName,
		ID: ID,
		valuepairs: valuepairs,
		async: async,
		completefunc: function(xData, Status) 
		{		
			if(Status== 'success') 
			{
				var strError = $(xData.responseXML).SPFilterNode('ErrorText').text();
				if(strError != "") 
				{
					//alert(ListItemID );						
					RetVal= "Error : " +  strError;											
				}
				else
				{
//					console.log( "  xData.responseText : "+  xData.responseText );
					if(ShowAlerts) alert("Updated.");
				}
			}			
		}
	});
	
	return RetVal;
		
}


function CreateListItem(ListTitle, item){

	 /*
	 item = {
            "__metadata": { "type": 'SP.Data." + ListTitle +"ListItem' },
            "Title": "Abcd",
            "ToUserOrGroupId": { 'results': [353,127] }
     };
     */
     
    
	  UpdateSPDigest();
     
      $.ajax({
        url: _spPageContextInfo.webAbsoluteUrl + "/_api/web/lists/getbytitle('" + ListTitle +"')/items",
        type: "POST",
        contentType: "application/json;odata=verbose",
        data:  JSON.stringify(item),
        headers: {
            "Accept": "application/json;odata=verbose",
            "X-RequestDigest": $("#__REQUESTDIGEST").val()
        },
        success: function (data) { 
        	// alert("updated.");
		 },
        error: function (request, status, error) { 
           alert("error while update.");

        }
    });
}

function UpdateSPDigest(){

	UpdateFormDigest(_spPageContextInfo.webServerRelativeUrl, _spFormDigestRefreshInterval);
	
	
	$.ajax({
	    url: _spPageContextInfo.webAbsoluteUrl + "/_api/contextinfo",
	    method: "POST",
	    async: false,
	    headers: { "Accept": "application/json; odata=verbose"},
	    success: function (data) {
	        $('#__REQUESTDIGEST').val(data.d.GetContextWebInformation.FormDigestValue);			
	    },
	    error: function (data, errorCode, errorMessage) {
	        alert(errorMessage)
	    }
	});

}

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\User.js```FileName```function CurrentUserDetails(){
	
	var result = {};
	var URL = SiteURL + "_api/web/currentuser"
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {	
			result = data.d;			            
        },
        error: function (error) {
            alert(JSON.stringify(error));
        }
    });	

	return result;	
}

function GetFirstName(FullName){
		
	var startPos = FullName.indexOf("(");
	if(startPos >= 0 ){
		startPos++;
	}
	var endPos = FullName.indexOf(" ", startPos );
	return FullName.substring(startPos, endPos );
}

function getSPUserName() {
			
	var userName = $().SPServices.username({
		fieldName: "Title",
	});
	
	return userName;

}

function UserGroupByName(GrpName){
	
	var res = false;
	var URL = SiteURL + "_api/web/sitegroups/getbyname('" + GrpName + "')/CanCurrentUserViewMembership";
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {	
			res = data.d.CanCurrentUserViewMembership;
			if(data.d.CanCurrentUserViewMembership){
				UserGroupsForUser.push(GrpName);
				UserGroupsIdForUser.push( UserGroupID(GrpName) );
			}					                       
        },
        error: function (error) {
            res = false;
        }
    });	

	return res;

	
}


function UserGroupID(GrpName){
	
	var GroupID;
	var URL = SiteURL + "_api/web/sitegroups/getbyname('" + GrpName + "')";
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {	
			GroupID = data.d.Id;				                       
        },
        error: function (error) {
            GroupID = "";
        }
    });	

	return GroupID;

	
}


function RefreshUserGroupsForUser()
{
	UserGroupsForUser = [];
	UserGroupsIdForUser = [];
	
	var res1 = UserGroupByName("CounterpartyAdmin");
	var res1 = UserGroupByName("CounterpartyDealer");
	var res1 = UserGroupByName("CounterpartyBMS");		
	var res1 = UserGroupByName("CounterpartyFIG");
	var res1 = UserGroupByName("CounterpartyBO");
			
}

function CheckUserAndGroup(IdList){
	
	var res = false;
	if( IdList.indexOf(_spPageContextInfo.userId) >= 0 ){
		res = true;
	}
	else{
		
		if(!UserGroupsIdForUser)	
		{
			RefreshUserGroupsForUser();
		}


		for(i=0;i<IdList.length;i++){
			for(j=0;j<UserGroupsIdForUser.length;j++){
				if( IdList[i] == UserGroupsIdForUser[j] ){
					res = true;
					//i = j = -1 // terminates loop
					break;
				}
				
				if(res) break;
			}
		}
	}
	return res;
}

function CurrentUserInGroupList(GroupNameList)
{
	var res = [];
	if( GroupNameList.indexOf(_spPageContextInfo.userId) >= 0 ){
		res = true;
	}
	else{
		
		if(!UserGroupsForUser)	
		{
			RefreshUserGroupsForUser();
		}

		for(i=0;i<GroupNameList.length;i++){
			for(j=0;j<UserGroupsForUser.length;j++){
				if( GroupNameList[i] == UserGroupsForUser[j] ){
					res.push(GroupNameList[i]);
				}
			}
		}
	}
	
	return res;
}


function IsCurrentUserInGroup(GroupName)
{
	if(!UserGroupsForUser)	
	{
		RefreshUserGroupsForUser();
	}
	
	if( $.inArray( GroupName , UserGroupsForUser ) == -1 )
	{
		return false;	
	}
	else
	{
		return true;
	}
}


function IsCurrentUserIdInGroup(GroupID)
{
	if(!UserGroupsIdForUser)	
	{
		RefreshUserGroupsForUser();
	}
	
	if( $.inArray( GroupID, UserGroupsIdForUser) == -1 )
	{
		return false;	
	}
	else
	{
		return true;
	}
}




function GetCurrentUserID()
{	
//debugger;
	var UserID = "";
	var URL = SiteURL + "_api/SP.UserProfiles.PeopleManager/GetMyProperties"
	
	$.ajax({
        url: URL,
        type: "GET",
		async: false,
        headers: {
            "accept": "application/json;odata=verbose",
        },
        success: function (data) 
        {	
			var properties = data.d.UserProfileProperties.results;
		
			
            for (var i = 0; i < properties.length; i++) 
            {
            	if(properties[i].Key == "AccountName" )
            	{
            		UserID = properties[i].Value; 
				}
				
				if(properties[i].Key == "PreferredName" )
            	{
            		UserName = properties[i].Value; 
				}
				
				if(properties[i].Key == "UserName" )
            	{
            		NtId = properties[i].Value;
				}


            }
            
        },
        error: function (error) {
            alert(JSON.stringify(error));
        }
    });	

        
   	return GetUserId(  UserID, UserName  );
}

function GetUserId(userName, UserName  ) {
  
  	var Result = {};
  	Result.UserName  = UserName;
	Result.NtId = NtId;

	var UserID = "";
    var prefix = "i:0#.w|";
    var siteUrl = SiteURL ;
    var accountName = prefix + userName;

    $.ajax({
        url: siteUrl + "_api/web/siteusers(@v)?@v='" + 
            encodeURIComponent(accountName) + "'",
        method: "GET",
        async: false,
        headers: { "Accept": "application/json; odata=verbose" },
        success: function (data) {
            UserID = data.d.Id;
        },
        error: function (data) {
            console.log(JSON.stringify(data));
        }
    });
    
    
    Result.UserID = UserID;    
    return Result;

}
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\JSCommon\Validation.js```FileName```function Validation($scope )
{
//debugger;		
	$scope.ErrorMessage = ""; 	
	var ErrorMsg = "";
	
	/*
	if($scopeStatusFlowObj.ToStatusId == "1" || $scopeStatusFlowObj.ToStatusId == "5"  )
	{
		return true;
	}
	*/

	ErrorMsg = CheckBlank($scope.SelObj.Branch, "Branch", ErrorMsg);
	/*
	ErrorMsg = CheckBlank($scope.SelObj.ApplicantName, "Applicant Name", ErrorMsg);
	ErrorMsg = CheckBlank($scope.SelObj.ApplicationDate, "Application Date", ErrorMsg);
	ErrorMsg = CheckNumber($scope.SelObj.NumberOfShares, "Number of shares to be subscribed", ErrorMsg );	
	//ErrorMsg = CheckBlank($scope.SelObj.UAQShareholderNo, "UAQ shareholder no", ErrorMsg);
	//ErrorMsg = CheckBlank($scope.SelObj.PassportNumber, "Passport Number", ErrorMsg);
	ErrorMsg = CheckBlank($scope.SelObj.KhulasatAlQaid, "Khulasat Al Qaid", ErrorMsg);
	ErrorMsg = CheckBlank($scope.SelObj.Mobilenumber, "Mobile number", ErrorMsg);
	ErrorMsg = CheckBlank($scope.SelObj.ApplicationSourced, "Application sourced", ErrorMsg);
	
	*/
		

	if(ErrorMsg)
	{
		$scope.ErrorMessage = ErrorMsg;
		return false;
	}
	else
	{
		return true;
	}
}

function CheckNumber(FiledData, FieldName, ErrorMsg )
{	
	if(FiledData)
	{
		FiledData = strReplaceAll( FiledData, ",", "")
		
		if(!$.isNumeric(FiledData))
		{
			ErrorMsg = AddErr(ErrorMsg, FieldName + " should be number");
		}		
	}	
	return ErrorMsg;
}


function CheckValidNumber(FiledData, FieldName, ErrorMsg )
{	
	if(FiledData)
	{
		FiledData = strReplaceAll( FiledData, ",", "")
		
		if(!$.isNumeric(FiledData) || FiledData == 0)
		{
			ErrorMsg = AddErr(ErrorMsg, FieldName + " should be number");
		}		
	}	
	else
	{
		ErrorMsg = AddErr( ErrorMsg, "Please provide " + FieldName)
	}
	return ErrorMsg;
}


function CheckBlank(FiledData, FieldName, ErrorMsg )
{	
	if(!FiledData)
	{
		ErrorMsg = AddErr( ErrorMsg, "Please provide " + FieldName);
	}
	
	return ErrorMsg;
}

function AddErr(err, msg)
{
	if(err)
	{
		err += ", ";
	}
	else
	{
		err = " ";
	}
	err += msg;
	return err;
}```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\LeftNav\LeftNavCtrl.js```FileName```//LeftNavCtrl.js
DocApp.controller('LeftNavCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{	
	$scope.link1 = "";
	
	function AddItem(list, Title, Link, Icon, Group, Order, Permission){		
		var item = {};
		item.Title = Title;
		item.Link = Link;
		item.Icon= Icon; 
		
		list.push(item);
	}
	
	$scope.ctrlOnLoad= function(){
		
		$(".sidenav").css("width", "4%");
		$('#imgEnbdLogo2').show();
		$( ".main" ).css("margin-left", "4%");
	
		
		if(!checkValidBrowser()){
			$('.divNonRecomendedBrowser').show();
			$('div.main').hide();
			//$('div.sidenav').hide();
		}
		
		/*
		$(".sideNavCollapse").click(function () {
			$('#imgEnbdLogo1').hide();
			$('#imgEnbdLogo2').hide();
			$(".sideNavCollapse").hide();
			$(".sideNavExpand").show();
			$('.txtSideNavExp').hide();
			
			$(".sidenav").animate({
				width: "4%"
			}, 500, "linear",function(){
				$('#imgEnbdLogo2').show();
			});
			$( ".main" ).animate({
			  "margin-left": "4%"
			}, 500, "linear" );
			
		});
		$(".sideNavExpand").click(function () {
			$(".sideNavCollapse").show();
			$(".sideNavExpand").hide();
			$('#imgEnbdLogo1').show();
			$('#imgEnbdLogo2').hide();
			$(".sidenav").animate({
				width: "16%"
			}, 500, "linear",function(){
				$('.txtSideNavExp').show();
			});
			$( ".main" ).animate({
			  "margin-left": "16%"
			}, 500, "linear" );
		});
		//Ends Here
		*/
		
		$scope.textAln = "center";
		var list = [];
		/*
		//AddItem(list ,'FX', '/EITRY/FX/SitePages/NewUIHome.aspx#!/FX', 'fa-dollar' );
		AddItem(list ,'Daily Digest', '/EITRY/FX/SitePages/TryUtil.aspx#!/DailyDigest', 'fa-hourglass-half' );
		AddItem(list ,'SharePoint Projects', '/EITRY/FX/SitePages/TryUtil.aspx#!/ProjectTracker', 'fa-list');
		AddItem(list ,'Other Projects', '/EITRY/FX/SitePages/TryUtil.aspx#!/TRYProjectTracker', 'fa-list-alt');
		AddItem(list ,'Action Tracker', '/EITRY/FX/SitePages/TryUtil.aspx#!/ActionTracker', 'fa-slideshare');
		AddItem(list ,'Deal Release Request', '/EITRY/FX/SitePages/TryUtil.aspx#!/DealRelList', 'fa-chevron-circle-down');
		*/
		
		var navList = GetListData("LeftNavigationUAT");
		$.each(navList, function(id, val){
			AddItem(list ,val.Title, val.Path, val.Icon );			
		});

		/*
		fa-history
		fa-indent
		fa-reply-all
		fa-reply-all
		fa-yelp
		*/
		
		$scope.linkList = list;
		
		setTimeout(function(){ 		
    		//$(".sideNavCollapse").click();
    		$scope.sideNavCollapseClick();
      	}, 100);
	}
	
	$scope.sideNavExpandClick = function(){
		$scope.textAln = "left";
		$(".sideNavCollapse").show();
		$(".sideNavExpand").hide();
		$('#imgEnbdLogo1').show();
		$('#imgEnbdLogo2').hide();
		$(".sidenav").animate({
			width: "16%"
		}, 500, "linear",function(){
			$('.txtSideNavExp').show();
		});
		$( ".main" ).animate({
		  "margin-left": "16%"
		}, 500, "linear" );

	}
	
	$scope.sideNavCollapseClick= function(){
		$scope.textAln = "center";
		$('#imgEnbdLogo1').hide();
		$('#imgEnbdLogo2').hide();
		$(".sideNavCollapse").hide();
		$(".sideNavExpand").show();
		$('.txtSideNavExp').hide();
		
		$(".sidenav").animate({
			width: "4%"
		}, 500, "linear",function(){
			$('#imgEnbdLogo2').show();
		});
		$( ".main" ).animate({
		  "margin-left": "4%"
		}, 500, "linear" );

	}


});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\LeftNav\LeftNavigation.html```FileName```<div class="sidenav" ng-controller="LeftNavCtrl" data-ng-init="ctrlOnLoad()">
  <a href="/EITRY/FX/">
	<img id="imgEnbdLogo1" src="../../../EITRY/FX/SiteAssets/TryUtil/img/Emirates-Islamic.jpg" alt="Emirates Islamic" style="width: 80%;margin-bottom: 8%;" />
	<img id="imgEnbdLogo2" src="../../../EITRY/FX/SiteAssets/TryUtil/img/Emirates-sl.jpg" alt="Emirates Islamic" style="width: 80%;margin-bottom: 30%;" />
  </a>

  <div ng-repeat="lnk  in linkList" style="color:white;" >
  
  	<a href="{{lnk.Link}}" title="{{lnk.Title}}" ng-style=" {'text-align' : textAln }" >
	  	<i class="fa font20" ng-class="lnk.Icon" aria-hidden="true"></i> 
	  		<span class="txtSideNavExp">{{lnk.Title}}</span>
	</a>    	
  </div>
  
  
  <i class="fa fa-chevron-circle-left sideNavCollapse font20 " aria-hidden="true" ng-click="sideNavCollapseClick()"></i>
  <i class="fa fa-chevron-circle-right sideNavExpand font20 " aria-hidden="true" ng-click="sideNavExpandClick()"></i>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\AdminView.html```FileName```<style>
/*Q style*/
.divQButtonGroup {
    padding-top: 0.5%;
    padding-bottom: 0.5%;
   
    background-color: ghostwhite;
   	
    margin-left: 3px !important;
    margin-top: 10px !important;
    margin-right: 0px !important;
    margin-bottom: 3px !important;


}

.divWBRequests,.divRLTBRequests,.divSalesRequests,.divALMRequests,.divARCRequests,.divBVWBRequests,.divBVRLTBRequests,.divBVALMRequests,.divBVARCRequests{
	cursor:pointer;	 
}


.card {
    position: relative;
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    -webkit-box-orient: vertical;
    -webkit-box-direction: normal;
    -ms-flex-direction: column;
    flex-direction: column;
    min-width: 0;
    word-wrap: break-word;
    background-color: #fff;
    background-clip: border-box;
    border: 1px solid #e3e6f0;
    border-radius: .35rem;
}

.border-left-alm {
    border-left: .50rem solid #3BBEB4 !important;
}
.text-alm{
	color:#3BBEB4;
	font-weight:bold;
}
.border-left-HoALM {
    border-left: .50rem solid darkolivegreen !important;
}
.text-HoALM {
	color:darkolivegreen;
	font-weight:bold;
}

.border-left-HoTRY {
    border-left: .50rem solid #f36c21 !important;
}
.text-HoTRY{
	color:#f36c21 ;
	font-weight:bold;
}
.border-left-enbd {
    border-left: .50rem solid #1f3c78!important;
}
.text-enbd {
	color:#1f3c78;
	font-weight:bold;
}
.border-left-CWM {
    border-left: .50rem solid #5c8a8a !important;
}
.text-CWM {
	color:#5c8a8a;
	font-weight:bold;
}

.border-left-primary {
    border-left: .50rem solid #4e73df !important;
}
.text-primary {
	color:#4e73df ;
	font-weight:bold;
}


.border-left-success {
    border-left: .50rem solid #1cc88a !important;
}
.border-left-warning {
    border-left: .50rem solid #f6c23e !important;
}



.shadow {
    -webkit-box-shadow: 0 .15rem 1.75rem 0 rgba(58,59,69,.15)!important;
    box-shadow: 0 .15rem 1.75rem 0 rgba(58,59,69,.15)!important;
}
.lndPgcard{
	padding-top: 5%;
    padding-bottom: 5%;
}

.actionButtonSign{
	padding-left: 6px;
    padding-right: 3px;
    border-bottom-width: 2px;
    padding-bottom: 2px;
    margin-bottom: 4px;
    margin-top: 4px;
}

.btnCreateNewRequest{
	padding: 2px;
	padding-right: 5px;
    padding-left: 5px;
	box-shadow:0px 0px 4px 2px #442157;
    margin-left: 2%;
	padding-bottom: 0px;
	
	color: #fff;
    background-color: #442157;
    border-color: #2e6da4;
    min-width:100px
}
.btnCreateNewRequest:hover{
	background-color: #914bb8;
	color: #fff;

}

.iconButton{
	padding: 2px;
	padding-right: 5px;
    padding-left: 5px;
	box-shadow:0px 0px 4px 2px #B1CBC8;
    margin-left: 2%;
	padding-bottom: 0px;
	
	color: #fff;
    background-color: #3BBEB4;
    border-color: #B1CBC8;
    min-width:50px
}
.iconButton:hover{
	background-color: #B1CBC8;
	color: #fff;

}


.SubHeader1Filter th{
    padding: 4px 4px 4px 4px;
    border-top: 1px solid #111;
}

/*Q style*/

</style>

<div  class="main-panel" data-ng-init="listCtrlOnLoad()">
	
	<div class=" row main-header">
		<div class=" col-md-3 main-header-title" >Action Tracker</div>	
		<div class=" col-md-9">									
		</div>
				
	</div>

	<div class="row content divQButtonGroup " >
	
		<div class="col-md-2 divWBRequests" ng-repa ng-click="ShowTab('DLA', 'HoTRY')" >
			<div class="card border-left-HoTRY shadow h-100 py-2">
				<div class="lndPgcard">
				  <div class="row no-gutters align-items-center">
					<div class="col-md-6">
					  <div class="text-xs font-weight-bold text-HoTRY mb-1 pull-right">HoTRY</div>
					</div>
					<div class="col-md-4">
						<span class="badge pull-left spWbReqCount">{{HoTryCount}}</span>
					</div>
				  </div>
				</div>
			  </div>
		</div>
		
		<div class="col-md-2 divWBRequests" ng-repa ng-click="ShowTab('Pending with ALM')" >
			<div class="card border-left-alm shadow h-100 py-2">
				<div class="lndPgcard">
				  <div class="row no-gutters align-items-center">
					<div class="col-md-6">
					  <div class="text-xs font-weight-bold text-alm mb-1 pull-right">ALM</div>
					</div>
					<div class="col-md-4">
						<span class="badge pull-left spWbReqCount">{{ALMCount}}</span>
					</div>
				  </div>
				</div>
			  </div>
		</div>
		
		<div class="col-md-2 divWBRequests" ng-repa ng-click="ShowTab('DLA', 'HoALM')" >
			<div class="card border-left-HoALM shadow h-100 py-2">
				<div class="lndPgcard">
				  <div class="row no-gutters align-items-center">
					<div class="col-md-6">
					  <div class="text-xs font-weight-bold text-HoALM mb-1 pull-right">BMS</div>
					</div>
					<div class="col-md-4">
						<span class="badge pull-left spWbReqCount">{{BMSCount}}</span>
					</div>
				  </div>
				</div>
			  </div>
		</div>
		
		
		
		<div class="col-md-2 divWBRequests" ng-repa ng-click="ShowTab('DLA', 'ENBD TRY')" >
			<div class="card border-left-enbd shadow h-100 py-2">
				<div class="lndPgcard">
				  <div class="row no-gutters align-items-center">
					<div class="col-md-6">
					  <div class="text-xs font-weight-bold text-enbd mb-1 pull-right">S&S</div>
					</div>
					<div class="col-md-4">
						<span class="badge pull-left spWbReqCount">{{SSCount}}</span>
					</div>
				  </div>
				</div>
			  </div>
		</div>
		
		<div class="col-md-2 divWBRequests" ng-repa ng-click="ShowTab('DLA', 'CWM')" >
			<div class="card border-left-CWM shadow h-100 py-2">
				<div class="lndPgcard">
				  <div class="row no-gutters align-items-center">
					<div class="col-md-6">
					  <div class="text-xs font-weight-bold text-CWM mb-1 pull-right">TTO</div>
					</div>
					<div class="col-md-4">
						<span class="badge pull-left spWbReqCount">{{TTOCount}}</span>
					</div>
				  </div>
				</div>
			  </div>
		</div>
		
		<div class="col-md-2 divWBRequests" ng-repa  ng-click="ShowTab('DLA', 'WBM')" >
			<div class="card border-left-primary shadow h-100 py-2">
				<div class="lndPgcard">
				  <div class="row no-gutters align-items-center">
					<div class="col-md-6">
					  <div class="text-xs font-weight-bold text-primary   mb-1 pull-right">Others</div>
					</div>
					<div class="col-md-4">
						<span class="badge pull-left spWbReqCount">{{OthersCount}}</span>
					</div>
				  </div>
				</div>
			  </div>
		</div>		
	</div>
	
	

	<div class="row content divQButtonGroup " style="">
		<div class="col-md-10">
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Adhoc Action
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Meeting
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="MeetingView()" >
				<i class="fa fa-list-ul" aria-hidden="true" ></i> Meeting View
			</button>
		</div>	
		<div class="col-md-2">
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
				<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
			</button>
	        
			<button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="TaskListing(QuqueTitle)" title="Refresh">
			<i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
			</button>	

		</div>	
	</div>
	
	<!--
	<div class="col-md-6">
		  <a href="" title="Wow. Looky Here." data-toggle="popover" data-content="More stuff here.." data-trigger="hover">I have a Popover</a>
	</div>
	
	<button type="button" class="btn btn-lg btn-danger" data-toggle="popover" title="Popover title" data-content="And here's some amazing content. It's very engaging. Right?">Click to toggle popover</button>
	-->
	
		
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\AdminViewCtrl.js```FileName```

DocApp.controller('AdminViewCtrl', function($scope, $interval,$location, $timeout,$routeParams) {


	
	
	$scope.listCtrlOnLoad= function(){
	
	DocApp.directive('toggle', function(){
	  return {
	    restrict: 'A',
	    link: function(scope, element, attrs){
	      if (attrs.toggle=="tooltip"){
	        $(element).tooltip();
	      }
	      if (attrs.toggle=="popover"){
	        $(element).popover();
	      }
	    }
	  };
	})


		SetSideBar("HoTM : Action Tracker", "Action Tracker");	
		
		$scope.BMSCount = 11;
		$scope.ALMCount = 11;
		$scope.HoTryCount= 11;
		$scope.SSCount = 11;
		$scope.TTOCount = 11;
		$scope.OthersCount = 11;
		
		return;		
	
		$('#divOverlay').show();
		
		DestroyTable();
		
		var filter = "&$filter=ActionType eq 'Meeting'";
		var alst = GetListData("MeetingTracker", filter );
		
		var dl = [];
		$.each(alst, function(id, act){
			var exists = false;
			for(i=0;i<dl.length;i++){
				if( dl[i].MeetingDate == act.MeetingDate && dl[i].Title == act.Title ){
					exists = true;
					break;
				}
			}
			if(!exists){
				dl.push(act);
			}
		});

		$scope.dataList = dl;
		
		updateTable();

	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
    function updateTable(){	
        setTimeout(function(){ 	
                                                                    
            $('#main-ListTable').DataTable( {                        
                stateSave: true,
                stateSaveCallback: function(settings,data) {			      
                ListState = JSON.stringify(data);			     
                ShowFromListState = false;			      
                },
                stateLoadCallback: function(settings) {
                    if(ShowFromListState){
                        ShowFromListState = false;						
                        $.each(ListStateFilters, function(id, filt){
                                $('.DataTableFilterCol' + filt.col  ).val(filt.val);
                        });
                        
                        return JSON.parse(ListState);
                    }
                    else{
                        return "";
                    }					
                },
                                            
                "pageLength": 20,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],            
                "order": [[ 1, "asc" ]], 
                "autoWidth": false,                       
                initComplete: function () {            
                    this.api().columns().every( function (ColCount) {
                        if( ColCount == 2 ){

                            var title = this.header();
                            //replace spaces with dashes
                            title = $(title).html().replace(/[\W]/g, '-');
                            var column = this;
                            var select = $('<select id="DataTableFilterCol' + ColCount + '" multiple="multiple" style="width: 100%;" ></select>')
                                .appendTo( $(column.footer()).empty() )
                                .on( 'change', function () {
                                    //Get the "text" property from each selected data 
                                    //regex escape the value and store in array
                                    var data = $.map( $(this).select2('data'), function( value, key ) {
                                    return value.text ? '^' + $.fn.dataTable.util.escapeRegex(value.text) + '$' : null;
                                            });
                                    
                                    //if no data selected use ""
                                    if (data.length === 0) {
                                    data = [""];
                                    }
                                    
                                    //join array into string with regex or (|)
                                    var val = data.join('|');
                                    
                                    //search for the option(s) selected
                                    column
                                        .search( val ? val : '', true, false )
                                        .draw();
                                } );
            
                            column.data().unique().sort().each( function ( d, j ) {
                                select.append( '<option value="'+d+'">'+d+'</option>' );
                            } );
                            
                            $('#DataTableFilterCol' + ColCount ).select2();                                                    
                            
                        }//ColCount != 2
                        else{
                        
                            var column = this;
                            var v = '';							
                            var column = this;
                            var textSearch =  $('<input class="DataTableFilterCol' + ColCount + '" type="text" style="width=100%" id="DataTableText" />')
                                .appendTo( $(column.footer()).empty() )
                                
                                .on( 'propertychange change keyup paste input', function () {
                                
                                        $('.auctionListTable').DataTable()
                                            .search('').columns().search('').draw();
                                            var val = $.fn.dataTable.util.escapeRegex(
                                            $(this).val()
                                        );
                                        column
                                            .search( val )
                                            .draw();
                                
                                    });							                    
                        }                    
                    } );
                },
            } );
                    
            $('#main-ListTable').on("click", "tbody tr ", function(){	
            
                ListStateFilters = [];
                for(i=0;i<10;i++){
                    var filt = {};
                    filt.col = i;
                    if( i == 2 || i == 3 || i == 7 ){
                        filt.val = $('#DataTableFilterCol' + i  + "" ).val();
                    }
                    else{
                        filt.val = $('.DataTableFilterCol' + i  + "" ).val();
                    }
                    ListStateFilters.push( filt );	
                }
                            
                auctionReqstItemElem = $(this);
                
                var id = auctionReqstItemElem[0].children[0].textContent;

                //debugger;
                $scope.item = $scope.dataList[id]; 
                window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/MeetingViewDetails/" + id;				
                $scope.$apply();
            });
            
            $('#divOverlay').hide();
            $('#divDataTable').show();
            
            if(UpdateListStateFilters){			
            
                for(i=0;i<10;i++){
                    var filt = ListStateFilters[i];			      
                    if( i == 2 || i == 3 || i == 7 ){		
                                                                
                        $('#DataTableFilterCol' + i + "").val(filt.val);
                        $('#DataTableFilterCol' + i + "").select2();                    

                    }
                    else{
                        $('.DataTableFilterCol' + filt.col  ).val(filt.val);
                    }
                    ListStateFilters.push( filt );	
                }
                UpdateListStateFilters = false;
            }                                                 
        }, 100);
    }	

});	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\Buttons.html```FileName```<div id="ButtonDiv" style="margin:10px;  ">
	<div class="text-danger" style="font-weight:bold;width:100%;padding-top:3px;padding-left:20px">{{ErrorMessage}}</div>
	
	<!--div style="float:left;padding:5px" ng-show="ShowAddNewButton" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="AddSubMeeting()" >			
			Add New Acttion
		</button>									
	</div-->


	<div style="float:left;padding:5px" ng-show="ShowSaveButton" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnSave()" >			
			Save
		</button>									
	</div>
	
	<!--div style="float:left;padding:5px" ng-show="IsBMS && item.CPStatus== 6" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="MarkCounterpartyInactive()" >			
			Mark Counterparty Inactive
		</button>									
	</div>


	<div style="float:left;padding:5px" ng-show="ShowNewWFButton" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="SubmitNewWorkflow()" >			
			Submit
		</button>									
	</div>

	<div style="float:left;padding:5px" ng-repeat="sf in StatusFlow">		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="TakeAction(sf)" >			
			{{sf.Title}}
		</button>									
	</div-->
	
	<div style="float:left;padding:5px">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onBackClick()" >						 
			Back to Queue
		</button>				 		
	</div>

	
</div>




```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\Comments.html```FileName```<!--
<div class="row" style="margin:0px" ng-show="actions[0].CompletionDateHistoryArr.length > 0" >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" >
			<div class="col-md-12 divSubHeadingLog" >History</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:150px;">Date</th>
							<th style="text-align:center;width:300px;">Action By</th>
							<th style="text-align:center;">Target Date</th>	
						</tr>
					</thead>
					<tbody>
						<tr  ng-repeat="cdt in actions[0].CompletionDateHistoryArr"  >	
							<td style="text-align:left;">{{cdt.Date}}</td>			
							<td style="text-align:left;">{{cdt.ActionBy}}</td>
							<td style="text-align:left;">{{cdt.ComplectionDate}}</td>						
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>

<div class="row" style="margin:0px" ng-show="actions[0].CommentList.length > 0" >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" >
			<div class="col-md-12 divSubHeadingLog" >History</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:150px;">Status</th>
							<th style="text-align:center;width:300px;">Action By</th>
							<th style="text-align:center;width:150px;">Date</th>
							<th class="text-center" style="">Updates</th>			
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="it in actions[0].CommentList" >	
							<td style="text-align:left;">{{it.Status}}</td>			
							<td style="text-align:left;">{{it.From}}</td>
							<td style="text-align:left;">{{ FormatCommentDate(it.Date)}}</td>
							<td style="text-align:left;">{{it.Comment}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>
-->
<div class="row" style="margin:0px"  >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" >
			<div class="col-md-12 divSubHeadingLog" >History</div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #fefcff;">
							<th style="text-align:center;width:150px;">Status</th>
							<th style="text-align:center;width:300px;">Action By</th>
							<th style="text-align:center;width:150px;">Date</th>
							<th class="text-center" style="">Updates</th>			
						</tr>
					</thead>
					<tbody>
						<tr ng-repeat="it in ListCombaind" >	
							<td style="text-align:left;">{{it.Status}}</td>			
							<td style="text-align:left;">{{it.From}}</td>
							<td style="text-align:left;">{{ it.Date}}</td>
							<td style="text-align:left;">{{it.Comment}}</td>
						</tr>
					</tbody>
				</table>
			</div>
			
		</div>
	</fieldset>
</div>


<div class="row" style="margin:0px" ng-show="subMeetings[0].Title && subMeetings[0].ActionType == 'Meeting' " >
	<fieldset>
		<div class="row content divPnlSrchRsltChartsLog" >
			<div class="col-md-12 divSubHeadingLog" >Other Actions on {{actions[0].MeetingDate}} for {{actions[0].Title}} </div>
			<div class="col-md-12" style="padding:0px">
				<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
					<thead>						
						<tr style="background-color: #ffe6cc;">
							<th>Action Point</th>								
							<!--th style="width:250px">Responsibility</th-->	
							<th style="width:100px">Status</th>						
							<th style="width:100px">Comp. Date</th>		
						</tr>
					</thead>
					<tbody>
						<tr  ng-repeat="it in subMeetings" ng-click="NavigateItem(it.ID)" class="trHover" >	
							<td>{{it.ActionPointTitle}}</td>								
							<!--td>
								{{ GetResponsibility(it.Responsibility) }}
								<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
			
							</td-->
							<td>{{it.Status}}</td>						
							<td>{{it.ComplectionDate}}</td>
						</tr>
					</tbody>
				</table>

			</div>
			
		</div>
	</fieldset>
</div>


```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\DaysActions.html```FileName```<div style="margin:4px">
	<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
		<thead>
			<tr><th colspan="4" >Comments</th></tr>
			<tr style="background-color: #ffe6cc;">
				<th style="text-align:center;width:150px;">Action Point</th>
				<th style="text-align:center;width:300px;">Responsibility</th>
				<th style="text-align:center;width:150px;">Expected Completion Date</th>
				<th class="text-center" style="">Status</th>			
			</tr>
		</thead>
		<tbody>
			<tr  ng-repeat="al in item.DaysActions" >	
				<td style="text-align:left;">{{al.ActionPointTitle}}</td>			
				<td style="text-align:left;"></td>
				<td style="text-align:left;">{{al.ComplectionDate}}</td>
				<td style="text-align:left;">{{al.Status}}</td>
			</tr>
		</tbody>
	</table>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\Details.html```FileName```<div class="row" style="margin:0px" >
 <fieldset>
 
 <div class="row content divPnlSrchRsltCharts" ng-class-odd="'divPnlSrchRsltChartsOdd'" ng-class-even="'divPnlSrchRsltChartsEven'" >
 		
 		<div class="col-md-11 divSubHeading" >Action Points</div>

		<div class="col-md-1 divSubHeading"  >
			<button type="button" class="close" aria-label="Close" ng-click="DeleteAction($index)" ng-hide="item.Id || $index == 0" >
			  <span aria-hidden="true" style="color:red">&times;</span>
			</button>
		</div>	
			
		<div class="form-group input-group col-md-12 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">													
				 <input name="ActionPointTitle{{$index}}" class="form-control ActionPointTitle" type="text" maxlength="70"
		    		data-provider="datepicker" ng-model="item.ActionPointTitle" ng-disabled="read"  required errmsg="Action Point Title"/>		    			
					<span>Action Point<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
				<p ng-show="(se || af['ActionPointTitle'  + $index].$touched) && af['ActionPointTitle'  + $index].$invalid " class="text-danger">Action Point Title required.</p>
				<div style="text-align: right;padding: 0px 10px;">{{item.ActionPointTitle.length}}/70</div>
			</label>
												 
		</div>
		
		<!--div class="col-md-1 " ng-if="!read" style="padding-top:20px">{{item.ActionPointTitle.length}}\70</div-->

		 
		 
		<div class="form-group input-group col-md-12 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">									
				<textarea  name="ActionPoint{{$index}}" id="ActionPoint" ng-model="item.ActionPoint" ng-disabled="read"  class="multiLineInput" errmsg="Details"
					style="height:100px"    maxlength="1000"
					 ></textarea>		
					<span>Details</span>
				<p ng-show="(se || af.ActionPoint.$touched) && af.ActionPoint.$invalid " class="text-danger">Action Point required.</p>
				<div style="text-align: right;padding: 0px 10px;">{{item.ActionPoint.length}}/1000</div>
			</label>										 
		</div>
		<!--div class="col-md-1 " ng-if="!read" style="padding-top:20px">{{item.ActionPoint.length}}\1000</div-->

		<!--Responsibility-->
										
		<div class="form-group input-group col-md-2 HedgeDivCol" style="width: 12.499999995%;flex: 0 0 12.499%;max-width: 12.499%;">
			<label class="form-group has-float-label">
			    <select name="Status{{$index}}" class="form-control" ng-model="item.ResponsibilityType" ng-disabled="read"  required  errmsg="Responsibility Type" >
					<option selected="selected"  value="Team" >Team</option>
					<option  value="Person" >Person</option>						
				</select>
			    <span>Responsibility Type</span>
			     <p ng-show="(se || af.Status.$touched) && af.Status.$invalid " class="text-danger">Responsibility Type.</p>
			</label>										 
		</div>
							 				
		<div class="form-group input-group col-md-3 HedgeDivCol" ng-show="item.ResponsibilityType == 'Team' ">
			<label class="form-group has-float-label">			    								
				<select name="Responsibility{{$index}}" class="form-control ResponsibilitySelect{{$index}} has-float-label" ng-model="item.ResponsibilityArr" 
					ng-disabled="read"  multiple="multiple" ng-required="item.ResponsibilityType == 'Team'" 
					errmsg="Responsibility" >
					<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
				</select>

			    <span>Responsibility</span>
			     <p ng-show="(se || af.Responsibility .$touched) && af.Responsibility .$invalid " class="text-danger">Responsibility required.</p>
			</label>										 
		</div>
				
		<div class="form-group input-group col-md-3 HedgeDivCol" ng-show="item.ResponsibilityType == 'Person' ">
		 	<label class="form-group has-float-label">
		 		<div  ng-show="!read"  id="RespPerDiv{{$index}}"></div>
		 		<div ng-show="read" ng-repeat="rm in item.RespPer.results" style="float:left;border:1px silver solid;padding-left:7px;padding-right:7px;background:white;height:35px;padding-top:10px">{{rm.Title}}</div>
		 		<span>Responsibility</span>
		 	</label>	 	
		 </div>
		 
		  <!--Responsibility-->
		 
		 <!--Stakeholder-->
		 
		 <div class="form-group input-group col-md-2 HedgeDivCol" style="width: 12.499999995%;flex: 0 0 12.499%;max-width: 12.499%;">
			<label class="form-group has-float-label">
			    <select name="Stakeholder{{$index}}" class="form-control" ng-model="item.StakeholderType" ng-disabled="read"  >
					<option selected ></option>
					<option  value="Team" >Team</option>
					<option  value="Person" >Person</option>						
				</select>
			    <span>Stakeholder Type</span>
			     <p ng-show="(se || af.StakeholderType.$touched) && af.StakeholderType.$invalid " class="text-danger">Stakeholder Type.</p>
			</label>										 
		</div>
							 				
		<div class="form-group input-group col-md-3 HedgeDivCol" ng-show="item.StakeholderType == 'Team' ">
			<label class="form-group has-float-label">			    								
				<select name="Responsibility{{$index}}" class="form-control ResponsibilitySelect{{$index}} has-float-label" 
					ng-model="item.StakeholderArr" ng-disabled="read"  multiple="multiple"   errmsg="Stakeholder" >
					<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
				</select>

			    <span>Stakeholder</span>
			     <p ng-show="(se || af.Stakeholder.$touched) && af.Stakeholder.$invalid " class="text-danger">Stakeholder required.</p>
			</label>										 
		</div>
				
		<div class="form-group input-group col-md-3 HedgeDivCol" ng-show="item.StakeholderType == 'Person' ">
		 	<label class="form-group has-float-label">
		 		<div  ng-show="!read"  id="StakeholderPerDiv{{$index}}"></div>
		 		<div ng-show="read" ng-repeat="rm in item.StakeholderPer.results" 
		 			style="float:left;border:1px silver solid;padding-left:7px;padding-right:7px;background:white;height:35px;padding-top:10px">{{rm.Title}}</div>
		 		<span>Stakeholder</span>
		 	</label>	 	
		 </div>

		 <!--Stakeholder-->
		 
		
		<div class="form-group input-group col-md-2 HedgeDivCol" style="width: 12.499999995%;flex: 0 0 12.499%;max-width: 12.499%;">
		  <label class="has-float-label">
		    <input name="ComplectionDate{{$index}}" class="form-control ComplectionDate{{$index}}" type="text" required  errmsg="Completion Date"
		    	data-provider="datepicker" ng-model="item.ComplectionDate" ng-disabled="adminRead"  />
		    <span>Target Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
		    <p ng-show="(se || af['ComplectionDate'  + $index].$touched) && af['ComplectionDate'  + $index].$invalid " class="text-danger">Completion Date required.</p>
		  </label>	 
		</div>
		
		<div class="form-group input-group col-md-2 HedgeDivCol" style="width: 12.499999995%;flex: 0 0 12.499%;max-width: 12.499%;">
			<label class="form-group has-float-label">
			    <select name="Status{{$index}}" class="form-control" ng-model="item.Status" ng-disabled="read"  required errmsg="Status" >
					<option  value="Not Started" >Not Started</option>
					<option  value="In Progress" >In Progress</option>
					<option  value="Completed" >Completed</option>
					<option  value="Removed" >Removed</option>							
				</select>
			    <span>Status</span>
			     <p ng-show="(se || af.Status.$touched) && af.Status.$invalid " class="text-danger">Status required.</p>
			</label>										 
		</div>
								
		
						
	<div class="col-md-12"  ng-show="ShowAddNewButton && {{$index}} == actions.length-1 " >		
		<button style="padding:5px;float:right" type="button" class="btn btn-sm  EI-ButtonPurple" ng-click="AddSubMeeting()" >			
			Add New Acttion
		</button>									
	</div>

 </div>																																														 
																																													 
 </fieldset>   																	  								  																	
</div>

<div class="row content divPnlSrchRsltCharts"   ng-show="ShowComment" >
	<div class="col-md-12 divSubHeading" >Update</div>

	<div class="form-group input-group col-md-12 HedgeDivCol" style="padding-bottom:0px">
		<label class="form-group has-float-label FormLabel">									
			<textarea  name="CurrentComment{{$index}}" id="CurrentComment" ng-model="item.CurrentComment"  class="multiLineInput"   maxlength="500" style="height:100px"
				 ></textarea>						
			<p ng-show="(se || af.CurrentComment.$touched) && af.CurrentComment.$invalid " class="text-danger">Comment required.</p>
			
		</label>										 
	</div>
	
	<!--div class="col-md-11 " >
		<button style="padding:5px;margin:0px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnAddComment($index)" >Add</button>
	</div-->
	<div class="col-md-1 " style="text-align: right;padding: 0px 10px;">{{item.CurrentComment.length}}/500</div>

	
	<!--div class="col-md-1 " ng-if="ShowComment && !read" style="padding-top:20px">{{item.CurrentComment.length}}\200</div-->
</div>


```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingDetails.html```FileName```
<div id="snackbar"></div>
<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="listCtrlOnLoad()" >
  <div class="panel panel-default" style="width: 100%">
   
    
    <div class="panel-heading item-panel-heading" >  
    	
    	<!--p class="label label-ApprovalStatus itemStatus" style="float:right">						
				<span ng-click="FillTestVal()">Status : {{ item.Status }}</span>
		</p-->
			
		
			
    	<div class="pannel-header">
    	
    		
		
			<div class="main-header-title col-md-11">
				Meeting Details<span style="color:red;font-weight:bold"> UAT</span>
				<p class="label " ng-show="actions[0].ID"
					style="float:right;margin-top: 2px;margin-right: 20px;font-size: small;padding-bottom:0px;color:orange;font-weight:bold">						
						<span>Action ID: AT{{actions[0].ID}}</span>
				</p>
			</div>	
									
			<button type="button" class="close col-md-1 " ng-click="onBackClick()"  aria-label="Close" style="float:right;color: #462157 !important;width:70px;font-size:34px">
	           <span aria-hidden="true">×</span>
	        </button>	
	        	
		</div>		   		
    </div>

    <div class="meeting-panel-body">        	
        <form name="af" novalidate>	    	    
	    	<div class="tab-content pageTabContentStyles" >    	    		    			    		    			    		
	    		<div id="tabDetails" class="tab-pane fade in active"  >	
	    			
	    			<div class="row content divPnlSrchRsltCharts" >
	    				<div class="col-md-12 divSubHeading" >Action Details</div>

					 	<div class="form-group input-group col-md-4 HedgeDivCol">
						  <label class="has-float-label">
						    <input name="MeetingDate" class="form-control MeetingDate" type="text"
						    	data-provider="datepicker" ng-model="actions[0].MeetingDate" ng-disabled="read"  required />
						    <span>Meeting Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
						    <p ng-show="(se || af.MeetingDate.$touched) && af.MeetingDate.$invalid " class="text-danger">Meeting Date required.</p>
						  </label>	 
						</div>
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="ActionType" class="form-control" ng-model="actions[0].ActionType" ng-disabled="read" required ng-change="ActionTypeChange()"  >
							    	<option ng-repeat="m  in ActionTypeList">{{m.Title}}</option>											 						
								</select>
							    <span>Action Type<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.ActionType.$touched) && af.ActionType.$invalid " class="text-danger">Action Type required.</p>
							</label>										 
						</div>
				
						
						<div class="form-group input-group col-md-4 HedgeDivCol">
							<label class="form-group has-float-label">
							    <select name="ActionName" class="form-control" ng-model="actions[0].Title" ng-disabled="read" required  >
							    	<option ng-repeat="m  in ActionNameList">{{m}}</option>											 						
								</select>
							    <span>Meeting Name / Generic Action Point<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							     <p ng-show="(se || af.ActionName.$touched) && af.ActionName.$invalid " class="text-danger">Action Name required.</p>
							</label>										 
						</div>
						
						<div class="form-group input-group col-md-12 HedgeDivCol" ng-show="actions[0].ActionType == 'Meeting' ">
							<label class="form-group has-float-label FormLabel">									
								<textarea  name="MeetingMinutes{{$index}}" id="MeetingMinutes" ng-model="actions[0].MeetingMinutes" ng-disabled="read"  class="multiLineInput" errmsg="Meeting Minutes"
									style="height:100px"    maxlength="1000"
									 ></textarea>		
									<span>Meeting Minutes</span>
								<p ng-show="(se || af.MeetingMinutes.$touched) && af.MeetingMinutes.$invalid " class="text-danger">Meeting Minutes required.</p>
								<div style="text-align: right;padding: 0px 10px;">{{actions[0].MeetingMinutes.length}}/1000</div>
							</label>										 
						</div>
						
					</div>
  			
    				<!--div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/Details.html'" ></div-->  
    				
    				
				
   					<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/Details.html'" 
   						ng-repeat="item in actions"></div> 
   					
   					<div class="row" style="width: 100%;">
						<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/Buttons.html'" ></div>	
					</div>
					
   					<div style="width:100%;" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/Comments.html'"></div> 
   					
   				    
					
   				    
   				    										    				    				    					    		
	    		</div>	    			    										
					
				
																											
	    	</div>
    	</form>
    	
    	<!--div class="row" style="width: 100%;">
			<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/MeetingGroup.html'" ></div>	
		</div-->	
				
    </div>
    
  </div>  
</div>


	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingDetailsCtrl.js```FileName```DocApp.controller('MeetingDetailsCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.f1 = '';
	$scope.f2 = '';	
	$scope.f3 = '';	
	$scope.ShowComment = false;
	
	$scope.ShowAddNewButton = false;
	
	
	$scope.onBtnAddComment = function(id)    
	{
		var act = $scope.actions[id];
		if(act.CurrentComment){		
			addComment(act.CommentList, act.Status, GetSiteConfig("CurrentUser").Title, act.CurrentComment);
			act.Remarks = angular.toJson(act.CommentList);
			
			var valuepairs = [];
			valuepairs.push( ["Remarks", act.Remarks ]);				
			var id = UpdateField(MeetingTrackerList, act.Id, valuepairs );

			act.CurrentComment = "";
			
			//$location.path("ActionTracker");
			$location.path(LastListingPage);

		}
		else{
			alert("Please provide Update");
		}

	}
	
	$scope.onBackClick = function()    
	{			
		var v = $scope.af;
		if($scope.af.$dirty){
			
			var warnMsg = "Do you want to quit without creating the action(s)?";
			if($scope.actions[0].ID){
				warnMsg = "Do you want to quit without saving the changes?";
			}
			
			if (confirm( warnMsg ) == true) {
			  //$location.path("ActionTracker");
			  $location.path(LastListingPage);
			  MeetingShowFromListState  = true;			  
			  MeetingUpdateListStateFilters= true;
			} 
		}
		else{
			//$location.path("ActionTracker");
			$location.path(LastListingPage);
			MeetingShowFromListState  = true;			  
			MeetingUpdateListStateFilters= true;
		}				
	}
	
	
	$scope.FormatCommentDate= function(date)    
	{			
		 var dt =  new moment(date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY hh:mm A')
		 return dt;
	}
	
	$scope.CommentDateFormat = function(date, format)    
	{			
		 var dt =  new moment(date, format ).format('DD-MMM-YYYY hh:mm A')
		 return dt;
	}


	$scope.NavigateItem= function(ID)    
	{			
		 $location.path("ActionDetails/" + ID);
	}
	
	$scope.DeleteAction = function(ID)    
	{			
		 //alert(ID);
		 $scope.actions.splice(ID,1);
	}

	
	$scope.AddSubMeeting = function()    
	{			
		var act = {};
		act.ActionPointTitle = "";
		if($scope.actions.length > 0 ){		 
			act.MeetingDate = $scope.actions[0].MeetingDate;
			act.Title = $scope.actions[0].Title;
			act.ActionType = $scope.actions[0].ActionType ;
			act.MeetingMinutes = $scope.actions[0].MeetingMinutes;
		}
		else{
			act.MeetingDate = ''; //new moment();
			act.Title = '';
			act.ActionType = '';
			act.MeetingMinutes = '';
		}
		
		act.ActionPoint = '';
		act.Responsibility = '';
		act.Status = 'Not Started';
		act.Remarks = '';
		act.ComplectionDate = '';
		
		act.ActionPointTitle = '';
		act.CompletionDateHistory = '';
		act.ResponsibilityType = 'Team';
		act.StakeholderType = 'Team';
		
		act.RespPer = '';
		act.CompletionDateHistoryArr = [];
		act.CommentList= [];
		$scope.actions.push(act);	
		
		SetControls($scope.actions.length-1);

			 
	}


	
	
	$scope.ActionTypeChange = function(){		
		var ac = $scope.ActionTypeList;
		for(i=0;i<ac.length;i++){
			if( ac[i].Title == $scope.actions[0].ActionType ){
				$scope.ActionNameList = ac[i].subTypes;
				break;
			}
		}
		
		if($scope.ActionNameList.length == 1 ){
			$scope.actions[0].Title = $scope.ActionNameList[0];
		}
	}	
			
	$scope.onBtnSave = function()    
	{			
		if(!ValidateItem()){
			return;
		}
		
		$scope.af.$dirty = false;
		
		//update all rows
			
			

		
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		for(id=0;id<$scope.actions.length;id++){		
			
			var act = $scope.actions[id];
			
			if(act.ResponsibilityType == "Team"){
				act.Responsibility = angular.toJson(act.ResponsibilityArr);
				act.RespPer = "";			
			}
			else if(act.ResponsibilityType == "Person"){
				act.RespPer = getUserInfo("RespPerDiv" + id);
				act.Responsibility = [];	
			}
			
			if(act.StakeholderType == "Team"){
				act.Stakeholder = angular.toJson(act.StakeholderArr);
				act.StakeholderPer  = "";			
			}
			else if(act.StakeholderType == "Person"){
				act.StakeholderPer = getUserInfo("StakeholderPerDiv" + id);
				act.Stakeholder = [];	
			}
			else{
				act.Stakeholder = [];
				act.StakeholderPer  = "";
			}

			
			if(act.LastComplectionDate && act.LastComplectionDate != act.ComplectionDate){
				var dtItem = {};
				dtItem.Date = moment().format('DD-MMM-YYYY');
				dtItem.ActionBy = GetSiteConfig("CurrentUser").Title
				dtItem.ComplectionDate = "Changed from " +  act.LastComplectionDate + " to " + act.ComplectionDate;
				act.CompletionDateHistoryArr.push(dtItem)
			}		
			act.CompletionDateHistory = angular.toJson(act.CompletionDateHistoryArr);
			
			if(act.CurrentComment){		
				addComment(act.CommentList, act.Status, GetSiteConfig("CurrentUser").Title, act.CurrentComment);
				act.Remarks = angular.toJson(act.CommentList);
				act.CurrentComment = "";
			}
			
			if(id != 0 && !act.GroupId ){
				act.GroupId = $scope.actions[0].Id;								
			}
			
			if(id != 0){
				act.MeetingDate = $scope.actions[0].MeetingDate;
				act.Title = $scope.actions[0].Title;
				act.ActionType = $scope.actions[0].ActionType;	
				act.MeetingMinutes = $scope.actions[0].MeetingMinutes;				
			}
			
			act.LastModifiedDate = new moment().format('YYYY-MM-DD HH:mm:ss')
			if(act.Status == "Completed" ){
				act.CompletedDate = new moment().format('YYYY-MM-DD HH:mm:ss')
			}
			else{
				act.CompletedDate = "";
			}
			
			var IsNewReq = act.ID ? false : true;
			var itemId = UpdateList(act, MeetingTrackerList, IsNewReq, IsNewReq);
			if(itemId){
				act.Id = itemId;
				act.ID = itemId;
			}
			//act.Id = itemId;
			
			if(id == 0 && !act.GroupId ){
				act.GroupId = act.Id;
				UpdateList(act, MeetingTrackerList, false, false);
			}	
			CombainHistory(act.CommentList, act.CompletionDateHistoryArr );
			
			$scope.ErrorMessage = "Updated";			
			
			ShowSnacker("Updated");				
		}
				
		$('#divOverlay').hide();
		$('#ListDetails').show();

		/*
		if(!$scope.ShowAddNewButton){
			//$location.path("ActionTracker");
			$location.path(LastListingPage);
		}
		*/
		//
	}	
	
	function ValidateItem(){
	
		var errMessage = "";
		if ( $scope.af.$valid) {
		
			for(id=0;id<$scope.actions.length;id++){
				
				var act = $scope.actions[id];
				if(act.ResponsibilityType == 'Person'){
					var RespPer = getUserInfo("RespPerDiv" + id);
		        	if(!RespPer){
		        		errMessage +=  "Responsibility required. ";		        		
		        	} 
		        } 
		        /*
		        if(act.StakeholderType == 'Person'){
					var RespPer = getUserInfo("StakeholderPerDiv" + id);
		        	if(!RespPer){
		        		errMessage +=  "Stakeholder required. ";		        		
		        	} 
		        } 
		        */

        	}
        	
			if(errMessage){
				$scope.ErrorMessage = errMessage;
		        return false;
			}        	
        	
        	
            $scope.errMessage = "";   
            return true;     
        } 
        else {
        	$scope.se = true;
        	if( $scope.af.$error.required  != null || $scope.af.$error.required  != undefined ){	
        		$.each($scope.af.$error.required, function(id, err){
        			
        			if(  err.$$attr.errmsg == null || err.$$attr.errmsg == undefined ){	
        				errMessage += err.$name + " required. ";        				
        			}
        			else{        			 
        				errMessage += err.$$attr.errmsg + " required. ";
        			}
        		});
        	}        	
        	$scope.ErrorMessage = errMessage;
        	return false;
		}
	}
	



	$scope.listCtrlOnLoad = function(){
        	    	    	   			
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		if(!LastListingPage){
			LastListingPage = "ActionTracker";
		}

		
		$scope.se = false;
		//$scope.subMeetings = [];				
								
		$scope.CommentList = [];	
		
		setTimeout(function(){						  
		    
		    //$('.ResponsibilitySelect').select2();
		    		    		    
			$('.MeetingDate').datetimepicker({
				 
				locale:  moment.locale('en', {
			        week: { dow: 1 }
			    }),
			    maxDate: moment(),
    
				format: 'DD-MMM-YYYY',
				defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
				//enabledDates: moment().format('DD-MMM-YYYY'), //.add(1, 'days')
		    });	     	     
		    $(".MeetingDate").on("dp.change", function() {
		        $scope.actions[0].MeetingDate = $(".MeetingDate").val();						
				$scope.$apply();
		    });	 
		    
		   /* 		   		    
		    $('.ComplectionDate').datetimepicker({
				format: 'DD-MMM-YYYY',
				//defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
		    });	     	     
		    $(".ComplectionDate").on("dp.change", function() {
		        $scope.item.ComplectionDate = $(".ComplectionDate").val();						
				$scope.$apply();
		    });	
		    */
		    
		    /*
		    //set textbox height
		    $('textarea').each(function () {		    	
			  this.setAttribute('style', 'height:' + (this.scrollHeight) + 'px;overflow-y:hidden;');
			}).on('input', function () {
				if(!$(this)[0].name == "ActionPoint" ){
					this.style.height = 'auto';
			 	 	this.style.height = (this.scrollHeight) + 'px';
				}
				else{
					
				}										  
			});
			*/
			
		    setTimeout(function(){	
		    	if(!$scope.actions[0].MeetingDate){
		    	 	$scope.actions[0].MeetingDate = $(".MeetingDate").val();
		    	 }
		    	 //$scope.item.ComplectionDate = $(".ComplectionDate").val();
		    	 $scope.$apply()
		    }, 500);		    		    		    
		    
	    }, 200);
	    
		
		$scope.ShowSaveButton = false;
		
		setTimeout(function(){ 		
    		$scope.listDetailsOnLoadInit();
    	}, 1);
	}
	
	
	function UpdateSubMeetings(){
	
		//filter = "&$filter=RespPer/Id eq " + _spPageContextInfo.userId;
		//var filter = ",RespPer/Title,RespPer/Id&$expand=RespPer/ID,RespPer/Title" + filter;		
		$scope.subMeetings = [];
		
		if($scope.actions[0].ID){
				
			var filter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID" //&$filter=Author/Id eq " + _spPageContextInfo.userId;
				+ "&$filter=MeetingDate eq '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
				+ " and ActionType eq '" + encodeURIComponent($scope.actions[0].ActionType) + "' and Title eq '" + encodeURIComponent($scope.actions[0].Title) + "'"
				+ " and ID ne " + $scope.actions[0].ID;
	
					
			$scope.subMeetings = GetListData(MeetingTrackerList, filter );
		}

		//$scope.subMeetings
	}
	
	function UpdateActionTypes(){
		var types = GetConfigList("MeetingTypeList"); 
		
		
		$scope.ResponsibilityList = ResponsibilityList;
		
		var ac = [];
		$.each(types, function(id, ty){
			var nw = true;
			for(i=0;i<ac.length;i++){
				if( ac[i].Title == ty.Title){
					ac[i].subTypes.push(ty.ActionSubType);
					nw = false;
					break;
				}
			}
			if(nw){
				var type = {};
				type.Title = ty.Title;
				type.subTypes= [];
				type.subTypes.push(ty.ActionSubType);
				ac.push(type);
			}
		});
		$scope.ActionTypeList = ac;
	}
		
	$scope.listDetailsOnLoadInit = function(){
		//$scope.EntityList = GetConfigList("EntityList");
		$scope.read = true;
		$scope.adminRead = true;
		
		$scope.itenId = $routeParams.itenId;
		$scope.ShowSaveButton = false;
		
		UpdateResponsibilityConfig();
		
		UpdateActionTypes();
						
		if($routeParams.itenId){
		
			$scope.ShowComment = true;
			//filter = ",RespPer/Title,RespPer/Id&$expand=RespPer/ID,RespPer/Title" + filter;
			var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID eq " + $routeParams.itenId;
			var listItems = GetListData(MeetingTrackerList, listFilter );
						
			if(listItems.length > 0 ){				
				//$scope.item = listItems[0];
				$scope.actions = []
				$scope.actions[0] =  listItems[0]
				updateItemDetails(0);
				UpdateSubMeetings($routeParams.itenId);				
				SetControls(0);
				
				setTimeout(function(){ 		
					initializeSinglePeoplePicker("RespPerDiv" + "0");
					PopulateMembers($scope.actions[0].RespPerId, "RespPerDiv" + "0");
					
					initializeSinglePeoplePicker("StakeholderPerDiv" + "0");
					PopulateMembers($scope.actions[0].StakeholderPerId, "StakeholderPerDiv" + "0");

				}, 500);
								
			}
			
			
		}
		else{
		
			
			

			$scope.ShowComment = false;
			$scope.read = false;
			$scope.adminRead = false;
			
			$scope.ShowAddNewButton = true;	
			/*
			$scope.item = {};		
			$scope.item.Status = "Not Started";	
			$scope.item.ResponsibilityType= "Team"
			$scope.item.CompletionDateHistoryArr = [];
			$scope.item.CommentList= [];
			*/
			$scope.actions = [];
			$scope.AddSubMeeting();	
			
			if($routeParams.type == "Meeting" ){
				$scope.actions[0].ActionType = $routeParams.type;
			}
			else if($routeParams.type == "Action" ){
				$scope.actions[0].ActionType = "Adhoc";
			}

			
			
			setTimeout(function(){ 		
				initializeSinglePeoplePicker("RespPerDiv" + "0");	
				initializeSinglePeoplePicker("StakeholderPerDiv" + "0");			
			}, 500);
				
			
		}
		
		SetSideBar("Action Tracker Details", "Action Tracker");
							
		$scope.ShowSaveButton  = !$scope.read;
		
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();
	}
	
	function updateItemDetails(){
		
		$scope.actions[id].LastComplectionDate = $scope.actions[id].ComplectionDate;
				
		$scope.actions[id].CommentList =  angular.fromJson($scope.actions[id].Remarks);
		if(!$scope.actions[id].CommentList ){
			$scope.actions[id].CommentList= [];
		}
		
		$scope.actions[id].CommentList =  angular.fromJson($scope.actions[id].Remarks);
		if(!$scope.actions[id].CommentList ){
			$scope.actions[id].CommentList= [];
		}
		
		if( $scope.actions[id].CommentList.length == 0 ||  $scope.actions[id].CommentList[0].Status != "Initiation" ){
			//Created By
			var log = {};
			log.Status= "Initiation";
			log.From= $scope.actions[id].Author.Title;
			log.Date= moment($scope.actions[id].Created).format('YYYY-MM-DD hh:mm A'); //$scope.actions[id].Created; //moment().format('YYYY-MM-DD hh:mm A');
			log.Comment= "";	
			$scope.actions[id].CommentList.unshift(log);
		}
					
		try{
			$scope.actions[id].CompletionDateHistoryArr = angular.fromJson($scope.actions[id].CompletionDateHistory);
		}catch(ex){
			$scope.actions[id].CompletionDateHistoryArr = [];
		}
		if(!$scope.actions[id].CompletionDateHistoryArr){
			$scope.actions[id].CompletionDateHistoryArr = [];	
		}
						
		try{
			$scope.actions[id].ResponsibilityArr = angular.fromJson($scope.actions[id].Responsibility);
		}catch(ex){
			$scope.actions[id].ResponsibilityArr = [];
		}
		
		try{
			$scope.actions[id].StakeholderArr = angular.fromJson($scope.actions[id].Stakeholder);
		}catch(ex){
			$scope.actions[id].StakeholderArr = [];
		}

		
	
		$scope.ActionTypeChange();	
		
		if( _spPageContextInfo.userId == $scope.actions[id].AuthorId ){
			$scope.read = false;			
		}
		

		
		//$scope.actions[id].RespPerId.results
		if( currentUserResp.includes("Admin") ){
			$scope.read = false;
			$scope.adminRead = false;
		}
		else if($scope.actions[id].ResponsibilityType == "Team"){
			$.each($scope.actions[id].ResponsibilityArr , function(pid, Perval){
				if( currentUserResp.includes(Perval) ){
					$scope.read = false;
				}
			});			
		}
		else if($scope.actions[id].ResponsibilityType == "Person" && $scope.actions[id].RespPerId){
			$.each($scope.actions[id].RespPerId.results , function(pid, Perval){
				if( Perval == _spPageContextInfo.userId ){
					$scope.read = false;
				}
			});								
		}
		
	  	CombainHistory($scope.actions[id].CommentList, $scope.actions[id].CompletionDateHistoryArr );
			
	}
	
	function CombainHistory(CommentList, CompDateList ){
		///$scope.actions[id].CompletionDateHistoryArr
		var ListCombaind = [];
		$.each(CommentList, function(id, cmd){
			var log = {};	
			log.Status= cmd.Status;
			log.From= cmd.From;
			
			log.Date =  new moment(cmd.Date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY');
			log.DateSort = new moment(cmd.Date, "YYYY-MM-DD hh:mm A" ).unix();
			//log.Date= cmd.Date;
			log.Comment =  cmd.Comment; 
	
			ListCombaind.push(log);			

		});
		
		$.each(CompDateList, function(id, cmd){
			var log = {};
			log.Status =  "Completion Date change";
			log.From = cmd.ActionBy;
			log.Date = cmd.Date;
			log.DateSort = new moment(cmd.Date, "DD-MMM-YYYY" ).unix();
			
			log.Comment =  cmd.ComplectionDate;
			 
			ListCombaind.push(log);										
		});

		
		ListCombaind = ListCombaind.sort((a, b) => {
		
			//var da =  new moment(cmd.Date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY');
			
		    return a.DateSort - b.DateSort;
		});
		
		$scope.ListCombaind = ListCombaind;
	}
	
	function SetControls(id){
		setTimeout(function(){						  
		    
		    $('.ResponsibilitySelect' + id ).select2();
		    		    		    			 		    		   		   
		    $('.ComplectionDate' + id ).datetimepicker({
		    	
		    	locale:  moment.locale('en', {
			        week: { dow: 1 }
			    }),

				format: 'DD-MMM-YYYY',
				//defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
		    });	     	     
		    $(".ComplectionDate" + id ).on("dp.change", function() {
		        $scope.actions[id].ComplectionDate = $(".ComplectionDate"+ id ).val();						
				$scope.$apply();
		    });			    
		    initializeSinglePeoplePicker("RespPerDiv" + id);	
		    initializeSinglePeoplePicker("StakeholderPerDiv" + id);	    		  		    		  		    		    		    		   
	    }, 400);
	}
	
	function ShowSnacker(message){
	
		$('#snackbar').empty();
		$('#snackbar').append("<div class='alert alert-success'><strong>" + message + "</strong></div>");
	
		var x = document.getElementById("snackbar");
	    x.className = "show";
	    
	    setTimeout(function(){
			x.className = x.className.replace("show", ""); 
			$scope.ErrorMessage = "";
			$scope.$apply();
		}, 3000);
		
	}
	

	
						  
				
});

	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingGroup.html```FileName```
<div style="margin:25px" ng-show="subMeetings.length > 0">
	<table id="tblRequestAuditLogs" class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
		<thead>
			<tr><th colspan="4" >Other Actions</th></tr>
			<tr style="background-color: #ffe6cc;">
				<th>Action Point</th>								
				<th style="width:250px">Responsibility</th>	
				<th style="width:100px">Status</th>						
				<th style="width:100px">Comp. Date</th>		
			</tr>
		</thead>
		<tbody>
			<tr  ng-repeat="it in subMeetings" ng-click="NavigateItem(it.ID)" >	
				<td>{{it.ActionPointTitle}}</td>								
				<td>
					{{ GetResponsibility(it.Responsibility) }}
					<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>

				</td>
				<td>{{it.Status}}</td>						
				<td>{{it.ComplectionDate}}</td>
			</tr>
		</tbody>
	</table>
</div>

	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingList.html```FileName```<style>

	.select2-input{
		border:0px  !important;
	}
	.select2-search-choice{
		font-size:small;font-weight:normal;margin:0px;padding-right:0px;margin:1px !important;;
	}
	
	
	#DataTableText{
		border-radius: 4px !important;;
    	height: 33px !important;
	}
	
	.gridTabButton{
		padding: 4px 10px  !important;
		width:150px !important;
		text-align:center
	}

}
</style>
<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-3 main-header-title" >Action Tracker<span style="color:red;font-weight:bold"> UAT</span></div>	
		
		
		
		<div class=" col-md-9">
			
			
			<!--button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('My Teams Task')" style="float:right;margin-right:0px" ng-class="GetButtonClass('My Teams Task')" >
				 My Teams Task
			</button-->
						
		</div>
				
	</div>
	
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/QButtons.html'" style="width:100%" ></div>
	
	<!--div  class="row content  divPnlButton">
		<div class="col-md-10">
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Action
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Meeting
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
				Action View
			</button>

			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
				Meeting View
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="isAdmin"
				 ng-click="TaskListing('All Tasks')"  ng-class="GetButtonClass('All Tasks')" >
				All Actions{{AllTasksCount}}
			</button>

			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('Assigned by Me')"  ng-class="GetButtonClass('Assigned by Me')" >
				 Assigned by Me{{AssignedByMeTaskCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('Individual Task')" ng-class="GetButtonClass('Individual Task')" >
				 Individual Task{{IndividualTaskCount}}
			</button>
			
			
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('Team Task')" ng-class="GetButtonClass('Team Task')" >
				 Team Task{{TeamTaskCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('All Team Tasks')" ng-if="isAdmin"
				 ng-class="GetButtonClass('All Team Tasks')" >
				 Meeting Tasks{{AllTeamsTasksCount}}
			</button>
									
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('Stakeholder')"  ng-class="GetButtonClass('Stakeholder')" >
				 Stakeholder{{StakeholderTasksCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="isAdmin"
				 ng-click="TaskListing('All Tasks')"  ng-class="GetButtonClass('All Tasks')" >
				All Tasks{{AllTasksCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="!isAdmin"
				 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
				All Tasks{{AllTeamTasksCount}}
			</button>
			
			

			
			

			
		</div>
		
		<div class="col-md-2">								
				        
	        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
            	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
            </button>
	        
			 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="TaskListing(QuqueTitle)" title="Refresh">
	            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
	         </button>	
	         
			       				
		</div>	
		
	</div-->
	
	<div class="row main-data" >							
		<div class="panel panel-default" style="width: 100%;" >
			<div class="panel-heading item-panel-heading" style="">  
		    	<ul class="nav nav-tabs ullandingPageTabs" style="border-bottom:0px" id="ullandingPageTabs">
		    		<li class="active auctionCommentsTab lilandingPageTabs" id="lilandingPageTabs1" ><a class="gridTabButton" name="Pending Requests" data-toggle="tab" href="#tabAllOrders" target="_self">Pending</a></li>
		    		<li class="lilandingPageTabs" id="lilandingPageTabs2" ><a class="gridTabButton" name="Completed Requests" data-toggle="tab" href="#tabActiveOrders" target="_self">Completed</a></li>  
		    		<li class="lilandingPageTabs" id="lilandingPageTabs3" ><a class="gridTabButton" name="Removed Requests" data-toggle="tab" href="#tabActiveOrders" target="_self">Removed</a></li>  
		    		<li class="lilandingPageTabs" id="lilandingPageTabs4" ><a class="gridTabButton" name="All Requests" data-toggle="tab" href="#tabActiveOrders" target="_self">All</a></li>  		    					    		
		    	</ul>  
		    	
				<!--div style='position: absolute;top:78px;right:18px;'><label>Target Date : <input type='text' class='TableDateRangeFilter' name='reportrange' id='reportrange'/></label></div--> 
		    </div>
		    
		    <div class="panel-body" >
		    	<div id="divDataTable" style="width:100%">
					<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
						<thead>
							<tr>					
								<th class="hide">ID</th>
								<th style="width:80px" >Date</th>	
								<th style="width:70px">Action Type</th>
								<th style="width:150px">Meeting Name</th>
								<th>Action Point</th>								
								<th style="width:150px">Responsibility</th>	
								<th style="width:150px">Stakeholder</th>
								<th style="width:80px;padding-left:0px !important;padding-right:8px !important">Last Update</th>						
								<th style="width:80px;padding-left:0px !important;padding-right:8px !important">Target Date</th>									
								<th style="width:70px">Status</th>			
							</tr>
						</thead>
						
						<tfoot class="ttcpFooter">
				            <tr class="ttcpFtrTrCompleted">	
				            	<th class="hide">ID</th>
								<th>Date</th>	
								<th>Action Type</th>
								<th>Meeting Name</th>
								<th>Action Point</th>								
								<th>Responsibility</th>	
								<th>Stakeholder</th>	
								<th>Last Update Date</th>				
								<th>Target Date</th>								
								<th>Status</th>			
				            </tr>
				        </tfoot>		        		        
						<tbody>									
							<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
								<td class="hide">{{it.ID}}</td>	
								<td data-order="{{DateSer(it.MeetingDate)}}" >{{it.MeetingDate}}</td>		            	
								<td>{{it.ActionType}}</td>
								<td>{{it.Title}}</td>
								<td data-order="{{it.ID}}" ><span style="color:orange;font-weight:bold">AT{{it.ID}}</span> {{it.ActionPointTitle}}</td>								
								<td>
									{{ GetResponsibility(it.Responsibility) }}
									<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>		
								</td>
								
								<td>
									{{ GetResponsibility(it.Stakeholder) }}
									<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
								</td>
								<td data-order="{{DateSer(FormatDate(it.LastModifiedDate))}}" >{{FormatDate(it.LastModifiedDate)}}</td>					
								<td data-order="{{DateSer(it.ComplectionDate)}}" >{{it.ComplectionDate}}</td>								
								<td ng-style="{ 'background-color': MeetingStatus(it) }" >{{it.Status}}</td>	
							</tr>				 	  
						</tbody>									
					</table>
				</div>
		    </div>
		</div>
	
	</div>

</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingListCtrl.js```FileName```var lastTab = "";
var lastSeletedStatusTab = "";
var ListState = "";

var ShowFromListState = false;
var ListStateFilters = [];
var UpdateListStateFilters = false;

var MeetingShowFromListState = false;
var MeetingListStateFilters = [];
var MeetingUpdateListStateFilters = false;

var LastListingPage = "ActionTracker";


DocApp.controller('MeetingListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.AppCodeFolder = "TryUtilUAT";
	
	$scope.MeetingView = function(){
		window.location = "/" + SiteRelativeUrl + PagePath + "/MeetingView/";
	}

	$scope.ClearFilter = function(){
	
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
		updateTable();
	}


	$scope.listCtrlOnLoad= function(){
	//UpdateQueue(); return;
	//
		LastListingPage = "ActionTracker";
		
		SetSideBar("Action Tracker List", "Action Tracker");			
	
		$('#divOverlay').show();
		//$('#ListDetails').hide();
		
		setTimeout(function(){ 	
		
			if(!lastSeletedStatusTab){
				lastSeletedStatusTab = "Pending Requests";				
			}
			$scope.SeletedStatusTab = lastSeletedStatusTab;
			
			$('.nav-tabs a').on('shown.bs.tab', function(event){
				
				var target = $(event.target).text();    // active tab
				var y = $(event.relatedTarget).text();  // previous tab
				
				if(target == "Pending"){
					$scope.SeletedStatusTab = "Pending Requests";
				}
				else if(target == "Completed"){
					$scope.SeletedStatusTab = "Completed Requests";
				}
				else if(target == "Removed"){
					$scope.SeletedStatusTab = "Removed Requests";
				}
				else if(target == "All"){
					$scope.SeletedStatusTab = "All Requests";
				}
				lastSeletedStatusTab = $scope.SeletedStatusTab ;
								
				$scope.TaskListing($scope.QuqueTitle, $scope.SeletedStatusTab );
			});
			
			//UpdateMeetingDateSearch();
	
    		$scope.listCtrlOnLoadInit();
    	}, 10);
			
	}
	 // ["ALM","BMS","F&E","S&S"];
	$scope.listCtrlOnLoadInit = function()
	{
		
		
		$scope.startDate = moment();
		$scope.endDate = moment().add(30, 'days');
		
		
		$scope.isAdmin = false;
		UpdateResponsibilityConfig();
		if( currentUserResp.includes("Admin") ){
			$scope.isAdmin = true;			
		}
		
		if(!lastTab){
			if($scope.isAdmin){
				lastTab = "All Tasks";
			}
			else{
				lastTab = "Teams Combaind Tasks"; // "Team Task";
			}
		}
		
		
		if($scope.isAdmin){
			UpdateQueue();
		}
				
		$scope.TaskListing(lastTab, $scope.SeletedStatusTab);		
		$scope.$apply();						
					
	}
	
	$scope.GetButtonClass = function(title){
		if( title == $scope.QuqueTitle ){
			return "EI-ButtonPurple-Selected";
		}
		else{
			return '';
		}
	}
	
	$scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}
	
	$scope.FormatDate = function(date){
		return new moment(date).format("DD-MMM-YYYY");
	}


	$scope.MeetingStatus = function(itm){
		if(itm.Status == "Not Started" || itm.Status == "In Progress" ){
			var cd = new moment(itm.ComplectionDate, "DD-MMM-YYYY") ;
			var v = new moment().diff(cd, 'days');
			if(v > 0 ){
				return 'LightCoral';
			}

		}
		else if(itm.Status == "Completed" ){
			return 'LightGreen';
		}
		
		
		return '';
	}
	
	$scope.AddNew= function(type){
		window.location = "/" + SiteRelativeUrl + PagePath + "/NewAction/" + type;
	}
	
	
	


	$scope.TaskListing = function(queue, StatusTab){
				
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		setTimeout(function(){ 
			$scope.TaskListingPoc(queue, StatusTab);
		}, 0);
				
	}
	
	$scope.TaskListingPoc = function(queue, StatusTab){
		
		/*		
		if(!StatusTab){
			//$('#lilandingPageTabs1').addClass('active');
			$('#lilandingPageTabs2').removeClass('active');
			$('#lilandingPageTabs3').removeClass('active');
			$('#lilandingPageTabs4').removeClass('active');
			$scope.SeletedStatusTab = "Pending Requests";
		}
		*/
		
		$('#lilandingPageTabs1').removeClass('active');
		$('#lilandingPageTabs2').removeClass('active');
		$('#lilandingPageTabs3').removeClass('active');
		$('#lilandingPageTabs4').removeClass('active');


		switch(StatusTab){
			case "Pending Requests":
				$('#lilandingPageTabs1').addClass('active');break;
			case "Completed":
				$('#lilandingPageTabs2').addClass('active');break;
			case "Removed Requests":
				$('#lilandingPageTabs3').addClass('active');break;
			case "All Requests":
				$('#lilandingPageTabs4').addClass('active');break;	
		}
		
		
		
		var TeamTaskCount = 0;
		var IndividualTaskCount = GetListItemsCount(MeetingTrackerList, "Status", "Status ne 'Completed' and  Status ne 'Removed' and ( " + IndiviualTaskFilter + " ) " )
		$scope.IndividualTaskCount = " (" + IndividualTaskCount + ")";
		
		
		var countfilter = "";			
		$.each(currentUserResp, function(id, rval){
			if(rval){
				if(countfilter){
					countfilter += " or  ";
				}				
				countfilter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
			}
		});
		if(countfilter){
			countfilter = "( " + countfilter+ " )" + " and Status ne 'Completed'  and  Status ne 'Removed'";
			TeamTaskCount = GetListItemsCount(MeetingTrackerList, "Status", countfilter );
			$scope.TeamTaskCount = " (" + TeamTaskCount + ")";
		}	
		else{
			$scope.TeamTaskCount = "(0)";
			//queue = "Individual Task"
		}
										
		$scope.AssignedByMeTaskCount = " (" + GetListItemsCount(MeetingTrackerList, "Status", "Status ne 'Completed' and  Status ne 'Removed' and Author/Id eq " + _spPageContextInfo.userId )  + ")";

		//Stakeholder
		var countfilter = "";			
		$.each(currentUserResp , function(id, rval){
			if(rval){
				if(countfilter){
					countfilter += " or  ";
				}				
				countfilter += "substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
			}
		});		
		if(countfilter){
			countfilter = "( " + countfilter + " )" + " or ";
		}
		//countfilter += " StakeholderPer/Id eq " + _spPageContextInfo.userId;	
		countfilter +=  IndiviualStakeHolderFilter;
		
		countfilter= " ( " + countfilter + " ) ";				
		if(countfilter){
			countfilter = "( " + countfilter+ " )" + " and Status ne 'Completed'  and  Status ne 'Removed' ";
		}
		$scope.StakeholderTasksCount = " (" + GetListItemsCount(MeetingTrackerList, "Status", countfilter )  + ")";	
		
		
		if($scope.isAdmin){
			$scope.AllTasksCount = " (" + GetListItemsCount(MeetingTrackerList, "Status", "Status ne 'Completed'  and  Status ne 'Removed'") + ")";
			$scope.AllTeamsTasksCount = " (" + GetListItemsCount(MeetingTrackerList, "Status", " Status ne 'Completed' and  Status ne 'Removed' and ActionType eq 'Meeting' ") + ")";
		}
		else{
			
			filter = "";			
			$.each(currentUserResp , function(id, rval){
			    if(rval){
			        if(filter){
			            filter += " or  ";
			        }
			        else{
			            //filter = "&$filter=";
			        }
			        filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
			        
			        //Stakeholder all task
			        filter += " or substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
			    }								
			});	                        
			filter = filter + " or " + IndiviualTaskFilter;
			
			//Stakeholder all task
			filter = filter + " or " + IndiviualStakeHolderFilter;
			
			if(filter){
			    filter = "( " + filter +  " ) and Status ne 'Completed' and  Status ne 'Removed'"; //and ( Status ne 'Completed') ";
			}
			else{
				filter = " Status ne 'Completed' and  Status ne 'Removed'  ";
			}
					    
			$scope.AllTeamTasksCount = " (" + GetListItemsCount(MeetingTrackerList, "Status", filter ) + ")";
			filter = "";					     
    
			//AllTeamTasksCount = IndividualTaskCount + TeamTaskCount;
			//$scope.AllTeamTasksCount = " (" + AllTeamTasksCount + ")";
			
		}
		
		 		
		DestroyTable();

		/*
		if(queue == "Meeting View"){
			//filter = "&$filter=datefilter ";
			
			return;
		}
		*/

				
		var filter = "";
		if(queue == "All Tasks"){
			//filter = "&$filter=datefilter ";
		}
		else if(queue == "Assigned by Me"){
			filter = "Author/Id eq " + _spPageContextInfo.userId;			
		}
		else if(queue == "All Team Tasks"){
			filter = "ActionType eq 'Meeting'";			
		}
		else if(queue == "Individual Task"){		
			//filter = "RespPer/Id eq " + _spPageContextInfo.userId;			
			filter = IndiviualTaskFilter;						
		}
		else if(queue == "Team Task"){
			
			filter = "";			
			$.each(currentUserResp , function(id, rval){
				if(rval){
					if(filter){
						filter += " or  ";
					}
					else{
						//filter = "&$filter=";
					}
					filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
				}
			});		
			
			if(!filter){
				filter = " Responsibility eq '-' ";
			}
										
		}
		else if(queue == "Teams Combaind Tasks"){
			
			filter = "";			
			$.each(currentUserResp , function(id, rval){
				if(rval){
					if(filter){
						filter += " or  ";
					}
					else{
						//filter = "&$filter=";
					}
					filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
					
					//Stakeholder all task
					filter += " or substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
				}								
			});	
									
			filter = filter + " or " + IndiviualTaskFilter;
			
			//Stakeholder all task
			filter = filter + " or " + IndiviualStakeHolderFilter;
			
			if(!filter){
				filter = " Responsibility eq '-' ";
			}
										
		}
		else if(queue == "Stakeholder"){
			
			filter = "";			
			$.each(currentUserResp , function(id, rval){
				if(rval){
					if(filter){
						filter += " or  ";
					}
					else{
						//filter = "&$filter=";
					}
					filter += "substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
				}
			});	
			
			if(filter){
				filter = "( " + filter + " )" + " or ";
			}
			//filter += " StakeholderPer/Id eq " + _spPageContextInfo.userId;
			//Stakeholder all task
			filter +=  IndiviualStakeHolderFilter;	
			filter = " ( " + filter + " ) ";
		}
		else //
		{
			queue = "My Teams Task";
			
			filter = "RespPer/Id eq " + _spPageContextInfo.userId;
			filter += " or  Author/Id eq " + _spPageContextInfo.userId;

			//filter = "";
			$.each(currentUserResp , function(id, rval){
				if(rval){
					if(filter){
						filter += " or  ";
					}
					else{
						//filter = "&$filter=";
					}
					filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
				}
			});						
		}
		/*
		if(!filter){
			filter += "&$filter=";
		}
		else{
			filter = "( " + filter + " )" + " and ";
		}
		*/
		
		
		/*
		if(filter){
			filter = "&$filter=( " + filter + " )" + " and ";
		}
		else{
			filter = "&$filter=";
		}

		
		startdt = $scope.startDate.clone();
		enddt = $scope.endDate.clone();		
		var datefilter = "( (ComplectionDate ge '" + startdt.subtract(1, 'days').format("YYYY-MM-DD") +  ", 00:00:01' and ComplectionDate le '";
		datefilter += enddt.add(1, 'days').format("YYYY-MM-DD") +  ", 23:59:59' )";		
		var todayDt = new moment().add(1, 'days').format("YYYY-MM-DD")+  ", 00:00:01";
		datefilter += " or ( ComplectionDate le ' " + todayDt + "'  and ( Status eq 'Not Started' or Status eq 'In Progress') ) )";
				
		filter += datefilter;
		*/
		
		if(filter){
			filter = "&$filter=( " + filter + " )" + " and ";
		}
		else{
			filter = "&$filter=";
		}


		var SeletedStatusFilter = " Status ne 'Completed' and  Status ne 'Removed' ";
		if( $scope.SeletedStatusTab == "Completed Requests"){
			 SeletedStatusFilter = " Status eq 'Completed' ";			
		}	
		/*else if( $scope.SeletedStatusTab == "Completed Requests"){
			 SeletedStatusFilter = " Status ne 'Completed' ";			
		}*/
		else if( $scope.SeletedStatusTab == "Removed Requests"){
			 SeletedStatusFilter = " Status eq 'Removed' ";			
		}
		else if( $scope.SeletedStatusTab == "All Requests"){
			 SeletedStatusFilter = " Status ne 'All ' ";			
		}	
	
	
		

		filter += SeletedStatusFilter;

			
		//filter = "&$filter=" + filter;
		
		
		
		filter = ",RespPer/Title,RespPer/Id,StakeholderPer/Title,StakeholderPer/Id&$expand=RespPer/ID,RespPer/Title&$expand=StakeholderPer/ID,StakeholderPer/Title&$orderby=ComplectionDate asc" + filter;
		
		
		$scope.dataList = GetListData(MeetingTrackerList, filter );
						
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
			
			updateTable();		
			$scope.QuqueTitle = queue;
			lastTab = queue; 
		
		}, 0);
				
	}

	
	$scope.GetResponsibility = function(rs){
    	var res = "";
    	if(rs){
    		oAl = angular.fromJson(rs)
    		$.each(oAl, function(id, val){
				res = res ? res + ", " : res;
				res += val;
				
			});

			//res =  "agg" + oAl.length;
		}
		return res ;
    }


	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	
	function updateMeetingTable(){
		
	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {
				
				
				stateSave: true,
				stateSaveCallback: function(settings,data) {			      
			      ListState = JSON.stringify(data);			     
			      MeetingShowFromListState = false;			      
			    },
				stateLoadCallback: function(settings) {
					if(MeetingShowFromListState){
						ShowFromListState = false;						
						$.each(MeetingListStateFilters, function(id, filt){
								$('.DataTableFilterCol' + filt.col  ).val(filt.val);
						});
						
						return JSON.parse(ListState);
					}
					else{
						return "";
					}					
			    },
			    
			    				

				"pageLength": 20,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				//"order": [[ 6, "desc" ], [ 7, "asc" ] ], //, [ 7, "asc" ]
				"order": [[ 1, "asc" ]], //, [ 7, "asc" ]
				"autoWidth": false,
				//dom: 'Bfrtip',
				//"columnDefs": [{"type": "date", "targets": 1}],
				//"columnDefs" : [{"targets":1, "type":"date-eu"}],

							    
				//responsive: true,
			    //"pageLength": 15,
			    
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						if( ColCount == 2 || ColCount == 3 || ColCount == 7 ){

							var title = this.header();
			                  //replace spaces with dashes
			                  title = $(title).html().replace(/[\W]/g, '-');
			                  var column = this;
			                  var select = $('<select id="DataTableFilterCol' + ColCount + '" multiple="multiple" style="width: 100%;" ></select>')
			                      .appendTo( $(column.footer()).empty() )
			                      .on( 'change', function () {
			                        //Get the "text" property from each selected data 
			                        //regex escape the value and store in array
			                        var data = $.map( $(this).select2('data'), function( value, key ) {
			                          return value.text ? '^' + $.fn.dataTable.util.escapeRegex(value.text) + '$' : null;
			                                   });
			                        
			                        //if no data selected use ""
			                        if (data.length === 0) {
			                          data = [""];
			                        }
			                        
			                        //join array into string with regex or (|)
			                        var val = data.join('|');
			                        
			                        //search for the option(s) selected
			                        column
			                              .search( val ? val : '', true, false )
			                              .draw();
			                      } );
			   
			                  column.data().unique().sort().each( function ( d, j ) {
			                      select.append( '<option value="'+d+'">'+d+'</option>' );
			                  } );
			                  
			                $('#DataTableFilterCol' + ColCount ).select2();  
			                  
			                /*
			                //use column title as selector and placeholder
			                $('#' + title).select2({
			                  multiple: true,
			                  closeOnSelect: false,
			                  placeholder: "Select a " + title
			                });
			                
			                //initially clear select otherwise first option is selected
			                $('.select2').val(null).trigger('change');
			                */
			                
							/*
							var column = this;
							var select = $('<select class="DataTableFilterCol' + ColCount + '" id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.main-ListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val ? '^'+val+'$' : '', true, false )
										.draw();
								} );
							column.data().unique().sort().each( function ( d, j ) {
								
								select.append( '<option value="'+d+'">'+d+'</option>' )
	
							} );
							*/
							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input class="DataTableFilterCol' + ColCount + '" type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
								
								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();
								
								    });							
							/*
							var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
								.appendTo( $(column.footer()).empty() )
								.on( 'change', function () {
									$('.auctionListTable').DataTable()
									.search('').columns().search('').draw();
									var val = $.fn.dataTable.util.escapeRegex(
										$(this).val()
									);
									column
										.search( val )
										.draw();
								} );							
							$.each(ResponsibilityList , function(id, val){
								select.append( '<option value="'+ val.Title +'">'+ val.Title +'</option>' )	
	
							});
							*/


						}
						
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){	
			
				 MeetingListStateFilters = [];
				 for(i=0;i<10;i++){
				 	var filt = {};
			      	filt.col = i;
			      	if( i == 2 || i == 3 || i == 7 ){
			      		filt.val = $('#DataTableFilterCol' + i  + "" ).val();
					}
					else{
			      		filt.val = $('.DataTableFilterCol' + i  + "" ).val();
			      	}
			      	MeetingListStateFilters.push( filt );	
				 }
			      			
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				//var id =  $($(auctionReqstItemElem ).children()[0]).text();
				var id = auctionReqstItemElem[0].children[0].textContent;

				//debugger;
				$scope.item = $scope.dataList[id]; 
				window.location = "/" + SiteRelativeUrl + PagePath + "/ActionDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
			
			
			//UpdateMeetingDateSearch();
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
			if(MeetingUpdateListStateFilters){			
		       
				for(i=0;i<10;i++){
				 	var filt = MeetingListStateFilters[i];			      
			      	if( i == 2 || i == 3 || i == 7 ){		
			      			      				      		
			      		$('#DataTableFilterCol' + i + "").val(filt.val);
			      		$('#DataTableFilterCol' + i + "").select2();
						//$('#DataTableFilterCol' + i+ "").trigger('change');

					}
					else{
			      		$('.DataTableFilterCol' + filt.col  ).val(filt.val);
			      	}
			      	MeetingListStateFilters.push( filt );	
				 }



				MeetingUpdateListStateFilters = false;
			}

							 						
		}, 100);
	}
	
	
	function UpdateMeetingDateSearch(){
		setTimeout(function(){		
		 
		 	/*
		    var ht = "<div style='display: inline;margin: 0px 20px;float:right;'><label>Target Date : <input type='text' class='TableDateRangeFilter' name='reportrange' id='reportrange'/></label></div>";		    		   
		    $('#main-ListTable_filter').before(ht);
		    */
		    var start =  $scope.startDate; //moment().subtract(29, 'days');
		    var end = $scope.endDate; //moment();
		
		    function cb(start, end) {
		       // $('#reportrange span').html( "Targert date from <b>" +  start.format('DD-MMM-YYYY') + '</b> to <b>' + end.format('DD-MMM-YYYY') + '</b>' );
		        $scope.startDate = start;
		        $scope.endDate = end;

		        $('#reportrange').val( start.format('DD-MMM-YYYY') + ' - ' + end.format('DD-MMM-YYYY')  );		        		        
		    }
		
		    $('#reportrange').daterangepicker({
		        startDate: start,
		        endDate: end,
		        ranges: {
		           'Today': [moment(), moment()],
		           'Next Two Days': [moment(), moment().add(2, 'days')],
		           'Next 7 Days': [moment(), moment().add(7, 'days')],
		           'Next 30 Days': [moment(), moment().add(30, 'days')],
		           'This Month': [moment().startOf('month'), moment().endOf('month')],		           
		           'This Year': [moment().startOf('year'), moment().endOf('year')],	   		                
		           'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
		        },
		        locale: {
		        	format: 'DD-MMM-YYYY'
		        }
		    }, cb);
		    
		    $('#reportrange').on('apply.daterangepicker', function(ev, picker) {
			  //$scope.startDate = start;	
			   
		  
		      $scope.TaskListing($scope.QuqueTitle);
			});
		
		    cb(start, end);
		    
	    
	    }, 200);
	}
	
	$scope.QueueTaskListing = function(Title, type ){
					
		DestroyTable();

		var queueConfig = $scope.queueConfig;
		
		for(i=0;i<queueConfig.length;i++){
			if(queueConfig[i].Title == Title ){				
				
				
				if( type == "All" ){
					$scope.dataList = queueConfig[i].items;
				}
				else if( type == "Individual" ){
					$scope.dataList = queueConfig[i].indItems;
				}
				else if( type == "Team" ){
					$scope.dataList = queueConfig[i].temItems;
				}
				else{
					return;
				}
				
				
										
				$timeout(function() {
					try{
						$scope.$apply();
					}catch(err){}
					
					updateTable();		
					//$scope.QuqueTitle = queue;
					//lastTab = queue; 
				
				}, 0);

				
				break;
			}
		}
	}
	
	function UpdateQueue(){				
		//UpdateResponsibilityConfig();		 	
		var queueConfig  = [];
		queueConfig.push({Title : "HoTM", Display : "HoTM" , color : "#4e73df", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
		queueConfig.push({Title : "ALM", Display : "ALM" , color: "#3BBEB4", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false });
		queueConfig.push({Title : "S&S", Display : "S&S" , color : "SaddleBrown", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		queueConfig.push({Title : "F&E", Display : "F&E" , color : "#f36c21", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
		queueConfig.push({Title : "BMS", Display : "BMS" , color : "darkolivegreen", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  });
		queueConfig.push({Title : "TTO", Display : "TTO" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		queueConfig.push({Title : "PI", Display : "PI" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
										
		queueConfig.push({Title : "Others", Display : "Others" , color : "#1cc88a", Count : 0,  TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		
		var othersItem = queueConfig.length-1;
		
		var filter = ",RespPer/Title,RespPer/Id,StakeholderPer/Title,StakeholderPer/Id&$expand=RespPer/ID,RespPer/Title&$expand=StakeholderPer/ID,StakeholderPer/Title";
		filter += "&$filter=Status ne 'Completed' and  Status ne 'Removed'";
		
		var aLst = GetListData(MeetingTrackerList , filter );
		
		$.each(aLst, function(aId, act){
			var other = true;
			if(act.ResponsibilityType == "Team" && act.Responsibility){
				
				$.each(queueConfig, function(qId, qu){	
					if(act.Responsibility.indexOf(qu.Title) > -1 ){
						qu.Count++;
						qu.TeamCount++;						
						other = false;
						qu.items.push(act);
						qu.temItems.push(act);
					}																
				});				
			}
			else if(act.ResponsibilityType == "Person" ){
				//Person
				
				$.each(act.RespPerId.results, function(id1, per){
					$.each(ResponsibilityList, function(id2, rspItm){
						$.each(rspItm.Users.results, function(id3, usr){
							if(usr.Id == per){
								for(i=0;i<queueConfig.length;i++){
									if(queueConfig[i].Title == rspItm.Title){
										queueConfig[i].Count++;
										queueConfig[i].IndCount++;
										other = false;
										queueConfig[i].items.push(act);
										queueConfig[i].indItems.push(act);
										break;
									}
								}
							}
						});
					});
				});
				
			}
									
			if(other){								
				//act.RespPerId.results
				queueConfig[othersItem].Count++;
				
				if(act.ResponsibilityType == "Team"){
					queueConfig[othersItem].TeamCount++;
					queueConfig[othersItem].temItems.push(act);
				}
				else{
					queueConfig[othersItem].IndCount++;
					queueConfig[othersItem].indItems.push(act);
				}
				
				queueConfig[othersItem].items.push(act);

			}
		});
				
		$scope.queueConfig  = queueConfig;
		//debugger;
				 
	}


});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingTable.html```FileName``````File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingView.html```FileName```<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" x-undefined="" />
<title>Untitled 1</title>
</head>

<body>

</body>

</html>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingViewDetails.html```FileName```<form name="myForm"></form>

<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="listCtrlOnLoad()" >
	<div class="panel panel-default" style="width: 100%">
		<div class="panel-heading item-panel-heading" >      	    				
    		<div class="pannel-header">    	
				<div class="main-header-title col-md-11">Meeting Details 1<span style="color:red;font-weight:bold"> UAT</span></div>				
				<button type="button" class="close col-md-1 " ng-click="onBackClick()"  aria-label="Close" style="float:right;color: #462157 !important;width:70px;font-size:34px">
           			<span aria-hidden="true">×</span>
        		</button>	        						   		
    		</div>
		</div>
		
		<div class="meeting-panel-body">
			<form name="af" novalidate>	    	    
		    	<div class="tab-content pageTabContentStyles" >    	    		    			    		    			    		
		    		<div id="tabDetails" class="tab-pane fade in active"  >	
		    			
		    			<div class="row content divPnlSrchRsltCharts" >
		    				<div class="col-md-12 divSubHeading" >Meeting Details</div>
	
						 	<div class="form-group input-group col-md-4 HedgeDivCol">
							  <label class="has-float-label">
							    <input name="MeetingDate" class="form-control MeetingDate" type="text"
							    	data-provider="datepicker" ng-model="actions[0].MeetingDate" ng-disabled="true"  />
							    <span>Meeting Date</span>
							    <p ng-show="(se || af.MeetingDate.$touched) && af.MeetingDate.$invalid " class="text-danger">Meeting Date required.</p>
							  </label>	 
							</div>
							
							<div class="form-group input-group col-md-4 HedgeDivCol">
								<label class="form-group has-float-label">
									 <input type="text" class="form-control MeetingDate" ng-model="actions[0].ActionType" ng-disabled="true"/>								   
								    <span>Action Type</span>
								     <p ng-show="(se || af.ActionType.$touched) && af.ActionType.$invalid " class="text-danger">Action Type required.</p>
								</label>										 
							</div>
					
							
							<div class="form-group input-group col-md-4 HedgeDivCol">
								<label class="form-group has-float-label">
									<input type="text" class="form-control MeetingDate" ng-model="actions[0].Title" ng-disabled="true"/>								   
								    <span>Meeting Name / Generic Action Point</span>
								     <p ng-show="(se || af.ActionName.$touched) && af.ActionName.$invalid " class="text-danger">Action Name required.</p>
								</label>										 
							</div>
							
							<div class="form-group input-group col-md-12 HedgeDivCol">
								<label class="form-group has-float-label FormLabel">									
									<textarea  name="MeetingMinutes{{$index}}" id="MeetingMinutes" ng-model="actions[0].MeetingMinutes" ng-disabled="true"  class="multiLineInput" errmsg="Meeting Minutes"
										style="height:100px"    maxlength="1000"
										 ></textarea>		
										<span>Meeting Minutes</span>
									
								</label>										 
							</div>
							
							<div class="col-md-12" style="padding:10px">																			
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>						
										<tr style="background-color: #ffe6cc;">
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th></th>																							
										</tr>
									</thead>
									<tbody>

									<tr ng-repeat-start="it in subMeetings " ng-click="OnActionPointClick(it)" class="trHover">
									    <td>{{it.ActionPointTitle}}</td>
									    <td>
									    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
									    </td>		
									    <td>
											{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
										</td>
																		
										<td >{{it.Status}}</td>																
										<td>{{it.ComplectionDate}}</td>
										<td>									
											<a target="_blank" href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionDetails/{{it.ID}}" >
												<i class="fa fa-edit" style="font-size: large" ng-class="lnk.Icon" aria-hidden="true"></i>											
											</a>
										</td>
									</tr>
									<tr ng-repeat-end ng-show="it.show">
									    <td colspan="6" style="border:0px;padding:0px">
									    	<div style="padding:4px; border-top:0px;border-left:5px   #FFFFFF solid;border-right:5px #FFFFFF solid;border-bottom:8px  #FFFFFF solid;background:#F0F0F0;font-weight:bold">
									    		{{it.ActionPoint}}
									    	</div>
									    									    										    	
									    </td>
									</tr>
									
									</tbody>
								</table>													
							</div>	
							
							<div class="col-md-12">
								<div style="float:left">Other Actions for </div > 
								<div style="width:200px;float:left">
									<select name="Responsibility{{$index}}" class="form-control ResponsibilitySelect{{$index}} has-float-label" ng-model="item.ResponsibilityArr" 
										ng-disabled="read"  multiple="multiple" ng-required="item.ResponsibilityType == 'Team'" 
										errmsg="Responsibility" >
										<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
									</select>
								</div>
								<div style="float:left">with status </div > 
								<div style="width:200px;float:left">
									<select name="Responsibility{{$index}}" class="form-control ResponsibilitySelect{{$index}} has-float-label" ng-model="item.ResponsibilityArr" 
										ng-disabled="read"  multiple="multiple" ng-required="item.ResponsibilityType == 'Team'" 
										errmsg="Responsibility" >
										<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
									</select>
								</div>
								<div style="float:left">updated after </div >
								<div style="width:100px;float:left">
									<input name="ComplectionDate{{$index}}" class="form-control ComplectionDate{{$index}}" type="text" required  errmsg="Completion Date"
		    							data-provider="datepicker" ng-model="item.ComplectionDate" ng-disabled="adminRead"  />

								</div>

 

								
							</div>
							
							<!--Open Meettings -->
							
							<!--Pending items -->
							<div class="col-md-12" style="padding:10px">
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>
										<tr style="background-color:silver;" ><th colspan="7">Pending items from previous {{actions[0].Title}} meeting</th></tr>						
										<tr style="background-color: #ffe6cc;">
											<th>Meetting Date</th>
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th></th>																							
										</tr>
									</thead>
									<tbody>
										<tr ng-repeat-start="it in pendingItems" ng-click="OnActionPointClick(it)" class="trHover">
										    <td>{{it.MeetingDate}}</td>
										    <td>{{it.ActionPointTitle}}</td>
										    <td>
										    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
										    </td>		
										    <td>
												{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
											</td>
																			
											<td >{{it.Status}}</td>																
											<td>{{it.ComplectionDate}}</td>
											<td>									
												<a target="_blank" href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionDetails/{{it.ID}}" >
													<i class="fa fa-edit" style="font-size: large" ng-class="lnk.Icon" aria-hidden="true"></i>											
												</a>
											</td>
										</tr>
										<tr ng-repeat-end ng-show="it.show">
										    <td colspan="6" style="border:0px;padding:0px">
										    	<div style="padding:4px; border-top:0px;border-left:5px   #FFFFFF solid;border-right:5px #FFFFFF solid;border-bottom:8px  #FFFFFF solid;background:#F0F0F0;font-weight:bold">
										    		{{it.ActionPoint}}
										    	</div>
										    									    										    	
										    </td>
										</tr>
									</tbody>
								</table>
							</div>							
							<!-- End of Pending items -->
							
							<!--Modified items -->
							<div class="col-md-12" style="padding:10px">
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>
										<tr style="background-color:silver;" ><th colspan="8">Modified items from {{actions[0].Title}} meeting</th></tr>						
										<tr style="background-color: #ffe6cc;">
											<th>Meetting Date</th>
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th style="width:100px">Last Update Date</th>	
											<th></th>																					
										</tr>
									</thead>
									<tbody>
										<tr ng-repeat-start="it in modifiedItems" ng-click="OnActionPointClick(it)" class="trHover">
										    <td>{{it.MeetingDate}}</td>
										    <td>{{it.ActionPointTitle}}</td>
										    <td>
										    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
										    </td>		
										    <td>
												{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
											</td>
																			
											<td >{{it.Status}}</td>																
											<td>{{it.ComplectionDate}}</td>
											<td>{{FormatDate(it.LastModifiedDate)}}</td>
											<td>									
												<a target="_blank" href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionDetails/{{it.ID}}" >
													<i class="fa fa-edit" style="font-size: large" ng-class="lnk.Icon" aria-hidden="true"></i>											
												</a>
											</td>
										</tr>
										<tr ng-repeat-end ng-show="it.show">
										    <td colspan="6" style="border:0px;padding:0px">
										    	<div style="padding:4px; border-top:0px;border-left:5px   #FFFFFF solid;border-right:5px #FFFFFF solid;border-bottom:8px  #FFFFFF solid;background:#F0F0F0;font-weight:bold">
										    		{{it.ActionPoint}}
										    	</div>
										    									    										    	
										    </td>
										</tr>
									</tbody>
								</table>
							</div>							
							<!-- End of Modified items -->

							
							<div class="col-md-12" style="padding:10px">																			
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>
										<tr style="background-color:silver;" ><th colspan="8">Other Actions in {{actions[0].Title}} meeting</th></tr>						
										<tr style="background-color: #ffe6cc;">
											<th>Meetting Date</th>
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th style="width:100px">Last Update Date</th>
											<th></th>																							
										</tr>
									</thead>
									<tbody>

									<tr ng-repeat-start="it in otherMeetings" ng-click="OnActionPointClick(it)" class="trHover">
									    <td>{{it.MeetingDate}}</td>
									    <td>{{it.ActionPointTitle}}</td>
									    <td>
									    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
									    </td>		
									    <td>
											{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
										</td>
																		
										<td >{{it.Status}}</td>																
										<td>{{it.ComplectionDate}}</td>
										<td>{{FormatDate(it.LastModifiedDate)}}</td>

										<td>									
											<a target="_blank" href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionDetails/{{it.ID}}" >
												<i class="fa fa-edit" style="font-size: large" ng-class="lnk.Icon" aria-hidden="true"></i>											
											</a>
										</td>
									</tr>
									<tr ng-repeat-end ng-show="it.show">
									    <td colspan="6" style="border:0px;padding:0px">
									    	<div style="padding:4px; border-top:0px;border-left:5px   #FFFFFF solid;border-right:5px #FFFFFF solid;border-bottom:8px  #FFFFFF solid;background:#F0F0F0;font-weight:bold">
									    		{{it.ActionPoint}}
									    	</div>
									    									    										    	
									    </td>
									</tr>
									
									</tbody>
								</table>													
							</div>
							
							<!--Other Meettings -->																						
						</div>
													  				   						   																    				    				    					    		
		    		</div>	    			    																																																	
		    	</div>
	    	</form>
	    	
	    

		</div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingViewDetailsCtrl.js```FileName```DocApp.controller('MeetingViewDetailsCtrl', function($scope, $interval,$location, $timeout,$routeParams) {

	 

	$scope.FormatDate = function(date){
		return new moment(date).format("DD-MMM-YYYY");
	}

	$scope.onBackClick = function(){		
		  MeetingShowFromListState = true;
		  MeetingUpdateListStateFilters = true;
		  		  
		  $location.path("MeetingView");
	}
	
	$scope.OnActionPointClick = function(o){			
		if(!o.show){
            o.show = true; 
        }
        else{
            o.show = false;
        }
	}
	
	


	$scope.GetResponsibility = function(rs){
    	var res = "";
    	if(rs){
    		oAl = angular.fromJson(rs)
    		$.each(oAl, function(id, val){
				res = res ? res + ", " : res;
				res += val;
				
			});

			//res =  "agg" + oAl.length;
		}
		return res ;
    }

			
	$scope.listCtrlOnLoad= function(){
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listDetailsOnLoadInit();
    	}, 1);

	}
	
	$scope.listDetailsOnLoadInit = function(){
					
		if(!LastListingPage){
			LastListingPage = "ActionTracker";
		}
			
				
		SetSideBar("Action Tracker Details", "Action Tracker");
		
		if($routeParams.itenId){
		
			
			
			
		
			var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID eq " + $routeParams.itenId;
			$scope.actions = GetListData(MeetingTrackerList , listFilter );
						
			if($scope.actions.length > 0 ){	
				
				//Get Last meeting date
				var filter = "&$filter=MeetingDate ne '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
					+"&$orderby=MeetingDate desc&$top=1";
				//var res1 = GetListData(MeetingTrackerList , filter );
				//debugger;
				
				$scope.subMeetings = [];		
				if($scope.actions[0].ID){				
						
						
					var filter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID"
						+ "&$filter=MeetingDate eq '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
						+ " and ActionType eq '" + encodeURIComponent($scope.actions[0].ActionType) + "' and Title eq '" + encodeURIComponent($scope.actions[0].Title) + "' "
						
						// or  LastModifiedDate
					/*	
					var MeetingDate =  "'" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'";
													
					var filter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID"
					filter += "&$filter=" + 
						"( MeetingDate eq " + MeetingDate  + " and   ActionType eq encodeURIComponent($scope.actions[0].ActionType))";
					
					*/
					
					$scope.subMeetings = GetListData(MeetingTrackerList , filter );
				}											
			}
			
			//pendingItems 
			$scope.otherMeetings = [];		
			var filter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID"
				+ "&$filter=(MeetingDate ne '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
				+ " and ActionType eq '" + encodeURIComponent($scope.actions[0].ActionType) + "' and Title eq '" + encodeURIComponent($scope.actions[0].Title) + "' ) "
				+ " and (  Status eq 'Not Started' or  Status eq 'In Progress'  ) ";
				+ "&$orderby=MeetingDate desc";									
			$scope.pendingItems = GetListData(MeetingTrackerList , filter );
			
			
			
			//latmeeting Date
			var lastMeetingDate = "";
			var filter = "$select=*,StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID"
				+ "&$filter=( MeetingDate ne '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
				+ " and ActionType eq '" + encodeURIComponent($scope.actions[0].ActionType) + "' and Title eq '" + encodeURIComponent($scope.actions[0].Title) + "' ) "				
				+ "&$orderby=MeetingDate desc&$top=1";
			var lastMeetingDet = GetFirstSPListItem(MeetingTrackerList , filter );
			var MeetingDate = "";
			if(lastMeetingDet){
				var MeetingDate = new moment(lastMeetingDet.MeetingDate).format('DD-MMM-YYYY') ;
			}
			

				
			
			//modifiedItems
			$scope.modifiedItems = [];		
			var filter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID"
				+ "&$filter=(MeetingDate ne '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
				+ " and ActionType eq '" + encodeURIComponent($scope.actions[0].ActionType) + "' and Title eq '" + encodeURIComponent($scope.actions[0].Title) + "' ) "
				+ " and LastModifiedDate ge '" + new moment().subtract(1, 'month').format("YYYY-MM-DD") + "T20:00:00Z'" ;
				+ "&$orderby=LastModifiedDate desc";									
			$scope.modifiedItems = GetListData(MeetingTrackerList , filter );

			
			
			$scope.otherMeetings = [];		
			var filter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID&$expand=RespPer/ID&$expand=Author/ID&$expand=StakeholderPer/ID"
				+ "&$filter=(MeetingDate ne '" + new moment($scope.actions[0].MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
				+ " and ActionType eq '" + encodeURIComponent($scope.actions[0].ActionType) + "' and Title eq '" + encodeURIComponent($scope.actions[0].Title) + "' ) "
				//+ " and (  Status eq 'Not Started' or  Status eq 'In Progress'  ) ";
				+ "&$orderby=MeetingDate desc";									
			$scope.otherMeetings = GetListData(MeetingTrackerList , filter );	
			
			
		}
		
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();


	}
	
	
	
	
		
});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingViewList.html```FileName```<style>

	.select2-input{
		border:0px  !important;
	}
	.select2-search-choice{
		font-size:small;font-weight:normal;margin:0px;padding-right:0px;margin:1px !important;;
	}
}
</style>

<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-3 main-header-title" >Action Tracker<span style="color:red;font-weight:bold"> UAT</span></div>	
		<div class=" col-md-9"></div>				
	</div>
	
	<!--div  class="row content  divPnlButton">
		<div class="col-md-10">
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew()" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Meeting
			</button>
		</div>
	</div-->
	
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/QButtons.html'" style="width:100%" ></div>
	
	 <div class="panel-body" >
	 	<div id="divDataTable" style="width:100%">
	 		<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">
		 		<thead>
					<tr>					
						<th class="hide">ID</th>
						<th style="width:80px" >Date</th>	
						<th style="width:150px">Meeting Name</th>								
					</tr>
				</thead>
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class="hide">ID</th>
						<th>Date</th>						
						<th>Meeting Name</th>						
		            </tr>
		        </tfoot>
		        <tbody>									
					<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
						<td class="hide">{{it.ID}}</td>	
						<td data-order="{{DateSer(it.MeetingDate)}}" >{{it.MeetingDate}}</td>		            						
						<td>{{it.Title}}</td>					
					</tr>				 	  
				</tbody>
			</table>			
	 	</div>
	 </div>	
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\MeetingViewListCtrl.js```FileName```DocApp.controller('MeetingViewListCtrl', function($scope, $interval,$location, $timeout,$routeParams) {

	$scope.ActionView = function(){
		window.location = "/" + SiteRelativeUrl + PagePath + "/ActionTracker/";
	}

	$scope.listCtrlOnLoad= function(){
		
		$scope.QuqueTitle = "Meeting View";
		
		LastListingPage = "MeetingView";
		
		SetSideBar("Action Tracker List", "Action Tracker");			
	
		$('#divOverlay').show();
		
		DestroyTable();
		
		var filter = "&$filter=ActionType eq 'Meeting'";
		var alst = GetListData(MeetingTrackerList , filter );
		
		var dl = [];
		$.each(alst, function(id, act){
			var exists = false;
			for(i=0;i<dl.length;i++){
				if( dl[i].MeetingDate == act.MeetingDate && dl[i].Title == act.Title ){
					exists = true;
					break;
				}
			}
			if(!exists){
				dl.push(act);
			}
		});

		$scope.dataList = dl;
		
		updateTable();
		
		$scope.isAdmin = true;
		UpdateQueue();

	}
	
	
	$scope.AddNew= function(type){
		window.location = "/" + SiteRelativeUrl + PagePath + "/NewAction/" + type;
	}

	
	$scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
    function updateTable(){	
        setTimeout(function(){ 	
                                                                    
            $('#main-ListTable').DataTable( {                        
               /*
				stateSave: true,
                stateSaveCallback: function(settings,data) {			      
                ListState = JSON.stringify(data);			     
                ShowFromListState = false;			      
                },
                stateLoadCallback: function(settings) {
                    if(ShowFromListState){
                        ShowFromListState = false;						
                        $.each(ListStateFilters, function(id, filt){
                                $('.DataTableFilterCol' + filt.col  ).val(filt.val);
                        });
                        
                        return JSON.parse(ListState);
                    }
                    else{
                        return "";
                    }					
                },
                 */
                                            
                "pageLength": 20,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],            
                "order": [[ 1, "dec" ]], 
                "autoWidth": false,                       
                initComplete: function () {            
                    this.api().columns().every( function (ColCount) {
                        if( ColCount == 2 ){

                            var title = this.header();
                            //replace spaces with dashes
                            title = $(title).html().replace(/[\W]/g, '-');
                            var column = this;
                            var select = $('<select id="DataTableFilterCol' + ColCount + '" multiple="multiple" style="width: 100%;" ></select>')
                                .appendTo( $(column.footer()).empty() )
                                .on( 'change', function () {
                                    //Get the "text" property from each selected data 
                                    //regex escape the value and store in array
                                    var data = $.map( $(this).select2('data'), function( value, key ) {
                                    return value.text ? '^' + $.fn.dataTable.util.escapeRegex(value.text) + '$' : null;
                                            });
                                    
                                    //if no data selected use ""
                                    if (data.length === 0) {
                                    data = [""];
                                    }
                                    
                                    //join array into string with regex or (|)
                                    var val = data.join('|');
                                    
                                    //search for the option(s) selected
                                    column
                                        .search( val ? val : '', true, false )
                                        .draw();
                                } );
            
                            column.data().unique().sort().each( function ( d, j ) {
                                select.append( '<option value="'+d+'">'+d+'</option>' );
                            } );
                            
                            $('#DataTableFilterCol' + ColCount ).select2();                                                    
                            
                        }//ColCount != 2
                        else{
                        
                            var column = this;
                            var v = '';							
                            var column = this;
                            var textSearch =  $('<input class="DataTableFilterCol' + ColCount + '" type="text" style="width=100%" id="DataTableText" />')
                                .appendTo( $(column.footer()).empty() )
                                
                                .on( 'propertychange change keyup paste input', function () {
                                
                                        $('.auctionListTable').DataTable()
                                            .search('').columns().search('').draw();
                                            var val = $.fn.dataTable.util.escapeRegex(
                                            $(this).val()
                                        );
                                        column
                                            .search( val )
                                            .draw();
                                
                                    });							                    
                        }                    
                    } );
                },
            } );
                    
            $('#main-ListTable').on("click", "tbody tr ", function(){	
            
                ListStateFilters = [];
                for(i=0;i<10;i++){
                    var filt = {};
                    filt.col = i;
                    if( i == 2 || i == 3 || i == 7 ){
                        filt.val = $('#DataTableFilterCol' + i  + "" ).val();
                    }
                    else{
                        filt.val = $('.DataTableFilterCol' + i  + "" ).val();
                    }
                    ListStateFilters.push( filt );	
                }
                            
                auctionReqstItemElem = $(this);
                
                var id = auctionReqstItemElem[0].children[0].textContent;

                //debugger;
                $scope.item = $scope.dataList[id]; 
                window.location = "/" + SiteRelativeUrl + PagePath  + "/MeetingViewDetails/" + id;				
                $scope.$apply();
            });
            
            $('#divOverlay').hide();
            $('#divDataTable').show();
            /*
            if(UpdateListStateFilters){			
            
                for(i=0;i<10;i++){
                    var filt = ListStateFilters[i];			      
                    if( i == 2 || i == 3 || i == 7 ){		
                                                                
                        $('#DataTableFilterCol' + i + "").val(filt.val);
                        $('#DataTableFilterCol' + i + "").select2();                    

                    }
                    else{
                        $('.DataTableFilterCol' + filt.col  ).val(filt.val);
                    }
                    ListStateFilters.push( filt );	
                }
                UpdateListStateFilters = false;
            } 
            */                                                
        }, 100);
    }	
    
    function UpdateQueue(){				
		UpdateResponsibilityConfig();		 	
		var queueConfig  = [];
		queueConfig.push({Title : "HoTM", Display : "HoTM" , color : "#4e73df", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
		queueConfig.push({Title : "ALM", Display : "ALM" , color: "#3BBEB4", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false });
		queueConfig.push({Title : "S&S", Display : "S&S" , color : "SaddleBrown", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		queueConfig.push({Title : "F&E", Display : "F&E" , color : "#f36c21", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
		queueConfig.push({Title : "BMS", Display : "BMS" , color : "darkolivegreen", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  });
		queueConfig.push({Title : "TTO", Display : "TTO" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		queueConfig.push({Title : "PI", Display : "PI" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
				
		queueConfig.push({Title : "Others", Display : "Others" , color : "#1cc88a", Count : 0,  TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		
		var othersItem = queueConfig.length-1;
		
		var filter = ",RespPer/Title,RespPer/Id,StakeholderPer/Title,StakeholderPer/Id&$expand=RespPer/ID,RespPer/Title&$expand=StakeholderPer/ID,StakeholderPer/Title";
		filter += "&$filter=Status ne 'Completed' and  Status ne 'Removed'";
		
		var aLst = GetListData(MeetingTrackerList , filter );
		
		$.each(aLst, function(aId, act){
			var other = true;
			if(act.ResponsibilityType == "Team" && act.Responsibility){
				
				$.each(queueConfig, function(qId, qu){	
					if(act.Responsibility.indexOf(qu.Title) > -1 ){
						qu.Count++;
						qu.TeamCount++;						
						other = false;
						qu.items.push(act);
						qu.temItems.push(act);
					}																
				});				
			}
			else if(act.ResponsibilityType == "Person" ){
				//Person
				
				$.each(act.RespPerId.results, function(id1, per){
					$.each(ResponsibilityList, function(id2, rspItm){
						$.each(rspItm.Users.results, function(id3, usr){
							if(usr.Id == per){
								for(i=0;i<queueConfig.length;i++){
									if(queueConfig[i].Title == rspItm.Title){
										queueConfig[i].Count++;
										queueConfig[i].IndCount++;
										other = false;
										queueConfig[i].items.push(act);
										queueConfig[i].indItems.push(act);
										break;
									}
								}
							}
						});
					});
				});
				
			}
									
			if(other){								
				//act.RespPerId.results
				queueConfig[othersItem].Count++;
				
				if(act.ResponsibilityType == "Team"){
					queueConfig[othersItem].TeamCount++;
					queueConfig[othersItem].temItems.push(act);
				}
				else{
					queueConfig[othersItem].IndCount++;
					queueConfig[othersItem].indItems.push(act);
				}
				
				queueConfig[othersItem].items.push(act);

			}
		});
				
		$scope.queueConfig  = queueConfig;
		debugger;
				 
	}


});	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\QButtons.html```FileName```<div class="row content divPnlQueue" ng-if="isAdmin">

	<div class="card  QButton" style="border-left: .50rem solid {{qu.color}} !important;" ng-repeat="qu in queueConfig" >
		<div class="row  QCard  " style="color:{{qu.color}};">
										
			<div class="col-md-3 dropdown" style="text-align:center;padding:0px;">							
				 <div class=" dropdown-toggle" data-toggle="dropdown" style="" >
				  <span class="caret"></span></div>
				  <ul class="dropdown-menu">
				    <li><a ng-click="QueueTaskListing(qu.Title, 'Individual' )" >Individual task({{qu.IndCount}})</a></li>
				    <li><a ng-click="QueueTaskListing(qu.Title, 'Team' )" >Team task({{qu.TeamCount}})</a></li>				    
				  </ul>
			</div>
			
			<div class="col-md-9" ng-click="QueueTaskListing(qu.Title, 'All' )"  >
				<span >{{qu.Display}}</span>
				<span class="badge QBqdge">{{qu.Count}}</span>
			</div>
			
		</div>
	</div>	
					
</div>

<div  class="row content  divPnlButton">
	<div class="col-md-10">
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew('Action')" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Action
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew('Meeting')" >
				<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Meeting
			</button>
			
			<!--button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" 
				 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
				Action View{{AllTasksCount}}
			</button-->
						
						
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="isAdmin"
				 ng-click="TaskListing('All Tasks')"  ng-class="GetButtonClass('All Tasks')" >
				All Actions{{AllTasksCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="!isAdmin"
				 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
				All Actions{{AllTeamTasksCount}}
			</button>


			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('Assigned by Me')"  ng-class="GetButtonClass('Assigned by Me')" >
				 Assigned by Me{{AssignedByMeTaskCount}}
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem"  ng-if="QuqueTitle != 'Meeting View' "
				 ng-click="MeetingView()"  ng-class="GetButtonClass('Meeting View')" >
				Meeting View
			</button>
			
			<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="QuqueTitle == 'Meeting View' "
				 ng-click="ActionView()"  ng-class="GetButtonClass('Action View')" >
				Action View
			</button>

	</div>
	
	<div class="col-md-2">								
				        
        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
        	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
        </button>
        
		 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="TaskListing(QuqueTitle)" title="Refresh">
            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
         </button>	
         
		<!--button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
        </button-->            				
	</div>	


</div-->```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\test.css```FileName``````File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\ActionDetails.html```FileName```
<style>
	

	.FormWTDCap {
		background: #deeaf6;
		height: 20px;
		padding-top: 3px;
		padding-left: 10px;
		border-bottom: 1px white solid;		
		
		
		font-size:14px !important;
		font-weight: 500 !important;
		
		
		font-family:"Segoe UI" !important;
		color: #212529 !important;
	}

	.FormWTDCapText {
		
		
		font-size:14px !important;
		font-weight: 500 !important;
		
		
		font-family:"Segoe UI" !important;
		color: #212529 !important;
	}



	.FormWTDVal {	
		height: 17px;
		
		background: white;
		padding-top: 3px;
		padding-left: 5px;
		
		
		background: #F9F9F9;
		border-bottom: 1px white solid;
		padding: 4px  !important;

		/*
		font-weight :600;
		color: black;
		*/

		font-size:14px !important;
		font-weight: 500 !important;
		font-family:"Segoe UI" !important;
		color:#212529 !important;		
	}

	.form-control{
		padding: 5px !important;
	}

	.select2-search-choice{
		margin: 5px 1px 5px 5px !important;
	}

	.sp-peoplepicker-topLevel{
		border-radius: 4px;
		margin-left: 2px;margin-right: 2px;
		width: 890px !important;		
	}



</style>

<div>
	<table class="table table-bordered">
		<tr>	 
			<td class="FormWTDCap" style="width: 150px !important;" > Date</td>
			<td class="FormWTDVal" style="width: 150px !important;" >
				{{item.StartDate}}
			</td>

			<td class="FormWTDCap" style="width: 150px !important;" >Meeting Name<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></td>
			<td class="FormWTDVal" colspan="3"  style="width: 450px !important;">
				<span ng-if=" item.ActionType == 'Meeting' " >{{item.ActionName}}</span>
				<select ng-if=" item.ActionType == 'Adhoc' " name="ActionName" class="form-control" ng-model="item.ActionName" ng-disabled="read" required  >
					<option ng-repeat="m  in AdhocMeetingNameList">{{m}}</option>											 						
				</select>
				<p ng-show="(se || af.ActionName.$touched) && af.ActionName.$invalid " class="text-danger">Action Type required.</p>				
			</td>		
	    </tr>


		<tr>	     
			<td class="FormWTDCap">Action Point<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></td>
			<td class="FormWTDVal" colspan="3">
				<!-- {{item.Title}} -->
				<input name="Title" class="form-control Title" type="text" maxlength="70"
					data-provider="datepicker" ng-model="item.Title" ng-disabled="read"  required errmsg="Action Point Title"/>		    								
				<p ng-show="(se || af['Title'].$touched) && af['Title'].$invalid " class="text-danger">Action Point Title required.</p>
				<div style="text-align: right;padding: 0px 10px;">{{item.Title.length}}/70</div>
			</td>
	    </tr>
		<tr>	     
			<td class="FormWTDCap">Details</td>
			<td class="FormWTDVal" colspan="3" >
				<!-- {{item.Description}} -->
				<textarea  name="Description" id="Description" ng-model="item.Description" ng-disabled="read"  class="form-control" errmsg="Details"
					style="height:70px !important"    maxlength="1000"
					></textarea>							
				<p ng-show="(se || af.Description.$touched) && af.Description.$invalid " class="text-danger">Description required.</p>
				<div style="text-align: right;padding: 0px 10px;">{{item.Description.length}}/1000</div>
			</td>
	    </tr>
		
	    <tr>	      
			<td class="FormWTDCap">Responsibility<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></td>
			<td class="FormWTDVal" colspan="3" >
				<div class="row" style="margin-left: 0px;">
					<div style="float: left;">
						<select style="width: 100px;float: left !important;" id="ResponsibilityType" name="ResponsibilityType" class="form-control" ng-model="item.ResponsibilityType" ng-disabled="read"  required  errmsg="Responsibility Type" >
							<option selected="selected"  value="Team" >Team</option>
							<option  value="Person" >Person</option>						
						</select>
					</div>
					<div style="float: left;width: 895px">
						
						<div ng-show="!read && item.ResponsibilityType == 'Person' " id="RespPerDiv"></div>
						<div ng-show=" read && item.ResponsibilityType == 'Person' " ng-repeat="rm in item.RespPer.results" 
							style="float:left;border:1px silver solid;padding-left:7px;padding-right:7px;background:white;height:35px;padding-top:10px;width: 500px;">{{rm.Title}}</div>	

						<select style="padding-top: 1px !important;padding-left: 1px !important;"  name="ResponsibilitySelect" class="form-control ResponsibilitySelect has-float-label" ng-model="item.ResponsibilityArr"  
							ng-disabled="read"  multiple="multiple" ng-required="item.ResponsibilityType == 'Team'" style="padding-top: 1px !important;padding-left: 1px !important;"
							errmsg="Responsibility" ng-show="item.ResponsibilityType == 'Team' " >
							<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
						</select>

						
					</div>
				</div>
			</td>				
		</tr>
		<tr>	      
			<td class="FormWTDCap">Stakeholder</td>

			<td class="FormWTDVal" colspan="3" >
				<div class="row" style="margin-left: 0px;">
					<div style="width: 100px;float: left;">
						<select name="StakeholderType" class="form-control" ng-model="item.StakeholderType" ng-disabled="read"  >
							<option selected ></option>
							<option  value="Team" >Team</option>
							<option  value="Person" >Person</option>						
						</select>	
					</div>
					<div style="float: left;width: 895px">

						<div ng-show="!read && item.StakeholderType == 'Person' "  id="StakeholderPerDiv"></div>
						<div ng-show=" read && item.StakeholderType == 'Person' " ng-repeat="rm in item.StakeholderPer.results" 
							style="float:left;border:1px silver solid;padding-left:27px;padding-right:7px;background:white;height:35px;padding-top:10px;border-radius: 2px !important;">{{rm.Title}}</div>
				
						<select ng-show="item.StakeholderType == 'Team' " name="StakeholderSelect" class="form-control StakeholderSelect" 
							style="padding-top: 1px !important;padding-left: 1px !important;"  
							ng-model="item.StakeholderArr" ng-disabled="read"  multiple="multiple"   errmsg="Stakeholder" >
							<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
						</select>	
						
					</div>
				</div>	
			</td>			
	    </tr>
		<tr>
			<td class="FormWTDCap" style="width: 150px !important;">Status</td>
			<td class="FormWTDVal" style="width: 150px !important;" >
				
				<select name="Status" class="form-control" ng-model="item.Status" ng-disabled="read"  required errmsg="Status" >
					<option  value="Not Started" >Not Started</option>
					<option  value="In Progress" >In Progress</option>
					<option  value="Completed" >Completed</option>
					<option  value="Removed" >Removed</option>							
				</select>
			</td>

			<td class="FormWTDCap" style="width: 150px !important;;">Target Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></td>
			<td class="FormWTDVal"  >
				<input name="ComplectionDate" class="form-control ComplectionDate" type="text" required  errmsg="Target Date"
					data-provider="datepicker" ng-model="item.ComplectionDate" ng-disabled="adminRead"  
					style="width: 150px !important;"/>
				<p ng-show="(se || af['ComplectionDate'].$touched) && af['ComplectionDate'].$invalid " class="text-danger">Target Date required.</p>
		
			</td>
			
		</tr>
		
	</table>
</div>



<div class="row form-group"  ng-show="ShowComment" >
	<div class="col-md-12">
		<label for="CurrentComment">Update</label>					   					    
		<textarea  name="CurrentComment" id="CurrentComment" ng-model="item.CurrentComment" ng-disabled="read"  class="form-control" errmsg="CurrentComment"
		style="height:70px !important"    maxlength="500"
			></textarea>
		<div style="text-align: right;padding: 0px 10px;">{{item.CurrentComment.length}}/500</div>					 
		</div>					
</div>

	
	
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/Buttons.html'" style="width:100%" ></div>
	
	<style>

		.card-note {
		    background: #fff7dd !important;
		    border-color: #fff1c9 !important;
		    
		}
		.card-title{
			font-size:14px !important;
			font-weight: 500 !important;
			color:#212529 !important;
			font-family:"Segoe UI"

		}
		.card-text{
			font-size:14px !important;
			font-weight: 400 !important;
			font-family:"Segoe UI" !important;
			color:black !important;
		}

		


	 .btn-rounded{
		border-radius: 50px;
		margin: 0px;
		padding: 0px;
		text-align: center;		
		width: 30px;height: 30px;
		border: #9c8aa7 solid 5px;

    	/* box-shadow: 0px 0px 4px 2px #442157;    */
    	color: #fff;
    	background-color: #9c8aa7;
    	
		font-size: 24px  !important;
	}
	.btn-rounded:hover{
		background-color: #914bb8  !important;	
		border: #914bb8 solid 5px;
	}
					
	</style>	
	<!-- <div class="row" style="height: 40px;">
		<span style="float: left;margin-left: 30px;font-size: 20px;font-weight: 600;font-family: Segoe UI;border-right-width: 30px;margin: 3px 6px 0px 25px ;">
			Updates</span>	
		<i class="fa  fa-plus btn-rounded" style="padding: 0px;margin: 3px;" aria-hidden="true" 
		ng-click="ShowAddUpdate()"></i>
	</div> -->

	
	<!-- Modal -->
	<div class="modal fade" id="addUpdateModal" role="dialog">
		<div class="modal-dialog modal-lg">
		  <div class="modal-content">
			<div class="modal-header">
			  <button type="button" class="close" data-dismiss="modal">&times;</button>
			  <h4 class="modal-title">Modal Header</h4>
			</div>
			<div class="modal-body">
			  <p>This is a large modal.</p>
			</div>
			<div class="modal-footer">
			  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		  </div>
		</div>        
	  </div>

	<div class="card card-note" style="margin-bottom:8px;padding:2px !important" ng-repeat="it in item.AuditLog" ng-if="it.TaskID">
		<div class="card-body" style="padding:2px !important;">
			
			<div class="row">
				<div class="col-md-6" ><h5 class="card-title">{{it.ActionBy.Title}}</h5></div>
				<div class="col-md-6 " style="text-align:right"><h5 class="card-title">{{FormatDate(it.ActionTime)}}</h5></div>		
			</div>
			
			<div class="row ">
				<div class="col-md-12 " ><p class="card-text">{{it.Status == 'Completion Date change' ?  'Completion Date ' : '' }}{{ it.Status == 'Initiation' ? it.Status : it.Comment  }}</p></div>
			</div>
		</div>		
	</div>




```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\ActionModel.html```FileName```<div tabindex="7" id="ReqDetailsModal" class="modal fade " role="dialog" data-keyboard="false" data-backdrop="static">
	<div class="modal-dialog " style="width:1200px">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">×</span>
				</button>
				<h4 class="modal-title"><span id="modalManageReportHeading"></span>Action Details AT<span style="color:orange;font-weight:bold" class="ng-binding">  AT{{item.ID}}</span></h4>
				<span class="hide" id="spRequestItemId"></span>
				<span class="hide" id="spRequestTenorText"></span>
			</div>
			<!-- End Modal content-->
			
			<!-- Modal body-->
			<div class="modal-body">
			
				<div class="panel panel-default" style="margin-bottom: 5px;">
                <div class="panel-body" style="margin-bottom:10px">
                
	                 <div class="alert alert-danger saveQueryAlert hide" ></div>
	                      <!--ul class="nav nav-tabs" >
	                        <li class="active"><a  style="padding:5px 25px;width:150px;text-align:center" target="_self" data-toggle="tab" href="#meetActionDetails">Action Details</a></li>                      
	                        <li class=""><a style="padding:5px 15px;width:150px;text-align:center" target="_self" data-toggle="tab" href="#meetHistory">History</a></li> 	                       	                                            	                        
	                      </ul-->
	                      <div class="tab-content mngQueryTabs" style="background-color: transparent;border: none;">
	                        
	                        <div id="meetActionDetails" class="tab-pane fade in active">	                        		                        	
	                        	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/ActionDetails.html'" style="width:100%" ></div>	                        	
	                        </div>
		                        	                      
	                        <div id="meetHistory" class="tab-pane fade padd15">
	                        	                        
	                        </div>	 

	                      </div>

	                      
	                      
	                      
	                 </div>	                 
	            </div>	          				
			</div>
		</div>
	</div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\ActionModel_copy(1).html```FileName```
<div id="ReqDetailsModal" class="modal fade" role="dialog" data-keyboard="false" data-backdrop="static">
  <div class="modal-dialog modal-lg">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
           <span aria-hidden="true">×</span>
        </button>
        <h4 class="modal-title"><span id="modalManageReportHeading"></span>Task Details</h4>
        <span class="hide" id="spRequestItemId"></span>
        <span class="hide" id="spRequestTenorText"></span>
      </div>
      <!-- End Modal content-->

      <div class="modal-body">
          <div class="panel panel-default" style="margin-bottom: 5px;">
            <div class="panel-body">
             <div class="alert alert-danger saveQueryAlert hide">ooooooooooo
             </div>
             
              <ul class="nav nav-tabs" style="font-size:14px">
                <li class="active"><a href="#section1">Request Details</a></li> 
                <li class="active"><a href="#section2">Comments</a></li>
                <li class="active"><a href="#section3">Audit Log</a></li>                                             
              </ul>
              
              <div class="tab-content mngQueryTabs" style="background-color: transparent;border: none;">
                
                <div id="fdRequestDetails" class="tab-pane fade in active">
                	<div class="detailsPannel" >
                		
						<div id="section1" class="container-fluid">
						  <h1 style="color:black">Section 1</h1>
						  <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
						  <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
						</div>
						<div id="section2" class="container-fluid">
						  <h1 style="color:black">Section 2</h1>
						  <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
						  <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
						</div>
						<div id="section3" class="container-fluid">
						  <h1 style="color:black">Section 3</h1>
						  <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
						  <p>Try to scroll this section and look at the navigation bar while scrolling! Try to scroll this section and look at the navigation bar while scrolling!</p>
						</div>
           		                         		 
                	</div>
                	
                	
                </div>                                              
              </div>
              
              
             </div>
          </div>
      </div>
    </div>
  </div>
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\ActionTable.html```FileName```<div class="row main-data" >							
	<div class="panel panel-default" style="width: 100%;" >
	
		<div class="panel-heading item-panel-heading" ng-if="QueueTitle =='All Tasks' || QueueTitle =='Teams Combaind Tasks'  || QueueTitle =='Assigned by Me' ">  									
			<ul class="nav nav-tabs ullandingPageTabs" style="border-bottom:0px" id="ullandingPageTabs">
	    		<li class="active auctionCommentsTab lilandingPageTabs" id="lilandingPageTabs1" ><a class="gridTabButton" name="Pending" data-toggle="tab" href="#tabAllOrders" target="_self">Pending<span class="badge QBqdge">{{AllTasksCountPending}}</span></a></li>
	    		<li class="lilandingPageTabs" id="lilandingPageTabs2" ><a class="gridTabButton" name="Completed" data-toggle="tab" href="#tabActiveOrders" target="_self">Completed<span class="badge QBqdge">{{AllTasksCountCompleted}}</span></a></li>  
	    		<li class="lilandingPageTabs" id="lilandingPageTabs3" ><a class="gridTabButton" name="Removed" data-toggle="tab" href="#tabActiveOrders" target="_self">Removed<span class="badge QBqdge">{{AllTasksCountRemoved}}</span>	</a></li>  
	    		<li class="lilandingPageTabs" id="lilandingPageTabs4" ><a class="gridTabButton" name="All" data-toggle="tab" href="#tabActiveOrders" target="_self">All<span class="badge QBqdge">{{AllTasksCountAll}}</span></a></li>  		    					    		
	    	</ul>   
		</div>
		
		<div class="panel-body" >
			<div id="divDataTable" style="width:100%">
				<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
					<thead>
						<tr>					
							<th class="hide">ID</th>							
							<th style="width:80px" >Date</th>	
							<th style="width:70px">Action Type</th>
							<th style="width:150px">Meeting Name</th>
							<th>Action Point</th>								
							<th style="width:150px">Responsibility</th>	
							<th style="width:150px">Stakeholder</th>
							<th style="width:80px;padding-left:0px !important;padding-right:8px !important">Last Update</th>						
							<th style="width:80px;padding-left:0px !important;padding-right:8px !important">Target Date</th>									
							<th style="width:70px">Status</th>			
						</tr>
					</thead>
					
					<tfoot class="ttcpFooter">
						<tr class="ttcpFtrTrCompleted">	
							<th class="hide">ID</th>							
							<th>Date</th>	
							<th>Action Type</th>
							<th>Meeting Name</th>
							<th>Action Point</th>								
							<th>Responsibility</th>	
							<th>Stakeholder</th>	
							<th>Last Update Date</th>				
							<th>Target Date</th>								
							<th>Status</th>			
						</tr>
					</tfoot>		        		        
					<tbody>									
						<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'" ng-click="OnItemClick('ActionList', '', it.ID)">	
							<td class="hide">{{it.ID}}</td>								
							<td data-order="{{DateSer(it.MeetingDate)}}" >{{it.StartDate}}</td>		            	
							<td>{{it.ActionType}}</td>
							<td>{{it.ActionName}}</td>
							<td data-order="{{it.TaskID}}" ><span style="color:orange;font-weight:bold">AT{{it.ID}}</span> {{it.Title}}</td>								
							<td>
								{{ GetResponsibility(it.Responsibility) }}
								<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>		
							</td>
							
							<td>
								{{ GetResponsibility(it.Stakeholder) }}
								<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
							</td>
							<td data-order="{{DateSer(FormatDate(it.LastModifiedDate))}}" >{{FormatDate(it.LastModifiedDate)}}</td>					
							<td data-order="{{DateSer(it.ComplectionDate)}}" >{{it.ComplectionDate}}</td>								
							<td ng-style="{ 'background-color': MeetingStatus(it) }" >{{it.Status}}</td>	
						</tr>				 	  
					</tbody>									
				</table>
			</div>
		</div>
	</div>

</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\AppCouter.js```FileName```function GetActionTrackerCount(obj, team){
    var res = 0;
    for(i=0;i<obj.length;i++){
        if(obj.Title == team){
            res = obj.Count;
            break;
        }
    }
    return res;
}



/*

<script type="text/javascript" src="/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/AppCouter.js?v=1"></script>

try{
    $scope.ATCount = GetCurrentUserActionCount(); 
}catch(Ex){}

<button type="button" class="btn" 
onclick="window.open('https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionTracker','_blank')">
Action Tacker({{ATCount}})
</button>

*/

function GetCurrentUserActionCount(){


    var tasksCount = 0;

    //UpdateResponsibilityConfig
    var IndiviualTaskFilter = "";
	var IndiviualStakeHolderFilter = "";
	
	var ResponsibilityList = []
	var currentUserResp = []
	var filter = ",Users/Title,Users/Id&$expand=Users/ID,Users/Title"; 
	var resp = GetListData("ActionResponsibilityList", filter);
	
	$.each(resp, function(id, val){
		var v = val;
		if(val.Users.results){
			for(i=0;i<val.Users.results.length;i++){
				if(val.Users.results[i].Id == _spPageContextInfo.userId ){
					currentUserResp.push(val.Title);
					
					$.each(val.Users.results , function(uId, uVal){
						
						if(IndiviualTaskFilter ){
							IndiviualTaskFilter  += " or  ";
						}							
						IndiviualTaskFilter += "RespPer/Id eq " + uVal.Id; 
						
						if(IndiviualStakeHolderFilter){
							IndiviualStakeHolderFilter += " or  ";
						}							
						IndiviualStakeHolderFilter += "StakeholderPer/Id eq " + uVal.Id;
						
					});
					
					
					break;
				}
			}
		}
		
		if(	val.Title != 'Admin'){
			ResponsibilityList.push(val);
		}				
	});
    //End of UpdateResponsibilityConfig

    
    var isAtAdmin = false;	
   
    if( currentUserResp.includes("Admin") ){
        var isAtAdmin = true;			
    }

    if(isAtAdmin){
        tasksCount = GetListItemsCount("ActionTackerTaskListProd", "Status", "Status ne 'Completed'  and  Status ne 'Removed'") ;
    }
    else{
        filter = "";			
        $.each(currentUserResp , function(id, rval){
            if(rval){
                if(filter){
                    filter += " or  ";
                }
                else{
                    //filter = "&$filter=";
                }
                filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
                
                //Stakeholder all task
                filter += " or substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
            }								
        });	
        filter = filter + " or " + IndiviualTaskFilter;			
        //Stakeholder all task
        filter = filter + " or " + IndiviualStakeHolderFilter; 
        if(filter){
            filter = "( " + filter +  " ) and Status ne 'Completed' and  Status ne 'Removed'"; //and ( Status ne 'Completed') ";            
        }
        else{
            filter = " Status ne 'Completed' and  Status ne 'Removed'  ";
        }
        tasksCount = GetATListItemsCount("ActionTackerTaskListProd", "Status", filter );
    }

    return tasksCount;

}

function GetATListItemsCount(ListTitle, FieldTitle, filter) {

	
	var count = [];
	var URL = _spPageContextInfo.siteAbsoluteUrl  + "/FX/_api/web/lists/GetByTitle('" + ListTitle + "')/items?$top=5000&$select=" + FieldTitle;

	if (filter) {
		URL += "&$filter=" + filter;
	}	 
	
	$.ajax({    
		url: URL,
		    type: "GET",
		async: false,
		    headers: {      
			"accept": "application/json;odata=verbose",
			    
		},
		    success: function(data)      {
			if (data.d.results) {       
				//alert(data.d.results.length);
				count=data.d.results.length;
			}    
		},
		    error: function(error) {      			
		}  
	});

	return count;
}

function UpdateActionTrackerQueueCount(){				
   
    UpdateResponsibilityConfig();

    var ActionTackerTaskList = "ActionTackerTaskListUAT"; 

    var queueConfig  = [];
    queueConfig.push({Title : "HoTM", Display : "HoTM" , color : "#4e73df", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
    queueConfig.push({Title : "ALM", Display : "ALM" , color: "#3BBEB4", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false });
    queueConfig.push({Title : "S&S", Display : "S&S" , color : "SaddleBrown", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
    queueConfig.push({Title : "F&E", Display : "F&E" , color : "#f36c21", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
    queueConfig.push({Title : "BMS", Display : "BMS" , color : "darkolivegreen", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  });
    queueConfig.push({Title : "TTO", Display : "TTO" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
    queueConfig.push({Title : "PI", Display : "PI" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
                                    
    queueConfig.push({Title : "Others", Display : "Others" , color : "#1cc88a", Count : 0,  TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
    
    var othersItem = queueConfig.length-1;
    
    var filter = ",RespPer/Title,RespPer/Id,StakeholderPer/Title,StakeholderPer/Id&$expand=RespPer/ID,RespPer/Title&$expand=StakeholderPer/ID,StakeholderPer/Title";
    filter += "&$filter=Status ne 'Completed' and  Status ne 'Removed'";
    
    var aLst = GetListData(ActionTackerTaskList , filter );
    
    $.each(aLst, function(aId, act){
        var other = true;
        if(act.ResponsibilityType == "Team" && act.Responsibility){
            
            $.each(queueConfig, function(qId, qu){	
                if(act.Responsibility.indexOf(qu.Title) > -1 ){
                    qu.Count++;
                    qu.TeamCount++;						
                    other = false;
                    qu.items.push(act);
                    qu.temItems.push(act);
                }																
            });				
        }
        else if(act.ResponsibilityType == "Person" ){
            //Person
            
            $.each(act.RespPerId.results, function(id1, per){
                $.each(ResponsibilityList, function(id2, rspItm){
                    $.each(rspItm.Users.results, function(id3, usr){
                        if(usr.Id == per){
                            for(i=0;i<queueConfig.length;i++){
                                if(queueConfig[i].Title == rspItm.Title){
                                    queueConfig[i].Count++;
                                    queueConfig[i].IndCount++;
                                    other = false;
                                    queueConfig[i].items.push(act);
                                    queueConfig[i].indItems.push(act);
                                    break;
                                }
                            }
                        }
                    });
                });
            });
            
        }
                                
        if(other){								
            //act.RespPerId.results
            queueConfig[othersItem].Count++;
            
            if(act.ResponsibilityType == "Team"){
                queueConfig[othersItem].TeamCount++;
                queueConfig[othersItem].temItems.push(act);
            }
            else{
                queueConfig[othersItem].IndCount++;
                queueConfig[othersItem].indItems.push(act);
            }
            
            queueConfig[othersItem].items.push(act);

        }
    });
            
    return queueConfig;		
             
}```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\Buttons.html```FileName```<div class="row" id="ButtonDiv" style="margin:1px 10px 20px 1px !important;">
	
	<div class="text-danger" style="font-weight:bold;width:100%;padding-top:3px;padding-left:20px">{{ErrorMessage}}</div>
		
	<div style="float:left;padding:5px" ng-show="ShowSaveButton" >		
		<button style="margin:0px !important;padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnSave()" >			
			Save
		</button>									
	</div>

	<div style="float:left;padding:5px"  >		
		<button style="margin:0px !important;padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnCloseActionModel()" >			
			Back to Queue
		</button>									
	</div>


</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\Meeting.html```FileName```

<form name="myForm"></form>

<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="MeetingDetailOnLoad()" >
	<div class="panel panel-default" style="width: 100%">
		<div class="panel-heading item-panel-heading" >      	    				
    		<div class="pannel-header">    	
				<div class="main-header-title col-md-11">Meeting Details<span style="color:red;font-weight:bold"> UAT</span></div>				
				<button type="button" class="close col-md-1 " ng-click="onBackClick('Meeting')"  aria-label="Close" style="float:right;color: #462157 !important;width:70px;font-size:34px">
           			<span aria-hidden="true">×</span>
        		</button>	        						   		
    		</div>
		</div>
		
		<div class="meeting-panel-body">
			<form name="af1" novalidate>	    	    
		    	<div class="tab-content pageTabContentStyles" >    	    		    			    		    			    		
		    		<div id="tabDetails" class="tab-pane fade in active"  >	

						<!--Buttons-->
						
						<div class="row" id="ButtonDiv" style="margin:1px 10px 0px 1px !important;">
							
							<div class="text-danger" style="font-weight:bold;width:100%;padding-top:3px;padding-left:20px">{{MeetingErrorMessage}}</div>
								
							<div style="float:left;padding:10px"   >		
								<button  type="button" class="btn  btn-sm  EI-ButtonPurple" 
									ng-click="onBtnSaveMeeting()"
									ng-disabled="!(Title && StartDate && (MeetingMinutes || meeting.TypeID ))" >			
									Save
								</button>									
							</div>
							<!-- ng-disabled="!(Title && StartDate)"  -->
							<div style="float:left;padding:10px"    >		
								<button  type="button" class="btn btn-sm  EI-ButtonPurple"
                                 ng-click="OnItemClick('Meeting', 'Meeting')" 								 
								 ng-disabled="!(Title && StartDate && (MeetingMinutes || meeting.TypeID ))">			
								 	Add Action
                                </button>								
							</div>																										
							<div style="float:left;padding:10px">	
								<button  type="button" class="btn  btn-sm EI-ButtonPurple" 
									ng-click="onBackClick('Meeting')" >						 
									Back to Queue
								</button>				 		
							</div>													
						</div>
						
						<!--end of Buttons-->
		    									
		    			<div class="row content divPnlSrchRsltCharts" >
		    				<div class="col-md-12 divSubHeading" >Meeting Details</div>
	
                            <div class="form-group input-group col-md-4 HedgeDivCol">
								<label class="form-group has-float-label">

									<select name="Title" class="form-control" ng-model="Title"  required 
										ng-disabled="meeting.TypeID" >  <!-- ng-change="loadMeeting()"  -->
                                        <option ng-repeat="m  in MeetingNameList">{{m}}</option>											 						
                                    </select>

								    <span>Meeting Name<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
								     <!-- <p ng-show="(se || af.Title.$touched) && af.Title.$invalid " class="text-danger">Meeting Name required.</p> -->
								</label>										 
							</div>

						 	<div class="form-group input-group col-md-4 HedgeDivCol" >
							  <label class="has-float-label">
							    <input name="StartDate" class="form-control StartDate" type="text"
							    	data-provider="datepicker" ng-model="StartDate" ng-disabled="meeting.TypeID" />
							    <span>Meeting Date<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
							    <!-- <p ng-show="(se || af.StartDate.$touched) && af.StartDate.$invalid " class="text-danger">Meeting Date required.</p> -->
							  </label>	 
							</div>
							
																		
							
							
							<div class="form-group input-group col-md-12 HedgeDivCol" id="MeetingMinutes">
								<label class="form-group has-float-label FormLabel">									
									<textarea  name="Description" id="MeetingMinutes" ng-model="MeetingMinutes"  class="multiLineInput" 
										 errmsg="Meeting Minutes"
										 ng-disabled="disableEditMeeting"
										 style="min-height: 100px !important;" 
										 ></textarea>		
										<span>Meeting Minutes<i class="fa fa-asterisk mandatory " aria-hidden="true"></i></span>
									
								</label>										 
							</div>
							
							<div class="col-md-12" style="padding:10px" >																			
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>						
										<tr style="background-color: #ffe6cc;">
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th style="width:100px">Last Update</th>																				
										</tr>
									</thead>
									<tbody>										
									<tr ng-repeat="it in meetingTasks " ng-click="OnItemClick('Meeting', '', it.TaskID)" class="trHover"
										ng-show="it.TaskID" >
									    <td><span style="color:orange;font-weight:bold">AT{{it.TaskID}}</span> {{it.Title}}</td>
									    <td>
									    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
									    </td>		
									    <td>
											{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
										</td>
																		
										<td >{{it.Status}}</td>																
										<td>{{it.ComplectionDate}}</td>
										<td>{{it.TaskModifiedTime}}</td>
									</tr>

									<tr ng-repeat="it in newActList"  class="trHover" ng-click="OnItemClick('Meeting', '', '', $index )">
										<td>{{it.Title}}</td>
										<td>
											{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
										</td>		
										<td>
											{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
										</td>
																		
										<td >{{it.Status}}</td>																
										<td>{{it.ComplectionDate}}</td>
										<td>{{it.TaskModifiedTime}}</td>										
									</tr>																		
									</tbody>
								</table>													
							</div>	
                            
                            <!-- <div class="col-md-12" ng-show="Title && StartDate"  >		
                                <button style="padding:5px;float:right" type="button" class="btn btn-sm  EI-ButtonPurple"
                                 ng-click="OnItemClick('Meeting', 'Meeting')" >			
                                    Add New Acttion
                                </button>									
                            </div> -->

							<!--OtherTasks -->
							<div class="col-md-12" style="padding:10px">
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>
										<tr style="background-color:silver;" ><th colspan="7">
											<span style="float: left;padding: 3px 2px 2px 3px;">Pending tasks/tasks modified after </span>

											<input style="width: 100px;float:left;padding: 5px !important;height: 20px !important;margin-top: 0px;"
											 name="oneMothBackDateCtrl" class="form-control oneMothBackDateCtrl" type="text"
											data-provider="datepicker" ng-model="oneMothBackDate" ng-change="loadMeeting()" />

											<span style="float: left;padding: 3px 2px 2px 3px;"> from other {{Title}} meeting</span>
										</th></tr>						
										<tr style="background-color: #ffe6cc;">
											<th>Meetting Date</th>
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th style="width:100px">Last Update</th>																							
										</tr>
									</thead>
									<tbody>
										<tr ng-repeat="it in otherTasks"  class="trHover" ng-click="OnItemClick('Meeting', '', it.TaskID)" ng-show="it.TaskID" >
										    <td>{{it.StartDate}}</td>
											<td><span style="color:orange;font-weight:bold">AT{{it.TaskID}}</span> {{it.Title}}</td>
										    <td>
										    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
										    </td>		
										    <td>
												{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
											</td>
																			
											<td >{{it.Status}}</td>																
											<td>{{it.ComplectionDate}}</td>
											<td>{{it.TaskModifiedTime}}</td>
											
										</tr>
										
									</tbody>
								</table>
							</div>
							<!--End of OtherTasks -->
							
							<!-- <div class="col-md-12">
								<div style="float:left">Other Actions for </div > 
								<div style="width:200px;float:left">
									<select name="Responsibility{{$index}}" class="form-control ResponsibilitySelect{{$index}} has-float-label" ng-model="item.ResponsibilityArr" 
										ng-disabled="read"  multiple="multiple" ng-required="item.ResponsibilityType == 'Team'" 
										errmsg="Responsibility" >
										<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
									</select>
								</div>
								<div style="float:left">with status </div > 
								<div style="width:200px;float:left">
									<select name="Responsibility{{$index}}" class="form-control ResponsibilitySelect{{$index}} has-float-label" ng-model="item.ResponsibilityArr" 
										ng-disabled="read"  multiple="multiple" ng-required="item.ResponsibilityType == 'Team'" 
										errmsg="Responsibility" >
										<option ng-repeat="re  in ResponsibilityList">{{re.Title}}</option>						
									</select>
								</div>
								<div style="float:left">updated after </div >
								<div style="width:100px;float:left">
									<input name="ComplectionDate{{$index}}" class="form-control ComplectionDate{{$index}}" type="text" required  errmsg="Completion Date"
		    							data-provider="datepicker" ng-model="item.ComplectionDate" ng-disabled="adminRead"  />

								</div> >

 

								
							</div-->
							
							<!--Open Meettings -->
							
							
							<!-- End of Pending items -->
							
							<!--Modified items -->
							<!-- <div class="col-md-12" style="padding:10px">
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>
										<tr style="background-color:silver;" ><th colspan="8">Modified items from {{actions[0].Title}} meeting</th></tr>						
										<tr style="background-color: #ffe6cc;">
											<th>Meetting Date</th>
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th style="width:100px">Last Update Date</th>	
											<th></th>																					
										</tr>
									</thead>
									<tbody>
										<tr ng-repeat-start="it in modifiedItems" ng-click="OnActionPointClick(it)" class="trHover">
										    <td>{{it.MeetingDate}}</td>
										    <td>{{it.ActionPointTitle}}</td>
										    <td>
										    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
										    </td>		
										    <td>
												{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
											</td>
																			
											<td >{{it.Status}}</td>																
											<td>{{it.ComplectionDate}}</td>
											<td>{{FormatDate(it.LastModifiedDate)}}</td>
											<td>									
												<a target="_blank" href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionDetails/{{it.ID}}" >
													<i class="fa fa-edit" style="font-size: large" ng-class="lnk.Icon" aria-hidden="true"></i>											
												</a>
											</td>
										</tr>
										<tr ng-repeat-end ng-show="it.show">
										    <td colspan="6" style="border:0px;padding:0px">
										    	<div style="padding:4px; border-top:0px;border-left:5px   #FFFFFF solid;border-right:5px #FFFFFF solid;border-bottom:8px  #FFFFFF solid;background:#F0F0F0;font-weight:bold">
										    		{{it.ActionPoint}}
										    	</div>
										    									    										    	
										    </td>
										</tr>
									</tbody>
								</table>
							</div>							 -->
							<!-- End of Modified items -->
<!-- 
							
							<div class="col-md-12" style="padding:10px">																			
								<table class="table table-bordered table-condensed" style="width:100%;background-color: white;border: 1px solid lightgray;">
									<thead>
										<tr style="background-color:silver;" ><th colspan="8">Other Actions in {{actions[0].Title}} meeting</th></tr>						
										<tr style="background-color: #ffe6cc;">
											<th>Meetting Date</th>
											<th>Action Point</th>	
											<th style="width:250px">Responsibility</th>	
											<th style="width:250px">Stakeholder</th>																		
											<th style="width:100px">Status</th>						
											<th style="width:100px">Target Date	</th>
											<th style="width:100px">Last Update Date</th>
											<th></th>																							
										</tr>
									</thead>
									<tbody>

									<tr ng-repeat-start="it in otherMeetings" ng-click="OnActionPointClick(it)" class="trHover">
									    <td>{{it.MeetingDate}}</td>
									    <td>{{it.ActionPointTitle}}</td>
									    <td>
									    	{{GetResponsibility(it.Responsibility)}}<span ng-repeat="usr in it.RespPer.results">{{usr.Title}}</span>
									    </td>		
									    <td>
											{{ GetResponsibility(it.Stakeholder) }}<span ng-repeat="usr in it.StakeholderPer.results">{{usr.Title}}</span>		
										</td>
																		
										<td >{{it.Status}}</td>																
										<td>{{it.ComplectionDate}}</td>
										<td>{{FormatDate(it.LastModifiedDate)}}</td>

										<td>									
											<a target="_blank" href="https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx#!/ActionDetails/{{it.ID}}" >
												<i class="fa fa-edit" style="font-size: large" ng-class="lnk.Icon" aria-hidden="true"></i>											
											</a>
										</td>
									</tr>
									<tr ng-repeat-end ng-show="it.show">
									    <td colspan="6" style="border:0px;padding:0px">
									    	<div style="padding:4px; border-top:0px;border-left:5px   #FFFFFF solid;border-right:5px #FFFFFF solid;border-bottom:8px  #FFFFFF solid;background:#F0F0F0;font-weight:bold">
									    		{{it.ActionPoint}}
									    	</div>
									    									    										    	
									    </td>
									</tr>
									
									</tbody>
								</table>													
							</div>
							 -->
							<!--Other Meettings -->																						
						</div>
													  				   						   																    				    				    					    		
		    		</div>	    			    																																																	
		    	</div>
	    	</form>
	    	
	    

		</div>

        <form name="myForm"></form>
        <form name="af" novalidate>
        	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/ActionModel.html'" style="width:100%" ></div>
        </form>		

</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\MeetingList.html```FileName```<style>

	.select2-input{
		border:0px  !important;
	}
	.select2-search-choice{
		font-size:small;font-weight:normal;margin:0px;padding-right:0px;margin:1px !important;;
	}
	
	
	#DataTableText{
		border-radius: 4px !important;;
    	height: 33px !important;
	}
	
	
	
	 .bs-docs-example {
	    position: relative;
	    margin: 15px 0;
	    padding: 39px 19px 14px;
	    background-color: #fff;
	    border: 1px solid #ddd;
	    -webkit-border-radius: 4px;
	    -moz-border-radius: 4px;
	    border-radius: 4px;
	}
	.scrollspy-example {
	    height: 200px;
	    overflow: auto;
	    position: relative;
	}
	
	button {margin-top:2em;}


</style>
<div id="divOverlay" class="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>

<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class=" row main-header">
		<div class=" col-md-12 main-header-title" >Action Tracker<span style="color:red;font-weight:bold"> UAT</span></div>					
	</div>
	
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/QButtons.html'" style="width:100%" ></div>
	
    <div ng-show="QueueTitle != 'Meeting View'" ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/ActionTable.html'" style="width:100%" ></div>

    <div ng-show="QueueTitle == 'Meeting View'" ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/MeetingTable.html'" style="width:100%" ></div>
    
    <form name="myForm"></form>
    <form name="af" novalidate>
	<div ng-include="'/EITRY/FX/SiteAssets/TryUtilUAT/Proj/MeetingTracker/V2/ActionModel.html'" style="width:100%" ></div>
	</form>		

</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\MeetingListCtrl.js```FileName```var lastTab = "";
var lastSeletedStatusTab = "";
var ListState = "";

var ActionTackerTypesList = "ActionTackerTypesList";
var ActionTackerTaskList = "ActionTackerTaskListUAT"; // "ActionTackerTaskList";
var ActionTackerAuditLog = "ActionTackerAuditLog";

// var ActionTackerTypesList = "ActionTackerTypesListProd";
// var ActionTackerTaskList = "ActionTackerTaskListProd"; // "ActionTackerTaskList";
// var ActionTackerAuditLog = "ActionTackerAuditLogProd";


var ShowFromListState = false;
var ListStateFilters = [];
var UpdateListStateFilters = false;

var MeetingShowFromListState = false;
var MeetingListStateFilters = [];
var MeetingUpdateListStateFilters = false;

var LastListingPage = "ActionTracker";


DocApp.controller('MeetingListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{		
	//Meeting List
	$scope.ShowMeetingView = function(){
		
		var filter = "&$filter=ActionType eq 'Meeting'";
		$scope.meetingViewList = GetListData(ActionTackerTypesList , filter );
			
		$timeout(function() {
			try{
				$scope.$apply();
			}catch(err){}
			
			updateMeetingTable();
					
			$scope.QueueTitle = 'Meeting View';
			lastTab = 'Meeting View'; 
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
		
		}, 0);
	}

	function updateMeetingTable(){	

		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#second-ListTable'))){
			$('#second-ListTable').dataTable().fnDestroy();
		}

        setTimeout(function(){ 	
                                                                    
            $('#second-ListTable').DataTable( {                        
                                                          
                "pageLength": 25,
                "lengthMenu": [[25, 50, -1], [25, 50, "All"]],            
                "order": [[ 1, "dec" ]], 
                "autoWidth": false,
				initComplete: function () {            
                    this.api().columns().every( function (ColCount) {
                        if( ColCount == 2 ){

                            var title = this.header();
                            //replace spaces with dashes
                            title = $(title).html().replace(/[\W]/g, '-');
                            var column = this;
                            var select = $('<select id="secondDataTableFilterCol' + ColCount + '" multiple="multiple" style="width: 100%;" ></select>')
                                .appendTo( $(column.footer()).empty() )
                                .on( 'change', function () {
                                    //Get the "text" property from each selected data 
                                    //regex escape the value and store in array
                                    var data = $.map( $(this).select2('data'), function( value, key ) {
                                    return value.text ? '^' + $.fn.dataTable.util.escapeRegex(value.text) + '$' : null;
                                            });
                                    
                                    //if no data selected use ""
                                    if (data.length === 0) {
                                    data = [""];
                                    }
                                    
                                    //join array into string with regex or (|)
                                    var val = data.join('|');
                                    
                                    //search for the option(s) selected
                                    column
                                        .search( val ? val : '', true, false )
                                        .draw();
                                } );
            
                            column.data().unique().sort().each( function ( d, j ) {
                                select.append( '<option value="'+d+'">'+d+'</option>' );
                            } );
                            
                            $('#secondDataTableFilterCol' + ColCount ).select2();                                                    
                            
                        }//ColCount != 2
                        else{
                        
                            var column = this;
                            var v = '';							
                            var column = this;
                            var textSearch =  $('<input class="DataTableFilterCol' + ColCount + '" type="text" style="width=100%" id="DataTableText" />')
                                .appendTo( $(column.footer()).empty() )
                                
                                .on( 'propertychange change keyup paste input', function () {
                                
                                        $('.auctionListTable').DataTable()
                                            .search('').columns().search('').draw();
                                            var val = $.fn.dataTable.util.escapeRegex(
                                            $(this).val()
                                        );
                                        column
                                            .search( val )
                                            .draw();
                                
                                    });							                    
                        }                    
                    } );
                },                                       
            } );
                    
            $('#second-ListTable').on("click", "tbody tr ", function(){	                           
                auctionReqstItemElem = $(this);                
                var id = auctionReqstItemElem[0].children[0].textContent;
                //debugger;
                //$scope.item = $scope.dataList[id]; 
                //window.location = "/" + SiteRelativeUrl + PagePath  + "/MeetingViewDetails/" + id;		
				$location.path("MeetingViewDetails/" + id);		
                $scope.$apply();
            });
            
            $('#divOverlay').hide();
            $('#divDataTable').show();
                                                           
        }, 100);
    }


	//End of Meeting List


	//Meeting Details Funactions

	$scope.onBackClick = function(){

		//$location.path("ActionTracker");

		var v = $scope.af1;
		if($scope.af1.$dirty){
			
			var warnMsg = "Do you want to quit without creating the meeting?";
			if($scope.meeting.ID){
				warnMsg = "Do you want to quit without saving the changes?";
			}
			
			if (confirm( warnMsg ) == true) {
				$location.path("ActionTracker");
			} 
		}
		else{
			$location.path("ActionTracker");
		}

	}

	$scope.AddMeeting = function(){

		//LastListingPage = 'Meeting View';	
		$location.path("MeetingViewDetails");
	}

	$scope.MeetingDetailOnLoad = function(){


		SetSideBar("Action Tracker Details", "Action Tracker");
		UpdateResponsibilityConfig();

		UpdateActionTypes();

		$scope.oneMothBackDate =  new moment().subtract(1, 'month').format("DD-MMM-YYYY");

		setTimeout(function(){ 
			$('.StartDate').datetimepicker({
				format: 'DD-MMM-YYYY',
				//defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
			});	     	     
			$(".StartDate").on("dp.change", function() {
				var prevVal = $scope.StartDate;
				$scope.StartDate = $(".StartDate").val();						
				$scope.$apply();
				if($scope.StartDate != prevVal && $scope.Title ){
					$scope.loadMeeting();				
				}
			});	
			
			$('.oneMothBackDateCtrl').datetimepicker({
				format: 'DD-MMM-YYYY',
				defaultDate:  new moment().subtract(1, 'month').format("DD-MMM-YYYY"),
				useCurrent: false,			
			});	     	     
			$(".oneMothBackDateCtrl").on("dp.change", function() {
				$scope.oneMothBackDate = $(".oneMothBackDateCtrl").val();	
				UpdateMeetingActions();					
				$scope.$apply();			
			});

			$('#MeetingMinutes').on('change keyup keydown paste cut', 'textarea', function () {
				$(this).height(0).height(this.scrollHeight);
			}).find('textarea').trigger("change");


		}, 1000);

		initTaskControls();

		
		//
		if($routeParams.itenId){			
			//load meetings		
			$scope.loadMeeting($routeParams.itenId);
		}
		else{
			$scope.meeting = {};
		}
	}

	$scope.loadMeeting = function(id){

		var filter = "";
		var listFilter = "";
		$scope.disableEditMeeting = true;
		

		UpdateResponsibilityConfig();
		if( currentUserResp.includes("Admin") ){
			$scope.isAdmin = true;			
		}


		if(id){
			filter = "&$filter=TypeID eq " + id;
		}
		else if($scope.Title && $scope.StartDate ){
			filter = "&$filter=StartDate eq '" + new moment($scope.StartDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
						+ " and ActionType eq 'Meeting' and Title eq '" + encodeURIComponent($scope.Title) + "' "						
		}

		if(filter){

			var meeting = GetListData(ActionTackerTypesList , filter );

			if(meeting.length > 0 && meeting[0].Title ){
				$scope.meeting = meeting[0];
				$scope.Title =  $scope.meeting.Title;
				$scope.StartDate = $scope.meeting.StartDate;
				$scope.MeetingMinutes = $scope.meeting.Description;
				UpdateMeetingActions();
				//other meetings
				if($scope.isAdmin){
					$scope.disableEditMeeting = false;
				}
			}
			else{
				$scope.meeting = {};
				$scope.meetingTasks = [];
				$scope.MeetingMinutes = "";		
				UpdateOtherMeetingActions();
				$scope.disableEditMeeting = false;		
			}										
		}
		else{
			UpdateOtherMeetingActions();
		}	
		
		$timeout(function() {										
			try{
				$scope.$apply();
			}catch(err){}																							
		}, 10);	
	} 

	$scope.OnActionPointClick = function(o){			
		if(!o.show){
            o.show = true; 
        }
        else{
            o.show = false;
        }
	}

	function UpdateOtherMeetingActions(){

		//Other tasks
		//Parent ID
		//Status : Not Started, In Progress
		//Modified until last meeting
		//Modified until 
		
		if($scope.Title){

			var lstMeetFilter = "select=StartDate,TypeID,Title&$filter=Title eq '" + encodeURIComponent($scope.Title) +  "'";
			if($scope.meeting.TypeID){
				lstMeetFilter += " and TypeID ne "  + $scope.meeting.TypeID ;
			}
			lstMeetFilter += "&$orderby=StartDate desc&$top=1";
			var lastMeetingDet = GetFirstSPListItem(ActionTackerTypesList , lstMeetFilter );
			$scope.oneMothBackDate = new moment(lastMeetingDet.StartDate ).format("DD-MMM-YYYY");				

			//var oneMothBackDate = new moment().subtract(1, 'month').format("YYYY-MM-DD") + "T20:00:00Z";
			var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter= ";			
			var oneMothBackDate = $scope.oneMothBackDate + "T20:00:00Z";
			var oneMothBackDate = new moment($scope.oneMothBackDate, "DD-MMM-YYYY" ).subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z";
			listFilter += "ActionName eq '" + encodeURIComponent($scope.Title) + "' ";
			if($scope.meeting.TypeID){
				listFilter +=  " and ParentID ne "  + $scope.meeting.TypeID 
			}					
			listFilter += " and ( Status eq 'Not Started' or  Status eq 'In Progress' or TaskModifiedTime ge '" + oneMothBackDate + "')  ";
			
			$scope.otherTasks = GetListData(ActionTackerTaskList, listFilter );
		}
	}

	

	$scope.onBtnSaveMeeting = function()    
	{				
		$scope.meeting.ActionType = "Meeting";
		$scope.meeting.Title = $scope.Title;
		$scope.meeting.StartDate = $scope.StartDate;
		$scope.meeting.Description = $scope.MeetingMinutes;

		var newMeeting = true;
		if($scope.meeting.TypeID){
			newMeeting = false;
		}
		var itemId = UpdateList($scope.meeting, ActionTackerTypesList, newMeeting, newMeeting);							
		var valuepairs = [];
		valuepairs.push( ["TypeID", itemId ]);	
		UpdateField(ActionTackerTypesList, itemId , valuepairs );

		if(itemId){
			$scope.meeting.ID = itemId;
			$scope.meeting.Id = itemId;
			$scope.meeting.TypeID = itemId;
		}
		
		$scope.af1.$dirty = false;									
		ShowSnacker("Updated");										
	}

	function UpdateMeetingActions(){

		//Get Tasks
		var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter= ";			
		$scope.meetingTasks = GetListData(ActionTackerTaskList, listFilter + 'ParentID eq '  + $scope.meeting.TypeID );
		
		UpdateOtherMeetingActions();
	}


	//End of Meeting Details Funactions


	//Task Functions

	$scope.OnItemClick = function(OpendFrom, ActionType, id, ParentID){
			
		$scope.af.$dirty = false;
		/*
		$scope.af.$setPristine();
		$scope.af.$setValidity();
		$scope.af.$setUntouched();
		*/
		$scope.CommentList = [];		
		$scope.read = true;
		$scope.adminRead = true;
		$scope.se = false;

		try{
			$('.ResponsibilitySelect').select2('destroy');
			$('.StakeholderSelect').select2('destroy');
		}catch(err){}
		
		if(id){
		
			//var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID eq " + id;
			var listFilter = ",TaskCreaedBy/Title,TaskCreaedBy/Id,StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=TaskCreaedBy/ID&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID eq " + id;

			$scope.item = GetListData(ActionTackerTaskList, listFilter )[0];

			updateItemDetails();
						    		
    		$scope.read = false;
			$scope.ShowComment = true;			
		}
		else{
			$scope.item = {};
			$scope.item.ResponsibilityArr = [];
			$scope.item.StakeholderArr = [];

			if(ActionType == "Meeting"){
					$scope.item.ActionName = $scope.Title;
					$scope.item.StartDate = $scope.StartDate; 
			}			
			else{
				$scope.item.StartDate =  new moment().format("DD-MMM-YYYY"); 
			}			

			$scope.ShowComment = false;
			$scope.read = false;
			$scope.adminRead = false;
			$scope.read = false;
			if(!$scope.item.MeetingDate){
				$scope.item.MeetingDate = new moment().format("DD-MMM-YYYY");
			}			
			$scope.item.ActionType = ActionType;
			$scope.item.ResponsibilityType = 'Team';
			$scope.item.StakeholderType = 'Team';
			$scope.item.Status = 'Not Started';		
		}

		$scope.item.OpendFrom = OpendFrom;

		$scope.ShowSaveButton = !$scope.read;
		
		setTimeout(function(){
			if(id){
				clearPP("RespPerDiv" + "_TopSpan");
				clearPP("StakeholderPerDiv" + "_TopSpan");
				
				PopulateMembers($scope.item.RespPerId, "RespPerDiv" );
				PopulateMembers($scope.item.StakeholderPerId, "StakeholderPerDiv" );								
			}

			try{
				$('.ResponsibilitySelect').select2();
				$('.StakeholderSelect').select2();
			}catch(err){}									
		}, 500);
						
		$timeout(function() {										
			try{
				$scope.$apply();
			}catch(err){}	
						
			$('#ReqDetailsModal').modal('toggle');												
		}, 10);
						
	}

	$scope.onBtnCloseActionModel = function()    
	{	
		var v = $scope.af;
		if($scope.af.$dirty){
			
			var warnMsg = "Do you want to quit without creating the action(s)?";
			if($scope.item.ID){
				warnMsg = "Do you want to quit without saving the changes?";
			}
			
			if (confirm( warnMsg ) == true) {
				$('#ReqDetailsModal').modal('toggle');
			} 
		}
		else{
			$('#ReqDetailsModal').modal('toggle');
		}	
		
	}

	/*
	$scope.onBtnSaveNew = function() { 
		
		// $scope.newActList = [];

		if(!ValidateItem()){
			return;
		}	

		if($scope.item.OpendFrom == 'Meeting' && $scope.item.ActionType == "Meeting"){
			var act = $scope.item;
			if(act.ResponsibilityType == "Team"){
				act.Responsibility = angular.toJson(act.ResponsibilityArr);
				act.RespPer = "";			
			}
			else if(act.ResponsibilityType == "Person"){
				act.RespPer = getUserInfo("RespPerDiv");
				act.Responsibility = [];	
			}
			
			if(act.StakeholderType == "Team"){
				act.Stakeholder = angular.toJson(act.StakeholderArr);
				act.StakeholderPer  = "";			
			}
			else if(act.StakeholderType == "Person"){
				act.StakeholderPer = getUserInfo("StakeholderPerDiv");
				act.Stakeholder = [];	
			}
			else{
				act.Stakeholder = [];
				act.StakeholderPer  = "";
			}

			act.LastModifiedDate = new moment().format('YYYY-MM-DD HH:mm:ss')
			if(act.Status == "Completed" ){
				act.CompletedDate = new moment().format('YYYY-MM-DD HH:mm:ss')
			}
			else{
				act.CompletedDate = ""; 		
			}

			act.StartDate =  new moment().format('YYYY-MM-DD HH:mm:ss');
			act.TaskCreaedBy = _spPageContextInfo.userId;
			act.TaskCreatedTime =  new moment().format('YYYY-MM-DD HH:mm:ss') ;	

			if(act.itemIndex || act.itemIndex === 0 ){
				$scope.newActList[act.itemIndex] = act;
			}
			else{
				$scope.newActList.push(act);
			}
			
			$scope.item = {};
			$('#ReqDetailsModal').modal('toggle');
			$scope.af1.$dirty = false;
			
		}

		$timeout(function() {	
			
			if($scope.item.OpendFrom == 'ActionList' ){
				MeetingShowFromListState = true;
				$scope.listCtrlOnLoad();				
				$('#ReqDetailsModal').modal('toggle');
			}
			else if($scope.item.OpendFrom == 'Meeting' ){
				UpdateMeetingActions();	
				
				try{
					$scope.$apply();
				}catch(err){}

				$('#ReqDetailsModal').modal('toggle');
			}					
		}, 10);
	}
	*/
	$scope.onBtnSave = function()    
	{			
		if(!ValidateItem()){
			return;
		}				
		
		$scope.af.$dirty = false;				
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		var act = $scope.item;

		if($scope.item.OpendFrom == 'Meeting' && $scope.item.ActionType == "Meeting"){
						
			//Create/update meeting
			if($scope.meeting.TypeID){
				if(!act.ParentID){
					act.ParentID = $scope.meeting.TypeID;
				}	
				if( $scope.meeting.Description	!= $scope.MeetingMinutes ){
					//Update MeetingMinutes
					var valuepairs = [];
					valuepairs.push( ["Description", $scope.MeetingMinutes  ]);	
					UpdateField(ActionTackerTypesList, $scope.meeting.ID , valuepairs );
				}		
			}
			else{
				$scope.meeting.ActionType = $scope.item.ActionType;
				$scope.meeting.Title = $scope.Title;
				$scope.meeting.StartDate = $scope.StartDate;
				$scope.meeting.Description = $scope.MeetingMinutes;
	
				var itemId = UpdateList($scope.meeting, ActionTackerTypesList, true, true);							
				var valuepairs = [];
				valuepairs.push( ["TypeID", itemId ]);	
				UpdateField(ActionTackerTypesList, itemId , valuepairs );
				act.ParentID = itemId;
				$scope.meeting.TypeID = itemId;
				$scope.meeting.ID = itemId;
				$scope.meeting.Id = itemId;
				
			}
			//Get parent ID
		}
		
		if(act.ResponsibilityType == "Team"){
			act.Responsibility = angular.toJson(act.ResponsibilityArr);
			act.RespPer = "";			
		}
		else if(act.ResponsibilityType == "Person"){
			act.RespPer = getUserInfo("RespPerDiv");
			act.Responsibility = [];	
		}
		
		if(act.StakeholderType == "Team"){
			act.Stakeholder = angular.toJson(act.StakeholderArr);
			act.StakeholderPer  = "";			
		}
		else if(act.StakeholderType == "Person"){
			act.StakeholderPer = getUserInfo("StakeholderPerDiv");
			act.Stakeholder = [];	
		}
		else{
			act.Stakeholder = [];
			act.StakeholderPer  = "";
		}
		

		//act.LastModifiedDate = new moment().format('YYYY-MM-DD HH:mm:ss')
		act.TaskModifiedTime =  new moment().format("DD-MMM-YYYY");
		if(act.Status == "Completed" ){
			act.CompletedDate = new moment().format('DD-MMM-YYYY');
		}
		else{
			act.CompletedDate = ""; 		
		}

		var IsNewReq = act.ID ? false : true;
		if(IsNewReq){
			if(!act.StartDate){
				//act.StartDate =  new moment().format('YYYY-MM-DD HH:mm:ss');
				act.StartDate =  new moment().format('DD-MMM-YYYY');
			}
			act.TaskCreaedBy = _spPageContextInfo.userId;
			//act.TaskCreatedTime =  new moment().format('YYYY-MM-DD HH:mm:ss') ;	
			act.TaskCreatedTime =  new moment().format('DD-MMM-YYYY') ;		
		}
		else{
			if(act.TaskCreaedById){
				act.TaskCreaedBy = act.TaskCreaedById;
			}
		}

		var itemId = UpdateList(act, ActionTackerTaskList, IsNewReq, IsNewReq);
		if(itemId){
			act.Id = itemId;
			act.ID = itemId;
		}
		

		//Add Audit log
		if( IsNewReq ){	
			//task.TaskCreaedBy = itm.AuthorId; //itm.Author;
			//task.TaskCreatedTime = itm.MeetingDate;
			var valuepairs = [];
			valuepairs.push( ["TaskID", act.ID ]);	
			UpdateField(ActionTackerTaskList, act.ID, valuepairs );      
			AddComment(act.ID, act.Status, "Initiation")
	    }

		
		if(act.LastComplectionDate && act.LastComplectionDate != act.ComplectionDate){			
			var dateCmd = "Target Date changed from " +  act.LastComplectionDate + " to " + act.ComplectionDate;
			AddComment(act.ID, act.Status, dateCmd)
		}
		
		if(act.CurrentComment){	
			AddComment(act.ID, act.Status, act.CurrentComment)
		}		
		//End of Add Audit log
		

		
		$scope.ErrorMessage = "Updated";			
			
		ShowSnacker("Updated");	

		

		$timeout(function() {	
			
			if($scope.item.OpendFrom == 'ActionList' ){
				MeetingShowFromListState = true;
				$scope.listCtrlOnLoad();				
				$('#ReqDetailsModal').modal('toggle');
			}
			else if($scope.item.OpendFrom == 'Meeting' ){
				UpdateMeetingActions();	
				
				try{
					$scope.$apply();
				}catch(err){}

				$('#ReqDetailsModal').modal('toggle');
			}					
		}, 10);




		$('#divOverlay').hide();
		$('#ListDetails').show();


	}
	
	$scope.listCtrlOnLoad = function(){
											
		
		SetSideBar("Action Tracker List", "Action Tracker");			
	
		$('#divOverlay').show();	
		
		UpdateResponsibilityConfig();
		
		UpdateActionTypes();	
		
		setTimeout(function(){ 	
		
			if(!lastSeletedStatusTab){
				lastSeletedStatusTab = "Pending Requests";				
			}
			$scope.SeletedStatusTab = lastSeletedStatusTab;												
    		$scope.listCtrlOnLoadInit();    		    	    		    		    		        		    		    		    		
    	}, 10);
    	    	    	    	    	
    	setTimeout(function(){ 	
    		
			$('.nav-tabs a').on('shown.bs.tab', function(event){
				
				//var target = $(event.target).text();    // active tab
				//var y = $(event.relatedTarget).text();  // previous tab
				var target = $(event.target)[0].name;
				
				if(target == "Pending"){
					$scope.SeletedStatusTab = "Pending Requests";
				}
				else if(target == "Completed"){
					$scope.SeletedStatusTab = "Completed Requests";
				}
				else if(target == "Removed"){
					$scope.SeletedStatusTab = "Removed Requests";
				}
				else if(target == "All"){
					$scope.SeletedStatusTab = "All Requests";
				}
				lastSeletedStatusTab = $scope.SeletedStatusTab ;
								
				$scope.TaskListing($scope.QueueTitle, $scope.SeletedStatusTab );
			});
			//alert(1)
		}, 1000);
		

			
	}
	$scope.StatusTaskListing = function(SeletedStatusTab ){
				
		lastSeletedStatusTab = SeletedStatusTab;
		$scope.SeletedStatusTab = SeletedStatusTab ;
		$scope.TaskListing($scope.QueueTitle, SeletedStatusTab  );		
	}
	
	$scope.listCtrlOnLoadInit = function()
	{
				
		$scope.startDate = moment();
		$scope.endDate = moment().add(30, 'days');
				
		$scope.isAdmin = false;
		UpdateResponsibilityConfig();
		if( currentUserResp.includes("Admin") ){
			$scope.isAdmin = true;			
		}
		
		if(!lastTab){
			if($scope.isAdmin){
				lastTab = "All Tasks";
			}
			else{
				lastTab = "Teams Combaind Tasks"; // "Team Task";
			}
		}
				
		if($scope.isAdmin){
			UpdateQueue();
		}
				
		$scope.TaskListing(lastTab, $scope.SeletedStatusTab);		
		$scope.$apply();			
		
		initTaskControls();	
					
	}

	function initTaskControls(){
		//Init controls
		setTimeout(function(){ 
				
			try{
				$('.ResponsibilitySelect').select2();
				$('.StakeholderSelect').select2();
			}catch(err){}
						
			initializePeoplePickerMultiple("RespPerDiv");
			initializePeoplePickerMultiple("StakeholderPerDiv");
							
			$('.ComplectionDate').datetimepicker({
				format: 'DD-MMM-YYYY',
				//defaultDate: moment(),
				useCurrent: false,
				//minDate: moment(),
			});	     	     
			$(".ComplectionDate").on("dp.change", function() {
				$scope.item.ComplectionDate = $(".ComplectionDate").val();						
				$scope.$apply();
				
			});	
		}, 3000);
	}
	
	$scope.TaskListing = function(queue, StatusTab){
				
		$('#divOverlay').show();
		$('#ListDetails').hide();	

		if( queue == 'Meeting View'){
			LastListingPage = 'Meeting View'
		}
		else{
			LastListingPage = "ActionTracker";	
		}
		
		setTimeout(function(){ 
			$scope.TaskListingPoc(queue, StatusTab);
		}, 0);
				
	}
			
	$scope.QueueTaskListing = function(Title, type ){
					
		DestroyTable();
		
		$scope.QueueTitle = Title;

		var queueConfig = $scope.queueConfig;
		
		for(i=0;i<queueConfig.length;i++){
			if(queueConfig[i].Title == Title ){				
				
				
				if( type == "All" ){
					$scope.dataList = queueConfig[i].items;
				}
				else if( type == "Individual" ){
					$scope.dataList = queueConfig[i].indItems;
				}
				else if( type == "Team" ){
					$scope.dataList = queueConfig[i].temItems;
				}
				else{
					return;
				}
				
				
										
				$timeout(function() {
					try{
						$scope.$apply();
					}catch(err){}
					
					updateTable();		
					//$scope.QueueTitle = queue;
					//lastTab = queue; 
				
				}, 0);

				
				break;
			}
		}
	}
	
	function UpdateQueue(){				
		//UpdateResponsibilityConfig();		 	
		var queueConfig  = [];
		queueConfig.push({Title : "HoTM", Display : "HoTM" , color : "#4e73df", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
		queueConfig.push({Title : "ALM", Display : "ALM" , color: "#3BBEB4", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false });
		queueConfig.push({Title : "S&S", Display : "S&S" , color : "SaddleBrown", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		queueConfig.push({Title : "F&E", Display : "F&E" , color : "#f36c21", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );		
		queueConfig.push({Title : "BMS", Display : "BMS" , color : "#008080", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  });
		queueConfig.push({Title : "TTO", Display : "TTO" , color : "#4B0082", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		queueConfig.push({Title : "PI", Display : "PI" , color : "#8B008B", Count : 0, TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
										
		queueConfig.push({Title : "Others", Display : "Others" , color : "#1cc88a", Count : 0,  TeamCount : 0, IndCount : 0, items : [], temItems : [], indItems : [], sel: false  } );
		
		var othersItem = queueConfig.length-1;
		
		var filter = ",RespPer/Title,RespPer/Id,StakeholderPer/Title,StakeholderPer/Id&$expand=RespPer/ID,RespPer/Title&$expand=StakeholderPer/ID,StakeholderPer/Title";
		filter += "&$filter=Status ne 'Completed' and  Status ne 'Removed'";
		
		var aLst = GetListData(ActionTackerTaskList , filter );
		
		$.each(aLst, function(aId, act){
			var other = true;
			if(act.ResponsibilityType == "Team" && act.Responsibility){
				
				$.each(queueConfig, function(qId, qu){	
					if(act.Responsibility.indexOf(qu.Title) > -1 ){
						qu.Count++;
						qu.TeamCount++;						
						other = false;
						qu.items.push(act);
						qu.temItems.push(act);
					}																
				});				
			}
			else if(act.ResponsibilityType == "Person" ){
				//Person
				
				$.each(act.RespPerId.results, function(id1, per){
					$.each(ResponsibilityList, function(id2, rspItm){
						$.each(rspItm.Users.results, function(id3, usr){
							if(usr.Id == per){
								for(i=0;i<queueConfig.length;i++){
									if(queueConfig[i].Title == rspItm.Title){
										queueConfig[i].Count++;
										queueConfig[i].IndCount++;
										other = false;
										queueConfig[i].items.push(act);
										queueConfig[i].indItems.push(act);
										break;
									}
								}
							}
						});
					});
				});
				
			}
									
			if(other){								
				//act.RespPerId.results
				queueConfig[othersItem].Count++;
				
				if(act.ResponsibilityType == "Team"){
					queueConfig[othersItem].TeamCount++;
					queueConfig[othersItem].temItems.push(act);
				}
				else{
					queueConfig[othersItem].IndCount++;
					queueConfig[othersItem].indItems.push(act);
				}
				
				queueConfig[othersItem].items.push(act);

			}
		});
				
		$scope.queueConfig  = queueConfig;		
				 
	}
	
	$scope.ClearFilter = function(){
	
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
		updateTable();
	}
	
	$scope.GetButtonClass = function(title){
		if( title == $scope.QueueTitle ){
			return "EI-ButtonPurple-Selected"; 
		}
		else{
			return '';
		}
	}

	$scope.GetQueueButtonClass = function(title){
		if( title == $scope.QueueTitle ){
			return "EI-QButton-Selected"; 
		}
		else{
			return '';
		}
	}
	
	$scope.DateSer = function(date){
		return new moment(date, "DD-MMM-YYYY" ).unix();
	}
	
	$scope.FormatDate = function(date){
		return new moment(date).format("DD-MMM-YYYY");
	}
	
	$scope.MeetingStatus = function(itm){
		if(itm.Status == "Not Started" || itm.Status == "In Progress" ){
			var cd = new moment(itm.ComplectionDate, "DD-MMM-YYYY") ;
			var v = new moment().diff(cd, 'days');
			if(v > 0 ){
				return 'LightCoral';
			}

		}
		else if(itm.Status == "Completed" ){
			return 'LightGreen';
		}
		
		
		return '';
	}
	
	$scope.GetResponsibility = function(rs){
    	var res = "";
    	if(rs){
    		oAl = angular.fromJson(rs)
    		$.each(oAl, function(id, val){
				res = res ? res + ", " : res;
				res += val;
				
			});			
		}
		return res ;
    }
    
    $scope.TaskListingPoc = function(queue, StatusTab){
						
		
		
		$('#lilandingPageTabs1').removeClass('active');
		$('#lilandingPageTabs2').removeClass('active');
		$('#lilandingPageTabs3').removeClass('active');
		$('#lilandingPageTabs4').removeClass('active');


		switch(StatusTab){
			case "Pending Requests":
				$('#lilandingPageTabs1').addClass('active');break;
			case "Completed":
				$('#lilandingPageTabs2').addClass('active');break;
			case "Removed Requests":
				$('#lilandingPageTabs3').addClass('active');break;
			case "All Requests":
				$('#lilandingPageTabs4').addClass('active');break;	
		}
		        		
		var countfilter = "";			
		$.each(currentUserResp, function(id, rval){
			if(rval){
				if(countfilter){
					countfilter += " or  ";
				}				
				countfilter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
			}
		});
		if(countfilter){
			countfilter = "( " + countfilter+ " )" + " and Status ne 'Completed'  and  Status ne 'Removed'";
			TeamTaskCount = GetListItemsCount(ActionTackerTaskList, "Status", countfilter );
			$scope.TeamTaskCount = " (" + TeamTaskCount + ")";
		}	
		else{
			$scope.TeamTaskCount = "(0)";
		}
										
		$scope.AssignedByMeTaskCount = GetListItemsCount(ActionTackerTaskList, "Status", "Status ne 'Completed' and  Status ne 'Removed' and TaskCreaedBy/Id eq " + _spPageContextInfo.userId );
       		
		if($scope.isAdmin){
			$scope.AllTasksCount = GetListItemsCount(ActionTackerTaskList, "Status", "Status ne 'Completed'  and  Status ne 'Removed'") ;
			
			$scope.AllTasksCountPending = GetListItemsCount(ActionTackerTaskList, "Status", "Status ne 'Completed' and  Status ne 'Removed' " ) ;	
			$scope.AllTasksCountCompleted = GetListItemsCount(ActionTackerTaskList, "Status", " Status eq 'Completed' " );	
			$scope.AllTasksCountRemoved =GetListItemsCount(ActionTackerTaskList, "Status", " Status eq 'Removed' " );	
			$scope.AllTasksCountAll = GetListItemsCount(ActionTackerTaskList, "Status" );	
		}
		else{
			
			filter = "";			
			$.each(currentUserResp , function(id, rval){
			    if(rval){
			        if(filter){
			            filter += " or  ";
			        }
			        else{
			            //filter = "&$filter=";
			        }
			        filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
			        
			        //Stakeholder all task
			        filter += " or substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
			    }								
			});	                        
			filter = filter + " or " + IndiviualTaskFilter;
			
			//Stakeholder all task
			filter = filter + " or " + IndiviualStakeHolderFilter;
			$scope.AllTasksCountAll = "(" + GetListItemsCount(ActionTackerTaskList, "Status", filter  ) + ")";	
			var TabCountFilter = "";					
			if(filter){
				TabCountFilter = "( " + filter +  " ) and ";
			    filter = "( " + filter +  " ) and Status ne 'Completed' and  Status ne 'Removed'"; //and ( Status ne 'Completed') ";
				
			}
			else{
				filter = " Status ne 'Completed' and  Status ne 'Removed'  ";
			}
					    
			$scope.AllTeamTasksCount = GetListItemsCount(ActionTackerTaskList, "Status", filter );
			
			$scope.AllTasksCountPending =   GetListItemsCount(ActionTackerTaskList, "Status", TabCountFilter + " Status ne 'Completed' and  Status ne 'Removed' " );	
			$scope.AllTasksCountCompleted =  GetListItemsCount(ActionTackerTaskList, "Status", TabCountFilter + " Status eq 'Completed' " ) ;	
			$scope.AllTasksCountRemoved =    GetListItemsCount(ActionTackerTaskList, "Status", TabCountFilter + " Status eq 'Removed' " ) ;	
			
		}

		if(LastListingPage == 'Meeting View'){
			
			$scope.ShowMeetingView();					
		}
		else{

			DestroyTable();
		
			var filter = "";
			if(queue == "All Tasks"){
				//filter = "&$filter=datefilter ";
			}		
			else if(queue == "Assigned by Me"){ 
				filter = "TaskCreaedBy/Id eq " + _spPageContextInfo.userId;			
			}				
			else if(queue == "Teams Combaind Tasks"){ //Teams Combaind Tasks
				
				filter = "";			
				$.each(currentUserResp , function(id, rval){
					if(rval){
						if(filter){
							filter += " or  ";
						}
						else{
							//filter = "&$filter=";
						}
						filter += "substringof('" + encodeURIComponent(rval) + "' , Responsibility)";
						
						//Stakeholder all task
						filter += " or substringof('" + encodeURIComponent(rval) + "' , Stakeholder)";
					}								
				});	
										
				filter = filter + " or " + IndiviualTaskFilter;
				
				//Stakeholder all task
				filter = filter + " or " + IndiviualStakeHolderFilter;
				
				if(!filter){
					filter = " Responsibility eq '-' ";
				}
											
			}		
			else{
				return;
			}	
									
			if(filter){
				filter = "&$filter=( " + filter + " )" + " and ";
			}
			else{
				filter = "&$filter=";
			}


			var SeletedStatusFilter = " Status ne 'Completed' and  Status ne 'Removed' ";
			if( $scope.SeletedStatusTab == "Completed Requests"){
				SeletedStatusFilter = " Status eq 'Completed' ";			
			}			
			else if( $scope.SeletedStatusTab == "Removed Requests"){
				SeletedStatusFilter = " Status eq 'Removed' ";			
			}
			else if( $scope.SeletedStatusTab == "All Requests"){
				SeletedStatusFilter = " Status ne 'All ' ";			
			}	
		
			filter += SeletedStatusFilter;
			//TaskCreaedBy
			filter = ",TaskCreaedBy/Title,TaskCreaedBy/Id,RespPer/Title,RespPer/Id,StakeholderPer/Title,StakeholderPer/Id&$expand=TaskCreaedBy/ID&$expand=RespPer/ID,RespPer/Title&$expand=StakeholderPer/ID,StakeholderPer/Title&$orderby=ComplectionDate asc" + filter;
			$scope.dataList = GetListData(ActionTackerTaskList, filter );

			
			//$scope.dataList = updateTypesList(dataList );
									
			$timeout(function() {
				try{
					$scope.$apply();
				}catch(err){}
				
				updateTable();		
				$scope.QueueTitle = queue;
				lastTab = queue; 
			
			}, 0);
		}
		
		 		
		
				
	}

	$scope.ShowAddUpdate = function(){
		//alert(1);
		$('#addUpdateModal').modal('toggle');
	}
		
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
																	
			$('#main-ListTable').DataTable( {

				stateSave: true,
				stateSaveCallback: function(settings,data) {			      
			      ListState = JSON.stringify(data);			     
			      MeetingShowFromListState = false;			      
			    },
				stateLoadCallback: function(settings) {

					if(MeetingListStateFilters.length > 0){ //if(MeetingShowFromListState){
						ShowFromListState = false;		
						$timeout(function() {				
							$.each(MeetingListStateFilters, function(id, filt){	
								
								if( id == 2 || id == 3 || id == 	9 ){
									try{
										$('#DataTableFilterCol' + filt.col).select2('destroy');	
										$('#DataTableFilterCol' + filt.col  ).val(filt.val);
										$('#DataTableFilterCol' + filt.col).select2(); 									
									}catch(err){}
								}
								else{
									$('.DataTableFilterCol' + filt.col  ).val(filt.val);
								}
								
							});
						}, 1000);

						
						return JSON.parse(ListState);
					}
					else{
						return "";
					}					
			    },
			    			    				
				"pageLength": 25,
				"lengthMenu": [[25, 50, -1], [25, 50, "All"]],				
				"order": [[ 1, "asc" ]],
				"autoWidth": false,
				
			    initComplete: function () {

					this.api().columns().every( function (ColCount) {
						if( ColCount == 2 || ColCount == 3 || ColCount == 	9 ){

							var title = this.header();
			                  //replace spaces with dashes
			                  title = $(title).html().replace(/[\W]/g, '-');
			                  var column = this;
			                  var select = $('<select id="DataTableFilterCol' + ColCount + '" multiple="multiple" style="width: 100%;" ></select>')
			                      .appendTo( $(column.footer()).empty() )
			                      .on( 'change', function () {
									UpdateMeetingTableFilters();
			                        //Get the "text" property from each selected data 
			                        //regex escape the value and store in array
			                        var data = $.map( $(this).select2('data'), function( value, key ) {
			                          return value.text ? '^' + $.fn.dataTable.util.escapeRegex(value.text) + '$' : null;
			                                   });
			                        
			                        //if no data selected use ""
			                        if (data.length === 0) {
			                          data = [""];
			                        }
			                        
			                        //join array into string with regex or (|)
			                        var val = data.join('|');
			                        
			                        //search for the option(s) selected
			                        column
			                              .search( val ? val : '', true, false )
			                              .draw();
			                      } );
			   
			                  column.data().unique().sort().each( function ( d, j ) {
			                      select.append( '<option value="'+d+'">'+d+'</option>' );
			                  } );
			                  
			                $('#DataTableFilterCol' + ColCount ).select2();  			                 							
						}//ColCount != 2
						else{
						
							var column = this;
							var v = '';							
							var column = this;
							var textSearch =  $('<input class="DataTableFilterCol' + ColCount + '" type="text" style="width=100%" id="DataTableText" />')
    							.appendTo( $(column.footer()).empty() )
    							
								.on( 'propertychange change keyup paste input', function () {
										
										UpdateMeetingTableFilters();

								        $('.auctionListTable').DataTable()
								            .search('').columns().search('').draw();
								            var val = $.fn.dataTable.util.escapeRegex(
								            $(this).val()
								        );
								        column
								            .search( val )
								            .draw();								
								    });														
						}
						
					} );
				},
			} );
				
			
			$('#main-ListTable').off( 'click.rowClick' ).on('click.rowClick', 'tbody tr', function () {			
			//$('#main-ListTable').off("click", "tbody tr ", function(){	
				
				
				
				 
				 
			     /* 			
				auctionReqstItemElem = $(this);
			
				var id = auctionReqstItemElem[0].children[0].textContent;
				console.log("item click id : " + id);
				
				*/

				/*
				//debugger;
				var index = auctionReqstItemElem[0].children[1].textContent;
				$scope.item = $scope.dataList[index]; 
				
				//window.location = "/" + SiteRelativeUrl + PagePath + "/ActionDetails/" + id;				
				//$scope.$apply();
				*/
			
			});
			
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
			if(MeetingUpdateListStateFilters){			
		       
				for(i=0;i<10;i++){
				 	var filt = MeetingListStateFilters[i];			      
			      	if( i == 2 || i == 3 || i == 7 ){		
			      			      				      		
			      		$('#DataTableFilterCol' + i + "").val(filt.val);
			      		$('#DataTableFilterCol' + i + "").select2();						
					}
					else{
			      		$('.DataTableFilterCol' + filt.col  ).val(filt.val);
			      	}
			      	MeetingListStateFilters.push( filt );	
				 }
				MeetingUpdateListStateFilters = false;
			}

		}, 100);
	}

	function UpdateMeetingTableFilters(){
		MeetingListStateFilters = [];
		for(i=0;i<10;i++){
			var filt = {};
			 filt.col = i;
			 if( i == 2 || i == 3 || i == 9 ){
				 filt.val = $('#DataTableFilterCol' + i  + "" ).val(); 
		   }
		   else{
				 filt.val = $('.DataTableFilterCol' + i  + "" ).val();						
			 }
			 MeetingListStateFilters.push( filt );	
		}
	}
	
	function UpdateActionTypes(){ 
	
		var ac = GetConfigList("MeetingTypeList"); 

		$scope.MeetingNameList = [];
		$scope.AdhocMeetingNameList = [];
			
		for(i=0;i<ac.length;i++){
			if( ac[i].Title == "Meeting" ){
				$scope.MeetingNameList.push(ac[i].ActionSubType);				
			}
			else if ( ac[i].Title == "Adhoc" ){
				$scope.AdhocMeetingNameList.push(ac[i].ActionSubType);	
			}
		}
				
		$scope.ResponsibilityList = ResponsibilityList;

		/*
		var ac = [];
		$.each(types, function(id, ty){
			var nw = true;
			for(i=0;i<ac.length;i++){
				if( ac[i].Title == ty.Title){
					ac[i].subTypes.push(ty.ActionSubType);
					nw = false;
					break;
				}
			}
			if(nw){
				var type = {};
				type.Title = ty.Title;
				type.subTypes= [];
				type.subTypes.push(ty.ActionSubType);
				ac.push(type);
			}
		});
		$scope.ActionTypeList = ac;
		*/
	}
	
	
	function ValidateItem(){
	
		var errMessage = "";
		if ( $scope.af.$valid) {
			
			if($scope.item.ResponsibilityType == 'Person'){
				var RespPer = getUserInfo("RespPerDiv");
	        	if(!RespPer){
	        		errMessage +=  "Responsibility required. ";		        		
	        	} 
	        } 
	                	
			if(errMessage){
				$scope.ErrorMessage = errMessage;
		        return false;
			}        	
        	        	
            $scope.errMessage = "";   
            return true;     
        } 
        else {
        	$scope.se = true;
        	if( $scope.af.$error.required  != null || $scope.af.$error.required  != undefined ){	
        		$.each($scope.af.$error.required, function(id, err){
        			
        			if(  err.$$attr.errmsg == null || err.$$attr.errmsg == undefined ){	
        				errMessage += err.$name + " required. ";        				
        			}
        			else{        			 
        				errMessage += err.$$attr.errmsg + " required. ";
        			}
        		});
        	}        	
        	$scope.ErrorMessage = errMessage;
        	return false;
		}
	}	
	
	function updateItemDetails(){
		
		try{
			$scope.item.ResponsibilityArr = angular.fromJson($scope.item.Responsibility);
		}catch(ex){
			$scope.item.ResponsibilityArr = [];
		}
		
		try{
			$scope.item.StakeholderArr = angular.fromJson($scope.item.Stakeholder);
		}catch(ex){
			$scope.item.StakeholderArr = [];
		}

		//access

		if( _spPageContextInfo.userId == $scope.item.TaskCreaedById ){
	        $scope.read = false;			
	    }
		

		if( currentUserResp.includes("Admin") ){
			$scope.read = false;
			$scope.adminRead = false;
		}
		else if($scope.item.ResponsibilityType == "Team"){
			$.each($scope.item.ResponsibilityArr , function(pid, Perval){
				if( currentUserResp.includes(Perval) ){
					$scope.read = false;
				}
			});			
		}
		else if($scope.item.ResponsibilityType == "Person" && $scope.item.RespPerId){
			$.each($scope.item.RespPerId.results , function(pid, Perval){
				if( Perval == _spPageContextInfo.userId ){
					$scope.read = false;
				}
			});								
		}

		//End of access

	    $scope.item.LastComplectionDate = $scope.item.ComplectionDate;
	    
	    
	    var auditLogFilter = ",ActionBy/Title,ActionBy/Id&$expand=ActionBy/ID&$orderby=ActionTime desc, ID desc&$filter=TaskID eq " + $scope.item.TaskID;
		$scope.item.AuditLog = GetListData(ActionTackerAuditLog, auditLogFilter );

		var addInitiation = true;
		$scope.item.AuditLog.forEach( (al) => {
			if(al.Status === "Initiation"){
				addInitiation = false;
			}
		})
		if(addInitiation){
			var log = {};
			log.TaskID = $scope.item.TaskID;
			log.ActionBy = $scope.item.TaskCreaedBy;
			log.ActionTime = $scope.item.TaskCreatedTime;
			log.Status = "Initiation";			
			//log.Comment= "Initiation";	
			//$scope.item.AuditLog.push(log);
		}

	                
	    try{
	        $scope.item.ResponsibilityArr = angular.fromJson($scope.item.Responsibility);
	    }catch(ex){
	        $scope.item.ResponsibilityArr = [];
	    }
	    
	    try{
	        $scope.item.StakeholderArr = angular.fromJson($scope.item.Stakeholder);
	    }catch(ex){
	        $scope.item.StakeholderArr = [];
	    }
	
	    
	    //$scope.item.RespPerId.results
	    if( currentUserResp.includes("Admin") ){
	        $scope.read = false;
	        $scope.adminRead = false;
	    }
	    else if($scope.item.ResponsibilityType == "Team"){
	        $.each($scope.item.ResponsibilityArr , function(pid, Perval){
	            if( currentUserResp.includes(Perval) ){
	                $scope.read = false;
	            }
	        });			
	    }
	    else if($scope.item.ResponsibilityType == "Person" && $scope.item.RespPerId){
	        $.each($scope.item.RespPerId.results , function(pid, Perval){
	            if( Perval == _spPageContextInfo.userId ){
	                $scope.read = false;
	            }
	        });								
	    }
	    

	}
	
	function CombainHistory(CommentList, CompDateList ){
		///$scope.actions[id].CompletionDateHistoryArr
		var ListCombaind = [];
		$.each(CommentList, function(id, cmd){
			var log = {};	
			log.Status= cmd.Status;
			log.From= cmd.From;
			
			log.Date =  new moment(cmd.Date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY');
			log.DateSort = new moment(cmd.Date, "YYYY-MM-DD hh:mm A" ).unix();
			//log.Date= cmd.Date;
			log.Comment =  cmd.Comment; 
	
			ListCombaind.push(log);			

		});
		
		$.each(CompDateList, function(id, cmd){
			var log = {};
			log.Status =  "Completion Date change";
			log.From = cmd.ActionBy;
			log.Date = cmd.Date;
			log.DateSort = new moment(cmd.Date, "DD-MMM-YYYY" ).unix();
			
			log.Comment =  cmd.ComplectionDate;
			 
			ListCombaind.push(log);										
		});

		
		ListCombaind = ListCombaind.sort((a, b) => {
		
			//var da =  new moment(cmd.Date, "YYYY-MM-DD hh:mm A" ).format('DD-MMM-YYYY');
			
		    return a.DateSort - b.DateSort;
		});
		
		$scope.ListCombaind = ListCombaind;
	}
	
	function ShowSnacker(message){
	
		$('#snackbar').empty();
		$('#snackbar').append("<div class='alert alert-success'><strong>" + message + "</strong></div>");
	
		var x = document.getElementById("snackbar");
	    x.className = "show";
	    
	    setTimeout(function(){
			x.className = x.className.replace("show", ""); 
			$scope.ErrorMessage = "";
			$scope.$apply();
		}, 3000);
		
	}
	
	
	function GetUserIdFromDisplayName(DisplayName) {
  
  		var userID = "";
  	
	     $.ajax({
	        url: SiteURL + "/_api/web/siteusers?$filter=Title eq '" + 
	            encodeURIComponent(DisplayName) + "'",
	        method: "GET",
	        async: false,
	        headers: { "Accept": "application/json; odata=verbose" },
	        success: function (data) {        	
	            userID = data.d.results[0].Id;
	        },
	        error: function (data) {
	            console.log(JSON.stringify(data));
	        }
	    });
	    
	    
	      
	    return userID ;

	}

	function AddComment(TaskID, Status, Comment){
		var item = {}
		item.TaskID = TaskID;
		item.Status = Status;				
		item.ActionTime = new moment().format("YYYY-MM-DD HH:mm:ss");
		item.Comment = Comment;
		item.ActionBy = _spPageContextInfo.userId;			
		
		var itemId = UpdateList(item, ActionTackerAuditLog, true, true); 
	}
	
	function updateTypesList(list){
	
		if(!$scope.TypesList){		
			$scope.TypesList = GetListData(ActionTackerTypesList);
		}
		
		$.each(list, function(id, itm){
			for(i=0;i<$scope.TypesList.length;i++){
				if($scope.TypesList[i].ParentID == itm.ParentID ){
					itm.ActionType = $scope.TypesList[i].ActionType;
					break;
				}
			}
		});
		
		return list;
	}
	
	$scope.MeetingDataMiration = function(queue, StatusTab){
		
		var MeetingTrackerListMig = "MeetingTracker";

		//return;
		debugger;
		//var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID lt 80"; // or ID eq 84"; // or ID eq 82 or ID eq 85 or ID eq 86 or ID eq 169";
		//var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID gt 81"; //&$filter=ID gt 173";
		var listFilter = ",StakeholderPer/Title,StakeholderPer/Id,RespPer/Title,RespPer/Id,Author/ID,Author/Title&$expand=RespPer/ID,RespPer/Title&$expand=Author/ID&$expand=StakeholderPer/ID&$filter=ID gt 60"; //&$filter=ID gt 173";

//83 84
		var items = GetListData(MeetingTrackerListMig, listFilter );

		
		$.each(items, function(id, itm){
			
			var ParentID = "";
			var msg = "Item ID: " + itm.ID + " type : " + itm.ActionType;
			
			
			if(itm.ActionType == "Meeting"){
	
				//Check meeting existing			
				var typeFilter = "&$filter=StartDate eq '" + new moment(itm.MeetingDate, "DD-MMM-YYYY").subtract(1, 'days').format("YYYY-MM-DD") + "T20:00:00Z'"
						+ " and ActionType eq '" + encodeURIComponent(itm.ActionType) + "' and Title eq '" + encodeURIComponent(itm.Title) + "' "							
				var type = GetListData(ActionTackerTypesList, typeFilter);
				
				if(type.length > 1){
					alert("multiple meetings " + itm.MeetingDate + " " + itm.ActionType );
					console.log("multiple meetings " + itm.MeetingDate + " " + itm.ActionType );
				}
				
				
				if(type[0].ID){		
					/*		
					if(!type[0].ID){
						alert("meeting not found " + itm.MeetingDate + " " + itm.ActionType );
						console.log("meeting not found " + itm.MeetingDate + " " + itm.ActionType );
					}*/					
					ParentID = type[0].ID;	
					if(!type[0].MeetingMinutes && itm.MeetingMinutes){
						var valuepairs = [];
						valuepairs.push( ["MeetingMinutes", itm.MeetingMinutes ]);	
						UpdateField(ActionTackerTypesList, ParentID , valuepairs );
					}			
				}
				else{
					var item = {}
					item.ActionType = itm.ActionType;
					item.Title = itm.Title;
					item.StartDate = itm.MeetingDate;
					if(itm.MeetingMinutes){
						item.Description = itm.MeetingMinutes;
					}

					var itemId = UpdateList(item, ActionTackerTypesList, true, true);							
					var valuepairs = [];
					valuepairs.push( ["TypeID", itemId ]);	
					UpdateField(ActionTackerTypesList, itemId , valuepairs );
					ParentID = itemId;					
					//item.TypeID = itm.ID;															
				}												
				//Else Create meeting
			}
	
			//Add Task		
			var task = {}
			task.ActionType = itm.ActionType;
			task.ParentID = ParentID ;
			
			task.ActionName = itm.Title;

			task.Title = itm.ActionPointTitle;
			task.StartDate = itm.MeetingDate;
			//task.ComplectionDate = itm.ComplectionDate;
			if(itm.ComplectionDate){
				task.ComplectionDate = new moment(itm.ComplectionDate).format("DD-MMM-YYYY"); //itm.LastModifiedDate;
			}
			

			if(itm.CompletedDate){
				//task.CompletedDate = itm.CompletedDate;
				task.CompletedDate = new moment(itm.CompletedDate).format("DD-MMM-YYYY");
			}
			task.Description = itm.ActionPoint;
			task.Status = itm.Status;
			task.TaskCreaedBy = itm.AuthorId; 
			task.TaskCreatedTime = itm.MeetingDate;
			task.TaskModifiedBy = itm.EditorId;
			if(itm.LastModifiedDate){
				task.TaskModifiedTime = new moment(itm.LastModifiedDate).format("DD-MMM-YYYY"); //itm.LastModifiedDate;
			}
			
			task.ResponsibilityType = itm.ResponsibilityType;
			task.Responsibility = itm.Responsibility;
			if(itm.RespPer){
				var userInfo = '';
				$.each(itm.RespPer.results, function(id1, per){
					userInfo += per.Id + ";#" + per.Title + ";#";
				});
				task.RespPer = userInfo ;
			}		
			task.StakeholderType = itm.StakeholderType;
			task.Stakeholder = itm.Stakeholder;		
			if(itm.StakeholderPer){
				var userInfo = '';
				$.each(itm.StakeholderPer.results, function(id1, per){
					userInfo += per.Id + ";#" + per.Title + ";#";
				});
				task.StakeholderPer= userInfo ;
			}
				
			var taskItemId = UpdateList(task, ActionTackerTaskList, true, true);
			var valuepairs = [];		
			valuepairs.push( ["TaskID", taskItemId ]);	
			UpdateField(ActionTackerTaskList, taskItemId, valuepairs );
			//End of Add Task
			
			msg += " New ID : " + taskItemId;
						
			
			
			//Comment				
			var CommentList =  angular.fromJson(itm.Remarks);
			$.each(CommentList , function(id, cmd){
				var item = {}
				item.TaskID = taskItemId;
				item.Status = cmd.Status;				
				//item.ActionTime = new moment(cmd.Date, "YYYY-MM-DD hh:mm A").format("DD-MMM-YYYY");
				if(cmd.Date){
					try{
						item.ActionTime = cmd.Date; //new moment(cmd.Date, "DD-MMM-YYYY").format("YYYY-MM-DD hh:mm A"); //cmd.Date; //new moment(cmd.Date, "YYYY-MM-DD hh:mm A").format("DD-MMM-YYYY");
					}catch(err){}
				}
				item.Comment = cmd.Comment;				
				try{
					item.ActionBy =GetUserIdFromDisplayName(cmd.From);
				}catch(err){}
				
				var itemId = UpdateList(item, ActionTackerAuditLog, true, true);
			
			});			
			//End of Comment

			//CompletionDateHistory
			try{
				var CompletionDateHistory = angular.fromJson(itm.CompletionDateHistory);
			}catch(ex){
				CompletionDateHistory = [];
			}	
			
			$.each(CompletionDateHistory , function(id, cmd){

				var item = {}
				item.TaskID = taskItemId;
				
				item.Status = "Completion Date change";				
				if(cmd.Date){
					try{
						item.ActionTime = new moment(cmd.Date, "DD-MMM-YYYY").format("YYYY-MM-DD hh:mm A"); //cmd.Date; //new moment(cmd.Date, "YYYY-MM-DD hh:mm A").format("DD-MMM-YYYY");
					}catch(err){}
				}
				
				item.Comment = cmd.ComplectionDate;		
				
				try{
					item.ActionBy =GetUserIdFromDisplayName(cmd.ActionBy );
				}catch(err){}
				
				var itemId = UpdateList(item, ActionTackerAuditLog, true, true);
			});
			
							
			//End of CompletionDateHistory
	
			//End of add task
			
			console.log(msg);
		});	
		
		alert("Done");
	}

	

});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\MeetingTable.html```FileName```<div class="row main-data" style="width:100%" >
    <div class="panel-body" style="width:100%">
        <div id="divDataTable" style="width:100%">
            <table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="second-ListTable" style="width:100%">
                <thead>
                   <tr>					
                       <th class="hide">ID</th>
                       <th style="width:80px" >Date</th>	
                       <th style="width:150px">Meeting Name</th>								
                   </tr>
               </thead>
               <tfoot class="ttcpFooter">
                   <tr class="ttcpFtrTrCompleted">	
                       <th class="hide">ID</th>
                       <th>Date</th>						
                       <th>Meeting Name</th>						
                   </tr>
               </tfoot>
               <tbody>									
                   <tr ng-repeat="it in meetingViewList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
                       <td class="hide">{{it.ID}}</td>	
                       <td data-order="{{DateSer(it.StartDate)}}" >{{it.StartDate}}</td>		            						
                       <td>{{it.Title}}</td>					
                   </tr>				 	  
               </tbody>
           </table>			
        </div>
    </div>	
</div>```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\MeetingTracker\V2\QButtons.html```FileName```<div class="row content divPnlQueue" ng-if="isAdmin">

	<div class="card  QButton" style="border-left: .50rem solid {{qu.color}} !important;" ng-repeat="qu in queueConfig"  
		ng-class="GetQueueButtonClass(qu.Title)" >
		<div class="row  QCard  " style="color:{{qu.color}};">
																
			<div class="col-md-9" ng-click="QueueTaskListing(qu.Title, 'All' )"  >
				<span >{{qu.Display}}</span>
				<span class="badge QBqdge">{{qu.Count}}</span>
			</div>

			<div class="col-md-3 dropdown" style="text-align:center;padding:0px;">							
				<div class=" dropdown-toggle" data-toggle="dropdown" style="margin-right: 20px;"	 >
				 <span class="caret"></span></div>
				 <ul class="dropdown-menu">
				   <li><a ng-click="QueueTaskListing(qu.Title, 'Individual' )" >Individual task<span class="badge QBqdge">{{qu.IndCount}}</span></a></li>
				   <li><a ng-click="QueueTaskListing(qu.Title, 'Team' )" >Team task<span class="badge QBqdge">{{qu.TeamCount}}</span></a></li>				    
				 </ul>
		   </div>
			
		</div>
	</div>	
					
</div>

<div  class="row content  divPnlButton">
	<div class="col-md-10">
		
		<!-- 
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="MeetingDataMiration()" >
			<i class="fa fa-plus-circle" aria-hidden="true" ></i> Data Migration
		</button> 
		-->
		<!--button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddNew('ActionMoldel')" >
			<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Action M
		</button-->

		
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="OnItemClick('ActionList', 'Adhoc')" >
			<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Action
		</button>
			
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="AddMeeting()" >
			<i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Meeting
		</button>
							
					
		<!-- <button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="isAdmin"
			 ng-click="TaskListing('All Tasks')"  ng-class="GetButtonClass('All Tasks')" >
			All Actions<span class="badge QBqdge">{{AllTasksCount}}</span>
		</button> -->

		<div class="btn-group " style="margin-left: 30px;">
			<div style="float:left">
				<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem dropdown-toggle" ng-if="isAdmin"
					ng-click="TaskListing('All Tasks')"  ng-class="GetButtonClass('All Tasks')" 
					>
					All Actions<span class="badge QBqdge">{{AllTasksCount}}</span>				
				</button>
			</div>
			<!-- <div class=" dropdown " style="text-align:center;padding:0px;float:left;margin-top: 30px;margin-left: 10px;">							
				<div class=" dropdown-toggle" data-toggle="dropdown"  >
				 <span class="caret"></span></div>
				 <ul class="dropdown-menu">
				   <li><a ng-click="TaskListing('All Tasks')" >Individual task<span class="badge QBqdge">{{qu.IndCount}}</span></a></li>
				   <li><a ng-click="TaskListing('All Tasks')" >Team task<span class="badge QBqdge">{{qu.TeamCount}}</span></a></li>				    
				 </ul>
		   </div> -->
			
		</div>

		
		
		
		<!-- <button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="!isAdmin"
			 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
			All Actions<span class="badge QBqdge">{{AllTeamTasksCount}}</span>
		</button> -->

		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="!isAdmin"
			 ng-click="TaskListing('Teams Combaind Tasks')"  ng-class="GetButtonClass('Teams Combaind Tasks')" >
			All Actions<span class="badge QBqdge">{{AllTeamTasksCount}}</span>
		</button>


		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-click="TaskListing('Assigned by Me')"  ng-class="GetButtonClass('Assigned by Me')" >
			 Assigned by Me<span class="badge QBqdge">{{AssignedByMeTaskCount}}</span>
		</button>
		
		<button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem"  ng-if="QuqueTitle != 'Meeting View' "
			 ng-click="TaskListing('Meeting View')"  ng-class="GetButtonClass('Meeting View')" >
			Meeting View
		</button>
		
		<!--button type="button" class="btn btn-sm EI-ButtonPurple  AddNewItem" ng-if="QuqueTitle == 'Meeting View' "
			 ng-click="ActionView()"  ng-class="GetButtonClass('Action View')" >
			Action View
		</button-->

	</div>
	
	<div class="col-md-2">								
				        
        <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" title="Clear Filter" ng-click="ClearFilter()">	            	
        	<i class="fa fa-filter actionButtonSign" aria-hidden="true"></i>
        </button>
        
		 <button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="TaskListing(QuqueTitle)" title="Refresh">
            <i class="fa fa-history actionButtonSign" aria-hidden="true"></i>
         </button>	
         
		<!--button class="btn btn-success buttons-html5 iconButton pull-right" type="button" ng-click="ExportToExcel()" title="Export To Excel">	            	
        	<i class="fa fa-download actionButtonSign" aria-hidden="true"></i>
        </button-->            				
	</div>	


</div-->```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\Buttons.html```FileName```<div id="ButtonDiv" style="margin:10px;  ">
	<div style="font-weight:bold;color:red;width:100%;padding-top:3px;padding-left:20px">{{ErrorMessage}}</div>
	
	<div style="float:left;padding:5px" ng-show="ShowSaveButton" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="onBtnSave()" >			
			Save
		</button>									
	</div>
	
	<!--div style="float:left;padding:5px" ng-show="IsBMS && item.CPStatus== 6" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="MarkCounterpartyInactive()" >			
			Mark Counterparty Inactive
		</button>									
	</div>


	<div style="float:left;padding:5px" ng-show="ShowNewWFButton" >		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="SubmitNewWorkflow()" >			
			Submit
		</button>									
	</div>

	<div style="float:left;padding:5px" ng-repeat="sf in StatusFlow">		
		<button style="padding:5px" type="button" class="btn EI-ButtonPurple" ng-click="TakeAction(sf)" >			
			{{sf.Title}}
		</button>									
	</div-->
	
	<div style="float:left;padding:5px">	
		<button type="button" class="btn EI-ButtonPurple" ng-click="onBackClick()" >						 
			Back
		</button>				 		
	</div>

	
</div>

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\ProjDetails.html```FileName```<div class="row" style="margin:0px" >
 <fieldset>
 
 <div class="row" style="">
 
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="Title" id="Title" type="text"  class="form-control" 
					ng-model="item.Title" ng-disabled="read" />
					<span>TRY Initiative</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">TRY Initiative required.</p>
			</label>										 
		</div>
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="Stakeholder" id="Stakeholder" type="Stakeholder"  class="form-control" 
					ng-model="item.Stakeholder" ng-disabled="read" />
					<span>Stakeholder</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">Stakeholder required.</p>
			</label>										 
		</div>
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="Application" id="Application" type="Application"  class="form-control" 
					ng-model="item.Application" ng-disabled="read" />
					<span>Application</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">Application required.</p>
			</label>										 
		</div>
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="RequirementType" id="RequirementType" type="RequirementType"  class="form-control" 
					ng-model="item.RequirementType" ng-disabled="read" />
					<span>RequirementType</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">RequirementType required.</p>
			</label>										 
		</div>
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="Planned" id="Planned" type="Planned"  class="form-control" 
					ng-model="item.Planned" ng-disabled="read" />
					<span>Planned</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">Planned required.</p>
			</label>										 
		</div>
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="InitiativeStatus" id="InitiativeStatus" type="InitiativeStatus"  class="form-control" 
					ng-model="item.InitiativeStatus" ng-disabled="read" />
					<span>InitiativeStatus</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">InitiativeStatus required.</p>
			</label>										 
		</div>
		
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="ProposedPriority" id="ProposedPriority" type="ProposedPriority"  class="form-control" 
					ng-model="item.ProposedPriority" ng-disabled="read" />
					<span>ProposedPriority</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">ProposedPriority required.</p>
			</label>										 
		</div>
		
		<div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label FormLabel">
				<input name="DeskWisePriority" id="DeskWisePriority" type="DeskWisePriority"  class="form-control" 
					ng-model="item.DeskWisePriority" ng-disabled="read" />
					<span>DeskWisePriority</span>
				<p ng-show="(se || af.Fax.$touched) && af.Fax.$invalid " class="text-danger">DeskWisePriority required.</p>
			</label>										 
		</div>





	 
	 
		<!--div class="form-group input-group col-md-4 HedgeDivCol">
			<label class="form-group has-float-label">
			    <select name="Status" class="form-control" ng-model="item.Status" ng-disabled="read"  >
					<option  value="In Progress" >In Progress</option>
					<option  value="Not started" >Not started</option>
					<option  value="Completed" >Completed</option>							
				</select>
			    <span>Status</span>
			     <p ng-show="(se || af.BusinessSegment.$touched) && af.BusinessSegment.$invalid " class="text-danger">Business Segment required.</p>
			</label>										 
		</div>

 
	 
	  <div class="form-group input-group col-md-12 HedgeDivCol">
	 	<label class="form-group has-float-label">		   
			<textarea  name="Description" id="Description" ng-model="item.Description" ng-disabled="read"  class="multiLineInput"  ></textarea>
		    <span>Description</span>
		     <p ng-show="(se || af.Description.$touched) && af.Description.$invalid " class="text-danger">Description required.</p>
		  </label>										 
	  </div>
	  
	  <div class="form-group input-group col-md-12 HedgeDivCol">
	 	<label class="form-group has-float-label">		   
			<textarea  name="Comments" id="Comments" ng-model="item.Comments" ng-disabled="read"  class="multiLineInput"  ></textarea>
		    <span>Comments</span>
		     <p ng-show="(se || af.Description.$touched) && af.Description.$invalid " class="text-danger">Commentsrequired.</p>
		  </label>										 
	  </div-->	
	


 	
	 
 </div>																																														 
																																													 
 </fieldset>   																	  								  																	
</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\ProjectTrackerDetails.html```FileName```<form name="myForm"></form>

<div id="divOverlay" >
	<i class="fa fa-refresh fa-spin fa-5x"></i>
</div>	

<div class="ListDetails" id="ListDetails" data-ng-init="listCtrlOnLoad()" >
  <div class="panel panel-default" style="width: 100%">
   
    
    <div class="panel-heading item-panel-heading" >  
    	
    	<p class="label label-ApprovalStatus itemStatus" style="float:right">						
				<span ng-click="FillTestVal()">Status : {{ item.Status }}</span>
		</p>
			
    	<div class="pannel-header">
			<div class="main-header-title">Project Tracker Details</div>			
		</div>		   		
    </div>

    <div class="panel-body">
        	
        <form name="af" novalidate>	    	    
    	<div class="tab-content pageTabContentStyles">    	
    	
	    			    		    			    		
	    		<div id="tabDetails" class="tab-pane fade in active">	    			
    				<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/MeetingTracker/MeetingDetails.html'" ></div>    				    										    				    				    					    		
	    		</div>
	    		
	    		<!--div id="tabAuctionComments" class="tab-pane fade in ">	    			
    				<div style="width:100%" ng-include="'../SiteAssets/App/html/Comments.html'" ></div>	    						    				    				    					    		
	    		</div>	    			    		
	    		<div id="tabAuctionAuditLogs" class="tab-pane fade in ">	    			
    				<div style="width:100%" ng-include="'../SiteAssets/App/html/auditLog.html'" ></div>		    						    				    				    					    		
	    		</div-->
	    		
	    		
	    		
			
				
				
				<div class="row" style="width: 100%;">
					<div style="width:100%" ng-include="'../SiteAssets/TryUtil/Proj/ProjectTracker/Buttons.html'" ></div>	
				</div>
																	
    	</div>
    	</form>
    </div>
    
  </div>  
</div>


	```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\ProjectTrackerDetailsCtrl.js```FileName```DocApp.controller('ProjectTrackerDetailsCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.f1 = '';
	$scope.f2 = '';	
	$scope.f3 = '';	
	
	$scope.onBackClick = function()    
	{			
		 $location.path("ProjectTracker");
	}	
	
	$scope.onBtnSave = function()    
	{			
		$('#divOverlay').show();
		$('#ListDetails').hide();

		var IsNewReq = $scope.item.ID ? false : true;
		var id = UpdateList($scope.item, "ProjectTracker", IsNewReq, IsNewReq);
		
		$('#divOverlay').hide();
		$('#ListDetails').show();


		$location.path("ProjectTracker");
	}	


	$scope.listCtrlOnLoad = function(){
        	    	    	   			
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		SetSideBar("ProjectTracker", "SharePoint Project Tracker");	
		
		$scope.ShowSaveButton = false;
		
		setTimeout(function(){ 		
    		$scope.listDetailsOnLoadInit();
    	}, 1);
	}
	
	$scope.listDetailsOnLoadInit = function(){
		//$scope.EntityList = GetConfigList("EntityList");
		
		$scope.itenId = $routeParams.itenId;
		$scope.ShowSaveButton = true;
		
		if($routeParams.itenId){
		
			var listFilter = "&$filter=ID eq " + $routeParams.itenId;
			var listItems = GetListData("ProjectTracker", listFilter );
			if(listItems.length > 0 ){				
				$scope.item = listItems[0];
				//$scope.ins = angular.fromJson(listItems[0].HedgingInstrument);				
				//debugger;				
			}
		}
		else{
			$scope.item = {};		
			$scope.StatusId = "1";	
			//$scope.item.HedgeDate =  moment().format('DD-MMM-YYYY');
		}
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();
	}
						  
				
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\ProjectTrackerList.html```FileName```<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class="main-header row">
		<div class="main-header-title col-md-11">SharePoint Projects Tracker</div>
		<div class="col-md-1" style="float:right">
			<a href="https://workplace.emiratesislamic.ae/EITRY/FX/Lists/ProjectTracker/NewForm.aspx?Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx?page=ProjectTracker">Add New Project</a>
			
		</div>				
	</div>
	
	<div class="row main-data">
		<div id="divOverlay" style="display:none;">
			<i class="fa fa-refresh fa-spin fa-5x"></i>
		</div>		
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>					
						<th class="hide">ID</th>
		            	<th>#</th>	
						<th>Initiative Name</th>	
						<th>Workflow Name</th>
						<th>Project Type</th>															
						<th>Stakeholders</th>
						<!--th>Requirement Type</th-->
						<th>Status</th>
						<th>Planned Start Date</th>	
						<th>Completion Date</th>	
						<th>Priority</th>
						<th>Track</th>												
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class="hide">ID</th>
		            	<th>#</th>	
						<th>Initiative Name</th>	
						<th>Workflow Name</th>
						<th>Project Type</th>															
						<th>Stakeholders</th>
						<!--th>Requirement Type</th-->
						<th>Status</th>
						<th>Planned Start Date</th>	
						<th>Completion Date</th>	
						<th>Priority</th>	
						<th>Track</th>					
		            </tr>
		        </tfoot>
		        
		        
				<tbody>									
					<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
						<td class="hide">{{it.ID}}</td>
						<th >{{it.Order0}}</th>		
						<td>{{it.Title}}</td>		            	
						<td>{{it.WorkflowName}}</td>
						<td>{{it.ProjectType}}</td>														
						<td>{{it.Stakeholders}}</td>
						<!--td>{{it.RequirementType}}</td>
						<td>{{it.Status}}</td-->
						<td ng-style="{'Completed':{background:'LightGreen'}}[it.Status]" >{{it.Status}}</td>
						<td>{{it.PlannedStartDate}}</td>
						<td>{{it.CompletionDate}}</td>		
						<td>{{it.Priority}}</td>
						<td ng-style=" 'Delayed':{background:'LightCoral'}, 'On Track':{background: 'LightGreen'}}[it.Track]" >{{it.Track}}</td>
					</tr>				 	  
				</tbody>									
			</table>
		</div>

	</div>


</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\ProjectTrackerListCtrl.js```FileName```DocApp.controller('ProjectTrackerListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad= function(){
								
		//$('#divOverlay').show();
		//$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
			
	}
	
	$scope.listCtrlOnLoadInit = function()
	{
		var filter = "";
		//				
		//$scope.dataList = list;
		//var filter = "&$filter= CPStatus eq 6";
		//$scope.dataList = GeRequests(filter);		
		//$scope.$apply();
		//updateTable();
		
		DestroyTable();
		
		var filter = "&$orderby= Order0 asc "; //"&$filter= StatusId ne 8&$orderby=ID";
		$scope.dataList = GetListData("ProjectTracker", filter );
		$scope.$apply();
		
		updateTable();
		
		SetSideBar("SharePoint Projects", "SharePoint Projects");
					
	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
										
			
				
			$('#main-ListTable').DataTable( {
				
				"pageLength": 50,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 1, "asc" ]],
				"autoWidth": false,
				
				buttons: true ? [				        	
			        {
						text: '<button type="button" class="btn EI-ButtonPurple  AddNewItem" ><i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Project</button>',
						action: function ( e, dt, node, config ) {
							window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/NewProjectTracker/";
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonOrange " >In Progress</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("In Progress", "In Progress");
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >Not started</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("Not started", "Not started");
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >Completed</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("Completed", "Completed");
						}					
					},

					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >All Items</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("", "");
						}					
					}
				] : [],				    
				//responsive: true,
			    //"pageLength": 15,
			    
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						var column = this;
						var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
							.appendTo( $(column.footer()).empty() )
							.on( 'change', function () {
								$('.main-ListTable').DataTable()
								.search('').columns().search('').draw();
								var val = $.fn.dataTable.util.escapeRegex(
									$(this).val()
								);
								column
									.search( val ? '^'+val+'$' : '', true, false )
									.draw();
							} );
						column.data().unique().sort().each( function ( d, j ) {
							
							select.append( '<option value="'+d+'">'+d+'</option>' )

						} );
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				//var id =  $($(auctionReqstItemElem ).children()[0]).text();
				var id = auctionReqstItemElem[0].children[0].textContent;
				
				var loc = "https://workplace.emiratesislamic.ae/EITRY/FX/Lists/ProjectTracker/EditForm.aspx?ID=" + id + "&Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx?page=ProjectTracker";
				//window.open(loc );
				window.location = loc;
				//window.location = "https://workplace.emiratesislamic.ae/EITRY/FX/Lists/ProjectTracker/EditForm.aspx?ID=" + id + "&Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx?page=ProjectTracker";
				
				//https://workplace.emiratesislamic.ae/EITRY/FX/Lists/ProjectTracker/EditForm.aspx?ID=1&Source=

				//debugger;
				//$scope.item = $scope.dataList[id]; 
				//window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/ProjectTrackerDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
			
			
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}



});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\ProjectTracker\ProjListCtrl.js```FileName```DocApp.controller('ProjListCtrl', function($scope, $interval,$location, $timeout) 
{		
	$scope.f1 = '';
	$scope.f2 = '';	
	$scope.f3 = '';	
	$scope.DealerQ = 0;
	$scope.BmsQ = 0;
	$scope.FigQ = 0;	
	$scope.NBFigQ = 0;
	$scope.BackOfficeQ = 0;	
	
	
	$scope.GetStatusText = function(StatusId){	
		res = "";
		if(StatusId){
			var res = GetConfigListItem("StatusList", "StatusId", StatusId, "Title" );
		}
			
		return res;
	}
	
	$scope.GetRequestText = function(ReqId){	
		
		res = "";
		if(ReqId){
			//var res = GetConfigListItem("RequestType", "StatusId", StatusId, "Title" );
			var res = GetConfigListItem("RequestType", "ReqId", ReqId, "Title" );		
		}			
		return res;
	}

	
	$scope.listCtrlOnLoad= function()
    {
    	$('#divOverlay').show();
		$('#ListDetails').hide();
		
		SetSideBar("Counterparty List", "Counterparty List");
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 1);
    }
    
    $scope.ExcelReport = function()
    {    	    	
    	var res = [];		
		var row = ['Customer Name', 'CIF', 'Business Segment', 'Sub Segment', 'Request Type', 'Counterparty Type', 'ENBDLinkID', 'Status' ];						
        res.push(row);   
        $.each($scope.dataList, function(id, val){
        	var row = [];
        	row.push(val.Title);
        	row.push(val.CIF);
        	row.push(val.BusinessSegment);        				
			row.push(val.SubSegment);
			row.push(val.RequestType);
			row.push(val.CounterpartyType);
			row.push(val.ENBDLinkID);
			row.push( $scope.GetStatusText(val.StatusId)  );

        	res.push(row);
		});
		
		ExcelReportDownload(res, 'CounterpartyList-' + moment().format('DD-MM-YYYY-HH-mm-ss') +'.xlsx')
				
    }

    
    $scope.listCtrlOnLoadInit = function()
	{
		var filter = "";		
		DestroyTable();
		var filter = "&$filter= StatusId ne 6";
		$scope.dataList = GeRequests(filter);		
		$scope.$apply();
		updateTable();
		
		setTimeout(function(){
			$('.nav-tabs a').on('shown.bs.tab', function(event){
				var target = $(event.target).text();    // active tab
				var y = $(event.relatedTarget).text();  // previous tab
				if(target == "Pending Requests"){
					DestroyTable();					
					var filter = "&$filter= StatusId ne 5";
					$scope.dataList = GeRequests( filter );
					$scope.$apply();
					updateTable();

				}
				else if(target == "Completed Requests"){					
					DestroyTable();
					var filter = "&$filter= StatusId eq 6";
					$scope.dataList = GetListData("Counterparty", filter );
					$scope.$apply();
					updateTable();					
				}
				else if(target == "Inactive Counterparty"){					
					DestroyTable();
					var filter = "&$filter= CPStatus eq 7";
					$scope.dataList = GetListData("Counterparty", filter );
					$scope.$apply();
					updateTable();					
				}

			});
		});
		
	}
	
	$scope.ShowAjaxData = function(data, column){
		var obj = angular.fromJson(data);
		var res = "";
		$.each(obj , function(id, val){
			res = res ? res + ", " : res;
			res += val[column];
			
		});
		return res;
	}
	
	function GeRequests(filter){	
		
		$scope.f1 = '';
		$scope.f2 = '';	
		$scope.f3 = '';	

		$scope.DealerQ = 0;
		$scope.BmsQ = 0;
		$scope.FigQ = 0;
		$scope.NBFigQ = 0;

		$scope.BackOfficeQ = 0;
			
		var filter = filter + "&$orderby=ID"; // +  "&$filter= StatusId ne 8&$orderby=ID";
		var dataList = GetListData("Counterparty", filter );
		$.each(dataList, function(id, val){
			if( val.StatusId == "1" ){
				$scope.DealerQ++;
			}
			if( val.StatusId == "2" ){
				$scope.BmsQ++;
			}
			if( val.StatusId == "3" ){
				$scope.FigQ++;
			}
			if( val.StatusId == "4" ){
				$scope.NBFigQ++;
			}			
			if( val.StatusId == "5" ){
				$scope.BackOfficeQ++;
			}

		});		
		return dataList;
		
	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
		
					
		if(($.fn.DataTable.isDataTable('#auctionListTable'))){
			$('#auctionListTable').dataTable().fnDestroy();
		}
	}
	
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
										
			
				
			$('#auctionListTable').DataTable( {
				
				"pageLength": 15,
				"order": [[ 1, "asc" ]],
				"autoWidth": false,
				dom: 'Bfrtip',
				buttons: true ? [				        	
			        {
						text: '<button type="button" class="btn btn-primary  AddNewItem" ><i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add Counterparty</button>',
						action: function ( e, dt, node, config ) {
							window.location = "/" + SiteRelativeUrl + "SitePages/AppHome.aspx#!/NewItem/";
						}					
					},
					/*{
						text: '<button type="button" class="btn btn-info AddNewDesignation" >Dealer(' + $scope.DealerQ + ')</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("1","1");
						}					
					},*/
					{
						text: '<button type="button" class="btn btn-success AddNewDesignation" >BMS(' + $scope.BmsQ + ')</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("2","2");
						}					
					},
					/*{
						text: '<button type="button" class="btn btn-warning AddNewDesignation" >FI(' + $scope.FigQ + ')</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("3","3");
						}					
					},
					{
						text: '<button type="button" class="btn btn-warning AddNewDesignation" >NBFI(' + $scope.NBFigQ + ')</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("4","4");
						}					
					},*/
					{
						text: '<button type="button" class="btn btn-warning AddNewDesignation" >Back Officel(' + $scope.BackOfficeQ + ')</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("5","5");
						}					
					},

					{
						text: '<button type="button" class="btn btn-info AddNewDesignation" >All Items</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("","");
						}					
					}		    
				] : [],				    
				//responsive: true,
			    //"pageLength": 15,
			    
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						var column = this;
						var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
							.appendTo( $(column.footer()).empty() )
							.on( 'change', function () {
								$('.auctionListTable').DataTable()
								.search('').columns().search('').draw();
								var val = $.fn.dataTable.util.escapeRegex(
									$(this).val()
								);
								column
									.search( val ? '^'+val+'$' : '', true, false )
									.draw();
							} );
						column.data().unique().sort().each( function ( d, j ) {
							
							select.append( '<option value="'+d+'">'+d+'</option>' )

						} );
					} );
				},
			} );
			
			
			$('#auctionListTable').on("click", "tbody tr", function(){				
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				var id =  $($(auctionReqstItemElem ).children()[0]).text();
				//console.log("id: " + id );
				//$location.path("details/" + id);
				window.location = "/" + SiteRelativeUrl + "SitePages/AppHome.aspx#!/ItemDetails/" + id;
			});
			
			/*
			if(!IsCurrentUserInGroup('HedgeFrontOffice')){
				//$('.AddNewItem').parent().parent().hide();
			}
			*/
			
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 500);
	}




	
	
});```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\TRYProjectTracker\ProjectTrackerDetailsCtrl.js```FileName```DocApp.controller('ProjectTrackerDetailsCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.f1 = '';
	$scope.f2 = '';	
	$scope.f3 = '';	
	
	$scope.onBackClick = function()    
	{			
		 $location.path("ProjectTracker");
	}	
	
	$scope.onBtnSave = function()    
	{			
		$('#divOverlay').show();
		$('#ListDetails').hide();

		var IsNewReq = $scope.item.ID ? false : true;
		var id = UpdateList($scope.item, "ProjectTracker", IsNewReq, IsNewReq);
		
		$('#divOverlay').hide();
		$('#ListDetails').show();


		$location.path("ProjectTracker");
	}	


	$scope.listCtrlOnLoad = function(){
        	    	    	   			
		$('#divOverlay').show();
		$('#ListDetails').hide();
		
		SetSideBar("ProjectTracker", "Project Tracker");	
		
		$scope.ShowSaveButton = false;
		
		setTimeout(function(){ 		
    		$scope.listDetailsOnLoadInit();
    	}, 1);
	}
	
	$scope.listDetailsOnLoadInit = function(){
		//$scope.EntityList = GetConfigList("EntityList");
		
		$scope.itenId = $routeParams.itenId;
		$scope.ShowSaveButton = true;
		
		if($routeParams.itenId){
		
			var listFilter = "&$filter=ID eq " + $routeParams.itenId;
			var listItems = GetListData("ProjectTracker", listFilter );
			if(listItems.length > 0 ){				
				$scope.item = listItems[0];
				//$scope.ins = angular.fromJson(listItems[0].HedgingInstrument);				
				//debugger;				
			}
		}
		else{
			$scope.item = {};		
			$scope.StatusId = "1";	
			//$scope.item.HedgeDate =  moment().format('DD-MMM-YYYY');
		}
		$scope.$apply();
		$('#divOverlay').hide();
		$('#ListDetails').show();
	}
						  
				
});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\TRYProjectTracker\ProjectTrackerList.html```FileName```<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class="main-header row">
		<div class="main-header-title col-md-11">Project Tracker</div>
		<div class="col-md-1" style="float:right">
			<a href="https://workplace.emiratesislamic.ae/EITRY/FX/Lists/TRYProjectTracker/NewForm.aspx?Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx?page=TRYProjectTracker">Add New Project</a>
			
		</div>	
		
		
	</div>
	
	<div class="row main-data">
		<div id="divOverlay" style="display:none;">
			<i class="fa fa-refresh fa-spin fa-5x"></i>
		</div>		
		<div id="divDataTable" style="width:100%">
			<table class="table table-hover table-striped table-condensed dataTable dt-responsive ListDetails" id="main-ListTable" style="width:100%">				
				<thead>
					<tr>										
						<th class="hide">ID</th>
		            	<th>#</th>	
						<th>TRY Initiative</th>	
						<th>Project Type</th>															
						<th>Application</th>
						<th>RequirementType</th>
						<th>Stakeholder</th>	
						<th>Initiative Status</th>	
						<th>PlannedStartDate</th>
						<th>Completion Date</th>
						<th>Track</th>												
					</tr>
				</thead>
				
				<tfoot class="ttcpFooter">
		            <tr class="ttcpFtrTrCompleted">	
		            	<th class="hide">ID</th>
		            	<th>#</th>	
						<th>TRY Initiative</th>	
						<th>Project Type</th>															
						<th>Application</th>
						<th>RequirementType</th>
						<th>Stakeholder</th>	
						<th>Initiative Status</th>	
						<th>PlannedStartDate</th>
						<th>Completion Date</th>
						<th>Track</th>											
		            </tr>
		        </tfoot>

				<tbody>									
					<tr ng-repeat="it in dataList  | orFilter:'Status': f1: f2 : f3 " ng-class-odd="'alloTableOdd'" ng-class-even="'alloTableEven'">	
						<td class="hide">{{it.ID}}</td>						
						<th >{{it.PrjOrder}}</th>		
						<td>{{it.Title}}</td>		            	
						<td>{{it.ProjectType}}</td>															
						<td>{{it.Application}}</td>
						<td>{{it.RequirementType}}</td>
						<td>{{it.Stakeholder}}</td>
						<td>{{it.InitiativeStatus}}</td>		
						<td>{{it.PlannedStartDate}}</td>
						<td>{{it.CompletionDate}}</td>
						<td ng-style="{'Delayed':{background:'LightCoral'}, 'On Track':{background: 'LightGreen'}}[it.Track]" >{{it.Track}}</td>										
					</tr>				 	  
				</tbody>									
			</table>
		</div>

	</div>


</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\TRYProjectTracker\ProjectTrackerListCtrl.js```FileName```DocApp.controller('TRYProjectTrackerListCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad= function(){
	
					
		
		//$('#divOverlay').show();
		//$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
			
	}
	
	$scope.listCtrlOnLoadInit = function()
	{
		var filter = "";
		//				
		//$scope.dataList = list;
		//var filter = "&$filter= CPStatus eq 6";
		//$scope.dataList = GeRequests(filter);		
		//$scope.$apply();
		//updateTable();
		
		DestroyTable();
		
		var filter = "&$orderby= PrjOrder asc "; //"&$filter= StatusId ne 8&$orderby=ID";
		$scope.dataList = GetListData("TRYProjectTracker", filter );
		$scope.$apply();
		
		updateTable();
		SetSideBar("Other Projects", "Other Projects");
					
	}
	
	function DestroyTable(){
		$('#divOverlay').show();
		$('#divDataTable').hide();
							
		if(($.fn.DataTable.isDataTable('#main-ListTable'))){
			$('#main-ListTable').dataTable().fnDestroy();
		}
	}
	
	function UpdateList(f1,f2,f3){				
		
		DestroyTable();
		$scope.f1 = f1;
		$scope.f2 = f2;	
		if(f3){
			$scope.f3 = f3;
		}
		else{
			$scope.f3 = '';
		}
		$scope.$apply();		
		updateTable();


	}
	
	function updateTable(){
	
		setTimeout(function(){ 	
										
			
				
			$('#main-ListTable').DataTable( {
				
				"pageLength": 50,
				"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
				"order": [[ 1, "asc" ]],
				"autoWidth": false,
				
				buttons: true ? [				        	
			        {
						text: '<button type="button" class="btn EI-ButtonPurple  AddNewItem" ><i class="fa fa-plus-circle" aria-hidden="true" ></i>  Add New Project</button>',
						action: function ( e, dt, node, config ) {
							window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/NewTRYProjectTracker/";
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonOrange " >In Progress</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("In Progress", "In Progress");
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >Not started</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("Not started", "Not started");
						}					
					},
					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >Completed</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("Completed", "Completed");
						}					
					},

					{
						text: '<button type="button" class="btn EI-ButtonBlueGreeen " >All Items</button>',
						action: function ( e, dt, node, config ) {							
							UpdateList("", "");
						}					
					}
				] : [],				    
				//responsive: true,
			    //"pageLength": 15,
			    
			    initComplete: function () {
			    
					this.api().columns().every( function (ColCount) {
						var column = this;
						var select = $('<select id="DataTableSelect' + ColCount + '" ><option value=""></option></select>')
							.appendTo( $(column.footer()).empty() )
							.on( 'change', function () {
								$('.main-ListTable').DataTable()
								.search('').columns().search('').draw();
								var val = $.fn.dataTable.util.escapeRegex(
									$(this).val()
								);
								column
									.search( val ? '^'+val+'$' : '', true, false )
									.draw();
							} );
						column.data().unique().sort().each( function ( d, j ) {
							
							select.append( '<option value="'+d+'">'+d+'</option>' )

						} );
					} );
				},
			} );
			
			
			$('#main-ListTable').on("click", "tbody tr ", function(){				
				auctionReqstItemElem = $(this);
				//alert($($(auctionReqstItemElem ).children()[0]).text() );
				//var id =  $($(auctionReqstItemElem ).children()[0]).text();
				var id = auctionReqstItemElem[0].children[0].textContent;
				
				var loc = "https://workplace.emiratesislamic.ae/EITRY/FX/Lists/TRYProjectTracker/EditForm.aspx?ID=" + id + "&Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx?page=TRYProjectTracker";
				//window.open(loc );
				window.location = loc;
				//window.location = "https://workplace.emiratesislamic.ae/EITRY/FX/Lists/TRYProjectTracker/EditForm.aspx?ID=" + id + "&Source=https://workplace.emiratesislamic.ae/EITRY/FX/SitePages/TryUtil.aspx?page=TRYProjectTracker";
				
				//https://workplace.emiratesislamic.ae/EITRY/FX/Lists/TRYProjectTracker/EditForm.aspx?ID=1&Source=

				//debugger;
				//$scope.item = $scope.dataList[id]; 
				//window.location = "/" + SiteRelativeUrl + "SitePages/TryUtil.aspx#!/TRYProjectTrackerDetails/" + id;				
				$scope.$apply();
				//$('#cptryDetailsModel').modal('toggle');
			});
			
			
			
			$('#divOverlay').hide();
			$('#divDataTable').show();
			
				 						
		}, 100);
	}



});

```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\UserAccess\UserAccess.html```FileName```<div  data-ng-init="listCtrlOnLoad()" class="main-panel">

	<div class="main-header row">
		<div class="main-header-title col-md-11">User Access</div>
		<div class="col-md-1" style="float:right">
			
			
		</div>				
	</div>
	
	<div class="row main-data" style="padding-left:50px">
		<div id="divOverlay" style="display:none;">
			<i class="fa fa-refresh fa-spin fa-5x"></i>
		</div>		
		<div id="divDataTable" style="width:100%">
			<br/><br/>
			<input type="button" class="btn" value="Add User"  ng-click="addUser()" />
			<input type="button" class="btn" value="Delete User"  ng-click="deleteUser()" />

			</div>

	</div>


</div>
```File``````FileName```C:\Shaiju\Backup\File\code\TryUTIL\Proj\UserAccess\UserAccessCtrl.js```FileName```DocApp.controller('UserAccessCtrl', function($scope, $interval,$location, $timeout,$routeParams) 
{
	$scope.listCtrlOnLoad= function(){
								
		//$('#divOverlay').show();
		//$('#ListDetails').hide();
		
		setTimeout(function(){ 		
    		$scope.listCtrlOnLoadInit();
    	}, 10);
			
	}
	
	$scope.listCtrlOnLoadInit = function()
	{
		var filter = "";

		/*
		var filter = "&$orderby= Order0 asc "; //"&$filter= StatusId ne 8&$orderby=ID";
		$scope.dataList = GetListData("ProjectTracker", filter );
		$scope.$apply();
		
		updateTable();
		*/
		SetSideBar("User Access", "User Access");
					
	}
	
	
	$scope.addUser = function(){
		//addUserToSharePointGroup();
		AddUserToSharePointGroup('TestGroup', 'ShaijukumarK',onQuerySucceeded ); 
	}
	
	$scope.deleteUser = function(){
		RemoveUserFromSharePointGroup('TestGroup', 'ShaijukumarK',onQuerySucceeded );

	}
	
	function AddUserToSharePointGroup(groupName, userName, callbackFunction) {  
        
        var clientContext = new SP.ClientContext.get_current();  
        var siteGroups = clientContext.get_web().get_siteGroups();  
        var web = clientContext.get_web();  
        var spGroup = siteGroups.getByName(groupName);  
        var user = web.ensureUser(userName);  
        var userCollection = spGroup.get_users();  
        userCollection.addUser(user);  
        clientContext.load(user);  
        clientContext.load(spGroup);  
        clientContext.executeQueryAsync(function() {  
                callbackFunction();  
            }  
            ,
             function() {  
                alert('Request failed.');  
            } 
        );  
    }   
      
    function RemoveUserFromSharePointGroup(groupName, userName, callbackFunction) {  
        var clientContext = new SP.ClientContext.get_current();  
        var siteGroups = clientContext.get_web().get_siteGroups();  
        var web = clientContext.get_web();  
        var spGroup = siteGroups.getByName(groupName);  
        var user = web.ensureUser(userName);  
        var userCollection = spGroup.get_users();  
        clientContext.load(user);  
        clientContext.load(spGroup);  
        clientContext.executeQueryAsync(function() {  
                userCollection.removeByLoginName(user.get_loginName());  
                clientContext.executeQueryAsync(function() {
                    callbackFunction();
                }, function(){}); 
            }  
            ,
             function() {  
                alert('Request failed.');  
            } 
        );   
    }  
	
	function onQuerySucceeded() {
	     debugger;  
	    alert( " added.");
	}
	
	function onQueryFailed(sender, args) {
	debugger;
	    alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
	}



});
